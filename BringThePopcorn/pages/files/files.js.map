{"version":3,"sources":["files.ts"],"names":["BtPo","BtPo.UI","BtPo.UI.Pages","BtPo.UI.Pages.FilesPage","BtPo.UI.Pages.FilesPage.constructor","BtPo.UI.Pages.FilesPage.init","BtPo.UI.Pages.FilesPage.processed","BtPo.UI.Pages.FilesPage.picmedia","BtPo.UI.Pages.FilesPage.openmedia","BtPo.UI.Pages.FilesPage.hideMediaPicker","BtPo.UI.Pages.FilesPage.listItemInvoked","BtPo.UI.Pages.FilesPage.openItemsFor","BtPo.UI.Pages.FilesPage.navback","BtPo.UI.Pages.FilesPage.checkCurrentItemActions","BtPo.UI.Pages.FilesPage.templateSelector","BtPo.UI.Pages.FilesPage.playCurrent","BtPo.UI.Pages.FilesPage.addCurrent"],"mappings":"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","file":"BringThePopcorn/pages/files/files.js","sourcesContent":["module BtPo.UI.Pages {\r\n\r\n    export class FilesPage {\r\n        public static url = \"/pages/files/files.html\";\r\n        element: HTMLElement;\r\n        itemsPromise: WinJS.Promise<Kodi.Data.IMediaLibrary>;\r\n        data: Kodi.Data.IMediaLibrary;\r\n        filesList: WinJS.UI.ListView<any>;\r\n        fileitemtemplate: WinJS.Binding.Template;\r\n        folderitemtemplate: WinJS.Binding.Template;\r\n        mediacontainer: HTMLElement;\r\n        pagetitle: HTMLElement;\r\n        currentItemActions: HTMLElement;\r\n        btnup: HTMLButtonElement;\r\n        currentMedia: string;\r\n        currentRoot: any;\r\n        stack: any[];\r\n\r\n        init(element, options) {\r\n            this.stack = [];\r\n            \r\n            this.itemsPromise = Kodi.Data.loadRootData().then((data) => {\r\n                this.data = data;\r\n                return data;\r\n            });\r\n\r\n            if (options.media) {\r\n                this.itemsPromise = this.itemsPromise.then((data) => {\r\n                    this.openmedia(options.media);\r\n                    return data;\r\n                });\r\n            }\r\n        }\r\n\r\n        processed(element, options) {\r\n            this.checkCurrentItemActions();\r\n            this.filesList.itemTemplate = this.templateSelector.bind(this);\r\n        }\r\n\r\n        picmedia(arg) {\r\n            var elt = arg.elt as HTMLElement;\r\n            var media = elt.getAttribute(\"mediatype\");\r\n            this.openmedia(media);\r\n        }\r\n\r\n        openmedia(media: string) {\r\n            if (media == \"videos\") {\r\n                this.currentMedia = media;\r\n                this.pagetitle.innerText = media;\r\n                this.currentRoot = null;\r\n                this.stack.push({ items: new WinJS.Binding.List(this.data.videoSources.sources), label: media, isMediaSources : true });\r\n                this.filesList.itemDataSource = new WinJS.Binding.List(this.data.videoSources.sources).dataSource;\r\n                this.hideMediaPicker();\r\n            } else if (media == \"music\") {\r\n                this.currentMedia = media;\r\n                this.pagetitle.innerText = media;\r\n                this.currentRoot = null;\r\n                this.stack.push({ items: new WinJS.Binding.List(this.data.musicSources.sources), label: media, isMediaSources: true });\r\n                this.filesList.itemDataSource = new WinJS.Binding.List(this.data.musicSources.sources).dataSource;\r\n                this.hideMediaPicker();\r\n            } else if (media == \"pictures\") {\r\n                this.currentMedia = media;\r\n                this.pagetitle.innerText = media;\r\n                this.currentRoot = null;\r\n                this.stack.push({ items: new WinJS.Binding.List(this.data.picturesSources.sources), label: media, isMediaSources: true });\r\n                this.filesList.itemDataSource = new WinJS.Binding.List(this.data.picturesSources.sources).dataSource;\r\n                this.hideMediaPicker();\r\n            }\r\n        }\r\n\r\n        hideMediaPicker() {\r\n            \r\n            WinJS.UI.Animation.exitContent(this.mediacontainer).then(() => {\r\n                this.mediacontainer.style.display = \"none\";\r\n                setImmediate(() => {\r\n                    this.btnup.disabled = false;\r\n                });\r\n            });\r\n        }\r\n\r\n        listItemInvoked(arg) {\r\n            var page = this;\r\n            arg.detail.itemPromise.done(function (item) {\r\n                if (!item.data.filetype || item.data.filetype == 'directory') {\r\n                    page.openItemsFor(item.data);\r\n                } else {\r\n                    //return Kodi.API.Player.open(item.data.file, false);\r\n                }\r\n            });\r\n        }\r\n\r\n        openItemsFor(item) {\r\n            if (!item.filetype || item.filetype == 'directory') {\r\n                this.filesList.itemDataSource = null;\r\n                var target = item.file;\r\n                //if (item.file[item.file.length - 1] != '\\\\') {\r\n                //    var idx = item.file.lastIndexOf('\\\\');\r\n                //    target = item.file.substr(0, idx);\r\n                //}\r\n                console.log('opening ' + target);\r\n                this.pagetitle.innerText = item.label;\r\n                Kodi.API.Files.getDirectory('files', target).done((items) => {\r\n                    var fileitem = { id: item.id, label: item.label, file: target, items: items ? new WinJS.Binding.List(items.files) : new WinJS.Binding.List() };\r\n                    this.stack.push(fileitem);\r\n                    this.currentRoot = fileitem;\r\n                    this.checkCurrentItemActions();\r\n                    this.filesList.itemDataSource = this.currentRoot.items.dataSource;\r\n                });\r\n            }\r\n            this.checkCurrentItemActions();\r\n        }\r\n\r\n        navback() {\r\n            if (this.stack.length > 1) {\r\n                this.stack.splice(this.stack.length - 1, 1);\r\n                this.currentRoot = this.stack[this.stack.length - 1];\r\n                this.filesList.itemDataSource = this.currentRoot.items.dataSource;\r\n                this.pagetitle.innerText = this.currentRoot.label;\r\n            } else {\r\n                this.currentRoot = null;\r\n                this.mediacontainer.style.display = \"\";\r\n                this.pagetitle.innerText = \"files\";\r\n                this.filesList.itemDataSource = null;\r\n                setImmediate(() => {\r\n                    this.btnup.disabled = true;\r\n                });\r\n                WinJS.UI.Animation.enterContent(this.mediacontainer);\r\n            }\r\n            \r\n            this.checkCurrentItemActions();\r\n        }\r\n\r\n        checkCurrentItemActions() {\r\n            if (this.currentRoot && !this.currentRoot.isMediaSources) {\r\n                this.currentItemActions.style.visibility = \"visible\";\r\n            } else {\r\n                this.currentItemActions.style.visibility = \"hidden\";\r\n            }\r\n        }\r\n\r\n        templateSelector(arg) {\r\n            var page = this;\r\n            return arg.then(function (item) {\r\n                if (!item.data.filetype || item.data.filetype == 'directory')\r\n                    return page.folderitemtemplate.render(item.data).then(function (rendered) {\r\n                        $(rendered.children[0]).click(function () {\r\n                            page.openItemsFor(item.data);\r\n                        });\r\n                        return rendered;\r\n                    });\r\n                else {\r\n                    return page.fileitemtemplate.render(item.data).then(function (rendered) {\r\n                        var element = <any>rendered.children[0];\r\n                        var btnplay = element.querySelector(\".btpo-play\");\r\n                        var btnadd = element.querySelector(\".btpo-add\");\r\n                        $(element).click(function () {\r\n                            $(\".file-item.file.showActions\", page.element).removeClass(\"showActions\");\r\n                            element.classList.add(\"showActions\");\r\n                            clearTimeout(element.actionsTimeout);\r\n                            element.actionsTimeout = setTimeout(() => {\r\n                                element.classList.remove(\"showActions\");\r\n                            }, 5000);\r\n                        });\r\n\r\n                        WinJSContrib.UI.tap(btnplay, () => {\r\n                            return Kodi.API.Player.open(item.data.file, false);\r\n                        });\r\n\r\n                        WinJSContrib.UI.tap(btnadd, () => {\r\n                            return Kodi.API.Player.add(item.data.file, false);\r\n                        });\r\n\r\n                        return rendered;\r\n                    });\r\n                }\r\n            });\r\n        }\r\n\r\n        playCurrent() {\r\n            if (this.currentRoot && !this.currentRoot.isMediaSources) {\r\n                return Kodi.API.Player.open(this.currentRoot.file, true);\r\n            }\r\n        }\r\n\r\n        addCurrent() {\r\n            if (this.currentRoot && !this.currentRoot.isMediaSources) {\r\n                return Kodi.API.Player.add(this.currentRoot.file, true);\r\n            }\r\n        }\r\n    }\r\n\r\n    WinJS.UI.Pages.define(FilesPage.url, FilesPage);\r\n}\r\n"],"sourceRoot":" "}