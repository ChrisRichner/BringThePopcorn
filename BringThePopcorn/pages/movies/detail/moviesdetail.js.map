{"version":3,"sources":["moviesdetail.ts"],"names":["BtPo","BtPo.UI","BtPo.UI.Pages","BtPo.UI.Pages.MovieDetailPage","BtPo.UI.Pages.MovieDetailPage.constructor","BtPo.UI.Pages.MovieDetailPage.processed","BtPo.UI.Pages.MovieDetailPage.ready","BtPo.UI.Pages.MovieDetailPage.renderCast","BtPo.UI.Pages.MovieDetailPage.checkScroll","BtPo.UI.Pages.MovieDetailPage.resumeMovie","BtPo.UI.Pages.MovieDetailPage.playMovie","BtPo.UI.Pages.MovieDetailPage.playMovieLocal","BtPo.UI.Pages.MovieDetailPage.downloadMovie","BtPo.UI.Pages.MovieDetailPage.updateLayout"],"mappings":"AAAA,IAAO,IAAI,CAiIV;AAjID,WAAO,IAAI;IAACA,IAAAA,EAAEA,CAiIbA;IAjIWA,WAAAA,EAAEA;QAACC,IAAAA,KAAKA,CAiInBA;QAjIcA,WAAAA,KAAKA,EAACA,CAACA;YAClBC,IAAIA,aAAaA,GAAGA,IAAIA,KAAKA,CAACA,OAAOA,CAACA,QAAQA,CAACA,IAAIA,EAAEA,EAAEA,IAAIA,EAAEA,uBAAuBA,EAAEA,YAAYA,EAAEA,IAAIA,EAAEA,CAACA,CAACA;YAE5GA;gBAAAC;gBA0HAC,CAACA;gBAzGGD,mCAASA,GAATA,UAAUA,OAAOA,EAAEA,OAAOA;oBAA1BE,iBAkCCA;oBAjCGA,IAAIA,CAACA,KAAKA,GAAGA,OAAOA,CAACA,KAAKA,CAACA;oBAC3BA,IAAIA,CAACA,OAAOA,CAACA,EAAEA,GAAGA,OAAOA,GAAGA,YAAYA,CAACA,KAAKA,CAACA,IAAIA,EAAEA,CAACA;oBACtDA,IAAIA,CAACA,iBAAiBA,CAACA,MAAMA,GAAGA,GAAGA,GAAGA,IAAIA,CAACA,OAAOA,CAACA,EAAEA,GAAGA,qBAAqBA,CAACA;oBAC9EA,IAAIA,CAACA,YAAYA,CAACA,QAAQA,CAACA,IAAIA,CAACA,eAAeA,EAAEA,QAAQA,EAAEA;wBACvDA,oBAAoBA,CAACA,KAAIA,CAACA,WAAWA,CAACA,CAACA;wBACvCA,KAAIA,CAACA,WAAWA,GAAGA,qBAAqBA,CAACA;4BACrCA,KAAIA,CAACA,WAAWA,EAAEA,CAACA;wBACvBA,CAACA,CAACA,CAACA;oBACPA,CAACA,CAACA,CAACA;oBAEHA,EAAEA,CAACA,CAACA,IAAIA,CAACA,KAAKA,CAACA,IAAIA,CAACA,CAACA,CAACA;wBAClBA,IAAIA,IAAIA,GAAGA,IAAIA,CAACA,KAAKA,CAACA,cAAcA,CAACA,IAAIA,CAACA,KAAKA,CAACA,IAAIA,CAACA,CAACA;wBACtDA,EAAEA,CAACA,CAACA,IAAIA,CAACA,CAACA,CAACA;4BACPA,2CAA2CA;4BAC3CA,IAAIA,CAACA,iBAAiBA,CAACA,KAAKA,CAACA,OAAOA,GAAGA,EAAEA,CAACA;wBAC9CA,CAACA;oBACLA,CAACA;oBAEDA,IAAIA,CAACA,GAAGA,CAACA,MAAMA,CAACA,MAAMA,CAACA,eAAeA,CAACA,IAAIA,CAACA,KAAKA,CAACA,OAAOA,CAACA,CAACA,IAAIA,CAACA,UAACA,MAAMA;wBACnEA,EAAEA,CAACA,CAACA,MAAMA,CAACA,YAAYA,CAACA,MAAMA,IAAIA,MAAMA,CAACA,YAAYA,CAACA,MAAMA,CAACA,QAAQA,CAACA,CAACA,CAACA;4BACpEA,KAAIA,CAACA,cAAcA,CAACA,KAAKA,CAACA,OAAOA,GAAGA,EAAEA,CAACA;wBAC3CA,CAACA;oBACLA,CAACA,EAAEA,UAAUA,GAAGA;wBACZ,IAAI,CAAC,GAAG,GAAG,CAAC;oBAChB,CAAC,CAACA,CAACA;oBAGHA,IAAIA,CAACA,GAAGA,EAAEA,CAACA;oBACXA,IAAIA,SAASA,GAAGA,IAAIA,CAACA,OAAOA,CAACA,gBAAgBA,CAACA,eAAeA,CAACA,CAACA;oBAC/DA,GAAGA,CAACA,CAACA,GAAGA,CAACA,CAACA,GAAGA,CAACA,EAAEA,CAACA,GAAGA,SAASA,CAACA,MAAMA,EAAEA,CAACA,GAAGA,CAACA,EAAEA,CAACA,EAAEA,EAAEA,CAACA;wBAC/CA,CAACA,CAACA,IAAIA,CAACA,KAAKA,CAACA,OAAOA,CAACA,UAAUA,CAAUA,SAASA,CAACA,CAACA,CAACA,EAAEA,OAAOA,CAACA,KAAKA,CAACA,CAACA,CAACA;oBAC3EA,CAACA;oBACDA,MAAMA,CAACA,KAAKA,CAACA,OAAOA,CAACA,IAAIA,CAACA,CAACA,CAACA,CAACA;gBACjCA,CAACA;gBAEDF,+BAAKA,GAALA,UAAMA,OAAOA,EAAEA,OAAOA;oBAAtBG,iBAICA;oBAHGA,UAAUA,CAACA;wBACPA,KAAIA,CAACA,UAAUA,EAAEA,CAACA;oBACtBA,CAACA,EAAEA,GAAGA,CAACA,CAACA;gBACZA,CAACA;gBAEDH,oCAAUA,GAAVA;oBAAAI,iBAgBCA;oBAfGA,IAAIA,SAASA,GAAGA,QAAQA,CAACA,sBAAsBA,EAAEA,CAACA;oBAClDA,IAAIA,CAACA,GAAGA,EAAEA,CAACA;oBACXA,IAAIA,KAAKA,GAAGA,EAAEA,CAACA;oBACfA,IAAIA,CAACA,KAAKA,CAACA,IAAIA,CAACA,KAAKA,CAACA,CAACA,EAACA,EAAEA,CAACA,CAACA,OAAOA,CAACA,UAACA,CAACA;wBAClCA,CAACA,CAACA,IAAIA,CAACA,aAAaA,CAACA,MAAMA,CAACA,CAACA,CAACA,CAACA,IAAIA,CAACA,UAACA,QAAQA;4BACzCA,QAAQA,CAACA,KAAKA,CAACA,OAAOA,GAAGA,GAAGA,CAACA;4BAC7BA,KAAKA,CAACA,IAAIA,CAACA,QAAQA,CAACA,CAACA;4BACrBA,SAASA,CAACA,WAAWA,CAACA,QAAQA,CAACA,CAACA;wBACpCA,CAACA,CAACA,CAACA,CAACA;oBACRA,CAACA,CAACA,CAACA;oBAEHA,KAAKA,CAACA,OAAOA,CAACA,IAAIA,CAACA,CAACA,CAACA,CAACA,IAAIA,CAACA;wBACvBA,KAAIA,CAACA,SAASA,CAACA,WAAWA,CAACA,SAASA,CAACA,CAACA;wBACtCA,KAAKA,CAACA,EAAEA,CAACA,SAASA,CAACA,SAASA,CAACA,KAAKA,CAACA,CAACA;oBACxCA,CAACA,CAACA,CAACA;gBACPA,CAACA;gBAEDJ,qCAAWA,GAAXA;oBACIK,IAAIA,CAACA,GAAGA,IAAIA,CAACA,YAAYA,CAACA,YAAYA,CAACA;oBACvCA,IAAIA,cAAcA,GAAGA,IAAIA,CAACA,WAAWA,CAACA,MAAMA,CAACA,MAAMA,CAACA,MAAMA,CAACA;oBAC3DA,EAAEA,CAACA,CAACA,CAACA,cAAcA,IAAIA,IAAIA,CAACA,YAAYA,CAACA,KAAKA,CAACA,OAAOA,CAACA,CAACA,CAACA;wBACrDA,IAAIA,CAACA,YAAYA,CAACA,KAAKA,CAACA,OAAOA,GAAGA,EAAEA,CAACA;oBACzCA,CAACA;oBAEDA,IAAIA,GAAGA,GAAGA,CAACA,CAACA,GAAGA,IAAIA,CAACA,eAAeA,CAACA,SAASA,CAACA,CAACA;oBAC/CA,EAAEA,CAACA,CAACA,GAAGA,GAAGA,CAACA,CAACA,CAACA,CAACA;wBACVA,EAAEA,CAACA,CAACA,IAAIA,CAACA,YAAYA,CAACA,KAAKA,CAACA,OAAOA,IAAIA,GAAGA,CAACA,CAACA,CAACA;4BACzCA,IAAIA,CAACA,YAAYA,CAACA,KAAKA,CAACA,OAAOA,GAAGA,GAAGA,CAACA;wBAC1CA,CAACA;wBACDA,EAAEA,CAACA,CAACA,cAAcA,IAAIA,IAAIA,CAACA,YAAYA,CAACA,KAAKA,CAACA,OAAOA,IAAIA,GAAGA,CAACA,CAACA,CAACA;4BAC3DA,IAAIA,CAACA,YAAYA,CAACA,KAAKA,CAACA,OAAOA,GAAGA,GAAGA,CAACA;wBAC1CA,CAACA;oBACLA,CAACA;oBAACA,IAAIA,CAACA,CAACA;wBACJA,IAAIA,GAAGA,GAAGA,CAACA,GAAGA,GAAGA,CAACA,CAACA,CAACA,OAAOA,CAACA,CAACA,CAACA,GAAGA,EAAEA,CAACA;wBACpCA,EAAEA,CAACA,CAACA,IAAIA,CAACA,YAAYA,CAACA,KAAKA,CAACA,OAAOA,IAAIA,GAAGA,CAACA,CAACA,CAACA;4BACzCA,IAAIA,CAACA,YAAYA,CAACA,KAAKA,CAACA,OAAOA,GAAGA,GAAGA,CAACA;4BACtCA,EAAEA,CAACA,CAACA,cAAcA,CAACA,CAACA,CAACA;gCACjBA,IAAIA,CAACA,YAAYA,CAACA,KAAKA,CAACA,OAAOA,GAAGA,GAAGA,CAACA;4BAC1CA,CAACA;wBACLA,CAACA;oBACLA,CAACA;gBACLA,CAACA;gBAGDL,qCAAWA,GAAXA;oBACIM,MAAMA,CAACA,IAAIA,CAACA,GAAGA,CAACA,MAAMA,CAACA,MAAMA,CAACA,SAASA,CAACA,IAAIA,CAACA,KAAKA,CAACA,OAAOA,EAAEA,IAAIA,CAACA,CAACA;gBACtEA,CAACA;gBAEDN,mCAASA,GAATA;oBACIO,MAAMA,CAACA,IAAIA,CAACA,GAAGA,CAACA,MAAMA,CAACA,MAAMA,CAACA,SAASA,CAACA,IAAIA,CAACA,KAAKA,CAACA,OAAOA,CAACA,CAACA;gBAChEA,CAACA;gBAEDP,wCAAcA,GAAdA;oBACIQ,MAAMA,CAACA,IAAIA,CAACA,GAAGA,CAACA,cAAcA,CAACA,IAAIA,CAACA,KAAKA,CAACA,IAAIA,CAACA,CAACA;gBACpDA,CAACA;gBAEDR,uCAAaA,GAAbA;gBACAS,CAACA;gBAEDT,sCAAYA,GAAZA;oBACIU,IAAIA,CAACA,WAAWA,EAAEA,CAACA;gBACvBA,CAACA;gBAxHaV,mBAAGA,GAAGA,wCAAwCA,CAACA;gBAyHjEA,sBAACA;YAADA,CA1HAD,AA0HCC,IAAAD;YA1HYA,qBAAeA,kBA0H3BA,CAAAA;YAEUA,iBAAWA,GAAGA,KAAKA,CAACA,EAAEA,CAACA,KAAKA,CAACA,MAAMA,CAACA,eAAeA,CAACA,GAAGA,EAAEA,eAAeA,CAACA,CAACA;QAEzFA,CAACA,EAjIcD,KAAKA,GAALA,QAAKA,KAALA,QAAKA,QAiInBA;IAADA,CAACA,EAjIWD,EAAEA,GAAFA,OAAEA,KAAFA,OAAEA,QAiIbA;AAADA,CAACA,EAjIM,IAAI,KAAJ,IAAI,QAiIV","file":"BringThePopcorn/pages/movies/detail/moviesdetail.js","sourcesContent":["module BtPo.UI.Pages {\r\n    var actortemplate = new WinJS.Binding.Template(null, { href: '/templates/actor.html', extractChild: true });\r\n            \r\n    export class MovieDetailPage {\r\n        public static url = \"/pages/movies/detail/moviesdetail.html\";\r\n\r\n        element: HTMLElement;\r\n        eventTracker: WinJSContrib.UI.EventTracker;\r\n        movie: Kodi.API.Videos.Movies.Movie;\r\n        btnDownloadMovie: HTMLElement;\r\n        btnPlayMovieLocal: HTMLElement;\r\n        btnResumeMovie: HTMLElement;\r\n        headerbanner: HTMLElement;\r\n        headerposter: HTMLElement;\r\n        castItems: HTMLElement;\r\n        visualstate: any;\r\n        scrollContainer: HTMLElement;\r\n        scrollDelay: number;\r\n        actorsAspectRatio: any;\r\n\r\n        processed(element, options) {\r\n            this.movie = options.movie;\r\n            this.element.id = \"page-\" + WinJSContrib.Utils.guid();\r\n            this.actorsAspectRatio.prefix = \"#\" + this.element.id + \" .page-moviesdetail\";\r\n            this.eventTracker.addEvent(this.scrollContainer, \"scroll\", () => {\r\n                cancelAnimationFrame(this.scrollDelay);\r\n                this.scrollDelay = requestAnimationFrame(() => {\r\n                    this.checkScroll();\r\n                });\r\n            });\r\n\r\n            if (this.movie.file) {\r\n                var path = Kodi.Utils.getNetworkPath(this.movie.file);\r\n                if (path) {\r\n                    //this.btnDownloadMovie.style.display = \"\";\r\n                    this.btnPlayMovieLocal.style.display = \"\";\r\n                }\r\n            }\r\n\r\n            Kodi.API.Videos.Movies.getMovieDetails(this.movie.movieid).then((detail) => {\r\n                if (detail.moviedetails.resume && detail.moviedetails.resume.position) {\r\n                    this.btnResumeMovie.style.display = \"\";\r\n                }\r\n            }, function (err) {\r\n                var e = err;\r\n            });\r\n\r\n            \r\n            var p = [];\r\n            var bindables = this.element.querySelectorAll(\".moviebinding\");\r\n            for (var i = 0, l = bindables.length; i < l; i++) {\r\n                p.push(WinJS.Binding.processAll(<Element>bindables[i], options.movie));\r\n            }\r\n            return WinJS.Promise.join(p);\r\n        }\r\n\r\n        ready(element, options) {\r\n            setTimeout(() => {\r\n                this.renderCast();\r\n            }, 400);\r\n        }\r\n\r\n        renderCast() {\r\n            var container = document.createDocumentFragment();\r\n            var p = [];\r\n            var items = [];\r\n            this.movie.cast.slice(0,20).forEach((c) => {\r\n                p.push(actortemplate.render(c).then((rendered) => {\r\n                    rendered.style.opacity = '0';\r\n                    items.push(rendered);\r\n                    container.appendChild(rendered);\r\n                }));\r\n            });\r\n\r\n            WinJS.Promise.join(p).then(() => {\r\n                this.castItems.appendChild(container);\r\n                WinJS.UI.Animation.enterPage(items);\r\n            });\r\n        }\r\n\r\n        checkScroll() {\r\n            var h = this.headerbanner.clientHeight;\r\n            var posterinbanner = this.visualstate.states.medium.active;\r\n            if (!posterinbanner && this.headerposter.style.opacity) {\r\n                this.headerposter.style.opacity = '';\r\n            }\r\n\r\n            var dif = (h - this.scrollContainer.scrollTop);\r\n            if (dif < 0) {\r\n                if (this.headerbanner.style.opacity != '0') {\r\n                    this.headerbanner.style.opacity = '0';\r\n                }\r\n                if (posterinbanner && this.headerposter.style.opacity != '0') {\r\n                    this.headerposter.style.opacity = '0';\r\n                }\r\n            } else {\r\n                var val = (dif / h).toFixed(2) + '';\r\n                if (this.headerbanner.style.opacity != val) {\r\n                    this.headerbanner.style.opacity = val;\r\n                    if (posterinbanner) {\r\n                        this.headerposter.style.opacity = val;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n        resumeMovie() {\r\n            return Kodi.API.Videos.Movies.playMovie(this.movie.movieid, true);\r\n        }\r\n\r\n        playMovie() {\r\n            return Kodi.API.Videos.Movies.playMovie(this.movie.movieid);\r\n        }\r\n\r\n        playMovieLocal() {\r\n            return Kodi.App.playLocalMedia(this.movie.file);\r\n        }\r\n\r\n        downloadMovie() {\r\n        }\r\n\r\n        updateLayout() {\r\n            this.checkScroll();\r\n        }\r\n    }\r\n\r\n    export var MovieDetail = WinJS.UI.Pages.define(MovieDetailPage.url, MovieDetailPage);\r\n\r\n}"],"sourceRoot":" "}