{"version":3,"sources":["../scripts/winjscontrib/js/winjscontrib.ui.webcomponents.js","../scripts/winjscontrib/js/winjscontrib.winrt.core.js","../scripts/winjscontrib/js/winjscontrib.winrt.upnp.js","../scripts/winjscontrib/js/winjscontrib.bindings.js","../scripts/winjscontrib/js/winjscontrib.date.utils.js","../scripts/winjscontrib/js/winjscontrib.messenger.js","../scripts/winjscontrib/js/winjscontrib.datacontainer.winrt.file.js","../scripts/winjscontrib/js/winjscontrib.ui.jquery.js","../scripts/winjscontrib/js/winjscontrib.ui.dataform.js","../scripts/winjscontrib/js/winjscontrib.ui.animation.js","../scripts/winjscontrib/js/winjscontrib.ui.elasticbutton.js","../scripts/winjscontrib/js/winjscontrib.ui.fowrapper.js","../scripts/winjscontrib/js/winjscontrib.ui.multipass-renderer.js","../scripts/winjscontrib/js/winjscontrib.ui.grid.js","../scripts/winjscontrib/js/winjscontrib.ui.aspectratio.js","../scripts/winjscontrib/js/winjscontrib.ui.visualstate.js"],"names":["WinJSContrib","UI","WebComponents","global","inspect","node","customElement","ctrlName","nodeName","promises","attributes","getAttribute","registered","toUpperCase","mcnComponent","push","createElement","msParentSelectorScope","winControl","pageLifeCycle","observer","i","l","childNodes","length","WinJS","Promise","join","observeMutations","element","polyfill","MutationObserver","mutations","forEach","mutation","addedNodes","observe","childList","subtree","definition","scope","Utils","getScopeControl","p","wrap","process","getControlInstance","ctor","steps","render","attach","setAttribute","name","val","call","this","constructor","mcnWebComponent","map","ctx","control","property","data","applyAttribute","options","dataset","winOptions","getWinJSOptions","optionsCallback","ctrl","applyAll","applyMapping","tagname","mapping","contextData","item","attrcontext","attrvalue","context","attribute","type","resolveValue","resolve","applyValue","writeProperty","properties","events","controls","ctKey","controlDefinition","mapKey","key","controlmap","elt","optionsParser","window","select","Utilities","markSupportedForProcessing","text","parent","querySelector","document","registerElement","processAll","watch","register","override","existing","proto","Object","create","HTMLElement","prototype","createdCallback","attachedCallback","attributeChangedCallback","attrName","oldValue","newValue","Binding","Template","AppBar","AutoSuggestBox","BackButton","ContentDialog","DatePicker","FlipView","Flyout","Hub","HubSection","ItemContainer","ListView","Menu","Pivot","PivotItem","Rating","Repeater","SearchBox","SemanticZoom","SplitView","TimePicker","ToggleSwitch","ToolBar","Tooltip","ViewBox","WinRT","readProtocol","args","detail","kind","Windows","ApplicationModel","Activation","ActivationKind","protocol","uri","navArgs","action","undefined","protocolArgs","queryargs","query","substr","split","arg","decodeURIComponent","host","isConnected","nlvl","Networking","Connectivity","NetworkConnectivityLevel","profile","NetworkInformation","getInternetConnectionProfile","level","getNetworkConnectivityLevel","constrainedInternetAccess","internetAccess","hasInternetAccess","onInternetStatusChanged","callback","handler","network","addEventListener","removeEventListener","Alerts","messageBox","opt","_global","md","Popups","MessageDialog","content","title","commands","command","index","cmd","UICommand","id","label","invoked","append","isDefault","defaultCommandIndex","showAsync","complete","error","navigator","notification","confirm","res","c","then","wrapError","message","yes","no","e","toastNotification","notifications","Notifications","template","picture","ToastTemplateType","toastImageAndText01","toastText01","toastXml","ToastNotificationManager","getTemplateContent","toastTextElements","getElementsByTagName","toastImageElements","launch","toastElements","JSON","stringify","appendChild","createTextNode","text2","text3","toast","ToastNotification","toastNotifier","createToastNotifier","show","UPnP","endsWith","search","indexOf","xmlToJson","xml","obj","nodeType","j","nodeValue","hasChildNodes","tmp","colonIdx","clearNode","old","trim","parseXML","DOMParser","parseFromString","toHex","n","result","start","digit","hextab","pad","str","len","ntos","toString","unescape","htoa","replace","RegExp","nextchar","charAt","parseInt","atoh","charCodeAt","expandExponential","x","s","f","Math","abs","z","Array","r","deviceTypes","ContentDirectory1","ContentDirectory2","ContentDirectory3","ContentDirectory4","MediaRenderer1","MediaRenderer2","MediaRenderer3","MediaRenderer4","MediaServer1","MediaServer2","MediaServer3","MediaServer4","AVTransport1","AVTransport2","ConnectionManager1","ConnectionManager2","ConnectionManager3","devicesDiscovery","filter","timeout","exists","url","matches","devices","d","deviceDescriptionUrl","discover","onsuccess","err","clientSocket","close","ex","onerror","Sockets","DatagramSocket","onmessagereceived","reader","getDataReader","count","unconsumedBufferLength","readString","completed","items","toLowerCase","xhr","rawdevice","responseXML","device","root","rootUrl","UPnPDevice","console","getOutputStreamAsync","hostName","outputStream","writer","Storage","Streams","DataWriter","unicodeEncoding","UnicodeEncoding","Utf8","writeString","storeAsync","discovery","hasError","HostName","List","promise","getContentType","extension","lowerUrl","deviceObj","getService","serviceType","service","serviceList","deviceList","childdevice","childService","controlURL","getAVTransport","UPnPAVTransport","getContentDirectory","UPnPContentDirectory","getConnectionManager","UPnPConnectionManager","UPnPService","serviceObj","opts","debug","svc","svcType","svcUrl","self","upnpAction","upnpParameters","promiseComplete","promiseError","response","svcMsg","createRequest","sendRequest","xmlResponse","apply","handleResponse","upnpResponse","requestTemplate","types","i1","allowedValues","toNative","i8","Int8Array","checkAllowedValues","i2","i16","Int16Array","i4","i32","Int32Array","ui1","ui8","Uint8Array","ui2","ui16","Uint16Array","ui4","ui32","Uint32Array","int","isNaN","r4","f32","Float32Array","r8","f64","Float64Array","number","fixed_14_4","float","_float","parseFloat","char","string","xmlObj","currentPos","idx","exception","date","dateTime","Date","parseDate","toISOString","dateTime_tz","time","time_tz","boolean","bin_base64","atob","btoa","bin_hex","decodeURI","uuid","_name","upnpServiceType","upnpActionName","parameters","formatParameters","debugLog","encodeXML","svcInParams","svcInParams_xml","svcParam","typeCheck","upnpEndpointURL","upnpRequestXML","onUPnPResponse","soapaction","httpClient","Web","Http","HttpClient","Foundation","Uri","request","HttpRequestMessage","HttpMethod","post","headers","HttpStringContent","utf8","sendRequestAsync","readAsStringAsync","status","responseText","UPnPError","upnpResponseXML","onUPnPResolved","svcOutParams","responseJSON","responseContainer","responseVars","varName","varVal","firstChild","decodeXML","formatParameter","parameter","param","value","processParam","allowedValueList","matchFound","msg","description","b64chars","b64tab","bin","t","cb_encode","ccc","padlen","ord","chars","cb_decode","cccc","String","fromCharCode","b","a","hexChars","timestamp","struct","minutesOffset","numericKeys","exec","slice","k","UTC","parse","NaN","allowedContentDirectoryTypes","urn:schemas-upnp-org:service:ContentDirectory:1","urn:schemas-upnp-org:service:ContentDirectory:2","urn:schemas-upnp-org:service:ContentDirectory:3","urn:schemas-upnp-org:service:ContentDirectory:4","upnpType","getSystemUpdateId","Id","getSearchCapabilities","SearchCaps","getSortCapabilities","SortCaps","browse","objectId","browseFlag","startingIndex","requestedCount","sortCriteria","ObjectID","BrowseFlag","Filter","StartingIndex","RequestedCount","SortCriteria","Result","NumberReturned","TotalMatches","UpdateID","allowedConnectionManagerTypes","urn:schemas-upnp-org:service:ConnectionManager:1","urn:schemas-upnp-org:service:ConnectionManager:2","urn:schemas-upnp-org:service:ConnectionManager:3","getCurrentConnectionIDs","ConnectionIDs","getCurrentConnectionInfo","connectionId","ConnectionID","RcsID","AVTransportID","ProtocolInfo","PeerConnectionManager","PeerConnectionID","Direction","Status","getProtocolInfo","Source","Sink","allowedAVTransportTypes","urn:schemas-upnp-org:service:AVTransport:1","urn:schemas-upnp-org:service:AVTransport:2","getDeviceCapabilities","instanceId","InstanceID","PlayMedia","RecMedia","RecQualityModes","getMediaInfo","NrTracks","MediaDuration","CurrentURI","CurrentURIMetaData","NextURI","NextURIMetaData","PlayMedium","RecordMedium","WriteStatus","getPositionInfo","Track","TrackDuration","TrackMetaData","TrackURI","RelTime","AbsTime","RelCount","AbsCount","getTransportInfo","CurrentTransportState","CurrentTransportStatus","CurrentSpeed","getTransportSettings","PlayMode","RecQualityMode","setAVTransportURI","currentURI","currentURIMetaData","play","speed","Speed","pause","stop","next","previous","seek","unit","target","Unit","Target","allowedRenderingControlTypes","urn:schemas-upnp-org:service:RenderingControl:1","urn:schemas-upnp-org:service:RenderingControl:2","urn:schemas-upnp-org:service:RenderingControl:3","UPnPRenderingControl","listPresets","InstanceId","CurrentPresetNameList","selectPreset","presetName","PresetName","getBrightness","CurrentBrightness","setBrightness","desiredBrightness","DesiredBrightness","getContrast","CurrentContrast","setContrast","desiredContrast","DesiredContrast","getSharpness","CurrentSharpness","setSharpness","desiredSharpness","DesiredSharpness","getRedVideoGain","CurrentRedVideoGain","setRedVideoGain","desiredRedVideoGain","DesiredRedVideoGain","getGreenVideoGain","CurrentGreenVideoGain","setGreenVideoGain","desiredGreenVideoGain","DesiredGreenVideoGain","getBlueVideoGain","CurrentBlueVideoGain","setBlueVideoGain","desiredBlueVideoGain","DesiredBlueVideoGain","getRedVideoBlackLevel","CurrentRedVideoBlackLevel","setRedVideoBlackLevel","desiredRedVideoBlackLevel","DesiredRedVideoBlackLevel","getGreenVideoBlackLevel","CurrentGreenVideoBlackLevel","setGreenVideoBlackLevel","desiredGreenVideoBlackLevel","DesiredGreenVideoBlackLevel","getBlueVideoBlackLevel","CurrentBlueVideoBlackLevel","setBlueVideoBlackLevel","desiredBlueVideoBlackLevel","DesiredBlueVideoBlackLevel","getColorTemperature","CurrentColorTemperature","setColorTemperature","desiredColorTemperature","DesiredColorTemperature","getHorizontalKeystone","CurrentHorizontalKeystone","setHorizontalKeystone","desiredHorizontalKeystone","DesiredHorizontalKeystone","getVerticalKeystone","CurrentVerticalKeystone","setVerticalKeystone","desiredVerticalKeystone","DesiredVerticalKeystone","getMute","channel","Channel","CurrentMute","setMute","desiredMute","DesiredMute","getVolume","CurrentVolume","setVolume","desiredVolume","DesiredVolume","getVolumeDB","setVolumeDB","getVolumeDBRange","MinValue","MaxValue","getLoudness","CurrentLoudness","setLoudness","desiredLoudness","DesiredLoudness","getStateVariables","stateVariableList","StateVariableList","StateVariableValuePairs","setStateVariables","renderingControlUDN","serviceId","stateVariableValuePairs","RenderingControlUDN","ServiceType","ServiceId","getAllowedTransforms","CurrentAllowedTransformSettings","getTransforms","CurrentTransformValues","setTransforms","desiredTransformValues","DesiredTransformValues","getAllAvailableTransforms","AllAllowedTransformSettings","getAllowedDefaultTransforms","AllowedDefaultTransformSettings","getDefaultTransforms","CurrentDefaultTransformSettings","setDefaultTransforms","desiredDefaultTransformSettings","DesiredDefaultTransformSettings","Bindings","_setPic","dest","src","style","backgroundImage","classList","add","pictureUnavailable","bindingArguments","argname","_optionsParser","winBindArgs","removeHTML","initializer","source","sourceProperty","destProperty","readProperty","innerHTML","oneTime","innerText","removeHTMLAndEllipsisize","textRes","size","toStaticHTML","ellipsisizeString","staticHTML","dataAttr","addClass","setClass","newval","oldval","remove","format","bindingDesc","bind","asClass","showClassIf","className","toBgImage","setImage","ToRealDate","toLocaleDateString","setTimeout","loadImage","done","toSmartBgImage","showIf","setVisibility","opacity","visibility","display","hideIfNot","hideIfNotDefined","hideIf","showIfNot","showIfNotDefined","enableIf","disabled","disableIfNot","disableIf","enableIfNot","toWidth","setWidth","width","ellipsisize","sourcedata","toEllipsisized","emptyIfNull","twoWayOnChange","setVal","getVal","getProperty","propValue","dispose","cleanUpBindingList","bindingList","unwrappedItem","unwrap","daysSince","m","y","myDate","yourDate","secondsInADay","diff","floor","getTime","formatDate","setDate","moment","calendar","daysSinceDate","getMonth","getDate","getFullYear","fromdate","humanizeDate","addSuffix","duration","humanize","Messenger","receiver","sender","messenger","isWorker","_pendings","_receiver","_sender","_bindedProcessEvent","_processEvent","Class","mix","eventMixin","SmartWorkerPath","SmartWorker","path","Worker","w","_send","postMessage","importScripts","scriptPaths","_doImportScripts","execute","func","arguments","_runFunction","functionArgs","eval","messengerFunction","object","functions","eventName","asArgs","wrapper","guid","progress","event","warn","cleanUp","details","current","cancel","as","stack","dispatchEvent","terminate","__global","DataContainer","toJSONFileName","fileName","encodeURIComponent","deleteItemIfExistsAsync","folder","itemName","logger","getItemAsync","deleteAsync","getFileContentAsJSONAsync","file","encrypted","FileIO","readBufferAsync","cypheredText","provider","Security","Cryptography","DataProtection","DataProtectionProvider","unprotectAsync","unprotectedData","rawText","CryptographicBuffer","convertBinaryToString","BinaryStringEncoding","readFileAsync","creationCollisionOption","retry","containerLogger","readComplete","readError","CreationCollisionOption","openIfExists","filename","getFileAsync","verbose","setImmediate","info","writeFileAsync","objectGraph","encrypt","writeComplete","writeError","manageError","replaceExisting","bufferedText","convertStringToBinary","filePromise","createFileAsync","protectionPromise","protectAsync","protectedData","writeBufferAsync","Logs","getLogger","WinRTFilesContainer","container","folderPromise","useDataCache","dataCache","childs","parentfolder","createFolderAsync","ApplicationData","localFolder","makeCurrent","read","itemkey","clone","save","listKeys","getFilesAsync","files","ext","list","child","childWithTransaction","winrtfolder","renameAsync","NameCollisionOption","deleteContainer","clearAllCache","clearCache","clearDataCache","hasOwnProperty","HSL","hVal","sVal","lVal","h","addH","increment","addS","addL","hInc","sInc","lInc","$","fn","jQuery","tap","each","untap","hatchShow","css","hasClass","pw","fsize","fontSize","hide","fadeIn","pressEnterDefaultTo","eltSelector","$this","keypress","which","keyCode","$elt","blur","preventDefault","stopPropagation","mcnTapTracking","focus","click","onPressEnter","throttleTextChanged","throttling","lastval","keydown","clearTimeout","mcnTxtThrottling","transitionProperties","delay","targetValueCallback","that","toWinJSPromise","renderWith","templateSelector","get","children","renderWithEach","objectArray","itemCallback","templatedElt","scrollInView","offset","animate","viewState","ViewManagement","ApplicationView","horizontal","ApplicationViewState","snapped","fullScreenPortrait","offsetParent","scrollLeft","offsetLeft","scrollTop","offsetTop","scrollInParentView","loadedPromises","onloaded","currentTarget","naturalWidth","whenLoaded","afterTransition","currentElement","prom","onaftertransition","srcElement","timeOutRef","success","resultPromise","afterAnimation","ontransition","classBasedAnimation","classname","removeClass","DataFormState","define","_initObservable","mixin","expandProperties","isValid","updated","Namespace","DataForm","groups","messages","rules","state","allowTooltip","workOnCopy","tooltipDelay","tooltipPosition","tooltipTheme","initValidator","mcnDataForm","CrossPlatform","crossPlatformClass","setOptions","_messages","set","_rules","_groups","dataform","extend","refItem","validator","resetForm","autobindFields","tooltips","form","checkState","fieldElt","srcProperty","destFieldType","DataFormBinding","nbInvalids","numberOfInvalids","validate","submitHandler","invalidHandler","errorPlacement","$e","tooltipster","trigger","onlyOne","position","theme","lastError","newError","tooltipsterValidationTimeout","disposeSubTree","DefaultBindingOptions","trimText","convertEmptyToNull","Converters","none","fromObject","fromInput","stringifiedObject","DOMEventMixin","createEventProperties","parentDataForm","parentNode","updateInputFromObject","converter","updateObjectFromInput","fieldUpdated","validateObjectOnBlur","optionsText","inputType","inputOption","eventAdded","Animation","getOpt","fadeOut","elements","staggerDelay","itemdelay","maxdelay","timing","easing","to","executeTransition","initialDelay","extraDelay","delayFactor","delayCap","ret","min","pageExit","enterPage","stagger","animationParams","keyframe","equivalents","transform","cssName","promise1","executeAnimation","promise2","slideAnim","keyframeName","isIn","Easings","easeInQuad","easeOutQuad","transitionParams","from","slideFromBottom","slideFromTop","slideFromLeft","slideFromRight","slideToBottom","slideToTop","slideToLeft","slideToRight","tabExitPage","tabEnterPage","exitGrow","exagerated","dur","easeInQuint","exitShrink","shrinkAndFall","enterShrink","easeOutQuint","enterGrow","easeInCubic","easeInQuart","easeInSine","easeInExpo","easeInCirc","easeInBack","easeOutCubic","easeOutQuart","easeOutSine","easeOutExpo","easeOutCirc","easeOutBack","easeInOutQuad","easeInOutCubic","easeInOutQuart","easeInOutQuint","easeInOutSine","easeInOutExpo","easeInOutCirc","easeInOutBack","_browserStyleEquivalents","elasticbuttonkinds","rectangle","morphpath","svg","roundedrectangle","round","ElasticButton","behavior","reset","active","mina","elastic","easein","_kind","contentCreated","contentElement","moveChilds","bgElement","currentKind","snap","Snap","pathEl","paths","attr","eventTracker","EventTracker","addEvent","_ptdown","_ptup","FOWrapper","someProperty","_someProperty","wrapperId","body","height","blurFilter","sblurFilter","blurTo","stdDeviation","easeout","updateLayout","MultiPassRenderer","_scrollProcessor","_tolerance","_virtualize","_scrollContainer","scrollContainer","_multipass","multipass","_orientation","orientation","itemClassName","itemClass","itemTemplate","getTemplate","itemInvoked","onitemContent","_onScrollBinded","_onScroll","untapAll","_unregisterScrollEvents","rect","clear","refreshScrollEvents","tolerance","virtualize","_registerScrollEvents","_scrollRequest","cancelAnimationFrame","requestAnimationFrame","checkRendering","clearOffsets","_checkSection","_vIsInView","_checkItem","_hIsInView","pxTolerance","clientHeight","clientWidth","check","noRender","offsetFrom","renderItemsContent","onrendersection","rendered","empty","allRendered","prepareItems","renderOptions","resolveMethod","onitemInit","registereditems","itemdata","MultiPassItem","renderItems","renderer","itemDataPromise","itemData","delayed","_renderContent","_renderItemContent","GridControl","grid","layouts","defaultLayout","layout","itemsPerColumn","itemsPerRow","cellSpace","cellWidth","cellHeight","autolayout","elementReady","readyComplete","_autolayout","gridLayouts","getParentControlByClass","resetElement","isItem","minWidth","minHeight","left","top","clearContent","clearLayout","fill","matrix","col","fit","maxW","maxH","firstFit","numItems","visibleChilds","st","getComputedStyle","GridLayoutsImpl","flexhorizontal","flexFlow","alignContent","_itemsPerColumn","visibleitems","columns","ceil","flexvertical","hbloc","_containerH","cellW","space","colCount","colOffset","topOffset","eltH","cellH","ratioW","ratioH","gridCellsMatrix","eltW","offsetWidth","offsetHeight","eltColumns","eltRows","pos","elementWidth","vertical","plugin","_containerW","_itemsPerLine","elementHeight","oldlayout","getLayout","layoutChanged","layoutfunc","changeLayout","applyed","lastViewState","matchingLayout","mq","matchMedia","AspectRatio","baseWidth","_baseWidth","baseWidthMin","_baseWidthMin","baseWidthMargin","_baseWidthMargin","baseHeight","_baseHeight","baseHeightMin","_baseHeightMin","baseHeightMargin","_baseHeightMargin","ratio","_ratio","basedOn","_basedOn","_target","styleElt","pageLayout","parentpage","parentElement","updateLayoutBasedOnHeight","updateLayoutBasedOnWidth","prefix","nbitems","itemW","targetH","querySelectorAll","max","itemH","targetW","removeChild","VisualState","states","_states","checkAllStates","evaluate","wGt","wLt","hGt","hLt"],"mappings":"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","file":"winjscontrib-custom.js","sourcesContent":["/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/*\r\nWARNING: this feature is experimental\r\nYou must add winjscontrib.core.js before this file\r\n*/\r\n\r\n/// <reference path=\"winjscontrib.core.js\" />\r\nvar WinJSContrib = WinJSContrib || {};\r\nWinJSContrib.UI = WinJSContrib.UI || {};\r\n\r\n/**\r\n * @namespace\r\n */\r\nWinJSContrib.UI.WebComponents = WinJSContrib.UI.WebComponents || {};\r\n\r\n(function (global) {\r\n\t'use strict';\r\n\tvar registered = {};\r\n\tWinJSContrib.UI.WebComponents.registered = registered;\r\n\tWinJSContrib.UI.WebComponents.polyfill = false;\r\n\r\n\tif (!global.document.registerElement && global.MutationObserver) {\r\n\t\tWinJSContrib.UI.WebComponents.polyfill = true;\r\n\t}\r\n\r\n\tfunction inspect(node) {\r\n\t\tvar customElement = null;\r\n\t\tvar ctrlName = node.nodeName;\r\n\t\tvar promises = [];\r\n\r\n\t\tif (node.nodeName !== '#text') {\r\n\t\t\tif (node.attributes) {\r\n\t\t\t\tvar ctrlName = node.getAttribute(\"is\");\r\n\t\t\t\tif (ctrlName) {\r\n\t\t\t\t\t//we uppercase because node names are uppercase\r\n\t\t\t\t\tcustomElement = registered[ctrlName.toUpperCase()];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!customElement && node.nodeName !== 'DIV' && node.nodeName !== 'SPAN') {\r\n\t\t\t\tcustomElement = registered[node.nodeName];\r\n\t\t\t}\r\n\r\n\t\t\tif (customElement && !node.mcnComponent) {\r\n\t\t\t\t//createElement(node, customElement);\r\n\t\t\t\tpromises.push(createElement(node, customElement));\r\n\t\t\t}\r\n\r\n\t\t\tif (node.msParentSelectorScope && node.winControl && node.winControl.pageLifeCycle && node.winControl.pageLifeCycle.observer) {\r\n\t\t\t\t//element is a fragment with its own mutation observer, no need to inspect childs\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t//if (node.nodeName === 'WIN-TEMPLATE') {\r\n\t\t\t//    return;\r\n\t\t\t//}\r\n\r\n\t\t\tfor (var i = 0, l = node.childNodes.length; i < l; i++) {\r\n\t\t\t\tpromises.push(inspect(node.childNodes[i]));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn WinJS.Promise.join(promises);\r\n\t}\r\n\r\n\t/**\r\n\t * inspect current DOM element and create webcomponents found on that element and on its child.\r\n\t * @function\r\n\t * @param {HTMLElement} element DOM element to inspect\r\n\t */\r\n\tWinJSContrib.UI.WebComponents.processAll = function (element) { };\r\n\tif (WinJSContrib.UI.WebComponents.polyfill) {\r\n\t\tWinJSContrib.UI.WebComponents.processAll = inspect;\r\n\t}\r\n\r\n\tfunction observeMutations(element) {\r\n\t\tvar observer = null;\r\n\t\tif (WinJSContrib.UI.WebComponents.polyfill) {\r\n\t\t\tobserver = new MutationObserver(function (mutations) {\r\n\t\t\t\t//console.time('check mutation');\r\n\t\t\t\tmutations.forEach(function (mutation) {\r\n\t\t\t\t\tif (mutation.addedNodes.length) {\r\n\t\t\t\t\t\tfor (var i = 0, l = mutation.addedNodes.length; i < l ; i++) {\r\n\t\t\t\t\t\t\tinspect(mutation.addedNodes[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t//console.timeEnd('check mutation');\r\n\t\t\t});\r\n\r\n\t\t\tobserver.observe(element, { childList: true, subtree: true });\r\n\t\t}\r\n\r\n\t\treturn observer;\r\n\t}\r\n\tWinJSContrib.UI.WebComponents.watch = observeMutations;\r\n\r\n\tfunction createElement(element, definition) {\r\n\t\tvar ctrl = element.winControl;\r\n\t\telement.mcnComponent = true;\r\n\t\tvar scope = WinJSContrib.Utils.getScopeControl(element);\r\n\t\tvar p = WinJS.Promise.wrap();\r\n\t\tvar process = function () {\r\n\t\t\tgetControlInstance(definition.ctor, element);\r\n\t\t}\r\n\r\n\t\tif (scope && scope.pageLifeCycle) {\r\n\t\t\t//if the component is owned by a page/fragment, we process the control according to page lifecycle\r\n\t\t\tp = scope.pageLifeCycle.steps.render.attach(process);\r\n\t\t} else {\r\n\t\t\tprocess();\r\n\t\t}\r\n\r\n\t\t//put a proxy on setAttribute to detect changes in attributes\r\n\t\tvar setAttribute = element.setAttribute;\r\n\t\telement.setAttribute = function (name, val) {\r\n\t\t\tif (element.winControl) {\r\n\t\t\t\tsetAttribute.call(this, name, val);\r\n\t\t\t\tvar definition = element.winControl.constructor.mcnWebComponent;\r\n\t\t\t\tif (definition) {\r\n\t\t\t\t\tvar map = definition[name.toUpperCase()];\r\n\t\t\t\t\tif (map) {\r\n\t\t\t\t\t\tvar ctx = { control: element.winControl, name: map.property, data: {} }\r\n\t\t\t\t\t\tdefinition.applyAttribute(name, this, ctx);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn p;\r\n\t}\r\n\r\n\tfunction getControlInstance(ctor, element) {\r\n\t\telement.mcnComponent = true;\r\n\t\tvar definition = ctor.mcnWebComponent;\r\n\t\t//console.time('building ' + definition.name);\r\n\t\tvar options = {};\r\n\t\tif (element.dataset.winOptions) {\r\n\t\t\toptions = getWinJSOptions(element);\r\n\t\t}\r\n\r\n\t\tif (definition && definition.optionsCallback) {\r\n\t\t\toptions = definition.optionsCallback(element, options, scope);\r\n\t\t}\r\n\r\n\t\tvar ctrl = new ctor(element, options);\r\n\t\telement.winControl = ctrl;\r\n\t\tif (definition) {\r\n\t\t\tdefinition.applyAll(element);\r\n\t\t}\r\n\t\t//console.timeEnd('building ' + definition.name);\t\t\r\n\t}\r\n\r\n\tfunction applyMapping(tagname, ctor, mapping) {\r\n\t\tif (typeof mapping == 'function')\r\n\t\t\treturn;\r\n\t\tmapping = mapping || {};\r\n\r\n\t\tctor.mcnWebComponent = {\r\n\t\t\tname: tagname,\r\n\t\t\tmap: mapping.map || {},\r\n\t\t\toptionsCallback: mapping.optionsCallback,\r\n\t\t\tapplyAll: function (element) {\r\n\t\t\t\tvar contextData = {};\r\n\t\t\t\tfor (var item in this.map) {\r\n\t\t\t\t\tvar attrcontext = { control: element.winControl, name: this.map[item].property, data: contextData };\r\n\t\t\t\t\tthis.applyAttribute(item, element, null, attrcontext);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tapplyAttribute: function (name, element, attrvalue, context) {\r\n\t\t\t\tvar map = this.map[name.toUpperCase()];\r\n\t\t\t\tif (map) {\r\n\t\t\t\t\tvar val = attrvalue || element.getAttribute(map.attribute);\r\n\t\t\t\t\tvar ctrl = element.winControl;\r\n\t\t\t\t\tif (val && ctrl) {\r\n\t\t\t\t\t\tif (!map.type || map.type === 'property') {\r\n\t\t\t\t\t\t\tif (map.resolve) {\r\n\t\t\t\t\t\t\t\tWinJSContrib.Utils.applyValue(element, val, ctrl, map.property, context);\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tWinJSContrib.Utils.writeProperty(ctrl, map.property, val);\r\n\t\t\t\t\t\t} else if (map.type === 'event') {\r\n\t\t\t\t\t\t\tWinJSContrib.Utils.resolveValue(element, val, context);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (mapping.properties) {\r\n\t\t\tmapping.properties.forEach(function (p) {\r\n\t\t\t\tif (p) {\r\n\t\t\t\t\tctor.mcnWebComponent.map[p.toUpperCase()] = { attribute: p, property: p, resolve: true, type: 'property' };\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (mapping.events) {\r\n\t\t\tmapping.events.forEach(function (p) {\r\n\t\t\t\tif (p) {\r\n\t\t\t\t\tctor.mcnWebComponent.map[p.toUpperCase()] = { attribute: p, property: p, resolve: true, type: 'event' };\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (mapping.controls) {\r\n\t\t\tfor (var ctKey in mapping.controls) {\r\n\t\t\t\tvar control = mapping.controls[ctKey];\r\n\t\t\t\tvar controlDefinition = control.mcnWebComponent;\r\n\t\t\t\tfor (var mapKey in controlDefinition.map) {\r\n\t\t\t\t\tvar key = ctKey + '.' + mapKey;\r\n\t\t\t\t\tvar controlmap = controlDefinition.map[mapKey];\r\n\t\t\t\t\tctor.mcnWebComponent.map[key.toUpperCase()] = {\r\n\t\t\t\t\t\tattribute: ctKey + '.' + controlmap.attribute,\r\n\t\t\t\t\t\tproperty: ctKey + '.' + controlmap.property,\r\n\t\t\t\t\t\tresolve: controlmap.resolve\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t* Register a control to be used as a webcomponent. If a tagname has already been registered, \r\n\t* the function will throw an error unless you specify the override flag\r\n\t* @function\r\n\t* @param {string} tagname name for DOM element for the component\r\n\t* @param {function} ctor constructor for the WinJS control\r\n\t* @param {Object} mapping definition for mapping between control and DOM element\r\n\t* @param {boolean} override indicate that you want to override an existing component definition\r\n\t* @example\r\n\t* WinJSContrib.UI.WebComponents.register('mcn-semanticlistviews', WinJSContrib.UI.SemanticListViews, {\r\n\t*\tproperties: ['nameOfProperty'],\r\n\t*   events : ['nameOfEvent'],\r\n\t*\tcontrols: {\r\n\t*\t\t\"listview\": WinJS.UI.ListView,\r\n\t*\t\t\"zoomedOutListview\": WinJS.UI.ListView,\r\n\t*\t\t\"semanticZoom\": WinJS.UI.SemanticZoom\r\n\t*\t},\r\n\t*\tmap: {\r\n\t*\t\t\"DEFAULTGROUPLIMIT\": { attribute: 'defaultGroupLimit', property: '_dataManager.defaultGroupLimit', resolve: true },\r\n\t*\t\t\"GROUPKIND\": { attribute: 'groupKind', property: '_dataManager.groupKind', resolve: true },\r\n\t*\t\t\"FIELD\": { attribute: 'field', property: '_dataManager.field', resolve: true },\r\n\t*\t\t\"ITEMS\": { attribute: 'items', property: '_dataManager.items', resolve: true },\r\n\t*\t}\r\n\t*});\r\n\t*/\r\n\tWinJSContrib.UI.WebComponents.register = function register(tagname, ctor, mapping, override) {\r\n\t\tvar existing = registered[tagname.toUpperCase()];\r\n\t\tif (existing && !override) {\r\n\t\t\tthrow 'component ' + tagname + ' already exists';\r\n\t\t}\r\n\r\n\t\tapplyMapping(tagname, ctor, mapping);\r\n\r\n\t\tif (WinJSContrib.UI.WebComponents.polyfill) {\r\n\t\t\tglobal.document.createElement(tagname);\r\n\t\t\t//we uppercase because node names are uppercase\r\n\t\t\tregistered[tagname.toUpperCase()] = { ctor: ctor };\r\n\t\t} else if (global.document.registerElement) {\r\n\t\t\t//register component with \"real\" webcomponent\r\n\t\t\tvar proto = Object.create(HTMLElement.prototype);\r\n\t\t\tproto.createdCallback = function () {\r\n\t\t\t}\r\n\r\n\t\t\tproto.attachedCallback = function () {\r\n\t\t\t\tvar element = this;\r\n\t\t\t\tvar scope = WinJSContrib.Utils.getScopeControl(element);\r\n\t\t\t\tvar process = function () {\r\n\t\t\t\t\tgetControlInstance(ctor, element);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (scope && scope.pageLifeCycle) {\r\n\t\t\t\t\t//if the component is owned by a page/fragment, we process the control according to page lifecycle\r\n\t\t\t\t    scope.pageLifeCycle.steps.render.attach(process);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tprocess();\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t};\r\n\r\n\t\t\tproto.attributeChangedCallback = function (attrName, oldValue, newValue) {\r\n\t\t\t\tvar element = this;\r\n\t\t\t\tif (element.winControl) {\r\n\t\t\t\t\tvar definition = element.winControl.constructor.mcnWebComponent;\r\n\t\t\t\t\tif (definition) {\r\n\t\t\t\t\t\tvar map = definition.map[attrName.toUpperCase()];\r\n\t\t\t\t\t\tif (map) {\r\n\t\t\t\t\t\t\tdefinition.applyAttribute(attrName, element, newValue, { control: element.winControl, name: map.property, data: {} });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t};\r\n\r\n\t\t\tglobal.document.registerElement(tagname, { prototype: proto });\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getWinJSOptions(elt) {\r\n\t\treturn WinJS.UI.optionsParser(elt.dataset.winOptions, window, {\r\n\t\t\tselect: WinJS.Utilities.markSupportedForProcessing(function (text) {\r\n\t\t\t\tvar parent = WinJSContrib.Utils.getScopeControl(elt);\r\n\t\t\t\tif (parent) {\r\n\t\t\t\t\treturn parent.element.querySelector(text);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn document.querySelector(text);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n\tif (WinJS.Binding && WinJS.Binding.Template) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-template', WinJS.Binding.Template, {\r\n\t\t\tproperties: ['extractChild']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.AppBar) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-appbar', WinJS.UI.AppBar, {\r\n\t\t\tproperties: ['closedDisplayMode', 'disabled', 'hidden', 'layout', 'placement', 'sticky', 'commands', \r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.AutoSuggestBox) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-autosuggestbox', WinJS.UI.AutoSuggestBox, {\r\n\t\t\tproperties: ['chooseSuggestionOnEnter', 'disabled', 'onquerychanged', 'onquerysubmitted', \r\n\t\t\t\t'onresultsuggestionchosen', 'onsuggestionsrequested', 'placeholderText', 'queryText', \r\n\t\t\t\t'searchHistoryContext', 'searchHistoryDisabled'],\r\n\t\t\tevents: ['querychanged', 'querysubmitted', 'resultsuggestionchosen', 'suggestionsrequested']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.BackButton) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-backbutton', WinJS.UI.BackButton);\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ContentDialog) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-contentdialog', WinJS.UI.ContentDialog, {\r\n\t\t\tproperties: ['hidden', 'primaryCommandDisabled', 'primaryCommandText', 'secondaryCommandDisabled',\r\n\t\t\t\t'secondaryCommandText', 'title', 'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.DatePicker) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-datepicker', WinJS.UI.DatePicker, {\r\n\t\t\tproperties: ['calendar', 'datePattern', 'disabled', 'maxYear', 'minYear', \r\n\t\t\t\t'monthPattern', 'yearPattern', 'onchange', 'current'],\r\n\t\t\tevents: ['change']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.FlipView) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-flipview', WinJS.UI.FlipView, {\r\n\t\t\tproperties: ['currentPage', 'orientation', 'itemTemplate', 'itemDataSource', 'itemSpacing', 'ondatasourcecountchanged', 'onpagevisibilitychanged', 'onpageselected', 'onpagecompleted'],\r\n\t\t\tevents: ['datasourcecountchanged', 'pagevisibilitychanged', 'pageselected', 'pagecompleted']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Flyout) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-flyout', WinJS.UI.Flyout, {\r\n\t\t\tproperties: ['alignment', 'anchor', 'disabled', 'hidden', 'placement', \r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Hub) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-hub', WinJS.UI.Hub, {\r\n\t\t\tproperties: ['headerTemplate', 'indexOfFirstVisible', 'indexOfLastVisible', 'loadingState', \r\n\t\t\t\t'oncontentanimating', 'onheaderinvoked', 'onloadingstatechanged', \r\n\t\t\t\t'orientation', 'scrollPosition', 'sectionOnScreen', 'sections', 'zoomableView'],\r\n\t\t\tevents: ['contentanimating', 'headerinvoked', 'loadingstatechanged']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.HubSection) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-hubsection', WinJS.UI.HubSection, {\r\n\t\t\tproperties: ['contentElement', 'header', 'isHeaderStatic']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ItemContainer) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-itemcontainer', WinJS.UI.ItemContainer, {\r\n\t\t\tproperties: ['draggable', 'oninvoked', 'onselectionchanged', 'onselectionchanging', 'selected', 'selectionDisabled', \r\n\t\t\t\t'swipeBehavior', 'swipeOrientation', 'tapBehavior'],\r\n\t\t\tevents: ['invoked', 'selectionchanged', 'selectionchanging']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ListView) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-listview', WinJS.UI.ListView, {\r\n\t\t\tproperties: [\r\n\t\t\t\t'itemTemplate', 'itemDataSource', 'itemsDraggable', 'itemsReorderable',\r\n\t\t\t\t'oniteminvoked', 'groupHeaderTemplate', 'groupDataSource', 'swipeBehavior',\r\n\t\t\t\t'selectBehavior', 'tapBehavior', 'header', 'footer'\r\n\t\t\t],\r\n\t\t\tevents: ['iteminvoked']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Menu) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-menu', WinJS.UI.Menu, {\r\n\t\t\tproperties: ['alignment', 'anchor', 'commands', 'disabled', 'hidden', 'placement', \r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Pivot) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-pivot', WinJS.UI.Pivot, {\r\n\t\t\tproperties: ['items', 'locked', 'onitemanimationend', 'onitemanimationstart', 'onselectionchanged', \r\n\t\t\t\t'selectedIndex', 'selectedItem', 'title'],\r\n\t\t\tevents: ['itemanimationend', 'itemanimationstart', 'selectionchanged']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.PivotItem) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-pivotitem', WinJS.UI.PivotItem, {\r\n\t\t\tproperties: ['contentElement', 'header']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Rating) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-rating', WinJS.UI.Rating, {\r\n\t\t\tproperties: ['averageRating', 'disabled', 'enableClear', 'maxRating', \r\n\t\t\t\t'oncancel', 'onchange', 'onpreviewchange', 'tooltipStrings', 'userRating'],\r\n\t\t\tevents: ['cancel', 'change', 'previewchange']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Repeater) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-repeater', WinJS.UI.Repeater, {\r\n\t\t\tproperties: ['data', 'length', 'onitemchanged', 'onitemchanging', 'oniteminserted', 'oniteminserting', \r\n\t\t\t\t'onitemmoved', 'onitemmoving', 'onitemremoved', 'onitemremoving', 'onitemsloaded', \r\n\t\t\t\t'onitemsreloaded', 'onitemsreloading', 'template'],\r\n\t\t\tevents: ['itemchanged', 'itemchanging', 'iteminserted', 'iteminserting',\r\n\t\t\t\t'itemmoved', 'itemmoving', 'itemremoved', 'itemremoving', 'itemsloaded',\r\n\t\t\t\t'itemsreloaded', 'itemsreloading']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.SearchBox) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-searchbox', WinJS.UI.SearchBox, {\r\n\t\t\tproperties: ['chooseSuggestionOnEnter', 'disabled', 'focusOnKeyboardInput', 'onquerychanged', 'onquerysubmitted', \r\n\t\t\t\t'onresultsuggestionchosen', 'onsuggestionsrequested', 'placeholderText', 'queryText', \r\n\t\t\t\t'searchHistoryContext', 'searchHistoryDisabled'],\r\n\t\t\tevents: ['querychanged', 'querysubmitted', 'resultsuggestionchosen', 'suggestionsrequested']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.SemanticZoom) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-semanticzoom', WinJS.UI.SemanticZoom, {\r\n\t\t\tproperties: ['enableButton', 'locked', 'onzoomchanged', 'zoomedInItem', 'zoomedOut', 'zoomedOutItem', 'zoomFactor'],\r\n\t\t\tevents: ['zoomchanged']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.SplitView) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-splitview', WinJS.UI.SplitView, {\r\n\t\t\tproperties: ['contentElement', 'hiddenDisplayMode', 'paneElement', 'paneHidden', 'panePlacement', 'shownDisplayMode',\r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.TimePicker) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-timepicker', WinJS.UI.TimePicker, {\r\n\t\t\tproperties: ['onchange', 'clock', 'current', 'disabled', 'hourPattern',\r\n\t\t\t\t'minuteIncrement', 'minutePattern', 'periodPattern'],\r\n\t\t\tevents: ['onchange']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ToggleSwitch) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-toggleswitch', WinJS.UI.ToggleSwitch, {\r\n\t\t\tproperties: ['onchange', 'checked', 'disabled', 'labelOff', 'labelOn', 'title'],\r\n\t\t\tevents: ['onchange']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ToolBar) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-toolbar', WinJS.UI.ToolBar);\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Tooltip) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-tooltip', WinJS.UI.Tooltip, {\r\n\t\t\tproperties: ['contentElement', 'extraClass', 'infotip', 'innerHTML', 'onbeforeclose', \r\n\t\t\t\t'onbeforeopen', 'onclosed', 'onopened', 'placement'],\r\n\t\t\tevents: ['beforeclose', 'beforeopen', 'closed', 'opened']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ViewBox) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-viewbox', WinJS.UI.ViewBox);\r\n\t}\r\n\r\n\r\n\t/*\r\n\t\t\t\tWinJS.UI.MenuCommand\r\n\t\t\t\tWinJS.UI.NavBar\r\n\t\t\t\tWinJS.UI.NavBarCommand\r\n\t\t\t\tWinJS.UI.NavBarContainer\r\n\t\t\t\tToolbar\r\n\t*/\r\n})(this);","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var WinRT;\n    (function (WinRT) {\n        /**\n         * read protocol arguments from application activation event arguments\n         * @function WinJSContrib.WinRT.readProtocol\n         * @param {Object} args WinJS application activation argument\n         * @returns {Object} protocol arguments\n         */\n        function readProtocol(args) {\n            if (args.detail.kind === Windows.ApplicationModel.Activation.ActivationKind.protocol && args.detail.uri) {\n                var navArgs = { action: undefined };\n                var protocolArgs = {};\n                var queryargs = args.detail.uri.query;\n                if (queryargs[0] == '?') {\n                    queryargs = queryargs.substr(1);\n                }\n                if (queryargs) {\n                    queryargs.split('&').forEach(function (item) {\n                        var arg = item.split('=');\n                        protocolArgs[arg[0]] = decodeURIComponent(arg[1]);\n                    });\n                }\n                navArgs.protocol = {\n                    action: args.detail.uri.host,\n                    args: protocolArgs\n                };\n                return navArgs;\n            }\n        }\n        WinRT.readProtocol = readProtocol;\n        ;\n        /**\n         * Indicate if a valid internet connection is available, even with constrained access\n         * @function WinJSContrib.WinRT.isConnected\n         * @returns {boolean}\n         */\n        function isConnected() {\n            var nlvl = Windows.Networking.Connectivity.NetworkConnectivityLevel;\n            var profile = Windows.Networking.Connectivity.NetworkInformation.getInternetConnectionProfile();\n            if (profile !== null) {\n                var level = profile.getNetworkConnectivityLevel();\n                return level === nlvl.constrainedInternetAccess || level === nlvl.internetAccess;\n            }\n            return false;\n        }\n        WinRT.isConnected = isConnected;\n        ;\n        /**\n         * Indicate if a valid internet connection is available\n         * @function WinJSContrib.WinRT.hasInternetAccess\n         * @returns {boolean}\n         */\n        function hasInternetAccess() {\n            var nlvl = Windows.Networking.Connectivity.NetworkConnectivityLevel;\n            var profile = Windows.Networking.Connectivity.NetworkInformation.getInternetConnectionProfile();\n            if (profile !== null) {\n                var level = profile.getNetworkConnectivityLevel();\n                return level === nlvl.internetAccess;\n            }\n            return false;\n        }\n        WinRT.hasInternetAccess = hasInternetAccess;\n        ;\n        /**\n         * trigger callback when internet connection status is changing\n         * @function WinJSContrib.WinRT.onInternetStatusChanged\n         * @param {function} callback callback for internet status change notification\n         * @returns {function} function to call for unregistering the callback\n         */\n        function onInternetStatusChanged(callback) {\n            var handler = function (arg) {\n                var e = arg;\n                callback(WinJSContrib.WinRT.hasInternetAccess());\n            };\n            var network = Windows.Networking.Connectivity.NetworkInformation;\n            network.addEventListener('networkstatuschanged', handler);\n            return function () {\n                network.removeEventListener('networkstatuschanged', handler);\n            };\n        }\n        WinRT.onInternetStatusChanged = onInternetStatusChanged;\n    })(WinRT = WinJSContrib.WinRT || (WinJSContrib.WinRT = {}));\n})(WinJSContrib || (WinJSContrib = {}));\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Alerts;\n    (function (Alerts) {\n        /**\n         * show system alert box\n         * @function WinJSContrib.Alerts.messageBox\n         * @param {Object} opt message options\n         * @returns {WinJS.Promise}\n         */\n        function messageBox(opt) {\n            var _global = window;\n            if (opt) {\n                if (_global.Windows) {\n                    var md = new Windows.UI.Popups.MessageDialog(opt.content);\n                    if (opt.title) {\n                        md.title = opt.title;\n                    }\n                    if (opt.commands && opt.commands.forEach) {\n                        opt.commands.forEach(function (command, index) {\n                            var cmd = new Windows.UI.Popups.UICommand();\n                            if (command.id)\n                                cmd.id = command.id;\n                            cmd.label = command.label;\n                            if (command.callback) {\n                                cmd.invoked = command.callback;\n                            }\n                            ((md.commands)).append(cmd);\n                            if (command.isDefault) {\n                                md.defaultCommandIndex = index;\n                            }\n                        });\n                    }\n                    return (md.showAsync());\n                }\n                else {\n                    return new WinJS.Promise(function (complete, error) {\n                        var title = \"\";\n                        if (opt.title) {\n                            title = opt.title;\n                        }\n                        var commands = [];\n                        if (opt.commands && opt.commands.forEach) {\n                            //if (opt.commands.length > 2) {\n                            //    return WinJS.Promise.wrapError(\"you must specify maximum 2 commands on Cordova platforms\");\n                            //}\n                            opt.commands.forEach(function (command, index) {\n                                commands.push(command.label);\n                            });\n                        }\n                        else\n                            commands = ['Ok'];\n                        if (_global.navigator && _global.navigator.notification && _global.navigator.notification.confirm) {\n                            _global.navigator.notification.confirm(opt.content, function (res) {\n                                if (opt.commands && opt.commands[res - 1] && opt.commands[res - 1].callback) {\n                                    var c = opt.commands[res - 1].callback();\n                                    if (c && c.then) {\n                                        c.then(function () {\n                                            complete(true);\n                                        });\n                                    }\n                                    else {\n                                        complete(true);\n                                    }\n                                }\n                                else if (res != 0)\n                                    complete(true);\n                                else\n                                    complete(false);\n                            }, title, commands // buttonLabels\n                            );\n                        }\n                        else {\n                            if (window.confirm(title))\n                                complete(true);\n                            else\n                                complete(false);\n                        }\n                    });\n                }\n            }\n            return WinJS.Promise.wrapError(\"you must specify commands as an array of objects with properties text and callback such as {text: '', callback: function(c){}}\");\n        }\n        Alerts.messageBox = messageBox;\n        ;\n        /**\n         * show system alert box\n         * @function WinJSContrib.Alerts.message\n         * @param {string} title title of the alert\n         * @param {string} content text for the alert\n         * @returns {WinJS.Promise}\n         */\n        function message(title, content) {\n            return WinJSContrib.Alerts.messageBox({ title: title, content: content });\n        }\n        Alerts.message = message;\n        /**\n         * show system alert box\n         * @function WinJSContrib.Alerts.confirm\n         * @param {string} title title of the alert\n         * @param {string} content text for the alert\n         * @param {string} yes text for yes\n         * @param {string} no text for no\n         * @returns {WinJS.Promise}\n         */\n        function confirm(title, content, yes, no) {\n            return new WinJS.Promise(function (complete, error) {\n                WinJSContrib.Alerts.messageBox({\n                    title: title,\n                    content: content,\n                    commands: [\n                        {\n                            label: yes,\n                            callback: function (e) {\n                                complete(true);\n                            },\n                            isDefault: true\n                        },\n                        {\n                            label: no,\n                            callback: function (e) {\n                                complete(false);\n                            }\n                        }\n                    ]\n                });\n            });\n        }\n        Alerts.confirm = confirm;\n        /**\n         * show system toast notification\n         * @function WinJSContrib.Alerts.toastNotification\n         * @param {Object} data toast options\n         */\n        function toastNotification(data) {\n            if (Windows) {\n                var notifications = Windows.UI.Notifications;\n                var template = data.template || (data.picture ? notifications.ToastTemplateType.toastImageAndText01 : notifications.ToastTemplateType.toastText01);\n                //var template = notifications.ToastTemplateType[data.template]; //toastImageAndText01;\n                var toastXml = notifications.ToastNotificationManager.getTemplateContent(template);\n                var toastTextElements = toastXml.getElementsByTagName(\"text\");\n                var toastImageElements = toastXml.getElementsByTagName(\"image\");\n                if (data.launch) {\n                    var toastElements = toastXml.getElementsByTagName(\"toast\");\n                    toastElements[0].setAttribute(\"launch\", JSON.stringify(data.launch));\n                }\n                toastTextElements[0].appendChild(toastXml.createTextNode(data.text));\n                if (data.text2 && toastTextElements.length > 1) {\n                    toastTextElements[1].appendChild(toastXml.createTextNode(data.text2));\n                }\n                if (data.text3 && toastTextElements.length > 1) {\n                    toastTextElements[2].appendChild(toastXml.createTextNode(data.text3));\n                }\n                if (data.picture) {\n                    toastImageElements[0].setAttribute(\"src\", data.picture); //\"ms-appx:///images/logo.png\"\n                }\n                var toast = new notifications.ToastNotification(toastXml);\n                var toastNotifier = notifications.ToastNotificationManager.createToastNotifier();\n                toastNotifier.show(toast);\n            }\n            else {\n                throw \"No notification plugin found\";\n            }\n        }\n        Alerts.toastNotification = toastNotification;\n        /**\n         * show system toast notification\n         * @function WinJSContrib.Alerts.toast\n         * @param {string} text text displayed in the toast\n         * @param {string} picture path to a picture to display in the toast\n         */\n        function toast(text, picture) {\n            WinJSContrib.Alerts.toastNotification({ text: text, picture: picture });\n        }\n        Alerts.toast = toast;\n    })(Alerts = WinJSContrib.Alerts || (WinJSContrib.Alerts = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\n//# sourceMappingURL=../../Sources/WinRT/winjscontrib.winrt.core.js.map","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib = WinJSContrib || {};\r\nWinJSContrib.UPnP = WinJSContrib.UPnP || {};\r\n\r\n(function (global) {\r\n\r\n    WinJSContrib.UPnP.deviceTypes = {\r\n        ContentDirectory1: 'urn:schemas-upnp-org:service:ContentDirectory:1',\r\n        ContentDirectory2: 'urn:schemas-upnp-org:service:ContentDirectory:2',\r\n        ContentDirectory3: 'urn:schemas-upnp-org:service:ContentDirectory:3',\r\n        ContentDirectory4: 'urn:schemas-upnp-org:service:ContentDirectory:4',\r\n        MediaRenderer1: 'urn:schemas-upnp-org:device:MediaRenderer:1',\r\n        MediaRenderer2: 'urn:schemas-upnp-org:device:MediaRenderer:2',\r\n        MediaRenderer3: 'urn:schemas-upnp-org:device:MediaRenderer:3',\r\n        MediaRenderer4: 'urn:schemas-upnp-org:device:MediaRenderer:4',\r\n        MediaServer1: 'urn:schemas-upnp-org:device:MediaServer:1',\r\n        MediaServer2: 'urn:schemas-upnp-org:device:MediaServer:2',\r\n        MediaServer3: 'urn:schemas-upnp-org:device:MediaServer:3',\r\n        MediaServer4: 'urn:schemas-upnp-org:device:MediaServer:4',\r\n        AVTransport1:'urn:schemas-upnp-org:service:AVTransport:1',\r\n        AVTransport2: 'urn:schemas-upnp-org:service:AVTransport:2',\r\n        ConnectionManager1: 'urn:schemas-upnp-org:service:ConnectionManager:1',\r\n        ConnectionManager2: 'urn:schemas-upnp-org:service:ConnectionManager:2',\r\n        ConnectionManager3: 'urn:schemas-upnp-org:service:ConnectionManager:3'\r\n    };\r\n\r\n    WinJSContrib.UPnP.devicesDiscovery = function devicesDiscovery(filter, callback, timeout) {\r\n        var hostName;\r\n        try {\r\n            hostName = new Windows.Networking.HostName(\"239.255.255.250\");\r\n        } catch (ex) {\r\n            error({ message: \"Invalid host name.\" });\r\n            return;\r\n        }\r\n\r\n        var devices = new WinJS.Binding.List();\r\n\r\n        var discovery = {\r\n            devices: devices,\r\n            hasError: null,\r\n            promise: null,\r\n        };\r\n\r\n        function exists(url) {\r\n            var matches = devices.filter(function (d) {\r\n                return (url == d.deviceDescriptionUrl);\r\n            });\r\n            return matches.length > 0;\r\n        }\r\n\r\n        function discover(filter) {\r\n            return new WinJS.Promise(function (complete, error) {\r\n                var clientSocket = new Windows.Networking.Sockets.DatagramSocket();\r\n\r\n                function onsuccess(err) {\r\n                    try {\r\n                        if (clientSocket)\r\n                            clientSocket.close();\r\n                    } catch (ex) {\r\n                    }\r\n                    complete(devices);\r\n                }\r\n\r\n                function onerror(err) {\r\n                    try {\r\n                        if (clientSocket)\r\n                            clientSocket.close();\r\n                    } catch (ex) {\r\n                    }\r\n                    error(err);\r\n                }\r\n\r\n                clientSocket.onmessagereceived = function (args) {\r\n                    var e = args;\r\n                    var reader = args.getDataReader();\r\n                    var count = reader.unconsumedBufferLength;\r\n                    var data = reader.readString(count);\r\n                    var completed = false;\r\n\r\n                    if (data) {\r\n                        var items = data.split('\\n');\r\n                        items.forEach(function (item) {\r\n                            if (!completed && item.toLowerCase().indexOf('location:') == 0) {\r\n                                var url = item.substr(9, item.length - 9);\r\n                                completed = true;\r\n                                if (!exists(url)) {\r\n                                    WinJS.xhr({ url: url }).then(function (r) {\r\n\r\n                                        var rawdevice = xmlToJson(r.responseXML);\r\n                                        var device = rawdevice.root.device;\r\n\r\n                                        device.deviceDescriptionUrl = url;\r\n                                        device.rootUrl = url.substr(0, url.indexOf('/', 8));\r\n                                        if (!exists(url)) {\r\n                                            devices.push(new WinJSContrib.UPnP.UPnPDevice(device));\r\n                                        }\r\n\r\n                                        if (callback)\r\n                                            callback(device, url);\r\n                                    }, function (err) {\r\n                                        console.error('calling device failed');\r\n                                        console.error(err);\r\n                                    });\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n\r\n                }\r\n\r\n                clientSocket.getOutputStreamAsync(hostName, \"1900\").then(function (outputStream) {\r\n                    var message = \"M-SEARCH * HTTP/1.1\\r\\n\" +\r\n                                        \"HOST: 239.255.255.250:1900\\r\\n\" +\r\n                                          \"ST:\" + (filter || \"upnp:rootdevice\") + \"\\r\\n\" +\r\n                                          \"MAN:\\\"ssdp:discover\\\"\\r\\n\" +\r\n                                          \"MX:3\\r\\n\\r\\n\";\r\n\r\n\r\n                    var writer = new Windows.Storage.Streams.DataWriter(outputStream);\r\n                    writer.unicodeEncoding = Windows.Storage.Streams.UnicodeEncoding.Utf8;\r\n                    writer.writeString(message);\r\n                    return writer.storeAsync();\r\n                }).then(function () {\r\n                    return WinJS.Promise.timeout(timeout || 20000);\r\n                }).then(onsuccess, onerror);\r\n            }).then(function (res) {\r\n                discovery.hasError = false;\r\n            }, function (err) {\r\n                discovery.hasError = true;\r\n                discovery.error = err;\r\n            });\r\n        }\r\n\r\n        var promises = [];\r\n\r\n        if (!filter || (typeof filter == 'string')) {\r\n            promises.push(discover(filter));\r\n        }\r\n        else if (filter && typeof filter != 'string' && filter.length) {\r\n            for (var i = 0 ; i < filter.length; i++) {\r\n                promises.push(discover(filter[i]));\r\n            }\r\n        }\r\n\r\n        discovery.promise = WinJS.Promise.join(promises);\r\n\r\n        return discovery;\r\n    }\r\n\r\n    function endsWith(text, search) {\r\n        return text.indexOf(search) == text.length - search.length;\r\n    }\r\n\r\n    WinJSContrib.UPnP.getContentType = function (url, extension) {\r\n        var lowerUrl = url.toLowerCase();\r\n\r\n        if (extension == \"mp3\" || endsWith(lowerUrl, \".mp3\"))\r\n            return \"audio/mp3\";\r\n\r\n        if (extension == \"mp4\" || endsWith(lowerUrl, \".mp4\"))\r\n            return \"video/mp4\";\r\n\r\n        if (extension == \"avi\" || endsWith(lowerUrl, \".avi\"))\r\n            return \"video/avi\";\r\n\r\n        if (extension == \"mkv\" || endsWith(lowerUrl, \".mkv\"))\r\n            return \"video/x-matroska\";\r\n    }\r\n\r\n    function xmlToJson(xml) {\r\n\r\n        // Create the return object\r\n        var obj = {};\r\n\r\n        if (xml.nodeType == 1) { // element\r\n            // do attributes\r\n            if (xml.attributes.length > 0) {\r\n                obj[\"@attributes\"] = {};\r\n                for (var j = 0; j < xml.attributes.length; j++) {\r\n                    var attribute = xml.attributes.item(j);\r\n\r\n                    obj[\"@attributes\"][attribute.nodeName] = attribute.nodeValue;\r\n                }\r\n            }\r\n        } else if (xml.nodeType == 3) { // text\r\n            obj = xml.nodeValue;\r\n        }\r\n\r\n        // do children\r\n        if (xml.hasChildNodes()) {\r\n            var properties = 0;\r\n            for (var i = 0; i < xml.childNodes.length; i++) {\r\n                var item = xml.childNodes.item(i);\r\n                var nodeName = item.nodeName;\r\n                if (typeof (obj[nodeName]) == \"undefined\") {\r\n                    var tmp = xmlToJson(item);\r\n                    var colonIdx = nodeName.indexOf(':');\r\n                    if (colonIdx > 0) {\r\n                        var clearNode = nodeName.substr(colonIdx + 1, nodeName.length - colonIdx - 1);\r\n\r\n                    }\r\n\r\n                    if (clearNode && !obj[clearNode]) {\r\n                        obj[clearNode] = tmp;\r\n                    } else {\r\n                        obj[nodeName] = tmp;\r\n                    }\r\n\r\n                    properties++;\r\n                } else {\r\n                    if (typeof (obj[nodeName].push) == \"undefined\") {\r\n                        var old = obj[nodeName];\r\n                        obj[nodeName] = [];\r\n                        obj[nodeName].push(old);\r\n                    }\r\n                    obj[nodeName].push(xmlToJson(item));\r\n                    properties++;\r\n                }\r\n            }\r\n\r\n            if (obj['#text'] && typeof obj['#text'] == 'string') {\r\n                obj['#text'] = obj['#text'].trim();\r\n            }\r\n            if (properties == 1 && obj['#text'] && typeof obj['#text'] == 'string') {\r\n                obj = obj['#text'];\r\n            }\r\n        }\r\n\r\n        for (var e in obj[\"@attributes\"]) {\r\n            if (!obj[e])\r\n                obj[e] = obj[\"@attributes\"][e];\r\n        }\r\n\r\n        return obj;\r\n    };\r\n\r\n    /**\r\n     * UPnP device\r\n     * @class\r\n     */\r\n    WinJSContrib.UPnP.UPnPDevice = function (deviceObj) {\r\n        for (var p in deviceObj) {\r\n            this[p] = deviceObj[p];\r\n        }\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getService = function (serviceType) {\r\n        var device = this;\r\n        var service = null;\r\n\r\n        if (typeof serviceType == 'string')\r\n            serviceType = [serviceType];\r\n\r\n        if (device.serviceList && device.serviceList.service) {\r\n            service = device.serviceList.service.filter(function (s) {\r\n                return serviceType.indexOf(s.serviceType) >= 0;\r\n            })[0];\r\n\r\n            if (!service && device.deviceList) {\r\n                device.deviceList.device.forEach(function (childdevice) {\r\n                    var childService = childdevice.serviceList.service.filter(function (s) {\r\n                        return serviceType.indexOf(s.serviceType) >= 0;\r\n                    })[0];\r\n\r\n                    if (childService)\r\n                        service = childService;\r\n                });\r\n            }\r\n        }\r\n\r\n        if (service) {\r\n            service.rootUrl = device.rootUrl;\r\n            service.url = device.rootUrl + service.controlURL;\r\n        }\r\n\r\n        return service;\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getAVTransport = function () {\r\n        var service = this.getService([WinJSContrib.UPnP.deviceTypes.AVTransport1, WinJSContrib.UPnP.deviceTypes.AVTransport2]);\r\n        if (service) {\r\n            return new WinJSContrib.UPnP.UPnPAVTransport(service);\r\n        }\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getContentDirectory = function () {\r\n        var service = this.getService([WinJSContrib.UPnP.deviceTypes.ContentDirectory1, WinJSContrib.UPnP.deviceTypes.ContentDirectory2, WinJSContrib.UPnP.deviceTypes.ContentDirectory3, WinJSContrib.UPnP.deviceTypes.ContentDirectory4]);\r\n        if (service) {\r\n            return new WinJSContrib.UPnP.UPnPContentDirectory(service);\r\n        }\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getConnectionManager = function () {\r\n        var service = this.getService([WinJSContrib.UPnP.deviceTypes.ConnectionManager1, WinJSContrib.UPnP.deviceTypes.ConnectionManager2, WinJSContrib.UPnP.deviceTypes.ConnectionManager3]);\r\n        if (service) {\r\n            return new WinJSContrib.UPnP.UPnPConnectionManager(service);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Code largely from https://github.com/richtr/plug.play.js\r\n     */\r\n\r\n    WinJSContrib.UPnP.UPnPService = function (serviceObj, opts) {\r\n\r\n        this.options = opts || { debug: false };\r\n        this.svc = serviceObj;\r\n\r\n        // API stub\r\n        this.action = function () { };\r\n\r\n        //if (!this.svc || !(this.svc instanceof NetworkService)) {\r\n\r\n        //    this.debugLog('First argument provided in constructor MUST be a valid NetworkService object');\r\n\r\n        //    return this;\r\n        //}\r\n\r\n        //if (!this.svc.type || this.svc.type.indexOf('upnp:') !== 0) {\r\n\r\n        //    this.debugLog('First argument provided in constructor MUST be a _UPnP_ NetworkService object');\r\n\r\n        //    return this;\r\n\r\n        //}\r\n\r\n        //this.svcType = this.svc.type.replace('upnp:', '');\r\n        this.svcType = this.svc.serviceType;\r\n        this.svcUrl = this.svc.url;\r\n\r\n        var self = this;\r\n\r\n        // Full API\r\n        this.action = function (upnpAction, upnpParameters, callback) {\r\n\r\n            return new WinJS.Promise(function (promiseComplete, promiseError) {\r\n\r\n                // Handle .action( name, callback )\r\n                if (!callback && Object.prototype.toString.call(upnpParameters) == '[object Function]') {\r\n                    callback = upnpParameters;\r\n                    upnpParameters = {};\r\n                }\r\n\r\n                // Generate a callback stub if a Function has not been provided\r\n                if (!callback || Object.prototype.toString.call(callback) !== '[object Function]') {\r\n                    callback = function (e, response) { };\r\n                }\r\n\r\n                // Create a UPnP XML Request message\r\n                var svcMsg = self.createRequest(self.svcType, upnpAction, upnpParameters);\r\n\r\n                // Send the UPnP XML Request message to the current service\r\n                self.sendRequest(self.svcType, upnpAction, self.svcUrl, svcMsg, function (e, xmlResponse) {\r\n\r\n                    if (e !== null) {\r\n                        callback.apply(self, [e, null]);\r\n                        promiseError(e);\r\n                        return;\r\n                    }\r\n\r\n                    // Parse UPnP XML Response message\r\n                    self.handleResponse(upnpAction, xmlResponse.responseXML || \"\", upnpParameters, function (e, upnpResponse) {\r\n\r\n                        // Fire callback\r\n                        callback.apply(self, [e, upnpResponse]);\r\n\r\n                        // Fire promise\r\n                        if (e !== null) {\r\n                            promiseError(e);\r\n                        } else {\r\n                            promiseComplete(upnpResponse);\r\n                        }\r\n\r\n                    });\r\n\r\n                });\r\n            });\r\n        }\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.constructor = WinJSContrib.UPnP.UPnPService;\r\n\r\n    // UPnP XML MESSAGING TEMPLATES\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.requestTemplate = \"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?>\\n\" +\r\n     \"<s:Envelope s:encodingStyle=\\\"http://schemas.xmlsoap.org/soap/encoding/\\\" \" +\r\n       \"xmlns:s=\\\"http://schemas.xmlsoap.org/soap/envelope/\\\">\\n\" +\r\n       \"\\t<s:Body>\\n\" +\r\n         \"\\t\\t<u:{ACTION_NAME} xmlns:u=\\\"{ACTION_TYPE}\\\">\\n\" +\r\n           \"{ACTION_VARS}\" +\r\n         \"\\t\\t</u:{ACTION_NAME}>\\n\" +\r\n       \"\\t</s:Body>\\n\" +\r\n     \"</s:Envelope>\\n\";\r\n\r\n    // UPNP PRIMITIVE VARIABLE TYPE CHECKERS\r\n    // from http://upnp.org/specs/arch/UPnP-arch-DeviceArchitecture-v1.0.pdf\r\n    WinJSContrib.UPnP.UPnPService.prototype.types = {\r\n\r\n        \"i1\": function (val, allowedValues, toNative) {\r\n            var i8 = new Int8Array(1);\r\n            i8[0] = val;\r\n\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(i8[0], allowedValues);\r\n\r\n        },\r\n\r\n        \"i2\": function (val, allowedValues, toNative) {\r\n            var i16 = new Int16Array(1);\r\n            i16[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(i16[0], allowedValues);\r\n        },\r\n\r\n        \"i4\": function (val, allowedValues, toNative) {\r\n            var i32 = new Int32Array(1);\r\n            i32[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(i32[0], allowedValues);\r\n        },\r\n\r\n        \"ui1\": function (val, allowedValues, toNative) {\r\n            var ui8 = new Uint8Array(1);\r\n            ui8[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(ui8[0], allowedValues);\r\n        },\r\n\r\n        \"ui2\": function (val, allowedValues, toNative) {\r\n            var ui16 = new Uint16Array(1);\r\n            ui16[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(ui16[0], allowedValues);\r\n        },\r\n\r\n        \"ui4\": function (val, allowedValues, toNative) {\r\n            var ui32 = new Uint32Array(1);\r\n            ui32[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(ui32[0], allowedValues);\r\n        },\r\n\r\n        \"int\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || isNaN(val)) {\r\n                val = 0;\r\n            } else if (typeof val !== 'number') {\r\n                if (val === true) {\r\n                    val = 1;\r\n                } else {\r\n                    val = parseInt(val + \"\", 10);\r\n                }\r\n            }\r\n            if (!toNative) {\r\n                val = expandExponential(val + \"\");\r\n            }\r\n            if (isNaN(val)) val = 0;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n        },\r\n\r\n        \"r4\": function (val, allowedValues, toNative) {\r\n            var f32 = new Float32Array(1);\r\n            f32[0] = val;\r\n            if (!toNative) {\r\n                return f32[0] ? expandExponential(f32[0] + \"\") : \"0\";\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(f32[0], allowedValues);\r\n        },\r\n\r\n        \"r8\": function (val, allowedValues, toNative) {\r\n            var f64 = new Float64Array(1);\r\n            f64[0] = val;\r\n            if (!toNative) {\r\n                return f64[0] ? expandExponential(f64[0] + \"\") : \"0\";\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(f64[0], allowedValues);\r\n        },\r\n\r\n        \"number\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['r8'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"fixed_14_4\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['float'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"float\": function (val, allowedValues, toNative) {\r\n            var _float = parseFloat(val);\r\n            if (!toNative) {\r\n                return _float ? expandExponential(_float + \"\") : \"0\";\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(_float, allowedValues);\r\n        },\r\n\r\n        \"char\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            } else if (val === false || val === true || val == \"true\" || val == \"yes\" || val == \"false\" || val == \"no\") {\r\n                val = (val === true || val == \"true\" || val == \"yes\") ? \"1\" : \"0\";\r\n            } else {\r\n                val = val.toString();\r\n            }\r\n            if (val.length > 0) {\r\n                val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n                return val.charAt(0);\r\n            }\r\n            return val;\r\n        },\r\n\r\n        \"string\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            val = val + \"\";\r\n\r\n            val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n            return val;\r\n        },\r\n\r\n        \"xmlObj\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            val = val + \"\";\r\n\r\n            val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n            try {\r\n                var s = '';\r\n\r\n                var currentPos = val.indexOf('&');\r\n                while (currentPos > 0) {\r\n                    var idx = val.indexOf(';', currentPos);\r\n                    if (idx < 0 || (idx - currentPos) > 5) {\r\n                        val = val.substr(0, currentPos) + \"&amp;\" + val.substr(currentPos + 1, val.length - (currentPos + 1));\r\n                    }\r\n                    currentPos = val.indexOf('&', currentPos + 1);\r\n                }\r\n\r\n                var xml = parseXML(val);\r\n                return xmlToJson(xml);\r\n            } catch (exception) {\r\n                console.error(exception);\r\n                return val;\r\n            }\r\n        },\r\n\r\n        \"date\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"dateTime\": function (val, allowedValues, toNative) {\r\n            if (toNative) { // Parse to ECMA Date object\r\n                if (Object.prototype.toString.call(val) == '[object String]') {\r\n                    val = new Date(parseDate(val));\r\n                    if (isNaN(val)) val = \"\";\r\n                } else if (Object.prototype.toString.call(val) == '[object Date]') {\r\n                    val = val;\r\n                }\r\n            } else { // Parse to ISO-8601 string\r\n                if (Object.prototype.toString.call(val) == '[object String]') {\r\n                    val = val + \"\";\r\n                } else if (Object.prototype.toString.call(val) == '[object Date]') {\r\n                    if (val.toString() == \"Invalid Date\") { // opera specific functionality\r\n                        val = \"\";\r\n                    } else {\r\n                        val = val.toISOString();\r\n                    }\r\n                }\r\n            }\r\n            val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n            return val;\r\n        },\r\n\r\n        \"dateTime_tz\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"time\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"time_tz\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"boolean\": function (val, allowedValues, toNative) {\r\n            if (val == 'false' || val == 'f' || val == 'no' || val == 'n' || val instanceof RegExp || val <= 0 || !val) {\r\n                if (toNative) {\r\n                    val = false;\r\n                } else {\r\n                    val = \"0\";\r\n                }\r\n            } else {\r\n                if (toNative) {\r\n                    val = true;\r\n                } else {\r\n                    val = \"1\";\r\n                }\r\n            }\r\n            return val;\r\n        },\r\n\r\n        \"bin_base64\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            if (val === true || val === false) {\r\n                val = val === true ? \"1\" : \"0\";\r\n            }\r\n            if (toNative) { // convert to string\r\n                val = atob(val + \"\");\r\n            } else { // convert to base64\r\n                val = btoa(val + \"\");\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n        },\r\n\r\n        \"bin_hex\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            if (val === true || val === false) {\r\n                val = val === true ? \"1\" : \"0\";\r\n            }\r\n            if (toNative) { // convert to string\r\n                val = htoa(val + \"\");\r\n            } else { // convert to hex\r\n                val = atoh(val + \"\");\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n        },\r\n\r\n        \"uri\": function (val, allowedValues, toNative) {\r\n            if (toNative) {\r\n                val = decodeURI(val + \"\");\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['string'](val, allowedValues); // No URI syntax checking\r\n        },\r\n\r\n        \"uuid\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['string'](val, allowedValues); // No UUID syntax checking\r\n        }\r\n\r\n    };\r\n\r\n    // Override .types toString function\r\n    for (var type in WinJSContrib.UPnP.UPnPService.prototype.types) {\r\n        WinJSContrib.UPnP.UPnPService.prototype.types[type]._name = type;\r\n        WinJSContrib.UPnP.UPnPService.prototype.types[type][\"toString\"] = function () { return this._name; };\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.createRequest = function (upnpServiceType, upnpActionName, parameters) {\r\n\r\n        parameters = this.formatParameters(parameters);\r\n\r\n        this.debugLog('Creating UPnP XML Control Message for [' + upnpActionName + '] with parameters:');\r\n        this.debugLog(JSON ? JSON.stringify(parameters) : null);\r\n\r\n        // Build basic part of XML request\r\n        var svcMsg = this.requestTemplate.replace(/\\{ACTION_TYPE\\}/g, encodeXML(trim(upnpServiceType)));\r\n\r\n        svcMsg = svcMsg.replace(/\\{ACTION_NAME\\}/g, encodeXML(trim(upnpActionName)));\r\n\r\n        var svcInParams = parameters['request'],\r\n            svcInParams_xml = \"\";\r\n\r\n        if (svcInParams) {\r\n\r\n            // Generate XML parameters syntax\r\n            for (var svcParam in svcInParams) {\r\n\r\n                // Perform type checking sanitization\r\n                if (svcInParams[svcParam]['type'] !== undefined && svcInParams[svcParam]['type'] !== null) {\r\n\r\n                    // get the primitive sanitization function\r\n                    var typeCheck = this.types[svcInParams[svcParam]['type']];\r\n\r\n                    if (typeCheck) {\r\n                        svcInParams[svcParam]['value'] = typeCheck(svcInParams[svcParam]['value'], svcInParams[svcParam]['allowedValueList'], false);\r\n                    }\r\n\r\n                }\r\n\r\n                if (svcInParams[svcParam]['value'] === null || svcInParams[svcParam]['value'] === undefined) {\r\n\r\n                    svcInParams[svcParam]['value'] = \"\"; // pass through empty value\r\n\r\n                }\r\n\r\n                svcInParams_xml += \"\\t\\t\\t<\" + svcParam + \">\" + encodeXML(trim(svcInParams[svcParam]['value'] + \"\")) + \"</\" + svcParam + \">\\n\";\r\n\r\n            }\r\n\r\n        }\r\n\r\n        // Add ACTION_VARS, if any\r\n        svcMsg = svcMsg.replace(/\\{ACTION_VARS\\}/g, svcInParams_xml);\r\n\r\n        // DEBUG\r\n        this.debugLog('[REQUEST] (SOAPAction: ' + upnpServiceType + '#' + upnpActionName + ') ' + svcMsg);\r\n\r\n        return svcMsg;\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.sendRequest = function (upnpServiceType, upnpActionName, upnpEndpointURL, upnpRequestXML, onUPnPResponse) {\r\n\r\n        var soapaction = '\\\"' + upnpServiceType.replace(/[\\\"\\#]/g, '') + '#' + upnpActionName.replace(/[\\\"\\#]/g, '') + '\\\"'\r\n        var httpClient = new Windows.Web.Http.HttpClient();\r\n        var uri = new Windows.Foundation.Uri(upnpEndpointURL);\r\n        var request = new Windows.Web.Http.HttpRequestMessage(Windows.Web.Http.HttpMethod.post, uri);\r\n        request.headers.append('SOAPACTION', soapaction);\r\n        //request.headers.append('Content-Type', 'text/xml; charset=\"utf-8\";');        \r\n\r\n        request.content = new Windows.Web.Http.HttpStringContent(upnpRequestXML, Windows.Storage.Streams.UnicodeEncoding.utf8, \"text/xml\");\r\n\r\n        httpClient.sendRequestAsync(request).then(function (r) {\r\n            var content = r.content.readAsStringAsync().then(function (text) {\r\n                var xml = parseXML(text);\r\n                var r = {\r\n                    status: 200,\r\n                    responseText: text,\r\n                    responseXML: xml\r\n                };\r\n                onUPnPResponse.apply(this, [null, r]);\r\n            });\r\n\r\n        }, function (err) {\r\n            onUPnPResponse.apply(undefined, [new UPnPError('XmlHttpRequest failed'), null]);\r\n        });\r\n\r\n        return this;\r\n\r\n        try {\r\n\r\n            var xhr = new XMLHttpRequest();\r\n\r\n            xhr.open('POST', upnpEndpointURL);\r\n            xhr.setRequestHeader('Content-Type', 'text/xml; charset=\"utf-8\";');\r\n            xhr.setRequestHeader('action', soapaction);\r\n            xhr.setRequestHeader('zurgl', soapaction);\r\n            xhr.setRequestHeader('SOAPAction', soapaction);\r\n\r\n            xhr.onabort = xhr.onerror = function () {\r\n\r\n                onUPnPResponse.apply(undefined, [new UPnPError('XmlHttpRequest failed'), null]);\r\n\r\n                //xhrManager.release(xhr);\r\n\r\n            };\r\n\r\n            var self = this;\r\n\r\n            xhr.onreadystatechange = function () {\r\n\r\n                if (this.readyState < 4) return;\r\n\r\n                if (this.status !== 200) {\r\n\r\n                    onUPnPResponse.apply(undefined, [new UPnPError('XmlHttpRequest expected 200 OK. Received ' + this.status + ' response.'), null]);\r\n\r\n                    self.debugLog(\"[ERROR-RESPONSE] \" + this.responseText);\r\n\r\n                    //xhrManager.release(xhr);\r\n\r\n                    return;\r\n\r\n                }\r\n\r\n                self.debugLog(\"[SUCCESS-RESPONSE] \" + this.responseText);\r\n\r\n                onUPnPResponse.apply(this, [null, this]);\r\n\r\n                //xhrManager.release(xhr);\r\n\r\n            };\r\n\r\n            xhr.send(upnpRequestXML);\r\n\r\n        } catch (e) {\r\n\r\n            onUPnPResponse.apply(undefined, [new UPnPError(e), null]);\r\n\r\n        }\r\n\r\n        return this; // allow method chaining\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.handleResponse = function (upnpActionName, upnpResponseXML, parameters, onUPnPResolved) {\r\n\r\n        parameters = this.formatParameters(parameters);\r\n\r\n        var svcOutParams = parameters['response'];\r\n\r\n        var responseJSON = {};\r\n\r\n        // Process all XML response variables\r\n        var responseContainer = upnpResponseXML.getElementsByTagName ?\r\n                                  upnpResponseXML.getElementsByTagName(upnpActionName + \"Response\") : null;\r\n\r\n        // If we don't have any response variables, try again with the namespace attached (required for lib to work in Firefox)\r\n        if (responseContainer === null || responseContainer.length <= 0) {\r\n            responseContainer = upnpResponseXML.getElementsByTagName ?\r\n                                      upnpResponseXML.getElementsByTagName(\"u:\" + upnpActionName + \"Response\") : null;\r\n        }\r\n\r\n        if (responseContainer !== null && responseContainer.length > 0) {\r\n\r\n            var responseVars = responseContainer[0].childNodes;\r\n\r\n            if (responseVars && responseVars.length > 0) {\r\n\r\n                for (var i = 0, l = responseVars.length; i < l; i++) {\r\n\r\n                    var varName = responseVars[i].nodeName;\r\n                    var varVal = responseVars[i].firstChild ? trim(decodeXML(responseVars[i].firstChild.nodeValue + \"\")) : null;\r\n\r\n                    // Perform type checking sanitization if requested\r\n                    if (svcOutParams[varName] && svcOutParams[varName]['type'] !== undefined && svcOutParams[varName]['type'] !== null) {\r\n\r\n                        // get the primitive sanitization function\r\n                        var typeCheck = this.types[svcOutParams[varName]['type']];\r\n\r\n                        if (typeCheck) {\r\n                            varVal = typeCheck(varVal, svcOutParams[varName]['allowedValueList'] || null, true);\r\n                        }\r\n\r\n                    }\r\n\r\n                    responseJSON[varName] = (varVal !== undefined && varVal !== null) ? varVal : \"\";\r\n\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n\r\n        // Fire callback with the parsed action response data\r\n        onUPnPResolved.apply(undefined, [null, { data: responseJSON }]);\r\n\r\n        return this; // allow method chaining\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.formatParameter = function (parameter) {\r\n\r\n        var param = {};\r\n\r\n        if (parameter['type'] !== undefined || parameter['value'] !== undefined || parameter['allowedValueList'] !== undefined) {\r\n\r\n            param = parameter;\r\n\r\n            if (parameter['allowedValueList'] !== undefined && typeof parameter['allowedValueList'] !== 'array') {\r\n                parameter['allowedValueList'] = [];\r\n            }\r\n\r\n        } else {\r\n\r\n            param = { value: parameter };\r\n\r\n        }\r\n\r\n        // check type is valid, otherwise discard requested type\r\n        if (param['type'] !== undefined && param['type'] !== null) {\r\n\r\n            if (!this.types[(param['type'] + \"\")]) {\r\n\r\n                delete param['type'];\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return param;\r\n\r\n    };\r\n\r\n    // Normalize the input parameters argument\r\n    WinJSContrib.UPnP.UPnPService.prototype.formatParameters = function (parameters) {\r\n\r\n        if (parameters === undefined || parameters === null) {\r\n            parameters = {};\r\n        }\r\n\r\n        if (!parameters['request']) {\r\n            parameters['request'] = {};\r\n        }\r\n\r\n        if (!parameters['response']) {\r\n            parameters['response'] = {};\r\n        }\r\n\r\n        for (var param in parameters) {\r\n\r\n            if (param === 'request' || param === 'response') {\r\n\r\n                for (var processParam in parameters[param]) {\r\n\r\n                    parameters[param][processParam] = this.formatParameter(parameters[param][processParam]);\r\n\r\n                }\r\n\r\n            } else { // append as 'request' parameter and remove from root object\r\n\r\n                parameters['request'][param] = this.formatParameter(parameters[param]);\r\n\r\n                delete parameters[param];\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return parameters;\r\n\r\n    };\r\n\r\n    // ALLOWED VALUE LIST CHECKER\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues = function (val, allowedValueList) {\r\n\r\n        // Check against allowedValues if provided\r\n        if (val && allowedValueList && Object.prototype.toString.call(allowedValueList) == '[object Array]') {\r\n\r\n            var matchFound = false;\r\n\r\n            for (var i = 0, l = allowedValueList.length; i < l; i++) {\r\n\r\n                if (val == allowedValueList[i]) {\r\n\r\n                    matchFound = true;\r\n                    break;\r\n\r\n                }\r\n            }\r\n\r\n            if (!matchFound) {\r\n                return \"\";\r\n            }\r\n        }\r\n\r\n        return val;\r\n\r\n    };\r\n\r\n    // UPnP DEBUGGER\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.debugLog = function (msg, level) {\r\n        if ((this.options && this.options.debug)) {\r\n            console[level || 'log'](\"Plug.UPnP: \" + msg);\r\n        }\r\n    };\r\n\r\n    // UPnP ERROR OBJECT\r\n\r\n    var UPnPError = function (description) {\r\n        return {\r\n            'description': description\r\n        };\r\n    };\r\n\r\n    function parseXML(text) {\r\n        return (new DOMParser()).parseFromString(text, \"text/xml\");\r\n    }\r\n\r\n    // *** CUSTOM TYPE FUNCTIONS ***\r\n\r\n    // BASE64 FUNCTIONS\r\n    // (forked from https://github.com/dankogai/js-base64/blob/master/base64.js)\r\n\r\n    var b64chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\r\n\r\n    var b64tab = (function (bin) {\r\n        var t = {};\r\n        for (var i = 0, l = bin.length; i < l; i++) t[bin.charAt(i)] = i;\r\n        return t;\r\n    })(b64chars);\r\n\r\n    var cb_encode = function (ccc) {\r\n        var padlen = [0, 2, 1][ccc.length % 3],\r\n            ord = ccc.charCodeAt(0) << 16\r\n                | ((ccc.length > 1 ? ccc.charCodeAt(1) : 0) << 8)\r\n                | ((ccc.length > 2 ? ccc.charCodeAt(2) : 0)),\r\n            chars = [\r\n                b64chars.charAt(ord >>> 18),\r\n                b64chars.charAt((ord >>> 12) & 63),\r\n                padlen >= 2 ? '=' : b64chars.charAt((ord >>> 6) & 63),\r\n                padlen >= 1 ? '=' : b64chars.charAt(ord & 63)\r\n            ];\r\n        return chars.join('');\r\n    };\r\n\r\n    var cb_decode = function (cccc) {\r\n        var len = cccc.length,\r\n            padlen = len % 4,\r\n            n = (len > 0 ? b64tab[cccc.charAt(0)] << 18 : 0)\r\n              | (len > 1 ? b64tab[cccc.charAt(1)] << 12 : 0)\r\n              | (len > 2 ? b64tab[cccc.charAt(2)] << 6 : 0)\r\n              | (len > 3 ? b64tab[cccc.charAt(3)] : 0),\r\n            chars = [\r\n                String.fromCharCode(n >>> 16),\r\n                String.fromCharCode((n >>> 8) & 0xff),\r\n                String.fromCharCode(n & 0xff)\r\n            ];\r\n        chars.length -= [0, 0, 2, 1][padlen];\r\n        return chars.join('');\r\n    };\r\n\r\n    var btoa = global.btoa || function (b) {\r\n        return b.replace(/[\\s\\S]{1,3}/g, cb_encode);\r\n    };\r\n\r\n    var atob = global.atob || function (a) {\r\n        return a.replace(/[\\s\\S]{1,4}/g, cb_decode);\r\n    };\r\n\r\n    // HEX FUNCTIONS\r\n\r\n    var hexChars = '0123456789abcdef';\r\n\r\n    var hextab = (function (bin) {\r\n        var t = {};\r\n        for (var i = 0, l = bin.length; i < l; i++) t[i] = bin.charAt(i);\r\n        return t;\r\n    })(hexChars);\r\n\r\n    function toHex(n) {\r\n        var result = ''\r\n        var start = true;\r\n        for (var i = 32; i > 0;) {\r\n            i -= 4;\r\n            var digit = (n >> i) & 0xf;\r\n            if (!start || digit != 0) {\r\n                start = false;\r\n                result += hextab[digit];\r\n            }\r\n        }\r\n        return (result == '' ? '0' : result);\r\n    }\r\n\r\n    function pad(str, len, pad) {\r\n        var result = str;\r\n        for (var i = str.length; i < len; i++) {\r\n            result = pad + result;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function ntos(n) {\r\n        n = n.toString(16);\r\n        if (n.length == 1) n = \"0\" + n;\r\n        n = \"%\" + n;\r\n        return unescape(n);\r\n    }\r\n\r\n    function htoa(str) {\r\n        str = str.toUpperCase().replace(new RegExp(\"s/[^0-9A-Z]//g\"));\r\n        var result = \"\";\r\n        var nextchar = \"\";\r\n        for (var i = 0; i < str.length; i++) {\r\n            nextchar += str.charAt(i);\r\n            if (nextchar.length == 2) {\r\n                result += ntos(parseInt(nextchar, 16));\r\n                nextchar = \"\";\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function atoh(str) {\r\n        var result = \"\";\r\n        for (var i = 0; i < str.length; i++) {\r\n            result += pad(toHex(str.charCodeAt(i) & 0xff), 2, '0');\r\n        }\r\n        return result;\r\n    }\r\n\r\n    // NUMBER FUNCTIONS\r\n\r\n    function expandExponential(str) {\r\n        return str.replace(/^([+-])?(\\d+).?(\\d*)[eE]([-+]?\\d+)$/, function (x, s, n, f, c) {\r\n            var l = +c < 0, i = n.length + +c, x = (l ? n : f).length,\r\n            c = ((c = Math.abs(c)) >= x ? c - x + l : 0),\r\n            z = (new Array(c + 1)).join(\"0\"), r = n + f;\r\n            return (s || \"\") + (l ? r = z + r : r += z).substr(0, i += l ? z.length : 0) + (i < r.length ? \".\" + r.substr(i) : \"\");\r\n        });\r\n    };\r\n\r\n    // STRING FUNCTIONS\r\n\r\n    var trim = function (str) {\r\n        if (String.prototype.trim) {\r\n            return str.trim();\r\n        } else {\r\n            return str.replace(/^\\s+|\\s+$/g, \"\");\r\n        }\r\n    };\r\n\r\n    var encodeXML = function (str) {\r\n        return str.replace(/\\&/g, '&amp;')\r\n                   .replace(/</g, '&lt;')\r\n                   .replace(/>/g, '&gt;')\r\n                   .replace(/'/g, '&#39;')\r\n                   .replace(/\"/g, '&quot;');\r\n    };\r\n\r\n    var decodeXML = function (str) {\r\n        return str.replace(/\\&quot;/g, '\"')\r\n                   .replace(/\\&\\#39;/g, '\\'')\r\n                   .replace(/\\&gt;/g, '>')\r\n                   .replace(/\\&lt;/g, '<')\r\n                   .replace(/\\&amp;/g, '&');\r\n    };\r\n\r\n    /**\r\n     * Date.parse with progressive enhancement for ISO 8601 <https://github.com/csnover/js-iso8601>\r\n     * © 2011 Colin Snover <http://zetafleet.com>\r\n     * Released under MIT license.\r\n     *\r\n     * 2012 - Modifications to accept times without dates - by Rich Tibbett\r\n     */\r\n\r\n    var parseDate = function (date) {\r\n        var timestamp, struct, minutesOffset = 0, numericKeys = [1, 4, 5, 6, 7, 10, 11];\r\n\r\n        if (typeof date !== 'string') date += \"\";\r\n\r\n        if ((struct = /^((\\d{4}|[+\\-]\\d{6})(?:-(\\d{2})(?:-(\\d{2}))?)?)?(?:[T\\s]?(\\d{2}):(\\d{2})(?::(\\d{2})(?:\\.(\\d{3}))?)?(?:(Z)|([+\\-])(\\d{4}))?)?$/.exec(date))) {\r\n\r\n            struct = struct.slice(1, struct.length);\r\n\r\n            // avoid NaN timestamps caused by “undefined” values being passed to Date.UTC\r\n            for (var i = 0, k; (k = numericKeys[i]) ; ++i) {\r\n                struct[k] = +struct[k] || 0;\r\n            }\r\n\r\n            // allow undefined days and months\r\n            struct[2] = (+struct[2] || 1) - 1;\r\n            struct[3] = +struct[3] || 1;\r\n\r\n            if (struct[8] !== 'Z' && struct[9] !== undefined) {\r\n                minutesOffset = ((struct[10] / 100) - ((struct[10] / 100) % 1)) * 60 + (struct[10] % 100);\r\n\r\n                if (struct[9] === '+') {\r\n                    minutesOffset = 0 - minutesOffset;\r\n                }\r\n            }\r\n\r\n            timestamp = Date.UTC(struct[1], struct[2], struct[3], struct[4], struct[5] + minutesOffset, struct[6], struct[7]);\r\n        }\r\n        else {\r\n            timestamp = Date.parse ? Date.parse(date) : NaN;\r\n        }\r\n\r\n        return timestamp;\r\n    };\r\n\r\n    var allowedContentDirectoryTypes = {\r\n        'urn:schemas-upnp-org:service:ContentDirectory:1': true,\r\n        'urn:schemas-upnp-org:service:ContentDirectory:2': true,\r\n        'urn:schemas-upnp-org:service:ContentDirectory:3': true,\r\n        'urn:schemas-upnp-org:service:ContentDirectory:4': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPContentDirectory = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedContentDirectoryTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Media Server Service\");\r\n            return;\r\n        }\r\n\r\n        // *** ContentDirectory:1 methods\r\n\r\n        this.getSystemUpdateId = function (callback) {\r\n\r\n            return this.action('GetSystemUpdateID', {\r\n                request: {},\r\n                response: {\r\n                    Id: {\r\n                        type: this.types.ui4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getSearchCapabilities = function (callback) {\r\n\r\n            return this.action('GetSearchCapabilities', {\r\n                request: {},\r\n                response: {\r\n                    SearchCaps: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getSortCapabilities = function (callback) {\r\n\r\n            return this.action('GetSortCapabilities', {\r\n                request: {},\r\n                response: {\r\n                    SortCaps: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.browse = function (objectId, browseFlag, filter, startingIndex, requestedCount, sortCriteria, callback) {\r\n\r\n            return this.action('Browse', {\r\n                request: {\r\n                    ObjectID: {\r\n                        value: objectId || '0',\r\n                        type: this.types.string\r\n                    },\r\n                    BrowseFlag: {\r\n                        value: browseFlag || 'BrowseDirectChildren',\r\n                        type: this.types.string\r\n                    },\r\n                    Filter: {\r\n                        value: filter || '*',\r\n                        type: this.types.string\r\n                    },\r\n                    StartingIndex: {\r\n                        value: startingIndex || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    RequestedCount: {\r\n                        value: requestedCount || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    SortCriteria: {\r\n                        value: sortCriteria,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    Result: {\r\n                        type: this.types.xmlObj\r\n                    },\r\n                    NumberReturned: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    TotalMatches: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    UpdateID: {\r\n                        type: this.types.ui4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.search = function (objectId, browseFlag, filter, startingIndex, requestedCount, sortCriteria, callback) {\r\n\r\n            return this.action('Search', {\r\n                request: {\r\n                    ObjectID: {\r\n                        value: objectId || '0',\r\n                        type: this.types.string\r\n                    },\r\n                    BrowseFlag: {\r\n                        value: browseFlag || 'BrowseDirectChildren',\r\n                        type: this.types.string\r\n                    },\r\n                    Filter: {\r\n                        value: filter || '*',\r\n                        type: this.types.string\r\n                    },\r\n                    StartingIndex: {\r\n                        value: startingIndex || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    RequestedCount: {\r\n                        value: requestedCount || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    SortCriteria: {\r\n                        value: sortCriteria,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    Result: {\r\n                        type: this.types.xmlObj\r\n                    },\r\n                    NumberReturned: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    TotalMatches: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    UpdateID: {\r\n                        type: this.types.ui4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n\r\n        // *** ContentDirectory:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ContentDirectory:2') {\r\n\r\n            // TODO: GetFeatureList, GetSortExtensionCapabilities, MoveObject\r\n\r\n        }\r\n\r\n\r\n        // *** ContentDirectory:3 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ContentDirectory:3') {\r\n\r\n            // TODO\r\n\r\n        }\r\n\r\n        // *** ContentDirectory:4 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ContentDirectory:4') {\r\n            // TODO\r\n        }\r\n    };\r\n    WinJSContrib.UPnP.UPnPContentDirectory.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n    var allowedConnectionManagerTypes = {\r\n        'urn:schemas-upnp-org:service:ConnectionManager:1': true,\r\n        'urn:schemas-upnp-org:service:ConnectionManager:2': true,\r\n        'urn:schemas-upnp-org:service:ConnectionManager:3': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPConnectionManager = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedConnectionManagerTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Service\");\r\n            return;\r\n        }\r\n\r\n        // *** ConnectionManager:1 methods\r\n\r\n        this.getCurrentConnectionIDs = function (callback) {\r\n\r\n            return this.action('GetCurrentConnectionIDs', {\r\n                request: {},\r\n                response: {\r\n                    ConnectionIDs: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getCurrentConnectionInfo = function (connectionId, callback) {\r\n\r\n            return this.action('GetCurrentConnectionInfo', {\r\n                request: {\r\n                    ConnectionID: {\r\n                        value: connectionId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    RcsID: {\r\n                        type: this.types.i4\r\n                    },\r\n                    AVTransportID: {\r\n                        type: this.types.i4\r\n                    },\r\n                    ProtocolInfo: {\r\n                        type: this.types.string\r\n                    },\r\n                    PeerConnectionManager: {\r\n                        type: this.types.string\r\n                    },\r\n                    PeerConnectionID: {\r\n                        type: this.types.i4\r\n                    },\r\n                    Direction: {\r\n                        type: this.types.string\r\n                    },\r\n                    Status: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getProtocolInfo = function (callback) {\r\n\r\n            return this.action('GetProtocolInfo', {\r\n                request: {},\r\n                response: {\r\n                    Source: {\r\n                        type: this.types.string\r\n                    },\r\n                    Sink: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        // *** ConnectionManager:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ConnectionManager:2') {\r\n            // TODO\r\n        }\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPConnectionManager.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n    var allowedAVTransportTypes = {\r\n        'urn:schemas-upnp-org:service:AVTransport:1': true,\r\n        'urn:schemas-upnp-org:service:AVTransport:2': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPAVTransport = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedAVTransportTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Media Renderer Service\");\r\n            return;\r\n        }\r\n\r\n        // *** AVTransport:1 methods\r\n\r\n        this.getDeviceCapabilities = function (instanceId, callback) {\r\n\r\n            return this.action('GetDeviceCapabilities', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    PlayMedia: {\r\n                        type: this.types.string\r\n                    },\r\n                    RecMedia: {\r\n                        type: this.types.string\r\n                    },\r\n                    RecQualityModes: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getMediaInfo = function (instanceId, callback) {\r\n\r\n            return this.action('GetMediaInfo', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    NrTracks: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    MediaDuration: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentURI: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentURIMetaData: {\r\n                        type: this.types.string\r\n                    },\r\n                    NextURI: {\r\n                        type: this.types.string\r\n                    },\r\n                    NextURIMetaData: {\r\n                        type: this.types.string\r\n                    },\r\n                    PlayMedium: {\r\n                        type: this.types.string\r\n                    },\r\n                    RecordMedium: {\r\n                        type: this.types.string\r\n                    },\r\n                    WriteStatus: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getPositionInfo = function (instanceId, callback) {\r\n\r\n            return this.action('GetPositionInfo', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    Track: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    TrackDuration: {\r\n                        type: this.types.string\r\n                    },\r\n                    TrackMetaData: {\r\n                        type: this.types.xmlObj\r\n                    },\r\n                    TrackURI: {\r\n                        type: this.types.string\r\n                    },\r\n                    RelTime: {\r\n                        type: this.types.string\r\n                    },\r\n                    AbsTime: {\r\n                        type: this.types.string\r\n                    },\r\n                    RelCount: {\r\n                        type: this.types.i4\r\n                    },\r\n                    AbsCount: {\r\n                        type: this.types.i4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getTransportInfo = function (instanceId, callback) {\r\n\r\n            return this.action('GetTransportInfo', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentTransportState: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentTransportStatus: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentSpeed: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getTransportSettings = function (instanceId, callback) {\r\n\r\n            return this.action('GetTransportSettings', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    PlayMode: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    RecQualityMode: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setAVTransportURI = function (instanceId, currentURI, currentURIMetaData, callback) {\r\n\r\n            return this.action('SetAVTransportURI', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    CurrentURI: {\r\n                        value: currentURI,\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentURIMetaData: {\r\n                        value: currentURIMetaData,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.play = function (instanceId, speed, callback) {\r\n\r\n            return this.action('Play', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Speed: {\r\n                        value: speed || '1',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.pause = function (instanceId, callback) {\r\n\r\n            return this.action('Pause', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.stop = function (instanceId, callback) {\r\n\r\n            return this.action('Stop', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.next = function (instanceId, callback) {\r\n\r\n            return this.action('Next', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.previous = function (instanceId, callback) {\r\n\r\n            return this.action('Previous', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.seek = function (instanceId, unit, target, callback) {\r\n\r\n            return this.action('Seek', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Unit: {\r\n                        value: unit,\r\n                        type: this.types.string\r\n                    },\r\n                    Target: {\r\n                        value: target,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        // *** AVTransport:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:AVTransport:2') {\r\n\r\n            // TODO\r\n\r\n        }\r\n    };\r\n    WinJSContrib.UPnP.UPnPAVTransport.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n    var allowedRenderingControlTypes = {\r\n        'urn:schemas-upnp-org:service:RenderingControl:1': true,\r\n        'urn:schemas-upnp-org:service:RenderingControl:2': true,\r\n        'urn:schemas-upnp-org:service:RenderingControl:3': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPRenderingControl = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedRenderingControlTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Media Renderer Service\");\r\n            return;\r\n        }\r\n\r\n        // *** RenderingControl:1 methods\r\n\r\n        this.listPresets = function (instanceId, callback) {\r\n\r\n            return this.action('ListPresets', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentPresetNameList: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.selectPreset = function (instanceId, presetName, callback) {\r\n\r\n            return this.action('SelectPreset', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    PresetName: {\r\n                        value: presetName || \"FactoryDefaults\",\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBrightness = function (instanceId, callback) {\r\n\r\n            return this.action('GetBrightness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBrightness: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setBrightness = function (instanceId, desiredBrightness, callback) {\r\n\r\n            return this.action('SetBrightness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredBrightness: {\r\n                        value: desiredBrightness,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getContrast = function (instanceId, callback) {\r\n\r\n            return this.action('GetContrast', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentContrast: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setContrast = function (instanceId, desiredContrast, callback) {\r\n\r\n            return this.action('SetContrast', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredContrast: {\r\n                        value: desiredContrast,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getSharpness = function (instanceId, callback) {\r\n\r\n            return this.action('GetSharpness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentSharpness: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setSharpness = function (instanceId, desiredSharpness, callback) {\r\n\r\n            return this.action('SetSharpness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredSharpness: {\r\n                        value: desiredSharpness,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getRedVideoGain = function (instanceId, callback) {\r\n\r\n            return this.action('GetRedVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentRedVideoGain: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setRedVideoGain = function (instanceId, desiredRedVideoGain, callback) {\r\n\r\n            return this.action('SetRedVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredRedVideoGain: {\r\n                        value: desiredRedVideoGain,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getGreenVideoGain = function (instanceId, callback) {\r\n\r\n            return this.action('GetGreenVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentGreenVideoGain: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setGreenVideoGain = function (instanceId, desiredGreenVideoGain, callback) {\r\n\r\n            return this.action('SetGreenVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredGreenVideoGain: {\r\n                        value: desiredGreenVideoGain,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBlueVideoGain = function (instanceId, callback) {\r\n\r\n            return this.action('GetBlueVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBlueVideoGain: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setBlueVideoGain = function (instanceId, desiredBlueVideoGain, callback) {\r\n\r\n            return this.action('SetBlueVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredBlueVideoGain: {\r\n                        value: desiredBlueVideoGain,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getRedVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetRedVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentRedVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setRedVideoBlackLevel = function (instanceId, desiredRedVideoBlackLevel, callback) {\r\n\r\n            return this.action('SetRedVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredRedVideoBlackLevel: {\r\n                        value: desiredRedVideoBlackLevel,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getGreenVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetGreenVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentGreenVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setGreenVideoBlackLevel = function (instanceId, desiredGreenVideoBlackLevel, callback) {\r\n\r\n            return this.action('SetGreenVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredGreenVideoBlackLevel: {\r\n                        value: desiredGreenVideoBlackLevel,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBlueVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetBlueVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBlueVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setBlueVideoBlackLevel = function (instanceId, desiredBlueVideoBlackLevel, callback) {\r\n\r\n            return this.action('SetBlueVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredBlueVideoBlackLevel: {\r\n                        value: desiredBlueVideoBlackLevel,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBlueVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetBlueVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBlueVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getColorTemperature = function (instanceId, callback) {\r\n\r\n            return this.action('GetColorTemperature', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentColorTemperature: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setColorTemperature = function (instanceId, desiredColorTemperature, callback) {\r\n\r\n            return this.action('SetColorTemperature', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredColorTemperature: {\r\n                        value: desiredColorTemperature,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getHorizontalKeystone = function (instanceId, callback) {\r\n\r\n            return this.action('GetHorizontalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentHorizontalKeystone: {\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setHorizontalKeystone = function (instanceId, desiredHorizontalKeystone, callback) {\r\n\r\n            return this.action('SetHorizontalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredHorizontalKeystone: {\r\n                        value: desiredHorizontalKeystone,\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVerticalKeystone = function (instanceId, callback) {\r\n\r\n            return this.action('GetVerticalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentVerticalKeystone: {\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setVerticalKeystone = function (instanceId, desiredVerticalKeystone, callback) {\r\n\r\n            return this.action('SetVerticalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredVerticalKeystone: {\r\n                        value: desiredVerticalKeystone,\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getMute = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetMute', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentMute: {\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setMute = function (instanceId, channel, desiredMute, callback) {\r\n\r\n            return this.action('SetMute', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredMute: {\r\n                        value: desiredMute,\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVolume = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetVolume', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentVolume: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setVolume = function (instanceId, channel, desiredVolume, callback) {\r\n\r\n            return this.action('SetVolume', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredVolume: {\r\n                        value: desiredVolume,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVolumeDB = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetVolumeDB', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentVolume: {\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setVolumeDB = function (instanceId, channel, desiredVolume, callback) {\r\n\r\n            return this.action('SetVolumeDB', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredVolume: {\r\n                        value: desiredVolume,\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVolumeDBRange = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetVolumeDBRange', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    MinValue: {\r\n                        type: this.types.i2\r\n                    },\r\n                    MaxValue: {\r\n                        type: this.types.i2\r\n                    },\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getLoudness = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetLoudness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentLoudness: {\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setLoudness = function (instanceId, channel, desiredLoudness, callback) {\r\n\r\n            return this.action('SetLoudness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredLoudness: {\r\n                        value: desiredLoudness,\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        // *** RenderingControl:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:RenderingControl:2' ||\r\n              this.upnpType === 'urn:schemas-upnp-org:service:RenderingControl:3') {\r\n\r\n            this.getStateVariables = function (instanceId, stateVariableList, callback) {\r\n\r\n                return this.action('GetStateVariables', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        },\r\n                        StateVariableList: {\r\n                            value: stateVariableList,\r\n                            type: this.types.string\r\n                        }\r\n                    },\r\n                    response: {\r\n                        StateVariableValuePairs: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.setStateVariables = function (instanceId, renderingControlUDN, serviceType, serviceId, stateVariableValuePairs, callback) {\r\n\r\n                return this.action('SetStateVariables', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        },\r\n                        RenderingControlUDN: {\r\n                            value: renderingControlUDN,\r\n                            type: this.types.string\r\n                        },\r\n                        ServiceType: {\r\n                            value: serviceType,\r\n                            type: this.types.string\r\n                        },\r\n                        ServiceId: {\r\n                            value: serviceId,\r\n                            type: this.types.string\r\n                        },\r\n                        StateVariableValuePairs: {\r\n                            value: stateVariableValuePairs,\r\n                            type: this.types.string\r\n                        }\r\n                    },\r\n                    response: {\r\n                        StateVariableList: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n        }\r\n\r\n        // *** RenderingControl:3 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:RenderingControl:3') {\r\n\r\n            this.getAllowedTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetAllowedTransforms', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        }\r\n                    },\r\n                    response: {\r\n                        CurrentAllowedTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetTransforms', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        }\r\n                    },\r\n                    response: {\r\n                        CurrentTransformValues: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.setTransforms = function (instanceId, desiredTransformValues, callback) {\r\n\r\n                return this.action('SetTransforms', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        },\r\n                        DesiredTransformValues: {\r\n                            value: desiredTransformValues,\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getAllAvailableTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetAllAvailableTransforms', {\r\n                    response: {\r\n                        AllAllowedTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getAllowedDefaultTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetAllowedDefaultTransforms', {\r\n                    response: {\r\n                        AllowedDefaultTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getDefaultTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetDefaultTransforms', {\r\n                    response: {\r\n                        CurrentDefaultTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.setDefaultTransforms = function (instanceId, desiredDefaultTransformSettings, callback) {\r\n\r\n                return this.action('SetDefaultTransforms', {\r\n                    request: {\r\n                        DesiredDefaultTransformSettings: {\r\n                            value: desiredDefaultTransformSettings,\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n        }\r\n\r\n    };\r\n    WinJSContrib.UPnP.UPnPRenderingControl.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n})(window);","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib;\r\n(function (WinJSContrib) {\r\n    'use strict';\r\n\r\n    /**\r\n     * Custom WinJS Bindings\r\n     * @namespace WinJSContrib.Bindings\r\n     */\r\n    (function (Bindings) {\r\n\r\n        /**\r\n         * path for default picture\r\n         */\r\n        WinJSContrib.Bindings.pictureUnavailable = '/images/unavailable.png';\r\n\r\n        /**\r\n         * Helper for reading arguments for an element\r\n         * @param {HTMLElement} element\r\n         * @param {string} argument name\r\n         */\r\n        WinJSContrib.Bindings.bindingArguments = function bindingArguments(elt, argname) {\r\n            var data;\r\n            if (WinJS.UI._optionsParser) {\r\n                var text = elt.getAttribute(\"data-win-bind-args\");\r\n                if (text) {\r\n                    data = WinJS.UI.optionsParser(text, window);\r\n                }\r\n            } else {\r\n                data = elt.dataset.winBindArgs;\r\n            }\r\n\r\n            if (data) {\r\n                if (argname) {\r\n                    return data[argname];\r\n                } else {\r\n                    return data;\r\n                }\r\n            }\r\n        };\r\n        var bindingArguments = WinJSContrib.Bindings.bindingArguments;\r\n\r\n        /**\r\n         * Binding function to remove HTML from data and add it to destination\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.removeHTML = WinJS.Binding.initializer(function (source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            var elt = document.createElement('DIV');\r\n            elt.innerHTML = data;\r\n            WinJS.Binding.oneTime({ value: elt.innerText }, ['value'], dest, [destProperty]);\r\n        });\r\n\r\n        /**\r\n         * Binding function to remove HTML from data and add it to destination with an ellipse after X characters. The number of characters is specified with \"ellipsisize\" argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.removeHTMLAndEllipsisize = WinJS.Binding.initializer(function (source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            var elt = document.createElement('DIV');\r\n            elt.innerHTML = data;\r\n            var textRes = elt.innerText;\r\n            var size = bindingArguments(dest, 'ellipsisize');\r\n\r\n            if (size)\r\n                textRes = toStaticHTML(WinJSContrib.Utils.ellipsisizeString(elt.innerText, size, true));\r\n            WinJS.Binding.oneTime({ value: textRes }, ['value'], dest, [destProperty]);\r\n        });\r\n\r\n        /**\r\n         * Binding function to remove HTML from data and add it to destination with an ellipse after X characters. The number of characters is specified with \"ellipsisize\" argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.staticHTML = WinJS.Binding.initializer(function (source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            dest[destProperty] = toStaticHTML(data);\r\n        });\r\n\r\n        /**\r\n         * Binding function to add a data-* attribute to the element. Use the destination name to specifiy attribute name\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         * @example\r\n         * //assuming object is { myproperty: 42 }\r\n         * <div data-win-bind=\"foo : myproperty WinJSContrib.Bindings.dataAttr\"></div>\r\n         * //will result to\r\n         * <div data-foo=\"42\" data-win-bind=\"foo : myproperty WinJSContrib.Bindings.dataAttr\"></div>\r\n         */\r\n        WinJSContrib.Bindings.dataAttr = WinJS.Binding.initializer(function dataAttrBinding(source, sourceProperty, dest, destProperty) {\r\n        \tvar data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n        \tdest.setAttribute('data-' + destProperty, data)\r\n        });\r\n\r\n        /**\r\n         * Binding function to add css class named after object property. You could format class by using a \"format\" argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.addClass = WinJS.Binding.initializer(function addClassBinding(source, sourceProperty, dest, destProperty) {\r\n            function setClass(newval, oldval) {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                var formatParameter = bindingArguments(dest, 'format');\r\n                if (formatParameter) {\r\n                    dest.classList.remove(formatParameter.format(oldval));\r\n                    dest.classList.add(formatParameter.format(data));\r\n                }\r\n                else {\r\n                    dest.classList.remove(oldval);\r\n                    dest.classList.add(data);\r\n                }\r\n            }\r\n\r\n            var bindingDesc = {};\r\n            bindingDesc[sourceProperty] = setClass;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * add css class based on a prefix defined with destProperty and the value from the source object\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.asClass = WinJS.Binding.initializer(function asClassBinding(source, sourceProperty, dest, destProperty) {\r\n            function setClass(newval, oldval) {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                dest.classList.remove(destProperty + '-' + oldval);\r\n                dest.classList.add(destProperty + '-' + data);\r\n            }\r\n            var bindingDesc = {};\r\n            bindingDesc[sourceProperty] = setClass;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * add css class based on truthy/falsy value from the source object\r\n         * css class has to be precised through data-win-bind-args='{\"className\": \"\"}' attribute\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.showClassIf = WinJS.Binding.initializer(function showClassIfBinding(source, sourceProperty, dest, destProperty) {\r\n            function setClass(newval, oldval) {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                var className = bindingArguments(dest, 'className');\r\n                dest.classList.remove(className);\r\n                if (data)\r\n                    dest.classList.add(className);\r\n            }\r\n            var bindingDesc = {};\r\n            bindingDesc[sourceProperty] = setClass;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * convert a url string for use as a background image url\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.toBgImage = WinJS.Binding.initializer(function toBgImageBinding(source, sourceProperty, dest, destProperty) {\r\n            function setImage() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data || !data.length) {\r\n                    dest.style.backgroundImage = '';\r\n                    return;\r\n                }\r\n                dest.style.backgroundImage = 'url(\"' + data + '\")';\r\n            }\r\n\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setImage;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n\r\n        WinJSContrib.Bindings.ToRealDate = WinJS.Binding.initializer(function ToRealDateBinding(source, sourceProperty, dest, destProperty) {\r\n            var date = new Date(source.date * 1000);\r\n            dest.innerHTML = date.toLocaleDateString();\r\n        });\r\n\r\n        function _setPic(dest, url) {\r\n            if (dest.nodeName.toLowerCase() == 'img') {\r\n                dest.src = url;\r\n            }\r\n            else {\r\n                dest.style.backgroundImage = 'url(\"' + url + '\")';\r\n            }\r\n            dest.classList.add('imageLoaded');\r\n        }\r\n\r\n        /**\r\n         * Asynchronously load a picture (using src for image tag and background-image for other elements) from url path, and add 'imageLoaded' css class once picture is ready. \r\n         * You could rely on '.imageLoaded' to add transitions for image loading\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.picture = WinJS.Binding.initializer(function toSmartBgImageBinding(source, sourceProperty, dest, destProperty) {\r\n            function setImage() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data || !data.length) {\r\n                    data = Bindings.pictureUnavailable;\r\n                }\r\n\r\n                dest.classList.remove('imageLoaded');\r\n                setTimeout(function () {\r\n                    WinJSContrib.UI.loadImage(data).done(function () {\r\n                        _setPic(dest, data);\r\n                    }, function () {\r\n                        _setPic(dest, Bindings.pictureUnavailable);\r\n                        WinJS.Utilities.addClass(dest, 'imageLoaded');\r\n                    });\r\n                }, 200);\r\n            }\r\n\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setImage;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n        WinJSContrib.Bindings.toSmartBgImage = WinJSContrib.Bindings.picture; //deprecated method name\r\n\r\n        /**\r\n         * show element if property is filled or true. The dest property can be used to choose what to use for showing/hiding object (opacity, visibility, or display)\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.showIf = WinJS.Binding.initializer(function hideUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.classList.remove('mcn-show');\r\n                    dest.classList.add('mcn-hide');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '0';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = 'hidden';\r\n                    } else {\r\n                        dest.style.display = 'none';\r\n                    }\r\n                } else {\r\n                    dest.classList.remove('mcn-hide');\r\n                    dest.classList.add('mcn-show');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = '';\r\n                    } else {\r\n                        dest.style.display = '';\r\n                    }\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * Alias for {@link WinJSContrib.Bindings.showIf}, just for semantic purpose\r\n         * @function\r\n         * @see WinJSContrib.Bindings.showIf\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.hideIfNot = WinJSContrib.Bindings.showIf;\r\n        WinJSContrib.Bindings.hideIfNotDefined = WinJSContrib.Bindings.showIf;//warning, deprecated\r\n\r\n        /**\r\n         * hide element if property is filled or true. The dest property can be used to choose what to use for showing/hiding object (opacity, visibility, or display)\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.hideIf = WinJS.Binding.initializer(function showUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.classList.remove('mcn-hide');\r\n                    dest.classList.add('mcn-show');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = '';\r\n                    } else {\r\n                        dest.style.display = '';\r\n                    }\r\n                } else {\r\n                    dest.classList.remove('mcn-show');\r\n                    dest.classList.add('mcn-hide');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '0';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = 'hidden';\r\n                    } else {\r\n                        dest.style.display = 'none';\r\n                    }\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * Alias for {@link WinJSContrib.Bindings.hideIf}, just for semantic purpose\r\n         * @function\r\n         * @see WinJSContrib.Bindings.hideIf\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.showIfNot = WinJSContrib.Bindings.hideIf; //warning, deprecated\r\n\r\n        WinJSContrib.Bindings.showIfNotDefined = WinJSContrib.Bindings.hideIf; //warning, deprecated\r\n\r\n        /**\r\n         * enable element if property is filled or true\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.enableIf = WinJS.Binding.initializer(function disableUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.disabled = true;\r\n                } else {\r\n                    dest.disabled = false;\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n        WinJSContrib.Bindings.disableIfNot = WinJSContrib.Bindings.enableIf;\r\n\r\n        /**\r\n         * disable element if property is filled or true\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.disableIf = WinJS.Binding.initializer(function enableUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.disabled = false;\r\n                } else {\r\n                    dest.disabled = true;\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n        WinJSContrib.Bindings.enableIfNot = WinJSContrib.Bindings.disableIf;\r\n\r\n        /**\r\n         * apply a percent number as width (in percent) on the element\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.toWidth = WinJS.Binding.initializer(function progressToWidth(source, sourceProperty, dest, destProperty) {\r\n            function setWidth() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.style.width = '';\r\n                } else {\r\n                    dest.style.width = data + '%';\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setWidth;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * truncate a string and add ellipse to the text if string is longer than a limit. The max size of text is determined by a 'ellipsisize' argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         * @example {@lang xml}\r\n         * <p data-win-bind=\"innerText : someLongText WinJSContrib.Bindings.ellipsisize\" data-win-bind-args='{ \"ellipsisize\" : 50}'></p>\r\n         */\r\n        WinJSContrib.Bindings.ellipsisize = WinJS.Binding.initializer(function toEllipsisizedBinding(source, sourceProperty, dest, destProperty) {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            var size = bindingArguments(dest, 'ellipsisize');\r\n            dest[destProperty] = toStaticHTML(WinJSContrib.Utils.ellipsisizeString(sourcedata, size, true));\r\n        });\r\n        WinJSContrib.Bindings.toEllipsisized = WinJSContrib.Bindings.ellipsisize; //deprecated name\r\n\r\n        WinJSContrib.Bindings.emptyIfNull = WinJS.Binding.initializer(function emptyIfNull(source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (typeof data === \"undefined\" || data === null) {\r\n                dest[destProperty] = \"\";\r\n            } else {\r\n                dest[destProperty] = data;\r\n            }\r\n        });\r\n\r\n\r\n        /**\r\n         * Two way binding triggered by \"change\" event on inputs\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.twoWayOnChange = WinJS.Binding.initializer(function twoWayOnChangeBinding(source, sourceProperty, dest, destProperty) {\r\n            function setVal() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                WinJSContrib.Utils.writeProperty(dest, destProperty, data || '');\r\n            }\r\n\r\n            function getVal() {\r\n                var val = WinJSContrib.Utils.getProperty(dest, destProperty);\r\n                WinJSContrib.Utils.writeProperty(source, sourceProperty, val.propValue);\r\n            }\r\n\r\n            dest.addEventListener('change', getVal, false);\r\n            if (!dest.winControl) {\r\n                dest.classList.add('win-disposable');\r\n                dest.winControl = {\r\n                    dispose: function () {\r\n                        dest.removeEventListener('change', getVal);\r\n                    }\r\n                };\r\n            }\r\n\r\n            var bindingDesc = {\r\n            };\r\n\r\n            bindingDesc[sourceProperty] = setVal;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /** \r\n         * cleans up a binding list by returning its items as non-observable \r\n         * @function \r\n         * @param {Object[]} bindingList binding list to clean up \r\n         * @returns {Object[]} array containing the cleaned up items \r\n         */\r\n        Bindings.cleanUpBindingList = function (bindingList) {\r\n            var result = [];\r\n\r\n            bindingList.forEach(function (item) {\r\n                var unwrappedItem = WinJS.Binding.unwrap(item);\r\n                result.push(unwrappedItem);\r\n            });\r\n\r\n            return result;\r\n        };\r\n\r\n\r\n    })(WinJSContrib.Bindings || (WinJSContrib.Bindings = {}));\r\n    var Bindings = WinJSContrib.Bindings;\r\n})(WinJSContrib || (WinJSContrib = {}));\r\n","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/// <reference path=\"WinJSContrib.binding.utils.js\" />\r\n/// <reference path=\"moment.min.js\" />\r\n\r\nvar WinJSContrib;\r\nWinJSContrib.Utils = WinJSContrib.Utils || {};\r\nWinJSContrib.Bindings = WinJSContrib.Bindings || {};\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    /** \r\n     * format date using binding argument 'formatDate'\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.formatDate = WinJS.Utilities.markSupportedForProcessing(function formatDateBinding(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                var arg = WinJSContrib.Bindings.bindingArguments(dest, 'formatDate') || 'L';\r\n                dest.innerText = moment(sourcedata).format(arg);\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n    /** \r\n     * format date using calendar function\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.calendar = WinJS.Utilities.markSupportedForProcessing(function formatDateBinding(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                dest.innerText = moment(sourcedata).calendar();\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n    function daysSince(m, d, y) {\r\n        if (d == '' || m == '' || y == '') {\r\n            //alert(\"All fields must be entered\");\r\n            return;\r\n        }\r\n\r\n        if (isNaN(m) || isNaN(y) || isNaN(d)) {\r\n            //alert(\"Only numbers .\");\r\n            return;\r\n        }\r\n\r\n        var myDate = new Date();\r\n        var yourDate = new Date(y, m - 1, d);\r\n\r\n        var secondsInADay = 1000 * 60 * 60 * 24;\r\n        var diff = Math.floor((myDate.getTime() - yourDate.getTime()) / secondsInADay);\r\n        return diff;\r\n    }\r\n\r\n\r\n    /**\r\n     * display number of days since a date\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.daysSinceDate = WinJS.Utilities.markSupportedForProcessing(function daysSinceDateBinding(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                sourcedata = new Date(sourcedata);\r\n                var m = sourcedata.getMonth() + 1, d = sourcedata.getDate(), y = sourcedata.getFullYear();\r\n                var fromdate = daysSince(m, d, y);\r\n                dest.innerText = fromdate;\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n    /**\r\n     * apply moment.js humanize formatting on a date. Use 'humanizeFormat' and 'addSuffix' arguments to configure binding\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.humanizeDate = WinJS.Utilities.markSupportedForProcessing(function humanizeDate(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                var arg = WinJSContrib.Bindings.bindingArguments(dest, \"humanizeFormat\"),\r\n                    addSuffix = WinJSContrib.Bindings.bindingArguments(dest, \"addSuffix\");\r\n                dest.innerText = moment.duration(sourcedata, arg).humanize(addSuffix);\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n\r\n})();","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib = WinJSContrib || {};\r\n\r\n(function () {\r\n\r\n    function Messenger(receiver, sender) {\r\n        var messenger = this;\r\n        messenger.isWorker = receiver.document === undefined;\r\n        messenger._pendings = {};\r\n        messenger._receiver = receiver;\r\n        messenger._sender = sender || receiver;\r\n        messenger._bindedProcessEvent = messenger._processEvent.bind(messenger);\r\n\r\n        if (messenger._receiver)\r\n            messenger._receiver.addEventListener('message', messenger._bindedProcessEvent);\r\n    };\r\n\r\n    /**\r\n     * @classdesc\r\n     * Wrapper for messaging between main code and iframe or web worker. All returns are wrapped as WinJS.Promise to enable asynchronous scenarios     \r\n     * @class\r\n     * @param {DOMElement} receiver element that will receive messages\r\n     * @param {DOMElement} sender element that will send messages\r\n     */\r\n    WinJSContrib.Messenger = WinJS.Class.mix(Messenger, WinJS.Utilities.eventMixin);\r\n\r\n    /**\r\n     * default path for smart worker js file\r\n     */\r\n    WinJSContrib.Messenger.SmartWorkerPath = '/scripts/winjscontrib/winjscontrib.messenger.worker.js';\r\n\r\n    /**\r\n     * @classdesc\r\n     * Wrapper for {@link WinJSContrib.Messenger} when using it with a webworker\r\n     * @class\r\n     * @param {string} [path] path to web worker file\r\n     */\r\n    WinJSContrib.Messenger.SmartWorker = function (path) {\r\n        if (window.Worker) {\r\n            var w = new window.Worker(path || WinJSContrib.Messenger.SmartWorkerPath);\r\n            return new WinJSContrib.Messenger(w, w);\r\n        }\r\n\r\n        return new WinJSContrib.Messenger(null, null);\r\n    }\r\n\r\n\r\n    WinJSContrib.Messenger.prototype._send = function (obj) {\r\n        if (this.isWorker) {\r\n            this._sender.postMessage(JSON.stringify(obj));\r\n        }\r\n        else {\r\n            this._sender.postMessage(JSON.stringify(obj), '*');\r\n        }\r\n    };\r\n\r\n    /**\r\n     * import script files\r\n     * @param {Array} scriptPaths an array of string paths to js files\r\n     */\r\n    WinJSContrib.Messenger.prototype.importScripts = function (scriptPaths) {\r\n        if (!this._receiver)\r\n            return WinJS.Promise.wrap();\r\n\r\n        return this.start('_doImportScripts', scriptPaths);\r\n    }\r\n\r\n    WinJSContrib.Messenger.prototype._doImportScripts = function (scriptPaths) {\r\n        return new WinJS.Promise(function (c) {\r\n            if (typeof scriptPaths == 'string') {\r\n                importScripts(scriptPaths);\r\n            } else if (scriptPaths.length) {\r\n                for (var i = 0 ; i < scriptPaths.length ; i++) {\r\n                    importScripts(scriptPaths[i]);\r\n                }\r\n            }\r\n            c();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * run the callback in the web worker. The callback is serialized to string so you must pass all variable used inside the function as arguments\r\n     * @param {function} func function callback\r\n     * @param {...Object} args\r\n     * @returns {WinJS.Promise}\r\n     */\r\n    WinJSContrib.Messenger.prototype.execute = function (func) {\r\n        var messenger = this;\r\n        var args = [];\r\n        if (arguments.length > 1) {\r\n            for (var i = 1 ; i < arguments.length; i++) {\r\n                args.push(arguments[i]);\r\n            }\r\n        }\r\n\r\n        if (messenger._receiver) {\r\n            var f = 'var messengerFunction=' + func;\r\n\r\n            return this.start('_runFunction', { f: f, args: args });\r\n        }\r\n        else {\r\n            return WinJS.Promise.timeout(0).then(function () {\r\n                return func.apply(null, args);\r\n            });\r\n        }\r\n    }\r\n\r\n    WinJSContrib.Messenger.prototype._runFunction = function (functionArgs) {\r\n        var messenger = this;\r\n        return new WinJS.Promise(function (c, e) {\r\n            try {\r\n                eval(functionArgs.f);\r\n                var res = messengerFunction.apply(null, functionArgs.args);\r\n                c(res);\r\n            } catch (exception) {\r\n                e(exception);\r\n            }\r\n        });\r\n    }\r\n\r\n    WinJSContrib.Messenger.prototype.map = function (object, functions) {\r\n        var messenger = this;\r\n        functions.forEach(function (name) {\r\n            messenger[name] = function () {\r\n                var f = object[name];\r\n                return f.apply(object, arguments);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * start an operation within iframe or worker and get a promise for completion\r\n     * @param {string} eventName name of the event/function to call\r\n     * @param {Object} data event/function passed as argument\r\n     * @returns {WinJS.Promise}\r\n     */\r\n    WinJSContrib.Messenger.prototype.start = function (eventName, data, asArgs) {\r\n        var messenger = this;\r\n\r\n        if (!messenger._receiver)\r\n            return WinJS.Promise.wrapError('worker not supported');\r\n\r\n        var wrapper = {\r\n            id: WinJSContrib.Utils.guid(),\r\n            complete: null, error: null, progress: null, promise: null\r\n        }\r\n\r\n        var event = {\r\n            name: eventName,\r\n            id: wrapper.id,\r\n            type: 'run',\r\n            data: data,\r\n            asArgs: asArgs,\r\n            sender: 'WinJSContrib.WinJSContrib.Messenger'\r\n        };\r\n\r\n        wrapper.promise = new WinJS.Promise(function (c, e, p) {\r\n            wrapper.complete = c;\r\n            wrapper.error = e;\r\n            wrapper.progress = p;\r\n        }, function oncancel() {\r\n            console.warn('message canceled');\r\n            event.type = 'cancel';\r\n            messenger._send(event);\r\n        });\r\n\r\n        messenger._pendings[wrapper.id] = wrapper;\r\n        var cleanUp = function () {\r\n            delete messenger._pendings[wrapper.id];\r\n        }\r\n        wrapper.promise.done(cleanUp, cleanUp);\r\n        messenger._send(event);\r\n\r\n        return wrapper.promise;\r\n    };\r\n\r\n    WinJSContrib.Messenger.prototype._processEvent = function (arg) {\r\n        var messenger = this;\r\n       \r\n        var details = typeof (arg.data) == 'string' ? JSON.parse(arg.data) : arg.data;\r\n        var name = details.name;\r\n        var data = details.data;\r\n        var asArgs = details.asArgs;\r\n\r\n        if (details.id) {\r\n            var wrapper = messenger._pendings[details.id];\r\n            if (wrapper && wrapper[details.type]) {\r\n                wrapper[details.type](data);\r\n                return;\r\n            }\r\n\r\n            if (details.type === 'cancel') {\r\n                var current = messenger._pendings[details.id];\r\n                if (current) {\r\n                    current.promise.cancel();\r\n                    delete messenger._pendings[details.id];\r\n                }\r\n            }\r\n            else if (details.type==='run' && name && messenger[name]) {\r\n                try {\r\n                    var p = null;\r\n                    if (asArgs) {\r\n                        p = WinJS.Promise.as(messenger[name].apply(messenger[name], data));\r\n                    } else {\r\n                        p = WinJS.Promise.as(messenger[name](data));\r\n                    }\r\n\r\n                   messenger._pendings[details.id] = { promise: p, details: details };\r\n\r\n                    p.then(function (arg) {\r\n                        messenger._send({ name: name, id: details.id, type: 'complete', sender: 'WinJSContrib.WinJSContrib.Messenger', data: arg });\r\n                    }, function (arg) {\r\n                        messenger._send({ name: name, id: details.id, type: 'error', sender: 'WinJSContrib.WinJSContrib.Messenger', data: arg });\r\n                    }, function (arg) {\r\n                        messenger._send({ name: name, id: details.id, type: 'progress', sender: 'WinJSContrib.WinJSContrib.Messenger', data: arg });\r\n                    }).then(function () {\r\n                        delete messenger._pendings[details.id];\r\n                    });\r\n                } catch (exception) {\r\n                    delete messenger._pendings[details.id];\r\n                    messenger._send({ name: name, id: details.id, type: 'error', sender: 'WinJSContrib.WinJSContrib.Messenger', data: { description: exception.description, message: exception.message, stack: exception.stack } });\r\n                }\r\n\r\n                return;\r\n            }\r\n            else {\r\n                messenger._send({ name: name, id: details.id, type: 'error', sender: 'WinJSContrib.WinJSContrib.Messenger', data: { message: 'callback function not found' } });\r\n            }\r\n        } else {\r\n            if (name && messenger[name]) {\r\n                messenger[name](data);\r\n                return;\r\n            }\r\n            messenger.dispatchEvent(name, data);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * release messenger and associated resources (if using webworker, worker is terminated\r\n     */\r\n    WinJSContrib.Messenger.prototype.dispose = function () {\r\n        var messenger = this;\r\n        if (messenger._receiver) {\r\n            if (messenger._receiver.terminate)\r\n                messenger._receiver.terminate();\r\n\r\n            messenger._receiver.removeEventListener('message', messenger._bindedProcessEvent);\r\n        }\r\n    };\r\n})();","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar __global = this;\r\nvar WinJSContrib;\r\n(function (WinJSContrib) {\r\n    var DataContainer;\r\n    (function (DataContainer) {\r\n        DataContainer.current = WinJSContrib.DataContainer.current || null;\r\n        var containerLogger = WinJSContrib.Logs.getLogger(\"WinJSContrib.DataContainer.WinRT\");\r\n        var WinRTFilesContainer = (function () {\r\n            function WinRTFilesContainer(key, options, parent) {\r\n                var container = this;\r\n                container.key = key;\r\n                container.options = options || {};\r\n                container.parent = parent;\r\n                container.folderPromise;\r\n                container.useDataCache = container.options.useDataCache || false;\r\n                container.dataCache = {};\r\n                container.childs = {};\r\n                if (!__global.Windows)\r\n                    throw \"WinRT is required !\";\r\n                if (!key) {\r\n                    container.folder = Windows.Storage.ApplicationData.current.localFolder;\r\n                    container.folderPromise = WinJS.Promise.wrap(container.folder);\r\n                }\r\n                else if (parent) {\r\n                    container.folderPromise = parent.folderPromise.then(function (parentfolder) {\r\n                        if (container.options.logger)\r\n                            container.options.logger.debug(\"open folder \" + key);\r\n                        return parentfolder.createFolderAsync(key, Windows.Storage.CreationCollisionOption.openIfExists);\r\n                    }).then(function (folder) {\r\n                        container.folder = folder;\r\n                        return folder;\r\n                    });\r\n                }\r\n            }\r\n            WinRTFilesContainer.makeCurrent = function (key, options) {\r\n                WinJSContrib.DataContainer.current = new WinRTFilesContainer(key, options);\r\n            };\r\n            WinRTFilesContainer.prototype.read = function (itemkey) {\r\n                var container = this;\r\n                if (container.useDataCache) {\r\n                    var data = container.dataCache[itemkey];\r\n                    if (data) {\r\n                        //clone object to avoid unintended object alteration\r\n                        var clone = JSON.parse(JSON.stringify(data));\r\n                        return WinJS.Promise.wrap(clone);\r\n                    }\r\n                }\r\n                return container.folderPromise.then(function (folder) {\r\n                    return readFileAsync(folder, itemkey, container.options.encrypted, Windows.Storage.CreationCollisionOption.openIfExists, 0, container.options.logger).then(function (data) {\r\n                        if (container.useDataCache) {\r\n                            container.dataCache[itemkey] = data;\r\n                        }\r\n                        return data;\r\n                    });\r\n                });\r\n            };\r\n            WinRTFilesContainer.prototype.save = function (itemkey, obj) {\r\n                var container = this;\r\n                if (container.useDataCache) {\r\n                    container.dataCache[itemkey] = obj;\r\n                }\r\n                return container.folderPromise.then(function (folder) {\r\n                    return writeFileAsync(folder, itemkey, obj, container.options.encrypted, Windows.Storage.CreationCollisionOption.replaceExisting, 0, container.options.logger);\r\n                });\r\n            };\r\n            WinRTFilesContainer.prototype.remove = function (itemkey) {\r\n                var container = this;\r\n                return container.folderPromise.then(function (folder) {\r\n                    return deleteItemIfExistsAsync(folder, itemkey, container.options.logger);\r\n                });\r\n            };\r\n            WinRTFilesContainer.prototype.listKeys = function () {\r\n                var container = this;\r\n                return container.folderPromise.then(function (folder) {\r\n                    return folder.getFilesAsync().then(function (files) {\r\n                        return files.map(function (f) {\r\n                            var key = f.path.substr(folder.path.length + 1);\r\n                            var ext = key.indexOf('.json');\r\n                            if (ext > 0) {\r\n                                key = key.substr(0, ext);\r\n                            }\r\n                            return key;\r\n                        });\r\n                    });\r\n                });\r\n            };\r\n            WinRTFilesContainer.prototype.list = function () {\r\n                var container = this;\r\n                return container.folderPromise.then(function (folder) {\r\n                    return folder.getFilesAsync();\r\n                });\r\n            };\r\n            WinRTFilesContainer.prototype.child = function (key) {\r\n                if (this.childs[key])\r\n                    return this.childs[key];\r\n                var res = new WinRTFilesContainer(key, this.options, this);\r\n                this.childs[key] = res;\r\n                return res;\r\n            };\r\n            WinRTFilesContainer.prototype.childWithTransaction = function (key, process) {\r\n                var current = this;\r\n                return this.child(key + \"-tmp\").folderPromise.then(function (winrtfolder) {\r\n                    return winrtfolder.deleteAsync().then(function () {\r\n                        return current.child(key + \"-tmp\");\r\n                    });\r\n                }).then(function (folder) {\r\n                    return process(folder).then(function (data) {\r\n                        return folder.folderPromise.then(function (winrtfolder) {\r\n                            return winrtfolder.renameAsync(key, Windows.Storage.NameCollisionOption.replaceExisting).then(function () {\r\n                                current.childs[key] = null;\r\n                                current.childs[key + \"-tmp\"] = null;\r\n                                return current.child(key);\r\n                            });\r\n                        });\r\n                    });\r\n                });\r\n            };\r\n            WinRTFilesContainer.prototype.deleteContainer = function () {\r\n                var container = this;\r\n                return container.folderPromise.then(function (folder) {\r\n                    return folder.deleteAsync();\r\n                });\r\n            };\r\n            WinRTFilesContainer.prototype.clearAllCache = function () {\r\n                var container = this;\r\n                container.clearCache();\r\n                container.clearDataCache();\r\n            };\r\n            WinRTFilesContainer.prototype.clearCache = function () {\r\n                var container = this;\r\n                container.childs = {};\r\n                for (var k in container.childs) {\r\n                    if (container.childs.hasOwnProperty(k)) {\r\n                        container.childs[k].clearCache();\r\n                    }\r\n                }\r\n            };\r\n            WinRTFilesContainer.prototype.clearDataCache = function () {\r\n                var container = this;\r\n                container.dataCache = {};\r\n                for (var k in container.childs) {\r\n                    if (container.childs.hasOwnProperty(k)) {\r\n                        container.childs[k].clearDataCache();\r\n                    }\r\n                }\r\n            };\r\n            return WinRTFilesContainer;\r\n        })();\r\n        DataContainer.WinRTFilesContainer = WinRTFilesContainer;\r\n        function toJSONFileName(fileName) {\r\n            return encodeURIComponent(fileName) + \".json\";\r\n        }\r\n        function deleteItemIfExistsAsync(folder, itemName, logger) {\r\n            return folder.getItemAsync(toJSONFileName(itemName)).then(function (item) {\r\n                return item;\r\n            }, function () {\r\n            }).then(function (item) {\r\n                if (item) {\r\n                    return item.deleteAsync().then(function () {\r\n                        if (logger)\r\n                            logger.debug(\"item deleted \" + item.path);\r\n                    }, function (err) {\r\n                        if (logger)\r\n                            logger.error(\"cannot delete item \" + item.path);\r\n                    });\r\n                }\r\n                else {\r\n                    return WinJS.Promise.wrap([]);\r\n                }\r\n            });\r\n        }\r\n        function getFileContentAsJSONAsync(file, encrypted) {\r\n            return Windows.Storage.FileIO.readBufferAsync(file).then(function (cypheredText) {\r\n                if (!encrypted)\r\n                    return cypheredText;\r\n                // On vérifie que le fichier n'est pas vide\r\n                if (cypheredText.length) {\r\n                    var provider = new Windows.Security.Cryptography.DataProtection.DataProtectionProvider();\r\n                    return provider.unprotectAsync(cypheredText);\r\n                }\r\n                else {\r\n                    return null;\r\n                }\r\n            }).then(function (unprotectedData) {\r\n                var obj = null;\r\n                if (unprotectedData !== null && unprotectedData !== undefined) {\r\n                    var rawText = Windows.Security.Cryptography.CryptographicBuffer.convertBinaryToString(Windows.Security.Cryptography.BinaryStringEncoding.utf8, unprotectedData);\r\n                    if (rawText) {\r\n                        try {\r\n                            obj = JSON.parse(rawText);\r\n                        }\r\n                        catch (exception) { }\r\n                    }\r\n                }\r\n                return obj;\r\n            });\r\n        }\r\n        function readFileAsync(folder, fileName, encrypted, creationCollisionOption, retry, logger) {\r\n            logger = logger || containerLogger;\r\n            return new WinJS.Promise(function (readComplete, readError) {\r\n                retry = retry || 0;\r\n                creationCollisionOption = creationCollisionOption || Windows.Storage.CreationCollisionOption.openIfExists;\r\n                var filename = toJSONFileName(fileName);\r\n                //folder.getFilesAsync(filename).then(function(file){})\r\n                folder.getFileAsync(filename).then(function (file) {\r\n                    return getFileContentAsJSONAsync(file, encrypted);\r\n                }).then(function (res) {\r\n                    logger.verbose(\"read \" + folder.path + '\\\\' + toJSONFileName(fileName));\r\n                    readComplete(res);\r\n                }, function (err) {\r\n                    if (err.number == -2147024894) {\r\n                        logger.debug(\"read empty \" + folder.path + '\\\\' + toJSONFileName(fileName));\r\n                        readComplete();\r\n                        return;\r\n                    }\r\n                    logger.warn(\"error reading \" + folder.path + '\\\\' + toJSONFileName(fileName));\r\n                    if (retry < 2) {\r\n                        setImmediate(function () {\r\n                            logger.info(\"retry reading \" + folder.path + '\\\\' + toJSONFileName(fileName));\r\n                            readFileAsync(folder, fileName, encrypted, creationCollisionOption, retry + 1, logger).then(readComplete, readError);\r\n                        });\r\n                    }\r\n                    else {\r\n                        readError({ message: 'fatal error reading ' + folder.path + '\\\\' + toJSONFileName(fileName), exception: err });\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        function writeFileAsync(folder, fileName, objectGraph, encrypt, creationCollisionOption, retry, logger) {\r\n            logger = logger || containerLogger;\r\n            return new WinJS.Promise(function (writeComplete, writeError) {\r\n                retry = retry || 0;\r\n                creationCollisionOption = creationCollisionOption || Windows.Storage.CreationCollisionOption.replaceExisting;\r\n                var bufferedText = Windows.Security.Cryptography.CryptographicBuffer.convertStringToBinary(JSON.stringify(objectGraph), Windows.Security.Cryptography.BinaryStringEncoding.utf8);\r\n                if (encrypt) {\r\n                    var provider = new Windows.Security.Cryptography.DataProtection.DataProtectionProvider(\"Local=user\");\r\n                }\r\n                function manageError(err) {\r\n                    logger.warn(\"error writing \" + folder.path + '\\\\' + toJSONFileName(fileName));\r\n                    if (retry < 2) {\r\n                        setImmediate(function () {\r\n                            logger.info(\"retry writing \" + folder.path + '\\\\' + toJSONFileName(fileName));\r\n                            writeFileAsync(folder, fileName, objectGraph, encrypt, creationCollisionOption, retry + 1, logger).then(writeComplete, writeError);\r\n                        });\r\n                    }\r\n                    else {\r\n                        writeError({ message: \"fatal error writing \" + folder.path + '\\\\' + toJSONFileName(fileName) + '\\r\\n', exception: err });\r\n                    }\r\n                }\r\n                // Ces deux opérations ne sont pas dépendantes l'une de l'autre et peuvent s'exécuter en parallèle\r\n                var filePromise = folder.createFileAsync(toJSONFileName(fileName), creationCollisionOption);\r\n                var protectionPromise = encrypt ? provider.protectAsync(bufferedText) : WinJS.Promise.wrap(bufferedText);\r\n                WinJS.Promise.join([filePromise, protectionPromise]).then(function (data) {\r\n                    var file = data[0];\r\n                    var protectedData = data[1];\r\n                    Windows.Storage.FileIO.writeBufferAsync(file, protectedData).then(function () {\r\n                        logger.verbose(\"file written \" + file.path);\r\n                        //setImmediate(function () {\r\n                        writeComplete(file);\r\n                        //});\r\n                    }, manageError);\r\n                }, manageError);\r\n            });\r\n        }\r\n    })(DataContainer = WinJSContrib.DataContainer || (WinJSContrib.DataContainer = {}));\r\n})(WinJSContrib || (WinJSContrib = {}));\r\n","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/**\r\n * @namespace\r\n */\r\nvar WinJSContrib = WinJSContrib || {};\r\n\r\n/**\r\n * @namespace\r\n */\r\nWinJSContrib.UI = WinJSContrib.UI || {};\r\n\r\n/**\r\n * @namespace\r\n */\r\nWinJSContrib.Utils = WinJSContrib.Utils || {};\r\n\r\n/// <reference path=\"winjscontrib.core.js\" />\r\nfunction HSL(hVal, sVal, lVal) {\r\n    var res = {\r\n        h: hVal,\r\n        s: sVal,\r\n        l: lVal,\r\n        addH: function (increment) {\r\n            this.h = this.h + increment;\r\n        },\r\n        addS: function (increment) {\r\n            this.s = this.s + increment;\r\n        },\r\n        addL: function (increment) {\r\n            this.l = this.l + increment;\r\n        },\r\n        toString: function () {\r\n            return 'hsl(' + this.h + ',' + this.s + '%, ' + this.l + '%)';\r\n        },\r\n        clone: function (hInc, sInc, lInc) {\r\n            var res = new HSL(this.h, this.s, this.l);\r\n            res.addH(hInc);\r\n            res.addS(sInc);\r\n            res.addL(lInc);\r\n            return res;\r\n        }\r\n    };\r\n\r\n    return res;\r\n}\r\n\r\n(function ($) {\r\n    $.fn.winControl = function () {\r\n        return this[0].winControl;\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.tap = function (callback, options) {\r\n        var opt = options || {};\r\n\r\n        return this.each(function () {\r\n        \tWinJSContrib.UI.tap(this, callback, options);\r\n        });\r\n    };\r\n\r\n    $.fn.untap = function (callback) {\r\n        return this.each(function () {\r\n            WinJSContrib.UI.untap(this);            \r\n        });\r\n    };\r\n\r\n    jQuery.fn.hatchShow = function () {\r\n        $('.hsjs').css('visibility', 'hidden').css('font-size', '').css('display', 'inner-block').css('white-space', 'pre').each(function () {\r\n            var t = $(this);\r\n            var parent = t.parent();\r\n            if (parent.hasClass('hatchshow_temp')) {\r\n                //t = parent;\r\n                parent = parent.parent();\r\n            }\r\n            else {\r\n                t.wrap(\"<span class='hatchshow_temp' style='display:block'>\");\r\n            }\r\n            var pw = parent.width();\r\n            var w = t.width();\r\n            while (t.width() < pw) {\r\n                var fsize = t.fontSize();\r\n                if (fsize > 200)\r\n                    break;\r\n                t.css('font-size', (fsize + 1) + \"px\"),\r\n                  function () {\r\n                      while (t.width() > pw) {\r\n                          var fsize = t.fontSize();\r\n                          if (fsize < 8)\r\n                              break;\r\n                          t.css('font-size', (fsize - .1) + \"px\")\r\n                      }\r\n                  };\r\n            };\r\n        }).hide().css('visibility', '').fadeIn();\r\n    };\r\n\r\n\r\n    jQuery.fn.fontSize = function () { return parseInt($(this).css('font-size').replace('px', '')); };\r\n\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.pressEnterDefaultTo = function (eltSelector, scope) {\r\n        return this.each(function () {\r\n            var $this = $(this);\r\n            $this.keypress(function (e) {\r\n                var key = e.which ? e.which : e.keyCode;\r\n                if (key == 13) {\r\n                    var $elt = scope ? $(eltSelector, scope) : $(eltSelector);\r\n                    jQuery(this).blur();\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    if ($elt[0].mcnTapTracking && $elt[0].mcnTapTracking.callback) {\r\n                        $elt[0].mcnTapTracking.callback($elt[0]);\r\n                    }\r\n                    $elt.focus().click();\r\n                }\r\n            });\r\n        });\r\n    };\r\n\r\n    $.fn.onPressEnter = function (callback) {\r\n        return this.each(function () {\r\n            var $this = $(this);\r\n            $this.keypress(function (e) {\r\n                var key = e.which ? e.which : e.keyCode;\r\n                if (key == 13) {\r\n                    jQuery(this).blur();\r\n                    e.preventDefault();\r\n                    if (callback) callback();\r\n                }\r\n            });\r\n        });\r\n    };\r\n\r\n    $.fn.throttleTextChanged = function (throttling, callback) {\r\n        return this.each(function () {\r\n            var elt = this;\r\n            var $this = $(this);\r\n            var lastval = elt.value;\r\n            $this.keydown(function (e) {\r\n                clearTimeout(elt.mcnTxtThrottling);\r\n                elt.mcnTxtThrottling = setTimeout(function () {\r\n                    lastval = elt.value;\r\n                    callback(elt, elt.value);\r\n                }, throttling);\r\n            });\r\n\r\n            $this.blur(function (e) {\r\n                if (lastval != elt.value) {\r\n                    lastval = elt.value;\r\n                    callback(elt, elt.value);\r\n                }\r\n            });\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.transitionProperties = function (properties, delay, targetValueCallback) {\r\n        var that = $(this);\r\n        //-ms-transition: all @transdur ease-in-out;\r\n        return new WinJS.Promise(function (complete, error) {\r\n            var val = properties + ' ' + delay + 'ms ease-out';\r\n            var res = that.css('transition', val);\r\n\r\n            if (targetValueCallback) {\r\n                targetValueCallback(res);\r\n            }\r\n            res.delay(delay + 10).promise().done(function () {\r\n                that.css('-ms-transition', '');\r\n                complete(res);\r\n            },\r\n            function () {\r\n                that.css('-ms-transition', '');\r\n                error(res);\r\n            });\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.toWinJSPromise = function () {\r\n        return new WinJS.Promise(function (complete, error) {\r\n            var res = this.promise().done(function () {\r\n                complete(res);\r\n            },\r\n            function () {\r\n                error(res);\r\n            });\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.renderWith = function (templateSelector, object) {\r\n        var template = $(templateSelector).get(0);\r\n        if (template)\r\n            template = template.winControl;\r\n\r\n        return this.each(function () {\r\n            var $this = $(this);\r\n            if (template) {\r\n                template.render(null, object).done(function (elt) {\r\n                    $this.append(elt.children[0]);\r\n                });\r\n            }\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.renderWithEach = function (templateSelector, objectArray, itemCallback) {\r\n        var template = $(templateSelector).get(0);\r\n        if (template)\r\n            template = template.winControl;\r\n\r\n        return this.each(function () {\r\n            var $this = $(this);\r\n            if (template) {\r\n                objectArray.forEach(function (element, index) {\r\n                    template.render(null, element).done(function (elt) {\r\n                        var templatedElt = elt.children[0];\r\n                        $this.append(templatedElt);\r\n                        if (itemCallback)\r\n                            itemCallback(element, templatedElt);\r\n                    });\r\n                });\r\n            }\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.scrollInView = function (offset, animate) {\r\n        var viewState = Windows.UI.ViewManagement.ApplicationView.value;\r\n        var horizontal = true;\r\n        if (viewState === Windows.UI.ViewManagement.ApplicationViewState.snapped || viewState === Windows.UI.ViewManagement.ApplicationViewState.fullScreenPortrait)\r\n            horizontal = false;\r\n\r\n        return this.each(function () {\r\n            var $this = $(this);\r\n            if (horizontal) {\r\n                this.offsetParent.scrollLeft = this.offsetLeft - (offset ? offset : 0);\r\n            } else {\r\n                this.offsetParent.scrollTop = this.offsetTop - (offset ? offset : 0);\r\n            }\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.scrollInParentView = function (offset, animate) {\r\n        var viewState = Windows.UI.ViewManagement.ApplicationView.value;\r\n        var horizontal = true;\r\n        if (viewState === Windows.UI.ViewManagement.ApplicationViewState.snapped || viewState === Windows.UI.ViewManagement.ApplicationViewState.fullScreenPortrait)\r\n            horizontal = false;\r\n\r\n        return this.each(function () {\r\n            if (horizontal) {\r\n                this.offsetParent.offsetParent.scrollLeft = this.offsetLeft - (offset ? offset : 0);\r\n            } else {\r\n                this.offsetParent.offsetParent.scrollTop = this.offsetTop - (offset ? offset : 0);\r\n            }\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.loadedPromises = function (callback) {\r\n        var res = [];\r\n        this.each(function () {\r\n            var $this = $(this);\r\n            var that = this;\r\n            var promise = new WinJS.Promise(function (complete, error) {\r\n                function onerror(e) {\r\n                    that.removeEventListener('error', onerror);\r\n                    that.removeEventListener('load', onloaded);\r\n                    error({ message: 'element not loaded', elt: e.currentTarget });\r\n                }\r\n\r\n                function onloaded() {\r\n                    that.removeEventListener('error', onerror);\r\n                    that.removeEventListener('load', onloaded);\r\n                    complete(that);\r\n                    if (callback)\r\n                        callback(that);\r\n                }\r\n\r\n                that.addEventListener('error', onerror);\r\n                that.addEventListener('load', onloaded, false);\r\n\r\n                if (that.naturalWidth > 0) {\r\n                    onloaded();\r\n                }\r\n            });\r\n            res.push(promise);\r\n        });\r\n\r\n        return res;\r\n    };\r\n\r\n    $.fn.whenLoaded = function (callback) {\r\n        var promises = this.loadedPromises();\r\n        if (callback) {\r\n            WinJS.Promise.join(promises).done(function (res) {\r\n                callback(res);\r\n            });\r\n        } else {\r\n            return WinJS.Promise.join(promises);\r\n        }\r\n    };\r\n\r\n    $.fn.afterTransition = function (callback, timeout) {\r\n        var promises = [];\r\n        var completed = false;\r\n\r\n        this.each(function () {\r\n            var currentElement = this;\r\n\r\n            var prom = new WinJS.Promise(function (complete, error) {\r\n                var onaftertransition = function (event) {\r\n                    if (event.srcElement === currentElement) {\r\n                        close();\r\n                    }\r\n                };\r\n                var close = function () {\r\n                    clearTimeout(timeOutRef);\r\n                    currentElement.removeEventListener(\"transitionend\", onaftertransition, false);\r\n                    complete();\r\n                }\r\n\r\n                currentElement.addEventListener(\"transitionend\", onaftertransition, false);\r\n                timeOutRef = setTimeout(close, timeout || 1000);\r\n            });\r\n            promises.push(prom);\r\n        });\r\n\r\n        var success = null, error = null;\r\n        var resultPromise = new WinJS.Promise(function (c, e) {\r\n            success = c;\r\n            error = e;\r\n        });\r\n\r\n        var p = WinJS.Promise.join(promises);\r\n        p.done(function () {\r\n            if (!completed) {\r\n                completed = true;\r\n                if (callback) {\r\n                    callback();\r\n                }\r\n                success();\r\n                return;\r\n            }\r\n            p.cancel();\r\n            error();\r\n        }, error);\r\n\r\n        return resultPromise;\r\n    };\r\n\r\n    $.fn.afterAnimation = function (callback) {\r\n        var promises = [];\r\n        this.each(function () {\r\n            var ctrl = this;\r\n            var prom = new WinJS.Promise(function (complete, error) {\r\n                function ontransition(event) {\r\n                    if (event.srcElement === currentElement) {\r\n                        ctrl.removeEventListener(\"animationend\", ontransition);\r\n                        complete();\r\n                    }\r\n                }\r\n\r\n                ctrl.addEventListener(\"animationend\", ontransition);\r\n            });\r\n            promises.push(prom);\r\n        });\r\n\r\n        WinJS.Promise.join(promises).done(function () {\r\n            if (callback)\r\n                callback();\r\n        });\r\n\r\n        return this;\r\n    };\r\n\r\n    $.fn.classBasedAnimation = function (classname) {\r\n        var promises = [];\r\n        return this.each(function () {\r\n            var ctrl = this;\r\n            $(ctrl).afterAnimation(function () {\r\n                $(ctrl).removeClass(classname);\r\n            });\r\n\r\n            $(ctrl).addClass(classname);\r\n        });\r\n    };\r\n})(jQuery);","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n(function () {\r\n    'use strict';\r\n    \r\n    var DataFormState = WinJS.Class.mix(WinJS.Class.define(function () {\r\n        this._initObservable();\r\n    }, {\r\n    }), WinJS.Binding.mixin, WinJS.Binding.expandProperties({ isValid: false, updated: false }));\r\n\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        DataForm: WinJS.Class.mix(WinJS.Class.define(\r\n            /**\r\n             * @class WinJSContrib.UI.DataForm\r\n             * @classdesc\r\n             * This control enhance data form management by adding validation mecanism and form state helpers. It must be placed on a form element.\r\n             * Input fields must use {@link WinJSContrib.UI.DataFormBinding} to bind object properties to input\r\n             * @param {HTMLElement} element DOM element containing the control\r\n             * @param {Object} options\r\n             */\r\n            function ctor(element, options) {\r\n                var ctrl = this;\r\n                this.element = element || document.createElement('FORM');\r\n                //$(this.element).submit(function (e) {\r\n                //    e.preventDefault()\r\n                //})\r\n                options = options || {};\r\n                this.groups = options.groups;\r\n                this.messages = options.messages;\r\n                this.rules = options.rules;\r\n                /**\r\n                 * state of the form\r\n                 * @field\r\n                 * @type {Object}\r\n                 */\r\n                this.state = new DataFormState();\r\n                this.state.item = {};\r\n                this.allowTooltip = options.allowTooltip || true;\r\n                this.workOnCopy = options.workOnCopy || true;\r\n                this.tooltipDelay = options.tooltipDelay || 4000;\r\n                this.tooltipPosition = options.tooltipPosition || 'right';\r\n                this.tooltipTheme = options.tooltipTheme || 'tooltipster-error';\r\n                this.initValidator();\r\n                this.element.winControl = this;\r\n                this.element.mcnDataForm = true;\r\n                this.element.classList.add('win-disposable');\r\n                if (WinJSContrib.CrossPlatform && WinJSContrib.CrossPlatform.crossPlatformClass)\r\n                    WinJSContrib.CrossPlatform.crossPlatformClass(this.element);\r\n                WinJS.UI.setOptions(this, options);\r\n                WinJS.UI.processAll(this.element).done(function () {\r\n                    WinJS.Binding.processAll(ctrl.element, ctrl.state);\r\n                });\r\n\r\n                $('.mcn-dataform-cancel', this.element).click(function (arg) {\r\n                    arg.preventDefault();\r\n                    ctrl.cancel();\r\n                });\r\n            },\r\n            /**\r\n             * @lends WinJSContrib.UI.DataForm.prototype\r\n             */\r\n        {\r\n            /**\r\n             * @member {Array}\r\n             */\r\n            messages: {\r\n                get: function () {\r\n                    return this._messages;\r\n                },\r\n                set: function (val) {\r\n                    this._messages = val;\r\n                }\r\n            },\r\n            /**\r\n             * @member {Array}\r\n             */\r\n            rules: {\r\n                get: function () {\r\n                    return this._rules;\r\n                },\r\n                set: function (val) {\r\n                    this._rules = val;\r\n                }\r\n            },\r\n            /**\r\n             * @member {Array}\r\n             */\r\n            groups: {\r\n                get: function () {\r\n                    return this._groups;\r\n                },\r\n                set: function (val) {\r\n                    this._groups = val;\r\n                }\r\n            },\r\n            /**\r\n             * object bound to data form\r\n             * @member {Object}\r\n             */\r\n            item: {\r\n                get: function () {\r\n                    return this.state.item;\r\n                },\r\n                set: function (val) {\r\n                    var dataform = this;\r\n                    if (dataform.workOnCopy) {\r\n                        dataform.state.item = $.extend(true, {}, val);\r\n                        dataform.state.refItem = val;\r\n                    }\r\n                    else {\r\n                        dataform.state.item = val;\r\n                    }\r\n\r\n                    \r\n                    dataform.validator.resetForm();\r\n\r\n                    dataform.autobindFields();\r\n                    WinJS.Binding.processAll(this.element, this.state).done(function () {\r\n                        var tooltips = dataform.allowTooltip;\r\n                        dataform.allowTooltip = false;\r\n                        dataform.validator.form();\r\n                        dataform.allowTooltip = tooltips;\r\n                        dataform.checkState();\r\n                        dataform.initValidator();\r\n                        dataform.state.updated = false;\r\n                    });\r\n                    dataform.dispatchEvent(\"itemchanged\", { dataform: this, item: val });\r\n                }\r\n            },\r\n            /**\r\n             * indicate if form has updates\r\n             * @member {boolean}\r\n             */\r\n            updated: {\r\n                get: function () {\r\n                    return this.state.updated;\r\n                },\r\n                set: function (val) {\r\n                    this.state.updated = val;\r\n                    this.dispatchEvent(\"haschanges\");\r\n                }\r\n            },\r\n\r\n            autobindFields: function () {\r\n                var ctrl = this;\r\n                $('[data-formfield]', ctrl.element).each(function () {\r\n                    var fieldElt = this;\r\n                    var srcProperty = $(fieldElt).data('formfield');\r\n                    var destFieldType = 'value';\r\n                    if (fieldElt.type == 'checkbox') {\r\n                        destFieldType = 'checked';\r\n                    }\r\n                    WinJSContrib.UI.DataFormBinding(ctrl.state.item, srcProperty.split('.'), fieldElt, [destFieldType]);\r\n                });\r\n            },\r\n\r\n            /**\r\n             * check form state\r\n             */\r\n            checkState: function () {\r\n                var nbInvalids = this.validator.numberOfInvalids();\r\n                this.state.isValid = nbInvalids == 0;\r\n            },\r\n\r\n            /**\r\n             * cancel updates on form item\r\n             */\r\n            cancel: function () {\r\n                var dataform = this;\r\n                if (dataform.workOnCopy) {\r\n                    dataform.item = $.extend(true, {}, dataform.state.refItem);\r\n                }\r\n            },\r\n\r\n            /**\r\n             * apply changes to source object (relevant only if using workOnCopy)\r\n             */\r\n            save: function () {\r\n                var dataform = this;\r\n                if (dataform.workOnCopy) {\r\n                    dataform.state.updated = false;\r\n                    dataform.state.refItem = $.extend(true, {}, dataform.state.item);\r\n                }\r\n            },\r\n\r\n            initValidator: function () {\r\n                var dataform = this;\r\n\r\n                this.validator = $(this.element).validate({\r\n                    groups: this.groups,\r\n                    rules: this.rules,\r\n                    submitHandler: function (form) {\r\n                        dataform.dispatchEvent('submitted', { item: dataform.state.item });\r\n                    },\r\n\r\n                    invalidHandler: function (form, validator) {\r\n                        dataform.checkState();\r\n                    },\r\n\r\n                    errorPlacement: function (error, element) {\r\n                        dataform.checkState();\r\n                        if (!dataform.allowTooltip)\r\n                            return;\r\n\r\n                        var $e = $(element);\r\n                        $e.tooltipster({\r\n                            trigger: 'custom',\r\n                            onlyOne: false,\r\n                            position: dataform.tooltipPosition,\r\n                            theme: dataform.tooltipTheme\r\n                        });\r\n\r\n                        var lastError = $e.data('lastError'),\r\n                            newError = $(error).text();\r\n\r\n                        $e.data('lastError', newError);\r\n\r\n                        if (newError !== '' && newError !== lastError) {\r\n                            $e.tooltipster('content', newError);\r\n                            $e.tooltipster('show');\r\n                            $e[0].tooltipsterValidationTimeout = setTimeout(function () {\r\n                                $e[0].tooltipsterValidationTimeout = null;\r\n                                if ($e.hasClass('tooltipster'))\r\n                                    $e.tooltipster('hide');\r\n                            }, dataform.tooltipDelay);\r\n                        }\r\n                    },\r\n\r\n                    success: function (label, element) {\r\n                        dataform.checkState();\r\n                        var $e = $(element);\r\n                        if ($e[0].tooltipsterValidationTimeout) {\r\n                            clearTimeout($e[0].tooltipsterValidationTimeout);\r\n                            $e[0].tooltipsterValidationTimeout = null;\r\n                        }\r\n\r\n                        if ($e.hasClass('tooltipstered')) {\r\n                            $e.tooltipster('hide');\r\n                        }\r\n                    }\r\n\r\n                });\r\n            },\r\n\r\n            /**\r\n             * validate form\r\n             */\r\n            validate: function () {\r\n                var res = this.validator.form();\r\n                return res;\r\n            },\r\n\r\n            /**\r\n             * release form\r\n             */\r\n            dispose: function () {\r\n                WinJS.Utilities.disposeSubTree(this.element);\r\n            }\r\n        },\r\n        /**\r\n         * @lends WinJSContrib.UI.DataForm\r\n         */\r\n        {\r\n            /**\r\n             * @namespace WinJSContrib.UI.DataForm.defaultBindingOptions\r\n             */\r\n            DefaultBindingOptions: {\r\n                trimText: true,\r\n                convertEmptyToNull: true,\r\n            },\r\n\r\n            /**\r\n             * @namespace WinJSContrib.UI.DataForm.Converters\r\n             */\r\n            Converters: {\r\n                /**\r\n                 * @member\r\n                 */\r\n                \"none\": {\r\n                    fromObject: function (val, options) {\r\n                        return val.toString();\r\n                    },\r\n                    fromInput: function (val, options) {\r\n                        return val;\r\n                    }\r\n                },\r\n                /**\r\n                 * @member\r\n                 */\r\n                \"text\": {\r\n                    fromObject: function (val, options) {\r\n                        if (typeof val === \"undefined\" || val === null)\r\n                            return '';\r\n\r\n                        var res = val.toString();\r\n                        \r\n                        return res;\r\n                    },\r\n                    fromInput: function (val, options) {\r\n                        var res = val;\r\n                        if (res && options && options.trimText) {\r\n                            res = res.trim();\r\n                        }\r\n                        if (options && options.convertEmptyToNull) {\r\n                            res = (res === '') ? null : res;\r\n                        }\r\n                        return res;\r\n                    }\r\n                },\r\n                /**\r\n                 * @member\r\n                 */\r\n                \"number\": {\r\n                    fromObject: function (val, options) {\r\n                        if (typeof val !== \"number\")\r\n                            return '';\r\n\r\n                        return val.toString();\r\n                    },\r\n                    fromInput: function (val, options) {\r\n                        if (typeof val !== \"undefined\" && val !== null)\r\n                            return parseFloat(val);\r\n\r\n                        return null;\r\n                    }\r\n                },\r\n                /**\r\n                 * @member\r\n                 */\r\n                \"boolean\": {\r\n                    fromObject: function (val, options) {\r\n                        if (typeof val === \"undefined\" || val === null)\r\n                            return '';\r\n\r\n                        return val.toString();\r\n                    },\r\n                    fromInput: function (val, options) {\r\n                        if (val === 'true')\r\n                            return true;\r\n                        if (val === 'false')\r\n                            return false;\r\n\r\n                        return null;\r\n                    }\r\n                },\r\n                /**\r\n                 * @member\r\n                 */\r\n                \"object\": {\r\n                    fromObject: function (val, options) {\r\n                        return val;\r\n                    },\r\n                    fromInput: function (val, options) {\r\n                        return val;\r\n                    }\r\n                },\r\n                /**\r\n                 * @member\r\n                 */\r\n                \"stringifiedObject\": {\r\n                    fromObject: function (val, options) {\r\n                        return JSON.stringify(val);\r\n                    },\r\n                    fromInput: function (val, options) {\r\n                        return JSON.parse(val);\r\n                    }\r\n                }\r\n            }\r\n        }),\r\n        WinJS.UI.DOMEventMixin,\r\n        WinJS.Utilities.createEventProperties(\"itemchanged\", \"haschanges\", \"submitted\")),\r\n\r\n        parentDataForm: function (element) {\r\n            var current = element.parentNode;\r\n\r\n            while (current) {\r\n                if (current.mcnDataForm) {\r\n                    return current.winControl;\r\n                }\r\n                current = current.parentNode;\r\n            }\r\n        },\r\n\r\n        \r\n\r\n        /**\r\n         * bi-directional binding for working with input fields and custom input controls. This binding expect a {@link WinJSContrib.UI.DataForm} to be found on the parent form\r\n         * @function WinJSContrib.UI.DataFormBinding\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        DataFormBinding: WinJS.Binding.initializer(function (source, sourceProperty, dest, destProperty) {\r\n            var dataform = WinJSContrib.UI.parentDataForm(dest);\r\n            var options = WinJSContrib.UI.DataForm.DefaultBindingOptions;\r\n            var optionsText = dest.getAttribute(\"data-formfield-options\");\r\n            if (optionsText) {\r\n                options = WinJS.UI.optionsParser(optionsText, window);\r\n            }\r\n            var inputType = \"\";\r\n            var inputOption = dest.getAttribute(\"data-forminput\");\r\n            if (inputOption) {\r\n                inputType = inputOption;\r\n            }\r\n\r\n            var fieldUpdated = false;\r\n            dest.classList.add('mcn-dataform-field');\r\n\r\n            //si le noeud n'est pas un champ input html, on renseigne la propriété form, sinon plantage de jquery validate\r\n            if (!dest.form) {\r\n                dest.form = dataform.element;\r\n            }\r\n\r\n            var inputType = 'text';\r\n            if ($(dest).data('formfield-type')) {\r\n                inputType = $(dest).data('formfield-type');\r\n            }\r\n            else if (dest.nodeName !== \"TEXTAREA\" && typeof dest.type !== \"undefined\") {\r\n                inputType = dest.type;\r\n            }\r\n            var converter = WinJSContrib.UI.DataForm.Converters[inputType] || WinJSContrib.UI.DataForm.Converters['text'];\r\n\r\n            function updateInputFromObject() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (typeof data === \"undefined\")\r\n                    data = null;\r\n\r\n                data = converter.fromObject(data, options);\r\n\r\n                WinJSContrib.Utils.writeProperty(dest, destProperty, data);\r\n            }\r\n\r\n            function updateObjectFromInput() {\r\n                dataform.checkState();\r\n                dataform.updated = true;\r\n                fieldUpdated = true;\r\n\r\n                if (!dest.id || dataform.validator.element(dest)) {\r\n                    var val = WinJSContrib.Utils.getProperty(dest, destProperty).propValue;\r\n                    if (val !== undefined)\r\n                        val = converter.fromInput(val, options);\r\n\r\n                    WinJSContrib.Utils.writeProperty(source, sourceProperty, val);\r\n                }\r\n            }\r\n\r\n            function validateObjectOnBlur() {\r\n                if (fieldUpdated)\r\n                    dataform.validator.element(dest);\r\n            }\r\n\r\n            \r\n            if (inputType) {\r\n                dest.addEventListener(inputType, updateObjectFromInput);\r\n            }\r\n\r\n            dest.addEventListener(\"change\", updateObjectFromInput);\r\n            if (dest.id) {\r\n                dest.addEventListener(\"blur\", validateObjectOnBlur);\r\n            }\r\n            if (dest.eventAdded && dest.winControl) {\r\n                dest.winControl.dispose();\r\n            }\r\n            if (!dest.winControl) {\r\n                dest.eventAdded = true;\r\n                dest.classList.add('win-disposable');\r\n                dest.winControl = {\r\n                    dispose: function () {\r\n                        dest.removeEventListener(\"change\", updateObjectFromInput);\r\n                        dest.removeEventListener(\"blur\", validateObjectOnBlur);\r\n                        if (inputType) {\r\n                            dest.removeEventListener(inputType, updateObjectFromInput);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            var bindingDesc = {\r\n            };\r\n\r\n            bindingDesc[sourceProperty] = updateInputFromObject;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        })\r\n    });\r\n})();\r\n","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/**\n * @namespace WinJSContrib.UI.Animation\n */\n/**\n */\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var UI;\n    (function (UI) {\n        var Animation;\n        (function (Animation) {\n            /**\n             * @enum\n             * @memberof WinJSContrib.UI.Animation\n             */\n            Animation.Easings = {\n                /**\n                 * Quad ease in\n                 */\n                easeInQuad: 'cubic-bezier(0.550, 0.085, 0.680, 0.530)',\n                /**\n                 * Cubic ease in\n                 */\n                easeInCubic: 'cubic-bezier(0.550, 0.055, 0.675, 0.190)',\n                /**\n                 * Quart ease in\n                 */\n                easeInQuart: 'cubic-bezier(0.895, 0.030, 0.685, 0.220)',\n                /**\n                 * Quint ease in\n                 */\n                easeInQuint: 'cubic-bezier(0.755, 0.050, 0.855, 0.060)',\n                /**\n                 * Sine ease in\n                 */\n                easeInSine: 'cubic-bezier(0.470, 0.000, 0.745, 0.715)',\n                /**\n                 * Expo ease in\n                 */\n                easeInExpo: 'cubic-bezier(0.950, 0.050, 0.795, 0.035)',\n                /**\n                 * Circ ease in\n                 */\n                easeInCirc: 'cubic-bezier(0.600, 0.040, 0.980, 0.335)',\n                /**\n                 * Back ease in\n                 */\n                easeInBack: 'cubic-bezier(0.600, -0.280, 0.735, 0.045)',\n                /**\n                 * Quad ease out\n                 */\n                easeOutQuad: 'cubic-bezier(0.250, 0.460, 0.450, 0.940)',\n                /**\n                 * Cubic ease out\n                 */\n                easeOutCubic: 'cubic-bezier(0.215, 0.610, 0.355, 1.000)',\n                /**\n                 * Quart ease out\n                 */\n                easeOutQuart: 'cubic-bezier(0.165, 0.840, 0.440, 1.000)',\n                /**\n                 * Quint ease out\n                 */\n                easeOutQuint: 'cubic-bezier(0.230, 1.000, 0.320, 1.000)',\n                /**\n                 * Sine ease out\n                 */\n                easeOutSine: 'cubic-bezier(0.390, 0.575, 0.565, 1.000)',\n                /**\n                 * Expo ease out\n                 */\n                easeOutExpo: 'cubic-bezier(0.190, 1.000, 0.220, 1.000)',\n                /**\n                 * Circ ease out\n                 */\n                easeOutCirc: 'cubic-bezier(0.075, 0.820, 0.165, 1.000)',\n                /**\n                 * Back ease out\n                 */\n                easeOutBack: 'cubic-bezier(0.175, 0.885, 0.320, 1.275)',\n                /**\n                 * Quad ease in-out\n                 */\n                easeInOutQuad: 'cubic-bezier(0.455, 0.030, 0.515, 0.955)',\n                /**\n                 * Cubic ease in-out\n                 */\n                easeInOutCubic: 'cubic-bezier(0.645, 0.045, 0.355, 1.000)',\n                /**\n                 * Quart ease in-out\n                 */\n                easeInOutQuart: 'cubic-bezier(0.770, 0.000, 0.175, 1.000)',\n                /**\n                 * Quint ease in-out\n                 */\n                easeInOutQuint: 'cubic-bezier(0.860, 0.000, 0.070, 1.000)',\n                /**\n                 * Sine ease in-out\n                 */\n                easeInOutSine: 'cubic-bezier(0.445, 0.050, 0.550, 0.950)',\n                /**\n                 * Expo ease in-out\n                 */\n                easeInOutExpo: 'cubic-bezier(1.000, 0.000, 0.000, 1.000)',\n                /**\n                 * Circ ease in-out\n                 */\n                easeInOutCirc: 'cubic-bezier(0.785, 0.135, 0.150, 0.860)',\n                /**\n                 * Back ease in-out\n                 */\n                easeInOutBack: 'cubic-bezier(0.680, -0.550, 0.265, 1.550)',\n            };\n            var equivalents = WinJS.Utilities._browserStyleEquivalents || { transform: { cssName: 'transform' } };\n            function getOpt(options) {\n                if (options && typeof options == 'number')\n                    return { duration: options };\n                else\n                    return options || {};\n            }\n            /**\n             * configurable fade out\n             * @function WinJSContrib.UI.Animation.fadeOut\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function fadeOut(elements, options) {\n                options = getOpt(options);\n                var args = {\n                    property: \"opacity\",\n                    delay: staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333),\n                    duration: options.duration || 167,\n                    timing: options.easing || \"ease-in-out\",\n                    to: 0\n                };\n                return WinJS.UI.executeTransition(elements, args);\n            }\n            Animation.fadeOut = fadeOut;\n            /**\n             * configurable fade in\n             * @function WinJSContrib.UI.Animation.fadeIn\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function fadeIn(elements, options) {\n                options = getOpt(options);\n                return WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333),\n                    duration: options.duration || 167,\n                    timing: options.easing || \"ease-in-out\",\n                    to: 1\n                });\n            }\n            Animation.fadeIn = fadeIn;\n            function staggerDelay(initialDelay, extraDelay, delayFactor, delayCap) {\n                return function (i) {\n                    var ret = initialDelay;\n                    for (var j = 0; j < i; j++) {\n                        extraDelay *= delayFactor;\n                        ret += extraDelay;\n                    }\n                    if (delayCap) {\n                        ret = Math.min(ret, delayCap);\n                    }\n                    return ret;\n                };\n            }\n            /**\n             * configurable page exit effect\n             * @function WinJSContrib.UI.Animation.pageExit\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function pageExit(elements, options) {\n                options = getOpt(options);\n                var args = {\n                    property: \"opacity\",\n                    delay: staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333),\n                    duration: options.duration || 160,\n                    timing: options.easing || \"ease-in\",\n                    to: 0\n                };\n                return WinJS.UI.executeTransition(elements, args);\n            }\n            Animation.pageExit = pageExit;\n            /**\n             * configurable page enter effect\n             * @function WinJSContrib.UI.Animation.enterPage\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function enterPage(elements, options) {\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 120, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var animationParams = {\n                    keyframe: 'WinJSContrib-EnterPage',\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: options.duration || 600,\n                    timing: options.easing || \"cubic-bezier(0.1, 0.9, 0.2, 1)\"\n                };\n                var promise1 = WinJS.UI.executeAnimation(elements, animationParams);\n                var args = {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: options.duration || 600,\n                    timing: options.easing || \"ease-out\",\n                    to: 1\n                };\n                var promise2 = WinJS.UI.executeTransition(elements, args);\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.enterPage = enterPage;\n            function slideAnim(element, keyframeName, isIn, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var duration = options.duration || isIn ? 250 : 150;\n                var delay = options.delay || 5;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var easing = WinJSContrib.UI.Animation.Easings.easeInQuad;\n                if (isIn)\n                    easing = WinJSContrib.UI.Animation.Easings.easeOutQuad;\n                var animationParams = {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: duration,\n                    timing: options.easing || easing\n                };\n                var promise1 = WinJS.UI.executeAnimation(element, animationParams);\n                var transitionParams = {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: duration / 2,\n                    timing: easing,\n                    from: 0,\n                    to: 1\n                };\n                if (!isIn) {\n                    transitionParams.from = 1;\n                    transitionParams.to = 0;\n                    if (transitionParams.delay < duration / 2)\n                        transitionParams.delay = duration / 2;\n                }\n                var promise2 = WinJS.UI.executeTransition(element, transitionParams);\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromBottom\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromBottom(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromBottom', true, options);\n            }\n            Animation.slideFromBottom = slideFromBottom;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromTop\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromTop(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromTop', true, options);\n            }\n            Animation.slideFromTop = slideFromTop;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromLeft\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromLeft(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromLeft', true, options);\n            }\n            Animation.slideFromLeft = slideFromLeft;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromRight\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromRight(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromRight', true, options);\n            }\n            Animation.slideFromRight = slideFromRight;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToBottom\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToBottom(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToBottom', false, options);\n            }\n            Animation.slideToBottom = slideToBottom;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToTop\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToTop(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToTop', false, options);\n            }\n            Animation.slideToTop = slideToTop;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToLeft\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToLeft(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToLeft', false, options);\n            }\n            Animation.slideToLeft = slideToLeft;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToRight\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToRight(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToRight', false, options);\n            }\n            Animation.slideToRight = slideToRight;\n            /**\n             * animation for tab exit\n             * @function WinJSContrib.UI.Animation.tabExitPage\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function tabExitPage(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var animationParams = {\n                    keyframe: \"WinJSContrib-tabExitPage\",\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: options.duration || 160,\n                    timing: \"ease-in\"\n                };\n                var promise1 = WinJS.UI.executeAnimation(elements, animationParams);\n                var transitionParams = {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: options.duration || 160,\n                    timing: \"linear\",\n                    from: 1,\n                    to: 0\n                };\n                var promise2 = WinJS.UI.executeTransition(elements, transitionParams);\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.tabExitPage = tabExitPage;\n            /**\n             * animation for tab exit\n             * @function WinJSContrib.UI.Animation.tabEnterPage\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function tabEnterPage(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: \"WinJSContrib-tabEnterPage\",\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: options.duration || 250,\n                    timing: WinJSContrib.UI.Animation.Easings.easeOutQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: options.duration || 250,\n                    timing: \"ease-out\",\n                    from: 0,\n                    to: 1\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.tabEnterPage = tabEnterPage;\n            /**\n             * exit and grow animation\n             * @function WinJSContrib.UI.Animation.exitGrow\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function exitGrow(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-exitGrow\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var dur = options.duration || 250;\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeInQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeInQuint,\n                    from: 1,\n                    to: 0\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.exitGrow = exitGrow;\n            /**\n             * exit and shrink animation\n             * @function WinJSContrib.UI.Animation.exitShrink\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function exitShrink(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-exitShrink\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var dur = options.duration || 250;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 10, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeInQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: WinJSContrib.UI.Animation.Easings.easeInQuint,\n                    from: 1,\n                    to: 0\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.exitShrink = exitShrink;\n            /**\n             * shrink and fall animation\n             * @function WinJSContrib.UI.Animation.shrinkAndFall\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function shrinkAndFall(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var dur = options.duration || 250;\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: \"WinJSContrib-shrinkAndFall\",\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || \"ease-in\"\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: \"ease-in\",\n                    from: 1,\n                    to: 0\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.shrinkAndFall = shrinkAndFall;\n            /**\n             * enter and shrink animation\n             * @function WinJSContrib.UI.Animation.enterShrink\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function enterShrink(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-enterShrink\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var dur = options.duration || 350;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeOutQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeOutQuint,\n                    from: 0,\n                    to: 1\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.enterShrink = enterShrink;\n            /**\n             * enter and shrink animation\n             * @function WinJSContrib.UI.Animation.enterGrow\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function enterGrow(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-enterGrow\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var dur = options.duration || 350;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeOutQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: WinJSContrib.UI.Animation.Easings.easeOutQuint,\n                    from: 0,\n                    to: 1\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.enterGrow = enterGrow;\n        })(Animation = UI.Animation || (UI.Animation = {}));\n    })(UI = WinJSContrib.UI || (WinJSContrib.UI = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\n//# sourceMappingURL=../../Sources/Common/winjscontrib.ui.animation.js.map","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n//this control requires snap.svg\r\n\r\n(function () {\r\n    'use strict';\r\n    var elasticbuttonkinds = {\r\n        rectangle: {\r\n            morphpath: 'M286,113c0,0-68.8,6-136,6c-78.2,0-137-6-137-6S6,97.198,6,62.5C6,33.999,13,12,13,12s59-7,137-7c85,0,136,7,136,7s8,17.598,8,52C294,96.398,286,113,286,113z',\r\n            svg: '<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 300 125\" preserveAspectRatio=\"none\"><path d=\"M286.5,113c0,0-104,0-136.5,0c-35.75,0-136.5,0-136.5,0s0-39.417,0-52.5c0-12.167,0-48.5,0-48.5s101.833,0,136.5,0c33.583,0,136.5,0,136.5,0s0,35.917,0,48.5C286.5,73.167,286.5,113,286.5,113z\"/></svg>'\r\n        },\r\n        roundedrectangle: {\r\n            morphpath: 'M287,95.25c0,11.046-5.954,19.75-17,19.75c0,0-90-4-120-4s-120,4-120,4c-11.046,0-17.25-9.5-17.25-20.5c0-8.715,0.25-10.75,0.25-34s-0.681-26.257-1-33.75C11.5,15,18.954,10,30,10c0,0,90,3,120,3s120-3,120-3c11.046,0,17.75,6.5,17,20c-0.402,7.239,0,6.75,0,30.5C287,83.5,287,84.75,287,95.25z',\r\n            svg: '<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 300 125\" preserveAspectRatio=\"none\"><path d=\"M290,95c0,11.046-8.954,20-20,20c0,0-90,0-120,0s-120,0-120,0c-11.046,0-20-9-20-20c0-8.715,0-25.875,0-34.5c0-7.625,0-22.774,0-30.5c0-11.625,8.954-20,20-20c0,0,90,0,120,0s120,0,120,0c11.046,0,20,8.954,20,20c0,7.25,0,22.875,0,30.5C290,69.125,290,84.5,290,95z\"/></svg>'\r\n        },\r\n        round: {\r\n            morphpath: 'M251,150c0,93.5-29.203,143-101,143S49,243.5,49,150C49,52.5,78.203,7,150,7S251,51.5,251,150z',\r\n            svg: '<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 300 300\" preserveAspectRatio=\"none\"><path d=\"M281,150c0,71.797-59.203,131-131,131S19,221.797,19,150S78.203,19,150,19S281,78.203,281,150z\"/></svg>'\r\n        },\r\n    };\r\n\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        ElasticButton: WinJS.Class.mix(WinJS.Class.define(function ctor(element, options) {\r\n            this.element = element || document.createElement('DIV');\r\n            options = options || {};\r\n            this.element.winControl = this;\r\n            this.behavior = {\r\n                speed: { reset: 800, active: 150 },\r\n                easing: { reset: mina.elastic, active: mina.easein }\r\n            };\r\n\r\n            this.element.classList.add('mcn-elasticbutton');\r\n            this.element.classList.add('win-disposable');\r\n            WinJS.UI.setOptions(this, options);\r\n        }, {\r\n            kind: {\r\n                get: function () {\r\n                    return this._kind;\r\n                },\r\n                set: function (val) {\r\n                    this._kind = val;\r\n                    this.render();\r\n                }\r\n            },\r\n\r\n            render: function () {\r\n                var ctrl = this;\r\n                this.element.classList.add('mcn-elasticbutton-' + ctrl.kind);\r\n                var contentCreated = false;\r\n                if (!ctrl.contentElement) {\r\n                    ctrl.contentElement = document.createElement('DIV');\r\n                    ctrl.contentElement.className = 'mcn-elasticbutton-content';\r\n                    WinJSContrib.Utils.moveChilds(ctrl.element, ctrl.contentElement);\r\n                    contentCreated = true;\r\n                }\r\n\r\n                if (!ctrl.bgElement) {\r\n                    ctrl.bgElement = document.createElement('DIV');\r\n                    ctrl.bgElement.className = 'mcn-elasticbutton-bg';\r\n                    ctrl.element.appendChild(ctrl.bgElement);\r\n                }\r\n\r\n                if (contentCreated) {\r\n                    ctrl.element.appendChild(ctrl.contentElement);\r\n                }\r\n\r\n                if (!ctrl.contentElement) {\r\n                    ctrl.contentElement = document.createElement('DIV');\r\n                    ctrl.contentElement.className = 'mcn-elasticbutton-content';\r\n                    while (ctrl.element.children.length > 0) {\r\n                        ctrl.contentElement.appendChild(ctrl.element.children[0]);\r\n                    }\r\n                    ctrl.element.appendChild(ctrl.contentElement);\r\n                }\r\n\r\n                ctrl.currentKind = elasticbuttonkinds[this.kind];\r\n                if (ctrl.currentKind) {\r\n                    ctrl.bgElement.innerHTML = ctrl.currentKind.svg;\r\n                    ctrl.snap = Snap(ctrl.bgElement.querySelector('svg'));\r\n                    ctrl.pathEl = ctrl.snap.select('path');\r\n                    ctrl.paths = {\r\n                        reset: ctrl.pathEl.attr('d'),\r\n                        active: ctrl.currentKind.morphpath\r\n                    };\r\n                    if (ctrl.eventTracker)\r\n                        ctrl.eventTracker.dispose();\r\n                    ctrl.eventTracker = new WinJSContrib.UI.EventTracker();\r\n                    ctrl.eventTracker.addEvent(ctrl.element, 'pointerdown', function (arg) { ctrl._ptdown(arg); });\r\n                    ctrl.eventTracker.addEvent(ctrl.element, 'pointerup', function (arg) { ctrl._ptup(arg); });\r\n                    ctrl.eventTracker.addEvent(ctrl.element, 'pointerleave', function (arg) { ctrl._ptup(arg); })\r\n                }\r\n            },\r\n\r\n            _ptdown: function (arg) {\r\n                this.element.classList.add(\"pressed\");\r\n                this.pathEl.stop().animate({ 'path': this.paths.active }, this.behavior.speed.active, this.behavior.easing.active);\r\n            },\r\n\r\n            _ptup: function (arg) {\r\n                this.element.classList.remove(\"pressed\");\r\n                this.pathEl.stop().animate({ 'path': this.paths.reset }, this.behavior.speed.reset, this.behavior.easing.reset);\r\n            },\r\n\r\n            dispose: function () {\r\n                if (this.eventTracker) this.eventTracker.dispose();\r\n                WinJS.Utilities.disposeSubTree(this.element);\r\n                this.element = null;\r\n            }\r\n        }),\r\n\t\tWinJS.Utilities.eventMixin,\r\n\t\tWinJS.Utilities.createEventProperties(\"myevent\"))\r\n    });\r\n})();","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/// <reference path=\"winjscontrib.core.js\" />\r\n\r\n//this controls requires snap.svg\r\n\r\n(function () {\r\n    'use strict';\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        FOWrapper: WinJS.Class.mix(WinJS.Class.define(function ctor(element, options) {\r\n            this.element = element || document.createElement('DIV');\r\n            options = options || {};\r\n            this.element.winControl = this;\r\n            this.element.classList.add('mcn-fowrapper');\r\n            this.element.classList.add('mcn-layout-ctrl');\r\n            this.element.classList.add('win-disposable');\r\n            WinJS.UI.setOptions(this, options);\r\n            this.render();\r\n        }, {\r\n            someProperty: {\r\n                get: function () {\r\n                    return this._someProperty;\r\n                },\r\n                set: function (val) {\r\n                    this._someProperty = val;\r\n                }\r\n            },\r\n\r\n            render: function () {\r\n                var ctrl = this;\r\n                ctrl.wrapperId = WinJSContrib.Utils.guid();\r\n                var body = document.createElement(\"BODY\");\r\n                body.className = \"mcn-fowrapper-content\";\r\n                body.style.width = '100%';\r\n                body.style.height = '100%';\r\n                WinJSContrib.Utils.moveChilds(ctrl.element, body);\r\n                ctrl.element.innerHTML = '<svg id=\"' + ctrl.wrapperId + '\" class=\"mcn-fowrapper-svg\" xmlns=\"http://www.w3.org/2000/svg\" style=\"width:100%; height: 100%\">' +\r\n                    '<defs>' +\r\n                        '<filter id=\"blur-' + ctrl.wrapperId + '\" x=\"0\" y=\"0\"><feGaussianBlur class=\"gblur\" in=\"SourceGraphic\" stdDeviation=\"0\" /></filter>' +\r\n                    '</defs>' +\r\n                    '<foreignObject class=\"fowrapper\" width=\"100%\" height=\"100%\" requiredExtensions=\"http://www.w3.org/1999/xhtml\" filter=\"url(#blur-' + ctrl.wrapperId + ')\">' +\r\n                    '</foreignObject>' +\r\n                '</svg>';\r\n                var container = ctrl.element.querySelector(\".fowrapper\");\r\n                ctrl.svg = ctrl.element.querySelector(\"svg\");\r\n                ctrl.container = container;\r\n                ctrl.content = body;\r\n                ctrl.blurFilter = ctrl.element.querySelector(\".gblur\");\r\n                ctrl.sblurFilter = Snap(ctrl.blurFilter);\r\n                container.appendChild(body);\r\n            },\r\n\r\n            blurTo: function (blur, duration, easing) {\r\n                var ctrl = this;\r\n\r\n                ctrl.sblurFilter.stop();\r\n                if (!duration) {\r\n                    ctrl.blurFilter.setAttribute(\"stdDeviation\", blur);                    \r\n                    return;\r\n                }\r\n\r\n                ctrl.sblurFilter.animate({ stdDeviation: blur }, duration, easing || mina.easeout);\r\n                ctrl.dispatchEvent('blur');\r\n            },\r\n\r\n            updateLayout: function () {\r\n                if (this.container) {\r\n                    this.container.setAttribute(\"width\", \"100%\");\r\n                    this.container.setAttribute(\"height\", \"100%\");\r\n                }\r\n            },\r\n\r\n            dispose: function () {\r\n                WinJS.Utilities.disposeSubTree(this.element);                \r\n                this.element = null;\r\n            }\r\n        }),\r\n        WinJS.Utilities.eventMixin,\r\n        WinJS.Utilities.createEventProperties(\"blur\"))\r\n    });\r\n})();","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib = WinJSContrib || {};\r\nWinJSContrib.UI = WinJSContrib.UI || {};\r\n\r\n(function () {\r\n    \"use strict\";\r\n\r\n    WinJSContrib.UI.MultiPassRenderer = WinJS.Class.define(\r\n    /**\r\n     * This control manage multi-pass rendering for improving performances when showing a list of items.\r\n     * The renderer will render \"shells\" for the items to enable page layout, and render items content on demand, or when items scrolls to view.  \r\n     * @class WinJSContrib.UI.MultiPassRenderer\r\n     */\r\n    function (element, options) {\r\n        options = options || {};\r\n        this.items = [];\r\n        this.element = element;\r\n        this._scrollProcessor = null;\r\n        this._tolerance = 1;\r\n        this._virtualize = false;\r\n        this._scrollContainer = options.scrollContainer || null;\r\n        this._multipass = options.multipass || false;\r\n        this._orientation = options.orientation || '';\r\n        this.itemClassName = options.itemClass || options.className || options.itemClassName;\r\n        this.itemTemplate = WinJSContrib.Utils.getTemplate(options.template || options.itemTemplate);\r\n        this.itemInvoked = options.invoked || options.itemInvoked;\r\n        this.onitemContent = options.onitemContent;\r\n        this._onScrollBinded = this._onScroll.bind(this);\r\n\r\n        if (element) {\r\n            element.className = element.className + ' mcn-items-ctrl mcn-layout-ctrl win-disposable';\r\n        }\r\n\r\n        //element.mcnRenderer = this;\r\n        //WinJS.UI.setOptions(this, options);\r\n    },\r\n    /**\r\n      * @lends WinJSContrib.UI.MultiPassRenderer.prototype\r\n      */\r\n    {\r\n        dispose : function(){\r\n            var ctrl = this;\r\n            WinJSContrib.UI.untapAll(ctrl.element);\r\n            WinJS.Utilities.disposeSubTree(ctrl.element);\r\n            ctrl._unregisterScrollEvents();\r\n            ctrl._scrollContainer = null;\r\n            ctrl.element = null;\r\n            ctrl._scrollProcessor = null;\r\n            ctrl.rect = null;           \r\n            ctrl.items = [];\r\n        },\r\n\r\n        clear: function () {\r\n            var ctrl = this;\r\n            WinJS.Utilities.disposeSubTree(ctrl.element);\r\n            ctrl.element.innerHTML = '';\r\n        },\r\n\r\n        /**\r\n         * kind of multipass, can be 'section', or 'item'\r\n         * @type {String}\r\n         * @field\r\n         */\r\n        multipass: {\r\n            get: function () {\r\n                return this._multipass;\r\n            },\r\n            set: function (val) {\r\n                this._multipass = val;\r\n                this.refreshScrollEvents();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * tolerance for determining if the rendering should apply. Tolerance is expressed in scroll container proportion. For example, 1 means that tolerance is equal to scroll container size\r\n         * @type {number}\r\n         * @field\r\n         */\r\n        tolerance: {\r\n            get: function () {\r\n                return this._tolerance;\r\n            },\r\n            set: function (val) {\r\n                this._tolerance = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * indicate if renderer empty items out of sight\r\n         * @type {boolean}\r\n         * @field\r\n         */\r\n        virtualize: {\r\n            get: function () {\r\n                return this._virtualize;\r\n            },\r\n            set: function (val) {\r\n                this._virtualize = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * could be 'vertical' or 'horizontal'\r\n         * @type {String}\r\n         * @field\r\n         */\r\n        orientation: {\r\n            get: function () {\r\n                return this._orientation;\r\n            },\r\n            set: function (val) {\r\n                this._orientation = val;\r\n                this.refreshScrollEvents();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Element containing scroll. If scrollContainer is filled, items content will get rendered when coming into view\r\n         * @type {HTMLElement}\r\n         * @field\r\n         */\r\n        scrollContainer: {\r\n            get: function () {\r\n                return this._scrollContainer;\r\n            },\r\n            set: function (val) {\r\n                this._unregisterScrollEvents();\r\n                this._scrollContainer = val;\r\n                this._registerScrollEvents();\r\n                //this.checkRendering();\r\n            }\r\n        },\r\n\r\n        _onScroll: function () {\r\n            var ctrl = this;\r\n            if (ctrl.scrollContainer && ctrl._scrollProcessor) {\r\n                if (ctrl._scrollRequest) {\r\n                    cancelAnimationFrame(ctrl._scrollRequest);\r\n                }\r\n\r\n                ctrl._scrollRequest = requestAnimationFrame(function () {\r\n                    ctrl.checkRendering();\r\n                });\r\n            }\r\n        },\r\n\r\n        _unregisterScrollEvents: function () {\r\n            this._scrollProcessor = null;\r\n            this.clearOffsets();\r\n            if (this.scrollContainer) {\r\n                this.scrollContainer.removeEventListener('scroll', this._onScrollBinded);\r\n            }\r\n        },\r\n\r\n        _registerScrollEvents: function () {\r\n            var ctrl = this;\r\n            if (ctrl.scrollContainer) {\r\n                this.scrollContainer.addEventListener('scroll', this._onScrollBinded);\r\n\r\n                if (ctrl.orientation == 'vertical') {\r\n                    if (ctrl.multipass == 'section') {\r\n                        ctrl._scrollProcessor = function () { ctrl._checkSection(ctrl._vIsInView); }\r\n                    } else if (ctrl.multipass == 'item') {\r\n                        ctrl._scrollProcessor = function () { ctrl._checkItem(ctrl._vIsInView); }\r\n                    }\r\n                } else {\r\n                    if (ctrl.multipass == 'section') {\r\n                        ctrl._scrollProcessor = function () { ctrl._checkSection(ctrl._hIsInView); }\r\n                    } else if (ctrl.multipass == 'item') {\r\n                        ctrl._scrollProcessor = function () { ctrl._checkItem(ctrl._hIsInView); }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * refresh scroll events associated to multi pass renderer\r\n         */\r\n        refreshScrollEvents: function () {\r\n            this._unregisterScrollEvents();\r\n            this._registerScrollEvents();\r\n            this.clearOffsets();\r\n        },\r\n\r\n        _vIsInView: function (rect, scrollContainer, tolerance) {\r\n            var pxTolerance = scrollContainer.clientHeight * tolerance;\r\n            if (rect.y >= scrollContainer.scrollTop - pxTolerance && rect.y <= scrollContainer.scrollTop + scrollContainer.clientHeight + pxTolerance)\r\n                return true;\r\n\r\n            if (rect.y + rect.height >= scrollContainer.scrollTop - pxTolerance && rect.y + rect.height <= scrollContainer.scrollTop + scrollContainer.clientHeight + pxTolerance)\r\n                return true;\r\n\r\n            if (rect.y <= scrollContainer.scrollTop - pxTolerance && rect.y + rect.height >= scrollContainer.scrollTop + scrollContainer.clientHeight + pxTolerance)\r\n                return true;\r\n\r\n            return false;\r\n        },\r\n\r\n        _hIsInView: function (rect, scrollContainer, tolerance) {\r\n            var pxTolerance = scrollContainer.clientWidth * (tolerance || 0);\r\n            if (rect.x >= scrollContainer.scrollLeft - pxTolerance && rect.x <= scrollContainer.scrollLeft + scrollContainer.clientWidth + pxTolerance)\r\n                return true;\r\n\r\n            if (rect.x + rect.width >= scrollContainer.scrollLeft - pxTolerance && rect.x + rect.width <= scrollContainer.scrollLeft + scrollContainer.clientWidth + pxTolerance)\r\n                return true;\r\n\r\n            if (rect.x <= scrollContainer.scrollLeft - pxTolerance && rect.x + rect.width >= scrollContainer.scrollLeft + scrollContainer.clientWidth + pxTolerance)\r\n                return true;\r\n\r\n            return false;\r\n        },\r\n\r\n        /**\r\n         * Clear cached offsets for bloc and for items\r\n         */\r\n        clearOffsets: function () {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n            \r\n            ctrl.rect = null;\r\n            ctrl.items.forEach(function (item) {\r\n                item.rect = null;\r\n            });\r\n        },\r\n\r\n        /**\r\n         * update ui related properties like cached offsets, scroll events, ...\r\n         */\r\n        updateLayout: function () {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n            ctrl.refreshScrollEvents();\r\n        },\r\n\r\n        _checkSection: function (check, tolerance, noRender) {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n            tolerance = tolerance || 0;\r\n\r\n            if (!ctrl.rect && ctrl.items && ctrl.items.length) {\r\n                ctrl.rect = WinJSContrib.UI.offsetFrom(ctrl.element, ctrl.scrollContainer);\r\n            } else {\r\n                ctrl.rect = ctrl.rect || { x: 0, y: 0, width: 0, height: 0 };\r\n                ctrl.rect.width = ctrl.element.clientWidth;\r\n                ctrl.rect.height = ctrl.element.clientHeight;\r\n            }\r\n\r\n            if (check(ctrl.rect, ctrl.scrollContainer, tolerance)) {\r\n                if (noRender)\r\n                    return true;\r\n\r\n                ctrl.renderItemsContent();\r\n                if (ctrl.onrendersection) {\r\n                    ctrl.onrendersection();\r\n                }\r\n            } else if (ctrl.virtualize && tolerance > 0 && ctrl.items && ctrl.items.length && ctrl.items[0].rendered) {\r\n                ctrl.items.forEach(function (item) {\r\n                    item.empty();\r\n                });\r\n            }\r\n\r\n            if (tolerance == 0 && ctrl.tolerance > 0) {\r\n                setImmediate(function () {\r\n                    ctrl._checkSection(check, ctrl.tolerance);\r\n                });\r\n            }\r\n        },\r\n\r\n        _checkItem: function (check, tolerance) {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n            tolerance = tolerance || 0;\r\n            var allRendered = true;\r\n\r\n            var countR = function () {\r\n                var countRendered = 0;\r\n                ctrl.items.forEach(function (item) {\r\n                    if (item.rendered) {\r\n                        countRendered++;\r\n                    }\r\n                });\r\n                console.log('rendered ' + countRendered);\r\n            }\r\n\r\n            if (ctrl._checkSection(check, tolerance, true)) {\r\n                ctrl.items.forEach(function (item) {\r\n                    if (!item.rect) {\r\n                        item.rect = WinJSContrib.UI.offsetFrom(item.element, ctrl.scrollContainer);\r\n                    }\r\n                    allRendered = allRendered & item.rendered;\r\n\r\n                    if (!item.rendered && check(item.rect, ctrl.scrollContainer, tolerance)) {\r\n                        item.render();\r\n                    } else if (item.rendered && ctrl.virtualize && tolerance > 0 && !check(item.rect, ctrl.scrollContainer, tolerance)) {\r\n                        item.empty();\r\n                    }\r\n                });\r\n                ctrl.allRendered = allRendered;\r\n                //countR();\r\n            } else if (tolerance > 0 && ctrl.items.length && (ctrl.items[0].rendered || ctrl.items[ctrl.items.length - 1].rendered)) {\r\n                ctrl.items.forEach(function (item) {\r\n                    if (!item.rect) {\r\n                        item.rect = WinJSContrib.UI.offsetFrom(item.element, ctrl.scrollContainer);\r\n                    }\r\n                    if (ctrl.virtualize && !check(item.rect, ctrl.scrollContainer, tolerance)) {\r\n                        item.empty();\r\n                    }\r\n                });\r\n                //countR();\r\n            }\r\n\r\n            if (tolerance == 0 && ctrl.tolerance > 0) {\r\n                setImmediate(function () {\r\n                    ctrl._checkItem(check, ctrl.tolerance);\r\n                });\r\n            }\r\n\r\n\r\n        },\r\n\r\n        /**\r\n         * render items shells to the page\r\n         * @param {Array} items array of items to render\r\n         * @param {Object} renderOptions options for rendering items, can override control options like item template\r\n         */\r\n        prepareItems: function (items, renderOptions) {\r\n            var ctrl = this;\r\n            items = items || [];\r\n            renderOptions = renderOptions || {};\r\n            var numItems = items.length;\r\n\r\n            var itemInvoked = renderOptions.itemInvoked || ctrl.itemInvoked;\r\n            if (typeof itemInvoked == 'string')\r\n                itemInvoked = WinJSContrib.Utils.resolveMethod(ctrl.element, itemInvoked);\r\n            var template = WinJSContrib.Utils.getTemplate(renderOptions.template) || ctrl.itemTemplate;\r\n            var className = renderOptions.itemClassName || ctrl.itemClassName;\r\n            var onitemInit = renderOptions.onitemInit || ctrl.onitemInit;\r\n            var onitemContent = renderOptions.onitemContent || ctrl.onitemContent;\r\n            var container = ctrl.element;\r\n            var registereditems = ctrl.items;\r\n\r\n            items.forEach(function (itemdata) {\r\n                var item = new WinJSContrib.UI.MultiPassItem(ctrl, null, {\r\n                    data: itemdata,\r\n                    template: template,\r\n                    className: className,\r\n                    itemInvoked: itemInvoked,\r\n                    onitemInit: onitemInit,\r\n                    onitemContent: onitemContent\r\n                });\r\n                registereditems.push(item);\r\n                container.appendChild(item.element);\r\n            });\r\n            //for (var i = 0 ; i < numItems; i++) {\r\n            //    var itemdata = items[i];\r\n            //    var item = new WinJSContrib.UI.MultiPassItem(ctrl, null, {\r\n            //        data: itemdata,\r\n            //        template: template,\r\n            //        className: className,\r\n            //        itemInvoked: itemInvoked,\r\n            //        onitemInit: onitemInit,\r\n            //        onitemContent: onitemContent\r\n            //    });\r\n            //    registereditems.push(item);\r\n            //    container.appendChild(item.element);\r\n            //}\r\n\r\n            if (renderOptions.renderItems || !this.multipass) {\r\n                ctrl.renderItemsContent();\r\n            }\r\n            //ctrl.element.style.display = '';\r\n        },\r\n\r\n        /**\r\n         * check rendering of items, based on multipass configuration (force items on screen to render)\r\n         */\r\n        checkRendering: function () {\r\n            var ctrl = this;\r\n            if (ctrl.element && ctrl._scrollProcessor)\r\n                ctrl._scrollProcessor();\r\n        },\r\n\r\n        /**\r\n         * force rendering of all unrendered items\r\n         */\r\n        renderItemsContent: function () {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n\r\n            ctrl.items.forEach(function (item) {\r\n                if (!item.rendered) {\r\n                    //setImmediate(function () {\r\n                    item.render();\r\n                    //});\r\n                }\r\n            });\r\n            ctrl.allRendered = true;\r\n        }\r\n    });\r\n\r\n    WinJSContrib.UI.MultiPassItem = WinJS.Class.define(\r\n        /**\r\n         * Item for multipass rendering\r\n         * @class WinJSContrib.UI.MultiPassItem\r\n         */\r\n    function (renderer, element, options) {\r\n        options = options || {};\r\n        var item = this;\r\n        item.renderer = renderer;\r\n        item.element = element || document.createElement('DIV');\r\n        item.element.className = item.element.className + ' ' + options.className + ' mcn-multipass-item unloaded win-disposable';\r\n        item.element.winControl = item;\r\n\r\n        item.itemInvoked = options.itemInvoked;\r\n        item.itemDataPromise = WinJS.Promise.as(options.data);\r\n\r\n        item.itemTemplate = options.template;\r\n        item.rendered = false;\r\n        item.onitemContent = options.onitemContent;\r\n        if (options.onitemInit) {\r\n            options.onitemInit(this);\r\n        }\r\n    },\r\n    /**\r\n     * @lends WinJSContrib.UI.MultiPassItem\r\n     */\r\n    {\r\n        dispose: function () {\r\n            var item = this;\r\n            item.renderer = null;\r\n            item.element = null;\r\n            item.itemInvoked = null;\r\n            item.itemData = null;\r\n            item.itemDataPromise = null;\r\n            item.itemTemplate = null;\r\n            item.onitemContent = null;\r\n        },\r\n\r\n        /**\r\n         * render item content\r\n         */\r\n        render: function (delayed) {\r\n            var ctrl = this;\r\n\r\n            if (ctrl.element && ctrl.itemTemplate && !ctrl.rendered) {\r\n\r\n                ctrl.rendered = true;\r\n                return ctrl._renderContent();\r\n            }\r\n\r\n            return WinJS.Promise.wrap(ctrl.contentElement);\r\n        },\r\n\r\n        /**\r\n         * empty item and mark it as unrendered\r\n         */\r\n        empty: function () {\r\n            var ctrl = this;\r\n            if (ctrl.element && ctrl.rendered) {\r\n                WinJSContrib.UI.untapAll(ctrl.element);\r\n                ctrl.element.classList.remove('loaded');\r\n                ctrl.element.innerHTML = '';\r\n                ctrl.rendered = false;\r\n            }\r\n        },\r\n\r\n        _renderItemContent: function (rendered) {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n\r\n            ctrl.element.appendChild(rendered);\r\n\r\n            if (ctrl.itemInvoked) {\r\n                if (typeof ctrl.itemInvoked == 'string')\r\n                    ctrl.itemInvoked = WinJSContrib.Utils.resolveMethod(ctrl.element, ctrl.itemInvoked);\r\n\r\n                if (ctrl.itemInvoked) {\r\n                    WinJSContrib.UI.tap(ctrl.element, function (arg) {\r\n                        ctrl.itemInvoked(ctrl);\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (ctrl.onitemContent) {\r\n                ctrl.onitemContent(ctrl.itemData, rendered);\r\n            }\r\n            else if (ctrl.renderer.onitemContent) {\r\n                ctrl.renderer.onitemContent(ctrl.itemData, rendered);\r\n            }\r\n\r\n            setImmediate(function () {\r\n                if (ctrl.element) {\r\n                    ctrl.element.classList.remove('unloaded');\r\n                    ctrl.element.classList.add('loaded');\r\n                }\r\n            });\r\n\r\n            ctrl.rendered = true;\r\n            ctrl.contentElement = rendered;\r\n            return rendered;\r\n        },\r\n\r\n        _renderContent: function () {\r\n            var ctrl = this;\r\n\r\n            if (ctrl.element && ctrl.itemTemplate) {\r\n                return ctrl.itemDataPromise.then(function (data) {\r\n                    ctrl.itemData = data;\r\n                    return ctrl.itemTemplate.render(data).then(function (rendered) {\r\n                        ctrl._renderItemContent(rendered);\r\n                    });\r\n                });\r\n            }\r\n\r\n            return WinJS.Promise.wrap();\r\n        }\r\n    });\r\n})();","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n(function () {\r\n\r\n\t\"use strict\";\r\n\r\n\t/**\r\n     * Object representing a layout configuration for the grid control\r\n     * @typedef {Object} WinJSContrib.UI.GridControlLayout\r\n     * @property {string} layout layout algorythm to apply (horizontal | vertical | flexhorizontal | flexvertical | hbloc\r\n     * @property {number} cellSpace space between grid cells\r\n     * @property {number} cellWidth width of grid cells\r\n     * @property {number} cellHeight height of grid cells\r\n     * @property {number} itemsPerColumn number of cells per column if using a layout with a fixed number of cells\r\n     * @property {number} itemsPerRow number of cells per row if using a layout with a fixed number of cells\r\n     * @example\r\n     * {\r\n     *     layout: 'horizontal',\r\n     *     itemsPerColumn: (options.itemsPerColumn) ? options.itemsPerColumn : undefined,\r\n     *     itemsPerRow: (options.itemsPerRow) ? options.itemsPerRow : undefined,\r\n     *     cellSpace: 10,\r\n     *     cellWidth: (options.cellWidth) ? options.cellWidth : undefined,\r\n     *     cellHeight: (options.cellHeight) ? options.cellHeight : undefined,\r\n     * }\r\n     */\r\n\r\n\tWinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n\t\tGridControl: WinJS.Class.define(\r\n            /**\r\n             * @classdesc\r\n             * Control that layout it's children with different algorythms. Used with {@link WinJSContrib.UI.Hub}, The Grid could rely on multipass rendering to optimize large hub pages load.\r\n             * @class WinJSContrib.UI.GridControl\r\n             * @param {HTMLElement} element DOM element containing the control\r\n             * @param {Object} options\r\n             */\r\n            function GridControl(element, options) {\r\n            \tvar grid = this;\r\n            \toptions = options || {};\r\n            \tgrid.element = element;\r\n\r\n            \tgrid.element.className = grid.element.className + ' mcn-grid-ctrl mcn-layout-ctrl win-disposable';\r\n            \tgrid.element.winControl = grid;\r\n\r\n\r\n            \t/**\r\n                 * multipass renderer for the grid\r\n                 * @field\r\n                 * @type WinJSContrib.UI.MultiPassRenderer\r\n                 */\r\n            \tgrid.renderer = new WinJSContrib.UI.MultiPassRenderer(grid.element, {\r\n            \t\tmultipass: options.multipass,\r\n            \t\titemClassName: options.itemClassName,\r\n            \t\titemTemplate: options.itemTemplate,\r\n            \t\titemInvoked: options.itemInvoked,\r\n            \t});\r\n\r\n\r\n            \tgrid.layouts = options.layouts;\r\n\r\n            \t/**\r\n                 * default layout definitions for the grid\r\n                 * @field\r\n                 * @type WinJSContrib.UI.GridControlLayout\r\n                 */\r\n            \tgrid.defaultLayout = {\r\n            \t\tlayout: options.layout || 'none',\r\n            \t\titemsPerColumn: (options.itemsPerColumn) ? options.itemsPerColumn : undefined,\r\n            \t\titemsPerRow: (options.itemsPerRow) ? options.itemsPerRow : undefined,\r\n            \t\tcellSpace: (options.cellSpace) ? options.cellSpace : 10,\r\n            \t\tcellWidth: (options.cellWidth) ? options.cellWidth : undefined,\r\n            \t\tcellHeight: (options.cellHeight) ? options.cellHeight : undefined,\r\n            \t};\r\n\r\n            \t/**\r\n                 * indicate if grid accept layout event from the page (if you use WinJS Contrib page events)\r\n                 * @field\r\n                 * @type boolean\r\n                 */\r\n            \tgrid.autolayout = options.autolayout || true;\r\n\r\n            \tvar parent = WinJSContrib.Utils.getScopeControl(grid.element);\r\n            \tif (parent && parent.pageLifeCycle) {\r\n            \t\tparent.pageLifeCycle.steps.layout.attach(function () {\r\n            \t\t\tif (grid.autolayout) {\r\n            \t\t\t\tgrid.layout();\r\n            \t\t\t}\r\n            \t\t});\r\n            \t}\r\n            \telse if (parent && parent.elementReady) {\r\n            \t\tparent.elementReady.then(function () {\r\n            \t\t\tparent.readyComplete.then(function () {\r\n            \t\t\t\tif (grid.autolayout) {\r\n            \t\t\t\t\tgrid.layout();\r\n            \t\t\t\t}\r\n            \t\t\t});\r\n            \t\t});\r\n            \t}\r\n            },\r\n            /**\r\n             * @lends WinJSContrib.UI.GridControl.prototype\r\n             */\r\n            {\r\n            \t/**\r\n                 * scroll element containing the grid. Required for multi pass rendering\r\n                 * @field\r\n                 * @type HTMLElement\r\n                 */\r\n            \tscrollContainer: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.scrollContainer;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.scrollContainer = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * indicate if grid layout itself according to the page lifecycle (default to true)\r\n                 * @field\r\n                 * @type boolean\r\n                 */\r\n            \tautolayout: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this._autolayout;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis._autolayout = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * layout definitions for the grid. It's an object containing several grid layout options. See {@link WinJSContrib.UI.GridControlLayout}\r\n                 * @field\r\n                 * @type Object\r\n                 */\r\n            \tlayouts: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.gridLayouts;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.gridLayouts = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * indicate the kind of multipass treatment\r\n                 * @field\r\n                 * @type string\r\n                 */\r\n            \tmultipass: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.multipass;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.multipass = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * callback triggered when clicking on an item\r\n                 * @field\r\n                 * @type HTMLElement\r\n                 */\r\n            \titemInvoked: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.itemInvoked;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.itemInvoked = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * item template (WinJS Template or template function)\r\n                 * @field\r\n                 * @type Object\r\n                 */\r\n            \titemTemplate: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.itemTemplate;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.itemTemplate = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * css class added on item's placeholder\r\n                 * @field\r\n                 * @type Object\r\n                 */\r\n            \titemClassName: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.itemClassName;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.itemClassName = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * items to render\r\n                 * @field\r\n                 * @type Object\r\n                 */\r\n            \titems: {\r\n            \t\tget: function () {\r\n            \t\t\treturn;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n\t\t\t\t\t\tif (val && val.length)\r\n            \t\t\t\tthis.prepareItems(val);\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * render HTML for items\r\n                 * @param {Array} items array of items to render\r\n                 * @param {Object} renderOptions\r\n                 */\r\n            \tprepareItems: function (items, renderOptions) {\r\n                    if (!this.element)\r\n                        return;\r\n                    \r\n            \t\tvar parent = WinJSContrib.Utils.getParentControlByClass('mcn-layout-ctrl', this.element);\r\n            \t\tvar parentMultipass = undefined;\r\n            \t\tif (!this.renderer.multipass && parent && parent.multipass) {\r\n            \t\t\tthis.renderer.multipass = parent.multipass;\r\n            \t\t}\r\n\r\n            \t\tthis.renderer.prepareItems(items, renderOptions);\r\n            \t},\r\n\r\n            \t/**\r\n                 * force items content to render\r\n                 */\r\n            \trenderItemsContent: function () {\r\n            \t\tif (!this.renderer)\r\n                        return;\r\n                    this.renderer.renderItemsContent();\r\n            \t},\r\n\r\n            \tresetElement: function (elt, isItem) {\r\n            \t\tvar style = elt.style;\r\n            \t\tif (isItem && style.position) style.position = '';\r\n            \t\tif (!isItem && style.display) style.display = '';\r\n            \t\tif (style.width) style.width = '';\r\n            \t\tif (style.height) style.height = '';\r\n            \t\tif (style.minWidth) style.minWidth = '';\r\n            \t\tif (style.minHeight) style.minHeight = '';\r\n            \t\tif (style.left) style.left = '';\r\n            \t\tif (style.top) style.top = '';\r\n            \t},\r\n\r\n            \tclearContent: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\tctrl.renderer.clear();\r\n            \t},\r\n\r\n            \t/**\r\n                 * Clear all layout and position styles on items\r\n                 */\r\n            \tclearLayout: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\t\r\n            \t\tctrl.resetElement(ctrl.element, false);\r\n            \t\tif (ctrl.element.children.length) {\r\n            \t\t\tfor (var i = 0, l = ctrl.element.children.length; i < l; i++) {\r\n            \t\t\t\tctrl.resetElement(ctrl.element.children[i], true);\r\n            \t\t\t}\r\n            \t\t}\r\n            \t},\r\n\r\n            \tfill: function (matrix, x, y, w, h) {\r\n            \t\tif (matrix.length < x + w) {\r\n            \t\t\tfor (var i = matrix.length ; i < x + w ; i++) {\r\n            \t\t\t\tmatrix.push([]);\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\tfor (var i = x ; i < x + w ; i++) {\r\n            \t\t\tvar col = matrix[i];\r\n            \t\t\tif (col.length < y + h) {\r\n            \t\t\t\tfor (var j = col.length ; j < y + h ; j++) {\r\n            \t\t\t\t\tcol.push(false);\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n\r\n            \t\t\tfor (var j = y ; j < y + h ; j++) {\r\n            \t\t\t\tcol[j] = true;\r\n            \t\t\t}\r\n            \t\t}\r\n            \t},\r\n\r\n            \tfit: function (matrix, x, y, w, h, maxW, maxH) {\r\n            \t\t//items to big\r\n            \t\tif (maxH && h > maxH && y === 0)\r\n            \t\t\treturn true;\r\n            \t\tif (maxW && w > maxW && x === 0)\r\n            \t\t\treturn true;\r\n\r\n            \t\t//overflow grid capacity\r\n            \t\tif (maxW && (x + w) > maxW)\r\n            \t\t\treturn false;\r\n            \t\tif (maxH && (y + h) > maxH)\r\n            \t\t\treturn false;\r\n\r\n            \t\tfor (var i = x ; i < x + w ; i++) {\r\n            \t\t\tvar col = matrix[i];\r\n            \t\t\tif (col) {\r\n            \t\t\t\tfor (var j = y ; j < y + h ; j++) {\r\n            \t\t\t\t\tif (col[j] === true)\r\n            \t\t\t\t\t\treturn false;\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\treturn true;\r\n            \t},\r\n\r\n            \tfirstFit: function (matrix, w, h, maxH, numItems) {\r\n            \t\tvar ctrl = this;\r\n            \t\tfor (var i = 0 ; i < numItems * maxH * 2 ; i++) {\r\n            \t\t\tvar col = matrix[i];\r\n            \t\t\tif (col) {\r\n            \t\t\t\tfor (var j = 0 ; j < maxH ; j++) {\r\n            \t\t\t\t\tif (col[j] !== true && ctrl.fit(matrix, i, j, w, h, undefined, maxH)) {\r\n            \t\t\t\t\t\treturn { x: i, y: j };\r\n            \t\t\t\t\t}\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n            \t\t\telse {\r\n            \t\t\t\treturn { x: i, y: 0 };\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\treturn undefined;\r\n            \t},\r\n\r\n            \tvisibleChilds: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\tvar res = [];\r\n\r\n            \t\tfor (var i = 0, l = ctrl.element.children.length; i < l ; i++) {\r\n            \t\t\tvar item = ctrl.element.children[i];\r\n            \t\t\tvar st = window.getComputedStyle(item);\r\n            \t\t\tif (st.display != 'none' && st.visibility != 'hidden') {\r\n            \t\t\t\tres.push(item);\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\treturn res;\r\n            \t},\r\n\r\n            \t/**\r\n                 * Layouts algorythm implementations\r\n                 */\r\n            \tGridLayoutsImpl: {\r\n            \t\tnone: function () {\r\n            \t\t},\r\n\r\n            \t\tflexhorizontal: function () {\r\n            \t\t\tvar ctrl = this;\r\n            \t\t\tctrl.renderer.orientation = 'horizontal';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\tctrl.element.style.display = 'flex';\r\n            \t\t\tctrl.element.style.flexFlow = 'column wrap';\r\n            \t\t\tctrl.element.style.alignContent = 'flex-start';\r\n            \t\t\t//ctrl.element.style.alignContent = 'flex-start';\r\n\r\n            \t\t\tif (ctrl.element.style.width)\r\n            \t\t\t\tctrl.element.style.width = '';\r\n\r\n            \t\t\tctrl.element.style.height = '';\r\n\r\n            \t\t\tif (ctrl.element.clientHeight)\r\n            \t\t\t\tctrl.element.style.height = ctrl.element.clientHeight + 'px';\r\n            \t\t\telse\r\n            \t\t\t\tctrl.element.style.height = '';\r\n\r\n            \t\t\tvar _itemsPerColumn = Math.floor(ctrl.element.clientHeight / (ctrl.data.cellHeight + ctrl.data.cellSpace));\r\n            \t\t\tif (_itemsPerColumn) {\r\n            \t\t\t\tvar visibleitems = ctrl.visibleChilds();\r\n            \t\t\t\tvar columns = Math.ceil(visibleitems.length / _itemsPerColumn);\r\n            \t\t\t\tctrl.element.style.minWidth = ((ctrl.data.cellWidth + ctrl.data.cellSpace) * columns) + 'px';\r\n            \t\t\t}\r\n            \t\t},\r\n\r\n            \t\tflexvertical: function () {\r\n            \t\t    var ctrl = this;\r\n                        ctrl.renderer.orientation = 'vertical';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\tctrl.element.style.display = 'flex';\r\n            \t\t\tctrl.element.style.flexFlow = 'row wrap';\r\n            \t\t\tctrl.element.style.alignContent = 'flex-start';\r\n\r\n            \t\t\tctrl.element.style.width = '';\r\n            \t\t\tif (ctrl.element.clientWidth)\r\n            \t\t\t\tctrl.element.style.width = ctrl.element.clientWidth + 'px';\r\n            \t\t\telse\r\n            \t\t\t\tctrl.element.style.width = '';\r\n\r\n            \t\t\tif (ctrl.element.style.height)\r\n            \t\t\t\tctrl.element.style.height = '';\r\n            \t\t},\r\n\r\n            \t\thbloc: function () {\r\n            \t\t\tvar ctrl = this;\r\n            \t\t\tctrl.renderer.orientation = 'horizontal';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\tctrl.element.style.height = '';\r\n            \t\t\tvar _containerH = ctrl.element.clientHeight;\r\n            \t\t\tif (!_containerH)\r\n            \t\t\t\treturn;\r\n\r\n            \t\t\tvar cellW = ctrl.data.cellWidth;\r\n            \t\t\tvar space = ctrl.data.cellSpace;\r\n            \t\t\tvar colCount = 1;\r\n            \t\t\tvar colOffset = 0;\r\n            \t\t\tvar topOffset = 0;\r\n\r\n            \t\t\tvar childs = ctrl.visibleChilds();\r\n            \t\t\tchilds.forEach(function (elt) {\r\n            \t\t\t\tif (elt.style.position != 'absolute')\r\n            \t\t\t\t\telt.style.position = 'absolute';\r\n            \t\t\t\tvar eltH = elt.clientHeight;\r\n            \t\t\t\tif (topOffset + eltH > _containerH) {\r\n            \t\t\t\t\tcolCount++;\r\n            \t\t\t\t\tcolOffset = colOffset + space + cellW;\r\n            \t\t\t\t\ttopOffset = 0;\r\n            \t\t\t\t}\r\n\r\n            \t\t\t\tif (elt.style.left != colOffset + 'px')\r\n            \t\t\t\t\telt.style.left = colOffset + 'px';\r\n            \t\t\t\tif (elt.style.top != topOffset + 'px')\r\n            \t\t\t\t\telt.style.top = topOffset + 'px';\r\n\r\n            \t\t\t\ttopOffset += eltH;\r\n            \t\t\t});\r\n\r\n            \t\t\tcolOffset = colOffset + cellW;\r\n            \t\t\tif (ctrl.element.style.width != colOffset + 'px')\r\n            \t\t\t\tctrl.element.style.width = colOffset + 'px';\r\n            \t\t},\r\n\r\n            \t\thorizontal: function () {\r\n            \t\t\tvar ctrl = this;\r\n            \t\t\tctrl.renderer.orientation = 'horizontal';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\tctrl.element.style.height = '';\r\n            \t\t\tvar _containerH = ctrl.element.clientHeight;\r\n            \t\t\tif (!_containerH)\r\n            \t\t\t\treturn;\r\n\r\n            \t\t\tvar _itemsPerColumn = Math.floor(_containerH / (ctrl.data.cellHeight + ctrl.data.cellSpace));\r\n            \t\t\tif (_itemsPerColumn <= 0)\r\n            \t\t\t\t_itemsPerColumn = 1;\r\n\r\n            \t\t\tvar cellW = ctrl.data.cellWidth;\r\n            \t\t\tvar cellH = ctrl.data.cellHeight;\r\n            \t\t\tvar space = ctrl.data.cellSpace;\r\n            \t\t\tvar aspectRatio = cellW / cellH;\r\n            \t\t\tvar ratioW = 1;\r\n            \t\t\tvar ratioH = 1;\r\n\r\n            \t\t\tif (ctrl.data.itemsPerColumn) {\r\n            \t\t\t\t_itemsPerColumn = ctrl.data.itemsPerColumn;\r\n            \t\t\t\tcellH = ((_containerH - ((_itemsPerColumn - 1) * space)) / _itemsPerColumn) >> 0;\r\n            \t\t\t\tcellW = (ctrl.data.cellWidth * cellH / ctrl.data.cellHeight) >> 0;\r\n            \t\t\t\tratioW = cellW / ctrl.data.cellWidth;\r\n            \t\t\t\tratioH = cellH / ctrl.data.cellHeight;\r\n            \t\t\t}\r\n\r\n            \t\t\tvar gridCellsMatrix = [[]];\r\n            \t\t\tvar childs = ctrl.visibleChilds();\r\n            \t\t\tchilds.forEach(function (elt) {\r\n            \t\t\t\telt.style.position = 'absolute';\r\n            \t\t\t\tvar eltW = elt.offsetWidth * ratioW;\r\n            \t\t\t\tvar eltH = elt.offsetHeight * ratioH;\r\n            \t\t\t\tvar eltColumns = (eltW / cellW) >> 0;\r\n            \t\t\t\tvar eltRows = (eltH / cellH) >> 0;\r\n\r\n            \t\t\t\tvar pos = ctrl.firstFit(gridCellsMatrix, eltColumns, eltRows, _itemsPerColumn, ctrl.element.children.length);\r\n            \t\t\t\tif (!pos)\r\n            \t\t\t\t\tpos = { x: 0, y: 0 };\r\n            \t\t\t\tctrl.fill(gridCellsMatrix, pos.x, pos.y, eltColumns, eltRows);\r\n\r\n            \t\t\t\tvar left = pos.x * (cellW + space);\r\n            \t\t\t\tvar top = pos.y * (cellH + space);\r\n            \t\t\t\tvar w = (eltColumns * cellW + ((eltColumns - 1) * space));\r\n            \t\t\t\tvar h = (eltRows * cellH + ((eltRows - 1) * space));\r\n            \t\t\t\telt.style.left = left + 'px';\r\n            \t\t\t\telt.style.top = top + 'px';\r\n            \t\t\t\telt.style.width = w + 'px';\r\n            \t\t\t\telt.style.height = h + 'px';\r\n            \t\t\t});\r\n\r\n            \t\t\tvar elementWidth = gridCellsMatrix.length * (cellW + space);\r\n            \t\t\tctrl.element.style.width = elementWidth + 'px';\r\n            \t\t},\r\n\r\n            \t\tvertical: function (plugin) {\r\n            \t\t\tvar ctrl = this;\r\n            \t\t\tctrl.renderer.orientation = 'vertical';\r\n            \t\t\tctrl.element.style.width = '';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\t//Be aware that in this case, we invert the matrix to crawl data in lines\r\n            \t\t\tvar _containerW = ctrl.element.clientWidth;\r\n            \t\t\tif (!_containerW)\r\n            \t\t\t\treturn;\r\n\r\n            \t\t\tvar _itemsPerLine = Math.floor(_containerW / (ctrl.data.cellWidth + ctrl.data.cellSpace));\r\n            \t\t\tif (_itemsPerLine <= 0)\r\n            \t\t\t\t_itemsPerLine = 1;\r\n\r\n            \t\t\tvar cellW = ctrl.data.cellWidth;\r\n            \t\t\tvar cellH = ctrl.data.cellHeight;\r\n            \t\t\tvar space = ctrl.data.cellSpace;\r\n            \t\t\tvar aspectRatio = cellW / cellH;\r\n            \t\t\tvar ratioW = 1;\r\n            \t\t\tvar ratioH = 1;\r\n\r\n            \t\t\tif (ctrl.data.itemsPerRow) {\r\n            \t\t\t\t_itemsPerLine = ctrl.data.itemsPerRow;\r\n            \t\t\t\tcellW = ((_containerW - ((_itemsPerLine - 1) * space)) / _itemsPerLine) >> 0;\r\n            \t\t\t\tcellH = (ctrl.data.cellHeight * cellW / ctrl.data.cellWidth) >> 0;\r\n            \t\t\t\tratioW = cellW / ctrl.data.cellWidth;\r\n            \t\t\t\tratioH = cellH / ctrl.data.cellHeight;\r\n            \t\t\t}\r\n\r\n            \t\t\tvar gridCellsMatrix = [[]];\r\n            \t\t\tvar childs = ctrl.visibleChilds();\r\n            \t\t\tchilds.forEach(function (elt) {\r\n            \t\t\t\telt.style.position = 'absolute';\r\n\r\n            \t\t\t\tvar eltW = elt.offsetWidth * ratioW;\r\n            \t\t\t\tvar eltH = elt.offsetHeight * ratioH;\r\n            \t\t\t\tvar eltColumns = (eltW / cellW) >> 0;\r\n            \t\t\t\tvar eltRows = (eltH / cellH) >> 0;\r\n\r\n            \t\t\t\tvar pos = ctrl.firstFit(gridCellsMatrix, eltRows, eltColumns, _itemsPerLine, ctrl.element.children.length);\r\n            \t\t\t\t//if (!pos)\r\n            \t\t\t\t//    return;\r\n\r\n            \t\t\t\tctrl.fill(gridCellsMatrix, pos.x, pos.y, eltRows, eltColumns);\r\n\r\n            \t\t\t\tvar left = pos.y * (cellW + space);\r\n            \t\t\t\tvar top = pos.x * (cellH + space);\r\n            \t\t\t\telt.style.left = left + 'px';\r\n            \t\t\t\telt.style.top = top + 'px';\r\n            \t\t\t\telt.style.width = (eltColumns * cellW + ((eltColumns - 1) * space)) + 'px';\r\n            \t\t\t\telt.style.height = (eltRows * cellH + ((eltRows - 1) * space)) + 'px';\r\n\r\n            \t\t\t});\r\n\r\n            \t\t\tvar elementHeight = gridCellsMatrix.length * (cellH + space);\r\n            \t\t\tctrl.element.style.height = elementHeight + 'px';\r\n            \t\t},\r\n            \t},\r\n\r\n            \t/**\r\n                 * layout content items\r\n                 */\r\n            \tlayout: function () {\r\n            \t    var ctrl = this;\r\n            \t    if (!ctrl.element)\r\n            \t        return;\r\n            \t\tvar oldlayout = ctrl.data;\r\n            \t\tctrl.data = ctrl.getLayout();\r\n\r\n            \t\tif (ctrl.data) {\r\n            \t\t\t//if (ctrl.data == oldlayout && ctrl.data.applyed)\r\n            \t\t\t//    return;\r\n\r\n            \t\t\tctrl.data.cellSpace = (ctrl.data.cellSpace != undefined ? ctrl.data.cellSpace : (ctrl.defaultLayout.cellSpace != undefined ? ctrl.defaultLayout.cellSpace : 10));\r\n            \t\t\tctrl.data.cellWidth = ctrl.data.cellWidth || ctrl.defaultLayout.cellWidth || 0;\r\n            \t\t\tctrl.data.cellHeight = ctrl.data.cellHeight || ctrl.defaultLayout.cellHeight || 0;\r\n\r\n            \t\t\t//if cell dimensions are not defined, take it from last child\r\n            \t\t\tif (!ctrl.data.cellWidth || !ctrl.data.cellHeight) {\r\n            \t\t\t    if (ctrl.element && ctrl.element.childNodes && ctrl.element.children.length > 0) {\r\n            \t\t\t\t\tvar childs = ctrl.visibleChilds();\r\n            \t\t\t\t\tif (childs && childs.length) {\r\n            \t\t\t\t\t\tvar firstChild = childs[0];\r\n            \t\t\t\t\t\tvar w = firstChild.clientWidth;\r\n            \t\t\t\t\t\tvar h = firstChild.clientHeight;\r\n            \t\t\t\t\t\tvar l = childs.length;\r\n            \t\t\t\t\t\tif (l > 10) l = 10;\r\n            \t\t\t\t\t\tfor (var i = 0, l = childs.length; i < l ; i++) {\r\n            \t\t\t\t\t\t\tvar item = childs[i];\r\n            \t\t\t\t\t\t\tif (w == 0 || item.clientWidth < w) {\r\n            \t\t\t\t\t\t\t\tw = item.clientWidth;\r\n            \t\t\t\t\t\t\t}\r\n            \t\t\t\t\t\t\tif (h == 0 || item.clientHeight < h) {\r\n            \t\t\t\t\t\t\t\th = item.clientHeight;\r\n            \t\t\t\t\t\t\t}\r\n            \t\t\t\t\t\t}\r\n            \t\t\t\t\t\tctrl.data.cellWidth = w;\r\n            \t\t\t\t\t\tctrl.data.cellHeight = h;\r\n            \t\t\t\t\t}\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n\r\n            \t\t\tvar layoutChanged = !oldlayout || ctrl.data.layout !== oldlayout.layout;\r\n            \t\t\tif (ctrl.data.layout) {\r\n            \t\t\t\tvar layoutfunc = ctrl.GridLayoutsImpl[ctrl.data.layout.toLowerCase()];\r\n            \t\t\t\tif (layoutfunc) {\r\n            \t\t\t\t\tif (layoutChanged)\r\n            \t\t\t\t\t\tctrl.changeLayout();\r\n\r\n            \t\t\t\t\tlayoutfunc.bind(ctrl)(layoutChanged);\r\n            \t\t\t\t\tctrl.data.applyed = true;\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n            \t\t\tctrl.renderer.checkRendering();\r\n            \t\t}\r\n            \t},\r\n\r\n            \tchangeLayout: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\tctrl.clearLayout();\r\n            \t\tctrl.renderer.updateLayout();\r\n            \t},\r\n\r\n            \t/**\r\n                 * update grid layout\r\n                 */\r\n            \tupdateLayout: function (element, viewState, lastViewState) {\r\n            \t    var ctrl = this;\r\n            \t    if (!ctrl.element)\r\n            \t        return;\r\n            \t\tctrl.layout();\r\n            \t},\r\n\r\n            \t/**\r\n                 * get layout applicable to the current context\r\n                 */\r\n            \tgetLayout: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\tvar matchingLayout = undefined;\r\n            \t\tif (ctrl.gridLayouts) {\r\n            \t\t\tfor (var name in ctrl.gridLayouts) {\r\n            \t\t\t\tvar layout = ctrl.gridLayouts[name];\r\n            \t\t\t\tif (ctrl.gridLayouts.hasOwnProperty(name)) {\r\n            \t\t\t\t\tif (layout.query) {\r\n            \t\t\t\t\t\tvar mq = window.matchMedia(layout.query);\r\n            \t\t\t\t\t\tif (mq.matches) {\r\n            \t\t\t\t\t\t\tmatchingLayout = layout;\r\n            \t\t\t\t\t\t}\r\n            \t\t\t\t\t} else if (!matchingLayout) {\r\n            \t\t\t\t\t\tmatchingLayout = layout;\r\n            \t\t\t\t\t}\r\n            \t\t\t\t}\r\n            \t\t\t\telse if (!matchingLayout) {\r\n            \t\t\t\t\tmatchingLayout = layout;\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\tif (!matchingLayout) {\r\n            \t\t\tmatchingLayout = ctrl.defaultLayout;\r\n            \t\t}\r\n\r\n            \t\treturn JSON.parse(JSON.stringify(matchingLayout));\r\n            \t},\r\n\r\n            \t/**\r\n                 * Release grid resources\r\n                 */\r\n            \tdispose: function () {\r\n            \t\tthis.element = null;\r\n            \t\tthis.renderer.dispose();\r\n            \t\tif (WinJS.Utilities.disposeSubTree)\r\n            \t\t\tWinJS.Utilities.disposeSubTree(this.element);\r\n            \t}\r\n            })\r\n\t});\r\n\r\n\tif (WinJSContrib.UI.WebComponents) {\r\n\t\tWinJSContrib.UI.WebComponents.register('mcn-grid', WinJSContrib.UI.GridControl, {\r\n\t\t\tproperties: ['multipass', 'autolayout', 'layouts', 'itemInvoked', 'itemTemplate', 'itemClassName', 'items']\r\n\t\t});\r\n\t}\r\n})();","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/// <reference path=\"winjscontrib.core.js\" />\r\n(function () {\r\n    'use strict';\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        AspectRatio: WinJS.Class.mix(WinJS.Class.define(function ctor(element, options) {\r\n            this.element = element || document.createElement('DIV');\r\n            options = options || {};\r\n            this.element.winControl = this;\r\n            this.element.style.display = 'none';\r\n            this.element.classList.add('mcn-aspectratio');\r\n            this.element.classList.add('win-disposable');\r\n            this.element.classList.add('mcn-layout-ctrl');\r\n            WinJS.UI.setOptions(this, options);\r\n            this.render();\r\n        }, {\r\n            baseWidth: {\r\n                get: function () {\r\n                    return this._baseWidth;\r\n                },\r\n                set: function (val) {\r\n                    this._baseWidth = val;\r\n                }\r\n            },\r\n\r\n            baseWidthMin: {\r\n                get: function () {\r\n                    return this._baseWidthMin;\r\n                },\r\n                set: function (val) {\r\n                    this._baseWidthMin = val;\r\n                }\r\n            },\r\n\r\n            baseWidthMargin: {\r\n                get: function () {\r\n                    return this._baseWidthMargin || 0;\r\n                },\r\n                set: function (val) {\r\n                    this._baseWidthMargin = val;\r\n                }\r\n            },\r\n\r\n            baseHeight: {\r\n                get: function () {\r\n                    return this._baseHeight;\r\n                },\r\n                set: function (val) {\r\n                    this._baseHeight = val;\r\n                }\r\n            },\r\n\r\n            baseHeightMin: {\r\n                get: function () {\r\n                    return this._baseHeightMin;\r\n                },\r\n                set: function (val) {\r\n                    this._baseHeightMin = val;\r\n                }\r\n            },\r\n\r\n            baseHeightMargin: {\r\n                get: function () {\r\n                    return this._baseHeightMargin || 0;\r\n                },\r\n                set: function (val) {\r\n                    this._baseHeightMargin = val;\r\n                }\r\n            },\r\n\r\n            ratio: {\r\n                get: function () {\r\n                    return this._ratio;\r\n                },\r\n                set: function (val) {\r\n                    this._ratio = val;\r\n                }\r\n            },\r\n\r\n            basedOn: {\r\n                get: function () {\r\n                    return this._basedOn;\r\n                },\r\n                set: function (val) {\r\n                    this._basedOn = val;\r\n                }\r\n            },\r\n\r\n            target: {\r\n                get: function () {\r\n                    return this._target;\r\n                },\r\n                set: function (val) {\r\n                    this._target = val;\r\n                }\r\n            },\r\n\r\n            render: function () {\r\n                var ctrl = this;\r\n                if (!ctrl.styleElt) {\r\n                    ctrl.styleElt = document.createElement('STYLE');\r\n                    ctrl.element.appendChild(ctrl.styleElt);\r\n                }\r\n                ctrl.updateLayout();\r\n            },\r\n\r\n            pageLayout: function () {\r\n                this.updateLayout();\r\n            },\r\n\r\n            updateLayout: function () {\r\n                var ctrl = this;\r\n\r\n                if (!ctrl.parentpage)\r\n                    ctrl.parentpage = WinJSContrib.Utils.getScopeControl(ctrl.element);\r\n\r\n                if (!ctrl.container)\r\n                    ctrl.container = ctrl.element.parentElement;\r\n\r\n                if (ctrl.container && ctrl.target) {\r\n                    if (ctrl.basedOn == \"height\") {\r\n                        ctrl.updateLayoutBasedOnHeight();\r\n                    } else {\r\n                        ctrl.updateLayoutBasedOnWidth();\r\n                    }\r\n                }\r\n            },\r\n\r\n            updateLayoutBasedOnWidth: function () {\r\n                var ctrl = this;\r\n\r\n                var classname = ctrl.target;\r\n                if (ctrl.prefix) {\r\n                    classname = ctrl.prefix + ' ' + classname;\r\n                }\r\n\r\n                var container = ctrl.parentpage.element;\r\n                if (ctrl.baseWidth) {\r\n                    var nbitems = ((ctrl.container.clientWidth / ctrl.baseWidth) << 0) + 1;\r\n                    var itemW = ((ctrl.container.clientWidth / nbitems) << 0) - ctrl.baseWidthMargin - 0.25;\r\n                    if (ctrl.ratio) {\r\n                        var targetH = (itemW / ctrl.ratio) << 0;\r\n                        ctrl.styleElt.innerHTML = classname + \"{ width: \" + itemW + \"px; height:\" + targetH + \"px}\";\r\n                    } else {\r\n                        ctrl.styleElt.innerHTML = classname + \"{ width: \" + itemW + \"px; }\";\r\n                    }\r\n                } else if (ctrl.ratio) {\r\n                    var elements = ctrl.container.querySelectorAll(ctrl.target);\r\n                    var eltW = elements[0].clientWidth;\r\n                    var eltH = elements[0].clientHeight;\r\n\r\n                    if (eltW > 0) {\r\n                        var targetH = (eltW / ctrl.ratio) << 0;\r\n                        if (ctrl.max) {\r\n                            var maxH = (container.clientHeight * ctrl.max / 100) << 0;\r\n                            if (targetH > maxH) {\r\n                                targetH = maxH;\r\n                            }\r\n                        }\r\n                        ctrl.styleElt.innerHTML = classname + \"{ height:\" + targetH + \"px}\";\r\n                    }\r\n                } else {\r\n                    console.warn(\"aspect ratio control must have baseWidth and/or ratio\")\r\n                }\r\n            },\r\n\r\n            updateLayoutBasedOnHeight: function () {\r\n                var ctrl = this;\r\n\r\n                var classname = ctrl.target;\r\n                if (ctrl.prefix) {\r\n                    classname = ctrl.prefix + ' ' + classname;\r\n                }\r\n\r\n                if (ctrl.baseHeight) {\r\n                    var nbitems = ((ctrl.container.clientHeight / ctrl.baseHeight) << 0) + 1;\r\n                    var itemH = ((ctrl.container.clientHeight / nbitems) << 0) - ctrl.baseHeightMargin;\r\n                    var targetW = (itemH / ctrl.ratio) << 0;\r\n                    ctrl.styleElt.innerHTML = classname + \"{ width: \" + targetW + \"px; height:\" + itemH + \"px}\";\r\n                } else {\r\n                    var elements = ctrl.container.querySelectorAll(ctrl.target);\r\n                    var eltW = elements[0].clientWidth;\r\n                    var eltH = elements[0].clientHeight;\r\n\r\n                    if (eltH > 0) {\r\n                        var targetW = (eltH * ctrl.ratio) << 0;\r\n                        if (ctrl.max) {\r\n                            var maxW = (ctrl.container.clientWidth * ctrl.max / 100) << 0;\r\n                            if (targetW > maxW) {\r\n                                targetW = maxW;\r\n                            }\r\n                        }\r\n                        ctrl.styleElt.innerHTML = classname + \"{ width:\" + targetW + \"px}\";\r\n                    }\r\n                }\r\n            },\r\n\r\n            dispose: function () {\r\n                var ctrl = this;\r\n                ctrl.parentpage = null;\r\n                ctrl.container = null;\r\n                ctrl.styleElt.parentElement.removeChild(ctrl.styleElt);\r\n                WinJS.Utilities.disposeSubTree(this.element);\r\n                this.element = null;\r\n            }\r\n        }),\r\n\t\tWinJS.Utilities.eventMixin,\r\n\t\tWinJS.Utilities.createEventProperties(\"myevent\"))\r\n    });\r\n})();","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n(function () {\r\n    'use strict';\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        VisualState: WinJS.Class.mix(WinJS.Class.define(function ctor(element, options) {\r\n            this.element = element || document.createElement('DIV');\r\n            options = options || {};\r\n            this.element.winControl = this;\r\n            this.element.style.display = \"none\";\r\n            this.element.classList.add('mcn-visualstate');\r\n            this.element.classList.add('mcn-layout-ctrl');\r\n            this.element.classList.add('win-disposable');\r\n            WinJS.UI.setOptions(this, options);\r\n        }, {\r\n            states: {\r\n                get: function () {\r\n                    return this._states;\r\n                },\r\n                set: function (val) {\r\n                    this._states = val;\r\n                }\r\n            },\r\n\r\n            target: {\r\n                get: function () {\r\n                    return this._target;\r\n                },\r\n                set: function (val) {\r\n                    this._target = val;\r\n                }\r\n            },\r\n\r\n            checkAllStates: function (name, state) {\r\n                var ctrl = this;\r\n                if (ctrl.states) {\r\n                    for (var n in ctrl.states) {\r\n                        ctrl.checkState(n, ctrl.states[n]);\r\n                    }\r\n                }\r\n            },\r\n\r\n            checkState: function (name, state) {\r\n                var ctrl = this;\r\n                if (!ctrl.element)\r\n                    return;\r\n\r\n                var target = ctrl.target || ctrl.element.parentElement;\r\n                var targetW = target.clientWidth;\r\n                var targetH = target.clientHeight;\r\n                var evaluate = true;\r\n                if (state.wGt)\r\n                    evaluate = evaluate && targetW > state.wGt;\r\n                if (state.wLt)\r\n                    evaluate = evaluate && targetW < state.wLt;\r\n                if (state.hGt)\r\n                    evaluate = evaluate && targetH > state.hGt;\r\n                if (state.hLt)\r\n                    evaluate = evaluate && targetH < state.hLt;\r\n\r\n                if (evaluate) {\r\n                    state.active = true;\r\n                    target.classList.add(\"state-\" + name);\r\n                } else {\r\n                    state.active = false;\r\n                    target.classList.remove(\"state-\" + name);\r\n                }\r\n            },\r\n\r\n            pageLayout: function () {\r\n                var ctrl = this;\r\n                ctrl.checkAllStates();\r\n            },\r\n\r\n            updateLayout: function () {\r\n                var ctrl = this;\r\n                ctrl.checkAllStates();\r\n            },\r\n\r\n            dispose: function () {\r\n                WinJS.Utilities.disposeSubTree(this.element);\r\n                this.element = null;\r\n            }\r\n        }),\r\n\t\tWinJS.Utilities.eventMixin,\r\n\t\tWinJS.Utilities.createEventProperties(\"myevent\"))\r\n    });\r\n})();"],"sourceRoot":" "}