{"version":3,"sources":["../scripts/winjscontrib/js/winjscontrib.ui.webcomponents.js","../scripts/winjscontrib/js/winjscontrib.winrt.core.js","../scripts/winjscontrib/js/winjscontrib.winrt.upnp.js","../scripts/winjscontrib/js/winjscontrib.bindings.js","../scripts/winjscontrib/js/winjscontrib.date.utils.js","../scripts/winjscontrib/js/winjscontrib.messenger.js","../scripts/winjscontrib/js/winjscontrib.datacontainer.winrt.file.js","../scripts/winjscontrib/js/winjscontrib.ui.jquery.js","../scripts/winjscontrib/js/winjscontrib.ui.dataform.js","../scripts/winjscontrib/js/winjscontrib.ui.navigator.js","../scripts/winjscontrib/js/winjscontrib.ui.animation.js","../scripts/winjscontrib/js/winjscontrib.ui.elasticbutton.js","../scripts/winjscontrib/js/winjscontrib.ui.fowrapper.js","../scripts/winjscontrib/js/winjscontrib.ui.multipass-renderer.js","../scripts/winjscontrib/js/winjscontrib.ui.grid.js","../scripts/winjscontrib/js/winjscontrib.ui.aspectratio.js","../scripts/winjscontrib/js/winjscontrib.ui.visualstate.js"],"names":["WinJSContrib","UI","WebComponents","global","inspect","node","customElement","ctrlName","nodeName","promises","attributes","getAttribute","registered","toUpperCase","mcnComponent","push","createElement","msParentSelectorScope","winControl","pageLifeCycle","observer","i","l","childNodes","length","WinJS","Promise","join","observeMutations","element","polyfill","MutationObserver","mutations","forEach","mutation","addedNodes","observe","childList","subtree","definition","scope","Utils","getScopeControl","p","wrap","process","getControlInstance","ctor","steps","render","attach","setAttribute","name","val","call","this","constructor","mcnWebComponent","map","ctx","control","property","data","applyAttribute","options","dataset","winOptions","getWinJSOptions","optionsCallback","ctrl","applyAll","applyMapping","tagname","mapping","contextData","item","attrcontext","attrvalue","context","attribute","type","resolveValue","resolve","applyValue","writeProperty","properties","events","controls","ctKey","controlDefinition","mapKey","key","controlmap","elt","optionsParser","window","select","Utilities","markSupportedForProcessing","text","parent","querySelector","document","registerElement","processAll","watch","register","override","existing","proto","Object","create","HTMLElement","prototype","createdCallback","attachedCallback","attributeChangedCallback","attrName","oldValue","newValue","Binding","Template","AppBar","AutoSuggestBox","BackButton","ContentDialog","DatePicker","FlipView","Flyout","Hub","HubSection","ItemContainer","ListView","Menu","Pivot","PivotItem","Rating","Repeater","SearchBox","SemanticZoom","SplitView","TimePicker","ToggleSwitch","ToolBar","Tooltip","ViewBox","WinRT","readProtocol","args","detail","kind","Windows","ApplicationModel","Activation","ActivationKind","protocol","uri","navArgs","action","undefined","protocolArgs","queryargs","query","substr","split","arg","decodeURIComponent","host","isConnected","nlvl","Networking","Connectivity","NetworkConnectivityLevel","profile","NetworkInformation","getInternetConnectionProfile","level","getNetworkConnectivityLevel","constrainedInternetAccess","internetAccess","hasInternetAccess","onInternetStatusChanged","callback","handler","network","addEventListener","removeEventListener","Alerts","messageBox","opt","_global","md","Popups","MessageDialog","content","title","commands","command","index","cmd","UICommand","id","label","invoked","append","isDefault","defaultCommandIndex","showAsync","complete","error","navigator","notification","confirm","res","c","then","wrapError","message","yes","no","e","toastNotification","notifications","Notifications","template","picture","ToastTemplateType","toastImageAndText01","toastText01","toastXml","ToastNotificationManager","getTemplateContent","toastTextElements","getElementsByTagName","toastImageElements","launch","toastElements","JSON","stringify","appendChild","createTextNode","text2","text3","toast","ToastNotification","toastNotifier","createToastNotifier","show","UPnP","endsWith","search","indexOf","xmlToJson","xml","obj","nodeType","j","nodeValue","hasChildNodes","tmp","colonIdx","clearNode","old","trim","parseXML","DOMParser","parseFromString","toHex","n","result","start","digit","hextab","pad","str","len","ntos","toString","unescape","htoa","replace","RegExp","nextchar","charAt","parseInt","atoh","charCodeAt","expandExponential","x","s","f","Math","abs","z","Array","r","deviceTypes","ContentDirectory1","ContentDirectory2","ContentDirectory3","ContentDirectory4","MediaRenderer1","MediaRenderer2","MediaRenderer3","MediaRenderer4","MediaServer1","MediaServer2","MediaServer3","MediaServer4","AVTransport1","AVTransport2","ConnectionManager1","ConnectionManager2","ConnectionManager3","devicesDiscovery","filter","timeout","exists","url","matches","devices","d","deviceDescriptionUrl","discover","onsuccess","err","clientSocket","close","ex","onerror","Sockets","DatagramSocket","onmessagereceived","reader","getDataReader","count","unconsumedBufferLength","readString","completed","items","toLowerCase","xhr","rawdevice","responseXML","device","root","rootUrl","UPnPDevice","console","getOutputStreamAsync","hostName","outputStream","writer","Storage","Streams","DataWriter","unicodeEncoding","UnicodeEncoding","Utf8","writeString","storeAsync","discovery","hasError","HostName","List","promise","getContentType","extension","lowerUrl","deviceObj","getService","serviceType","service","serviceList","deviceList","childdevice","childService","controlURL","getAVTransport","UPnPAVTransport","getContentDirectory","UPnPContentDirectory","getConnectionManager","UPnPConnectionManager","UPnPService","serviceObj","opts","debug","svc","svcType","svcUrl","self","upnpAction","upnpParameters","promiseComplete","promiseError","response","svcMsg","createRequest","sendRequest","xmlResponse","apply","handleResponse","upnpResponse","requestTemplate","types","i1","allowedValues","toNative","i8","Int8Array","checkAllowedValues","i2","i16","Int16Array","i4","i32","Int32Array","ui1","ui8","Uint8Array","ui2","ui16","Uint16Array","ui4","ui32","Uint32Array","int","isNaN","r4","f32","Float32Array","r8","f64","Float64Array","number","fixed_14_4","float","_float","parseFloat","char","string","xmlObj","currentPos","idx","exception","date","dateTime","Date","parseDate","toISOString","dateTime_tz","time","time_tz","boolean","bin_base64","atob","btoa","bin_hex","decodeURI","uuid","_name","upnpServiceType","upnpActionName","parameters","formatParameters","debugLog","encodeXML","svcInParams","svcInParams_xml","svcParam","typeCheck","upnpEndpointURL","upnpRequestXML","onUPnPResponse","soapaction","httpClient","Web","Http","HttpClient","Foundation","Uri","request","HttpRequestMessage","HttpMethod","post","headers","HttpStringContent","utf8","sendRequestAsync","readAsStringAsync","status","responseText","UPnPError","upnpResponseXML","onUPnPResolved","svcOutParams","responseJSON","responseContainer","responseVars","varName","varVal","firstChild","decodeXML","formatParameter","parameter","param","value","processParam","allowedValueList","matchFound","msg","description","b64chars","b64tab","bin","t","cb_encode","ccc","padlen","ord","chars","cb_decode","cccc","String","fromCharCode","b","a","hexChars","timestamp","struct","minutesOffset","numericKeys","exec","slice","k","UTC","parse","NaN","allowedContentDirectoryTypes","urn:schemas-upnp-org:service:ContentDirectory:1","urn:schemas-upnp-org:service:ContentDirectory:2","urn:schemas-upnp-org:service:ContentDirectory:3","urn:schemas-upnp-org:service:ContentDirectory:4","upnpType","getSystemUpdateId","Id","getSearchCapabilities","SearchCaps","getSortCapabilities","SortCaps","browse","objectId","browseFlag","startingIndex","requestedCount","sortCriteria","ObjectID","BrowseFlag","Filter","StartingIndex","RequestedCount","SortCriteria","Result","NumberReturned","TotalMatches","UpdateID","allowedConnectionManagerTypes","urn:schemas-upnp-org:service:ConnectionManager:1","urn:schemas-upnp-org:service:ConnectionManager:2","urn:schemas-upnp-org:service:ConnectionManager:3","getCurrentConnectionIDs","ConnectionIDs","getCurrentConnectionInfo","connectionId","ConnectionID","RcsID","AVTransportID","ProtocolInfo","PeerConnectionManager","PeerConnectionID","Direction","Status","getProtocolInfo","Source","Sink","allowedAVTransportTypes","urn:schemas-upnp-org:service:AVTransport:1","urn:schemas-upnp-org:service:AVTransport:2","getDeviceCapabilities","instanceId","InstanceID","PlayMedia","RecMedia","RecQualityModes","getMediaInfo","NrTracks","MediaDuration","CurrentURI","CurrentURIMetaData","NextURI","NextURIMetaData","PlayMedium","RecordMedium","WriteStatus","getPositionInfo","Track","TrackDuration","TrackMetaData","TrackURI","RelTime","AbsTime","RelCount","AbsCount","getTransportInfo","CurrentTransportState","CurrentTransportStatus","CurrentSpeed","getTransportSettings","PlayMode","RecQualityMode","setAVTransportURI","currentURI","currentURIMetaData","play","speed","Speed","pause","stop","next","previous","seek","unit","target","Unit","Target","allowedRenderingControlTypes","urn:schemas-upnp-org:service:RenderingControl:1","urn:schemas-upnp-org:service:RenderingControl:2","urn:schemas-upnp-org:service:RenderingControl:3","UPnPRenderingControl","listPresets","InstanceId","CurrentPresetNameList","selectPreset","presetName","PresetName","getBrightness","CurrentBrightness","setBrightness","desiredBrightness","DesiredBrightness","getContrast","CurrentContrast","setContrast","desiredContrast","DesiredContrast","getSharpness","CurrentSharpness","setSharpness","desiredSharpness","DesiredSharpness","getRedVideoGain","CurrentRedVideoGain","setRedVideoGain","desiredRedVideoGain","DesiredRedVideoGain","getGreenVideoGain","CurrentGreenVideoGain","setGreenVideoGain","desiredGreenVideoGain","DesiredGreenVideoGain","getBlueVideoGain","CurrentBlueVideoGain","setBlueVideoGain","desiredBlueVideoGain","DesiredBlueVideoGain","getRedVideoBlackLevel","CurrentRedVideoBlackLevel","setRedVideoBlackLevel","desiredRedVideoBlackLevel","DesiredRedVideoBlackLevel","getGreenVideoBlackLevel","CurrentGreenVideoBlackLevel","setGreenVideoBlackLevel","desiredGreenVideoBlackLevel","DesiredGreenVideoBlackLevel","getBlueVideoBlackLevel","CurrentBlueVideoBlackLevel","setBlueVideoBlackLevel","desiredBlueVideoBlackLevel","DesiredBlueVideoBlackLevel","getColorTemperature","CurrentColorTemperature","setColorTemperature","desiredColorTemperature","DesiredColorTemperature","getHorizontalKeystone","CurrentHorizontalKeystone","setHorizontalKeystone","desiredHorizontalKeystone","DesiredHorizontalKeystone","getVerticalKeystone","CurrentVerticalKeystone","setVerticalKeystone","desiredVerticalKeystone","DesiredVerticalKeystone","getMute","channel","Channel","CurrentMute","setMute","desiredMute","DesiredMute","getVolume","CurrentVolume","setVolume","desiredVolume","DesiredVolume","getVolumeDB","setVolumeDB","getVolumeDBRange","MinValue","MaxValue","getLoudness","CurrentLoudness","setLoudness","desiredLoudness","DesiredLoudness","getStateVariables","stateVariableList","StateVariableList","StateVariableValuePairs","setStateVariables","renderingControlUDN","serviceId","stateVariableValuePairs","RenderingControlUDN","ServiceType","ServiceId","getAllowedTransforms","CurrentAllowedTransformSettings","getTransforms","CurrentTransformValues","setTransforms","desiredTransformValues","DesiredTransformValues","getAllAvailableTransforms","AllAllowedTransformSettings","getAllowedDefaultTransforms","AllowedDefaultTransformSettings","getDefaultTransforms","CurrentDefaultTransformSettings","setDefaultTransforms","desiredDefaultTransformSettings","DesiredDefaultTransformSettings","Bindings","_setPic","dest","src","style","backgroundImage","classList","add","pictureUnavailable","bindingArguments","argname","_optionsParser","winBindArgs","removeHTML","initializer","source","sourceProperty","destProperty","readProperty","innerHTML","oneTime","innerText","removeHTMLAndEllipsisize","textRes","size","toStaticHTML","ellipsisizeString","staticHTML","dataAttr","addClass","setClass","newval","oldval","remove","format","bindingDesc","bind","asClass","toBgImage","setImage","ToRealDate","toLocaleDateString","setTimeout","loadImage","done","toSmartBgImage","showIf","setVisibility","opacity","visibility","display","hideIfNot","hideIfNotDefined","hideIf","showIfNot","showIfNotDefined","enableIf","disabled","disableIfNot","disableIf","enableIfNot","toWidth","setWidth","width","ellipsisize","sourcedata","toEllipsisized","emptyIfNull","twoWayOnChange","setVal","getVal","getProperty","propValue","dispose","cleanUpBindingList","bindingList","unwrappedItem","unwrap","daysSince","m","y","myDate","yourDate","secondsInADay","diff","floor","getTime","formatDate","setDate","moment","calendar","daysSinceDate","getMonth","getDate","getFullYear","fromdate","humanizeDate","addSuffix","duration","humanize","Messenger","receiver","sender","messenger","isWorker","_pendings","_receiver","_sender","_bindedProcessEvent","_processEvent","Class","mix","eventMixin","SmartWorkerPath","SmartWorker","path","Worker","w","_send","postMessage","importScripts","scriptPaths","_doImportScripts","execute","func","arguments","_runFunction","functionArgs","eval","messengerFunction","object","functions","eventName","asArgs","wrapper","guid","progress","event","warn","cleanUp","details","current","cancel","as","stack","dispatchEvent","terminate","__global","DataContainer","toJSONFileName","fileName","encodeURIComponent","deleteItemIfExistsAsync","folder","itemName","logger","getItemAsync","deleteAsync","getFileContentAsJSONAsync","file","encrypted","FileIO","readBufferAsync","cypheredText","provider","Security","Cryptography","DataProtection","DataProtectionProvider","unprotectAsync","unprotectedData","rawText","CryptographicBuffer","convertBinaryToString","BinaryStringEncoding","readFileAsync","creationCollisionOption","retry","containerLogger","readComplete","readError","CreationCollisionOption","openIfExists","filename","getFileAsync","verbose","setImmediate","info","writeFileAsync","objectGraph","encrypt","writeComplete","writeError","manageError","replaceExisting","bufferedText","convertStringToBinary","filePromise","createFileAsync","protectionPromise","protectAsync","protectedData","writeBufferAsync","Logs","getLogger","WinRTFilesContainer","container","folderPromise","useDataCache","dataCache","childs","parentfolder","createFolderAsync","ApplicationData","localFolder","makeCurrent","read","itemkey","clone","save","listKeys","getFilesAsync","files","ext","list","child","childWithTransaction","winrtfolder","renameAsync","NameCollisionOption","deleteContainer","clearAllCache","clearCache","clearDataCache","hasOwnProperty","HSL","hVal","sVal","lVal","h","addH","increment","addS","addL","hInc","sInc","lInc","$","fn","jQuery","tap","each","untap","hatchShow","css","hasClass","pw","fsize","fontSize","hide","fadeIn","pressEnterDefaultTo","eltSelector","$this","keypress","which","keyCode","$elt","blur","preventDefault","stopPropagation","mcnTapTracking","focus","click","onPressEnter","throttleTextChanged","throttling","lastval","keydown","clearTimeout","mcnTxtThrottling","transitionProperties","delay","targetValueCallback","that","toWinJSPromise","renderWith","templateSelector","get","children","renderWithEach","objectArray","itemCallback","templatedElt","scrollInView","offset","animate","viewState","ViewManagement","ApplicationView","horizontal","ApplicationViewState","snapped","fullScreenPortrait","offsetParent","scrollLeft","offsetLeft","scrollTop","offsetTop","scrollInParentView","loadedPromises","onloaded","currentTarget","naturalWidth","whenLoaded","afterTransition","currentElement","prom","onaftertransition","srcElement","timeOutRef","success","resultPromise","afterAnimation","ontransition","classBasedAnimation","classname","removeClass","DataFormState","define","_initObservable","mixin","expandProperties","isValid","updated","Namespace","DataForm","groups","messages","rules","state","allowTooltip","workOnCopy","tooltipDelay","tooltipPosition","tooltipTheme","initValidator","mcnDataForm","CrossPlatform","crossPlatformClass","setOptions","_messages","set","_rules","_groups","dataform","extend","refItem","validator","resetForm","autobindFields","tooltips","form","checkState","fieldElt","srcProperty","destFieldType","DataFormBinding","nbInvalids","numberOfInvalids","validate","submitHandler","invalidHandler","errorPlacement","$e","tooltipster","trigger","onlyOne","position","theme","lastError","newError","tooltipsterValidationTimeout","disposeSubTree","DefaultBindingOptions","trimText","convertEmptyToNull","Converters","none","fromObject","fromInput","stringifiedObject","DOMEventMixin","createEventProperties","parentDataForm","parentNode","updateInputFromObject","converter","updateObjectFromInput","fieldUpdated","validateObjectOnBlur","optionsText","inputType","inputOption","eventAdded","appView","nav","Navigation","defaultExitPageAnimation","Animation","exitPage","defaultEnterPageAnimation","enterPage","parentNavigator","mcnNavigator","PageControlNavigator","eventTracker","EventTracker","disableHistory","animationWaitForPreviousPageClose","animations","locks","enterPageAnimation","resolveMethod","exitPageAnimation","home","_lastViewstate","body","onkeyup","_keyupHandler","onkeypress","_keypressHandler","onmspointerup","_mspointerupHandler","Application","addEvent","_beforeNavigate","_navigated","systemNavigationManager","enableSystemBackButton","Core","SystemNavigationManager","getForCurrentView","canGoBack","back","handled","navigationEvents","addNavigationEvents","_history","backstack","resizeHandler","cancelAnimationFrame","requestAnimationFrame","_resized","_lastNavigationPromise","pageControl","pageElement","_pageElement","lastElementChild","history","addLock","removeLock","_createPageElement","getComputedStyle","direction","_disposed","removeNavigationEvents","_checkBackNavigation","currentPage","check","canClose","is","registerNavigationEvents","_getAnimationElements","isExit","getAnimationElements","altKey","button","forward","navigate","location","initialState","skipHistory","isback","stacked","navigateStacked","setPromise","pagePromise","splice","clearHistory","backStack","closeAllPages","pages","page","contains","removeChild","clear","open","pick","_handleStackedBack","isStacked","stackNavigation","previousPage","closePage","_updateBackButton","navactivate","distance","pageindex","navlocation","navstate","openStacked","navigationState","completeCallback","triggerPageExit","mcnNavigationDetails","navdeactivate","exitPagePromise","hidepage","exitPageResult","layoutCtrls","querySelectorAll","pageElementToClose","oldElement","untapAll","oldPageExitPromise","youpla","cancelPromises","stackedOn","stackedBy","unload","parentElement","log","pagecontainer","oldPage","closeOldPagePromise","parentedComplete","currentPageDetails","openNewPagePromise","Pages","renderFragment","getFragmentElement","fragmentInjector","oninit","mcnPage","renderComplete","onrender","clearNavigationHistory","appViewBackButtonVisibility","AppViewBackButtonVisibility","collapsed","onready","layoutProcess","vw","__checkLayout","updateLayout","_handleBack","visible","backButtons","clearNav","btn","onclick","ENTERPAGEANIMATION","EXITPAGEANIMATION","getOpt","fadeOut","elements","staggerDelay","itemdelay","maxdelay","timing","easing","to","executeTransition","initialDelay","extraDelay","delayFactor","delayCap","ret","min","pageExit","stagger","animationParams","keyframe","equivalents","transform","cssName","promise1","executeAnimation","promise2","slideAnim","keyframeName","isIn","Easings","easeInQuad","easeOutQuad","transitionParams","from","slideFromBottom","slideFromTop","slideFromLeft","slideFromRight","slideToBottom","slideToTop","slideToLeft","slideToRight","tabExitPage","tabEnterPage","exitGrow","exagerated","dur","easeInQuint","exitShrink","shrinkAndFall","enterShrink","easeOutQuint","enterGrow","easeInCubic","easeInQuart","easeInSine","easeInExpo","easeInCirc","easeInBack","easeOutCubic","easeOutQuart","easeOutSine","easeOutExpo","easeOutCirc","easeOutBack","easeInOutQuad","easeInOutCubic","easeInOutQuart","easeInOutQuint","easeInOutSine","easeInOutExpo","easeInOutCirc","easeInOutBack","_browserStyleEquivalents","elasticbuttonkinds","rectangle","morphpath","svg","roundedrectangle","round","ElasticButton","behavior","reset","active","mina","elastic","easein","_kind","contentCreated","contentElement","className","moveChilds","bgElement","currentKind","snap","Snap","pathEl","paths","attr","_ptdown","_ptup","FOWrapper","someProperty","_someProperty","wrapperId","height","blurFilter","sblurFilter","blurTo","stdDeviation","easeout","MultiPassRenderer","_scrollProcessor","_tolerance","_virtualize","_scrollContainer","scrollContainer","_multipass","multipass","_orientation","orientation","itemClassName","itemClass","itemTemplate","getTemplate","itemInvoked","onitemContent","_onScrollBinded","_onScroll","_unregisterScrollEvents","rect","refreshScrollEvents","tolerance","virtualize","_registerScrollEvents","_scrollRequest","checkRendering","clearOffsets","_checkSection","_vIsInView","_checkItem","_hIsInView","pxTolerance","clientHeight","clientWidth","noRender","offsetFrom","renderItemsContent","onrendersection","rendered","empty","allRendered","prepareItems","renderOptions","onitemInit","registereditems","itemdata","MultiPassItem","renderItems","renderer","itemDataPromise","itemData","delayed","_renderContent","_renderItemContent","GridControl","grid","layouts","defaultLayout","layout","itemsPerColumn","itemsPerRow","cellSpace","cellWidth","cellHeight","autolayout","elementReady","readyComplete","_autolayout","gridLayouts","getParentControlByClass","resetElement","isItem","minWidth","minHeight","left","top","clearContent","clearLayout","fill","matrix","col","fit","maxW","maxH","firstFit","numItems","visibleChilds","st","GridLayoutsImpl","flexhorizontal","flexFlow","alignContent","_itemsPerColumn","visibleitems","columns","ceil","flexvertical","hbloc","_containerH","cellW","space","colCount","colOffset","topOffset","eltH","cellH","ratioW","ratioH","gridCellsMatrix","eltW","offsetWidth","offsetHeight","eltColumns","eltRows","pos","elementWidth","vertical","plugin","_containerW","_itemsPerLine","elementHeight","oldlayout","getLayout","layoutChanged","layoutfunc","changeLayout","applyed","lastViewState","matchingLayout","mq","matchMedia","AspectRatio","baseWidth","_baseWidth","baseWidthMin","_baseWidthMin","baseWidthMargin","_baseWidthMargin","baseHeight","_baseHeight","baseHeightMin","_baseHeightMin","baseHeightMargin","_baseHeightMargin","ratio","_ratio","basedOn","_basedOn","_target","styleElt","pageLayout","parentpage","updateLayoutBasedOnHeight","updateLayoutBasedOnWidth","prefix","nbitems","itemW","targetH","max","itemH","targetW","VisualState","states","_states","checkAllStates","evaluate","wGt","wLt","hGt","hLt"],"mappings":"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","file":"winjscontrib-custom.js","sourcesContent":["/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/*\r\nWARNING: this feature is experimental\r\nYou must add winjscontrib.core.js before this file\r\n*/\r\n\r\n/// <reference path=\"winjscontrib.core.js\" />\r\nvar WinJSContrib = WinJSContrib || {};\r\nWinJSContrib.UI = WinJSContrib.UI || {};\r\n\r\n/**\r\n * @namespace\r\n */\r\nWinJSContrib.UI.WebComponents = WinJSContrib.UI.WebComponents || {};\r\n\r\n(function (global) {\r\n\t'use strict';\r\n\tvar registered = {};\r\n\tWinJSContrib.UI.WebComponents.registered = registered;\r\n\tWinJSContrib.UI.WebComponents.polyfill = false;\r\n\r\n\tif (!global.document.registerElement && global.MutationObserver) {\r\n\t\tWinJSContrib.UI.WebComponents.polyfill = true;\r\n\t}\r\n\r\n\tfunction inspect(node) {\r\n\t\tvar customElement = null;\r\n\t\tvar ctrlName = node.nodeName;\r\n\t\tvar promises = [];\r\n\r\n\t\tif (node.nodeName !== '#text') {\r\n\t\t\tif (node.attributes) {\r\n\t\t\t\tvar ctrlName = node.getAttribute(\"is\");\r\n\t\t\t\tif (ctrlName) {\r\n\t\t\t\t\t//we uppercase because node names are uppercase\r\n\t\t\t\t\tcustomElement = registered[ctrlName.toUpperCase()];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!customElement && node.nodeName !== 'DIV' && node.nodeName !== 'SPAN') {\r\n\t\t\t\tcustomElement = registered[node.nodeName];\r\n\t\t\t}\r\n\r\n\t\t\tif (customElement && !node.mcnComponent) {\r\n\t\t\t\t//createElement(node, customElement);\r\n\t\t\t\tpromises.push(createElement(node, customElement));\r\n\t\t\t}\r\n\r\n\t\t\tif (node.msParentSelectorScope && node.winControl && node.winControl.pageLifeCycle && node.winControl.pageLifeCycle.observer) {\r\n\t\t\t\t//element is a fragment with its own mutation observer, no need to inspect childs\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t//if (node.nodeName === 'WIN-TEMPLATE') {\r\n\t\t\t//    return;\r\n\t\t\t//}\r\n\r\n\t\t\tfor (var i = 0, l = node.childNodes.length; i < l; i++) {\r\n\t\t\t\tpromises.push(inspect(node.childNodes[i]));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn WinJS.Promise.join(promises);\r\n\t}\r\n\r\n\t/**\r\n\t * inspect current DOM element and create webcomponents found on that element and on its child.\r\n\t * @function\r\n\t * @param {HTMLElement} element DOM element to inspect\r\n\t */\r\n\tWinJSContrib.UI.WebComponents.processAll = function (element) { };\r\n\tif (WinJSContrib.UI.WebComponents.polyfill) {\r\n\t\tWinJSContrib.UI.WebComponents.processAll = inspect;\r\n\t}\r\n\r\n\tfunction observeMutations(element) {\r\n\t\tvar observer = null;\r\n\t\tif (WinJSContrib.UI.WebComponents.polyfill) {\r\n\t\t\tobserver = new MutationObserver(function (mutations) {\r\n\t\t\t\t//console.time('check mutation');\r\n\t\t\t\tmutations.forEach(function (mutation) {\r\n\t\t\t\t\tif (mutation.addedNodes.length) {\r\n\t\t\t\t\t\tfor (var i = 0, l = mutation.addedNodes.length; i < l ; i++) {\r\n\t\t\t\t\t\t\tinspect(mutation.addedNodes[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t//console.timeEnd('check mutation');\r\n\t\t\t});\r\n\r\n\t\t\tobserver.observe(element, { childList: true, subtree: true });\r\n\t\t}\r\n\r\n\t\treturn observer;\r\n\t}\r\n\tWinJSContrib.UI.WebComponents.watch = observeMutations;\r\n\r\n\tfunction createElement(element, definition) {\r\n\t\tvar ctrl = element.winControl;\r\n\t\telement.mcnComponent = true;\r\n\t\tvar scope = WinJSContrib.Utils.getScopeControl(element);\r\n\t\tvar p = WinJS.Promise.wrap();\r\n\t\tvar process = function () {\r\n\t\t\tgetControlInstance(definition.ctor, element);\r\n\t\t}\r\n\r\n\t\tif (scope && scope.pageLifeCycle) {\r\n\t\t\t//if the component is owned by a page/fragment, we process the control according to page lifecycle\r\n\t\t\tp = scope.pageLifeCycle.steps.render.attach(process);\r\n\t\t} else {\r\n\t\t\tprocess();\r\n\t\t}\r\n\r\n\t\t//put a proxy on setAttribute to detect changes in attributes\r\n\t\tvar setAttribute = element.setAttribute;\r\n\t\telement.setAttribute = function (name, val) {\r\n\t\t\tif (element.winControl) {\r\n\t\t\t\tsetAttribute.call(this, name, val);\r\n\t\t\t\tvar definition = element.winControl.constructor.mcnWebComponent;\r\n\t\t\t\tif (definition) {\r\n\t\t\t\t\tvar map = definition[name.toUpperCase()];\r\n\t\t\t\t\tif (map) {\r\n\t\t\t\t\t\tvar ctx = { control: element.winControl, name: map.property, data: {} }\r\n\t\t\t\t\t\tdefinition.applyAttribute(name, this, ctx);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn p;\r\n\t}\r\n\r\n\tfunction getControlInstance(ctor, element) {\r\n\t\telement.mcnComponent = true;\r\n\t\tvar definition = ctor.mcnWebComponent;\r\n\t\t//console.time('building ' + definition.name);\r\n\t\tvar options = {};\r\n\t\tif (element.dataset.winOptions) {\r\n\t\t\toptions = getWinJSOptions(element);\r\n\t\t}\r\n\r\n\t\tif (definition && definition.optionsCallback) {\r\n\t\t\toptions = definition.optionsCallback(element, options, scope);\r\n\t\t}\r\n\r\n\t\tvar ctrl = new ctor(element, options);\r\n\t\telement.winControl = ctrl;\r\n\t\tif (definition) {\r\n\t\t\tdefinition.applyAll(element);\r\n\t\t}\r\n\t\t//console.timeEnd('building ' + definition.name);\t\t\r\n\t}\r\n\r\n\tfunction applyMapping(tagname, ctor, mapping) {\r\n\t\tif (typeof mapping == 'function')\r\n\t\t\treturn;\r\n\t\tmapping = mapping || {};\r\n\r\n\t\tctor.mcnWebComponent = {\r\n\t\t\tname: tagname,\r\n\t\t\tmap: mapping.map || {},\r\n\t\t\toptionsCallback: mapping.optionsCallback,\r\n\t\t\tapplyAll: function (element) {\r\n\t\t\t\tvar contextData = {};\r\n\t\t\t\tfor (var item in this.map) {\r\n\t\t\t\t\tvar attrcontext = { control: element.winControl, name: this.map[item].property, data: contextData };\r\n\t\t\t\t\tthis.applyAttribute(item, element, null, attrcontext);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tapplyAttribute: function (name, element, attrvalue, context) {\r\n\t\t\t\tvar map = this.map[name.toUpperCase()];\r\n\t\t\t\tif (map) {\r\n\t\t\t\t\tvar val = attrvalue || element.getAttribute(map.attribute);\r\n\t\t\t\t\tvar ctrl = element.winControl;\r\n\t\t\t\t\tif (val && ctrl) {\r\n\t\t\t\t\t\tif (!map.type || map.type === 'property') {\r\n\t\t\t\t\t\t\tif (map.resolve) {\r\n\t\t\t\t\t\t\t\tWinJSContrib.Utils.applyValue(element, val, ctrl, map.property, context);\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tWinJSContrib.Utils.writeProperty(ctrl, map.property, val);\r\n\t\t\t\t\t\t} else if (map.type === 'event') {\r\n\t\t\t\t\t\t\tWinJSContrib.Utils.resolveValue(element, val, context);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (mapping.properties) {\r\n\t\t\tmapping.properties.forEach(function (p) {\r\n\t\t\t\tif (p) {\r\n\t\t\t\t\tctor.mcnWebComponent.map[p.toUpperCase()] = { attribute: p, property: p, resolve: true, type: 'property' };\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (mapping.events) {\r\n\t\t\tmapping.events.forEach(function (p) {\r\n\t\t\t\tif (p) {\r\n\t\t\t\t\tctor.mcnWebComponent.map[p.toUpperCase()] = { attribute: p, property: p, resolve: true, type: 'event' };\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (mapping.controls) {\r\n\t\t\tfor (var ctKey in mapping.controls) {\r\n\t\t\t\tvar control = mapping.controls[ctKey];\r\n\t\t\t\tvar controlDefinition = control.mcnWebComponent;\r\n\t\t\t\tfor (var mapKey in controlDefinition.map) {\r\n\t\t\t\t\tvar key = ctKey + '.' + mapKey;\r\n\t\t\t\t\tvar controlmap = controlDefinition.map[mapKey];\r\n\t\t\t\t\tctor.mcnWebComponent.map[key.toUpperCase()] = {\r\n\t\t\t\t\t\tattribute: ctKey + '.' + controlmap.attribute,\r\n\t\t\t\t\t\tproperty: ctKey + '.' + controlmap.property,\r\n\t\t\t\t\t\tresolve: controlmap.resolve\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t* Register a control to be used as a webcomponent. If a tagname has already been registered, \r\n\t* the function will throw an error unless you specify the override flag\r\n\t* @function\r\n\t* @param {string} tagname name for DOM element for the component\r\n\t* @param {function} ctor constructor for the WinJS control\r\n\t* @param {Object} mapping definition for mapping between control and DOM element\r\n\t* @param {boolean} override indicate that you want to override an existing component definition\r\n\t* @example\r\n\t* WinJSContrib.UI.WebComponents.register('mcn-semanticlistviews', WinJSContrib.UI.SemanticListViews, {\r\n\t*\tproperties: ['nameOfProperty'],\r\n\t*   events : ['nameOfEvent'],\r\n\t*\tcontrols: {\r\n\t*\t\t\"listview\": WinJS.UI.ListView,\r\n\t*\t\t\"zoomedOutListview\": WinJS.UI.ListView,\r\n\t*\t\t\"semanticZoom\": WinJS.UI.SemanticZoom\r\n\t*\t},\r\n\t*\tmap: {\r\n\t*\t\t\"DEFAULTGROUPLIMIT\": { attribute: 'defaultGroupLimit', property: '_dataManager.defaultGroupLimit', resolve: true },\r\n\t*\t\t\"GROUPKIND\": { attribute: 'groupKind', property: '_dataManager.groupKind', resolve: true },\r\n\t*\t\t\"FIELD\": { attribute: 'field', property: '_dataManager.field', resolve: true },\r\n\t*\t\t\"ITEMS\": { attribute: 'items', property: '_dataManager.items', resolve: true },\r\n\t*\t}\r\n\t*});\r\n\t*/\r\n\tWinJSContrib.UI.WebComponents.register = function register(tagname, ctor, mapping, override) {\r\n\t\tvar existing = registered[tagname.toUpperCase()];\r\n\t\tif (existing && !override) {\r\n\t\t\tthrow 'component ' + tagname + ' already exists';\r\n\t\t}\r\n\r\n\t\tapplyMapping(tagname, ctor, mapping);\r\n\r\n\t\tif (WinJSContrib.UI.WebComponents.polyfill) {\r\n\t\t\tglobal.document.createElement(tagname);\r\n\t\t\t//we uppercase because node names are uppercase\r\n\t\t\tregistered[tagname.toUpperCase()] = { ctor: ctor };\r\n\t\t} else if (global.document.registerElement) {\r\n\t\t\t//register component with \"real\" webcomponent\r\n\t\t\tvar proto = Object.create(HTMLElement.prototype);\r\n\t\t\tproto.createdCallback = function () {\r\n\t\t\t}\r\n\r\n\t\t\tproto.attachedCallback = function () {\r\n\t\t\t\tvar element = this;\r\n\t\t\t\tvar scope = WinJSContrib.Utils.getScopeControl(element);\r\n\t\t\t\tvar process = function () {\r\n\t\t\t\t\tgetControlInstance(ctor, element);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (scope && scope.pageLifeCycle) {\r\n\t\t\t\t\t//if the component is owned by a page/fragment, we process the control according to page lifecycle\r\n\t\t\t\t    scope.pageLifeCycle.steps.render.attach(process);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tprocess();\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t};\r\n\r\n\t\t\tproto.attributeChangedCallback = function (attrName, oldValue, newValue) {\r\n\t\t\t\tvar element = this;\r\n\t\t\t\tif (element.winControl) {\r\n\t\t\t\t\tvar definition = element.winControl.constructor.mcnWebComponent;\r\n\t\t\t\t\tif (definition) {\r\n\t\t\t\t\t\tvar map = definition.map[attrName.toUpperCase()];\r\n\t\t\t\t\t\tif (map) {\r\n\t\t\t\t\t\t\tdefinition.applyAttribute(attrName, element, newValue, { control: element.winControl, name: map.property, data: {} });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t};\r\n\r\n\t\t\tglobal.document.registerElement(tagname, { prototype: proto });\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getWinJSOptions(elt) {\r\n\t\treturn WinJS.UI.optionsParser(elt.dataset.winOptions, window, {\r\n\t\t\tselect: WinJS.Utilities.markSupportedForProcessing(function (text) {\r\n\t\t\t\tvar parent = WinJSContrib.Utils.getScopeControl(elt);\r\n\t\t\t\tif (parent) {\r\n\t\t\t\t\treturn parent.element.querySelector(text);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn document.querySelector(text);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n\tif (WinJS.Binding && WinJS.Binding.Template) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-template', WinJS.Binding.Template, {\r\n\t\t\tproperties: ['extractChild']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.AppBar) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-appbar', WinJS.UI.AppBar, {\r\n\t\t\tproperties: ['closedDisplayMode', 'disabled', 'hidden', 'layout', 'placement', 'sticky', 'commands', \r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.AutoSuggestBox) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-autosuggestbox', WinJS.UI.AutoSuggestBox, {\r\n\t\t\tproperties: ['chooseSuggestionOnEnter', 'disabled', 'onquerychanged', 'onquerysubmitted', \r\n\t\t\t\t'onresultsuggestionchosen', 'onsuggestionsrequested', 'placeholderText', 'queryText', \r\n\t\t\t\t'searchHistoryContext', 'searchHistoryDisabled'],\r\n\t\t\tevents: ['querychanged', 'querysubmitted', 'resultsuggestionchosen', 'suggestionsrequested']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.BackButton) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-backbutton', WinJS.UI.BackButton);\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ContentDialog) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-contentdialog', WinJS.UI.ContentDialog, {\r\n\t\t\tproperties: ['hidden', 'primaryCommandDisabled', 'primaryCommandText', 'secondaryCommandDisabled',\r\n\t\t\t\t'secondaryCommandText', 'title', 'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.DatePicker) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-datepicker', WinJS.UI.DatePicker, {\r\n\t\t\tproperties: ['calendar', 'datePattern', 'disabled', 'maxYear', 'minYear', \r\n\t\t\t\t'monthPattern', 'yearPattern', 'onchange', 'current'],\r\n\t\t\tevents: ['change']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.FlipView) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-flipview', WinJS.UI.FlipView, {\r\n\t\t\tproperties: ['currentPage', 'orientation', 'itemTemplate', 'itemDataSource', 'itemSpacing', 'ondatasourcecountchanged', 'onpagevisibilitychanged', 'onpageselected', 'onpagecompleted'],\r\n\t\t\tevents: ['datasourcecountchanged', 'pagevisibilitychanged', 'pageselected', 'pagecompleted']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Flyout) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-flyout', WinJS.UI.Flyout, {\r\n\t\t\tproperties: ['alignment', 'anchor', 'disabled', 'hidden', 'placement', \r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Hub) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-hub', WinJS.UI.Hub, {\r\n\t\t\tproperties: ['headerTemplate', 'indexOfFirstVisible', 'indexOfLastVisible', 'loadingState', \r\n\t\t\t\t'oncontentanimating', 'onheaderinvoked', 'onloadingstatechanged', \r\n\t\t\t\t'orientation', 'scrollPosition', 'sectionOnScreen', 'sections', 'zoomableView'],\r\n\t\t\tevents: ['contentanimating', 'headerinvoked', 'loadingstatechanged']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.HubSection) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-hubsection', WinJS.UI.HubSection, {\r\n\t\t\tproperties: ['contentElement', 'header', 'isHeaderStatic']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ItemContainer) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-itemcontainer', WinJS.UI.ItemContainer, {\r\n\t\t\tproperties: ['draggable', 'oninvoked', 'onselectionchanged', 'onselectionchanging', 'selected', 'selectionDisabled', \r\n\t\t\t\t'swipeBehavior', 'swipeOrientation', 'tapBehavior'],\r\n\t\t\tevents: ['invoked', 'selectionchanged', 'selectionchanging']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ListView) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-listview', WinJS.UI.ListView, {\r\n\t\t\tproperties: [\r\n\t\t\t\t'itemTemplate', 'itemDataSource', 'itemsDraggable', 'itemsReorderable',\r\n\t\t\t\t'oniteminvoked', 'groupHeaderTemplate', 'groupDataSource', 'swipeBehavior',\r\n\t\t\t\t'selectBehavior', 'tapBehavior', 'header', 'footer'\r\n\t\t\t],\r\n\t\t\tevents: ['iteminvoked']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Menu) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-menu', WinJS.UI.Menu, {\r\n\t\t\tproperties: ['alignment', 'anchor', 'commands', 'disabled', 'hidden', 'placement', \r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Pivot) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-pivot', WinJS.UI.Pivot, {\r\n\t\t\tproperties: ['items', 'locked', 'onitemanimationend', 'onitemanimationstart', 'onselectionchanged', \r\n\t\t\t\t'selectedIndex', 'selectedItem', 'title'],\r\n\t\t\tevents: ['itemanimationend', 'itemanimationstart', 'selectionchanged']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.PivotItem) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-pivotitem', WinJS.UI.PivotItem, {\r\n\t\t\tproperties: ['contentElement', 'header']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Rating) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-rating', WinJS.UI.Rating, {\r\n\t\t\tproperties: ['averageRating', 'disabled', 'enableClear', 'maxRating', \r\n\t\t\t\t'oncancel', 'onchange', 'onpreviewchange', 'tooltipStrings', 'userRating'],\r\n\t\t\tevents: ['cancel', 'change', 'previewchange']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Repeater) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-repeater', WinJS.UI.Repeater, {\r\n\t\t\tproperties: ['data', 'length', 'onitemchanged', 'onitemchanging', 'oniteminserted', 'oniteminserting', \r\n\t\t\t\t'onitemmoved', 'onitemmoving', 'onitemremoved', 'onitemremoving', 'onitemsloaded', \r\n\t\t\t\t'onitemsreloaded', 'onitemsreloading', 'template'],\r\n\t\t\tevents: ['itemchanged', 'itemchanging', 'iteminserted', 'iteminserting',\r\n\t\t\t\t'itemmoved', 'itemmoving', 'itemremoved', 'itemremoving', 'itemsloaded',\r\n\t\t\t\t'itemsreloaded', 'itemsreloading']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.SearchBox) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-searchbox', WinJS.UI.SearchBox, {\r\n\t\t\tproperties: ['chooseSuggestionOnEnter', 'disabled', 'focusOnKeyboardInput', 'onquerychanged', 'onquerysubmitted', \r\n\t\t\t\t'onresultsuggestionchosen', 'onsuggestionsrequested', 'placeholderText', 'queryText', \r\n\t\t\t\t'searchHistoryContext', 'searchHistoryDisabled'],\r\n\t\t\tevents: ['querychanged', 'querysubmitted', 'resultsuggestionchosen', 'suggestionsrequested']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.SemanticZoom) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-semanticzoom', WinJS.UI.SemanticZoom, {\r\n\t\t\tproperties: ['enableButton', 'locked', 'onzoomchanged', 'zoomedInItem', 'zoomedOut', 'zoomedOutItem', 'zoomFactor'],\r\n\t\t\tevents: ['zoomchanged']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.SplitView) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-splitview', WinJS.UI.SplitView, {\r\n\t\t\tproperties: ['contentElement', 'hiddenDisplayMode', 'paneElement', 'paneHidden', 'panePlacement', 'shownDisplayMode',\r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.TimePicker) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-timepicker', WinJS.UI.TimePicker, {\r\n\t\t\tproperties: ['onchange', 'clock', 'current', 'disabled', 'hourPattern',\r\n\t\t\t\t'minuteIncrement', 'minutePattern', 'periodPattern'],\r\n\t\t\tevents: ['onchange']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ToggleSwitch) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-toggleswitch', WinJS.UI.ToggleSwitch, {\r\n\t\t\tproperties: ['onchange', 'checked', 'disabled', 'labelOff', 'labelOn', 'title'],\r\n\t\t\tevents: ['onchange']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ToolBar) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-toolbar', WinJS.UI.ToolBar);\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Tooltip) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-tooltip', WinJS.UI.Tooltip, {\r\n\t\t\tproperties: ['contentElement', 'extraClass', 'infotip', 'innerHTML', 'onbeforeclose', \r\n\t\t\t\t'onbeforeopen', 'onclosed', 'onopened', 'placement'],\r\n\t\t\tevents: ['beforeclose', 'beforeopen', 'closed', 'opened']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ViewBox) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-viewbox', WinJS.UI.ViewBox);\r\n\t}\r\n\r\n\r\n\t/*\r\n\t\t\t\tWinJS.UI.MenuCommand\r\n\t\t\t\tWinJS.UI.NavBar\r\n\t\t\t\tWinJS.UI.NavBarCommand\r\n\t\t\t\tWinJS.UI.NavBarContainer\r\n\t\t\t\tToolbar\r\n\t*/\r\n})(this);","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var WinRT;\n    (function (WinRT) {\n        /**\n         * read protocol arguments from application activation event arguments\n         * @function WinJSContrib.WinRT.readProtocol\n         * @param {Object} args WinJS application activation argument\n         * @returns {Object} protocol arguments\n         */\n        function readProtocol(args) {\n            if (args.detail.kind === Windows.ApplicationModel.Activation.ActivationKind.protocol && args.detail.uri) {\n                var navArgs = { action: undefined };\n                var protocolArgs = {};\n                var queryargs = args.detail.uri.query;\n                if (queryargs[0] == '?') {\n                    queryargs = queryargs.substr(1);\n                }\n                if (queryargs) {\n                    queryargs.split('&').forEach(function (item) {\n                        var arg = item.split('=');\n                        protocolArgs[arg[0]] = decodeURIComponent(arg[1]);\n                    });\n                }\n                navArgs.protocol = {\n                    action: args.detail.uri.host,\n                    args: protocolArgs\n                };\n                return navArgs;\n            }\n        }\n        WinRT.readProtocol = readProtocol;\n        ;\n        /**\n         * Indicate if a valid internet connection is available, even with constrained access\n         * @function WinJSContrib.WinRT.isConnected\n         * @returns {boolean}\n         */\n        function isConnected() {\n            var nlvl = Windows.Networking.Connectivity.NetworkConnectivityLevel;\n            var profile = Windows.Networking.Connectivity.NetworkInformation.getInternetConnectionProfile();\n            if (profile !== null) {\n                var level = profile.getNetworkConnectivityLevel();\n                return level === nlvl.constrainedInternetAccess || level === nlvl.internetAccess;\n            }\n            return false;\n        }\n        WinRT.isConnected = isConnected;\n        ;\n        /**\n         * Indicate if a valid internet connection is available\n         * @function WinJSContrib.WinRT.hasInternetAccess\n         * @returns {boolean}\n         */\n        function hasInternetAccess() {\n            var nlvl = Windows.Networking.Connectivity.NetworkConnectivityLevel;\n            var profile = Windows.Networking.Connectivity.NetworkInformation.getInternetConnectionProfile();\n            if (profile !== null) {\n                var level = profile.getNetworkConnectivityLevel();\n                return level === nlvl.internetAccess;\n            }\n            return false;\n        }\n        WinRT.hasInternetAccess = hasInternetAccess;\n        ;\n        /**\n         * trigger callback when internet connection status is changing\n         * @function WinJSContrib.WinRT.onInternetStatusChanged\n         * @param {function} callback callback for internet status change notification\n         * @returns {function} function to call for unregistering the callback\n         */\n        function onInternetStatusChanged(callback) {\n            var handler = function (arg) {\n                var e = arg;\n                callback(WinJSContrib.WinRT.hasInternetAccess());\n            };\n            var network = Windows.Networking.Connectivity.NetworkInformation;\n            network.addEventListener('networkstatuschanged', handler);\n            return function () {\n                network.removeEventListener('networkstatuschanged', handler);\n            };\n        }\n        WinRT.onInternetStatusChanged = onInternetStatusChanged;\n    })(WinRT = WinJSContrib.WinRT || (WinJSContrib.WinRT = {}));\n})(WinJSContrib || (WinJSContrib = {}));\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Alerts;\n    (function (Alerts) {\n        /**\n         * show system alert box\n         * @function WinJSContrib.Alerts.messageBox\n         * @param {Object} opt message options\n         * @returns {WinJS.Promise}\n         */\n        function messageBox(opt) {\n            var _global = window;\n            if (opt) {\n                if (_global.Windows) {\n                    var md = new Windows.UI.Popups.MessageDialog(opt.content);\n                    if (opt.title) {\n                        md.title = opt.title;\n                    }\n                    if (opt.commands && opt.commands.forEach) {\n                        opt.commands.forEach(function (command, index) {\n                            var cmd = new Windows.UI.Popups.UICommand();\n                            if (command.id)\n                                cmd.id = command.id;\n                            cmd.label = command.label;\n                            if (command.callback) {\n                                cmd.invoked = command.callback;\n                            }\n                            ((md.commands)).append(cmd);\n                            if (command.isDefault) {\n                                md.defaultCommandIndex = index;\n                            }\n                        });\n                    }\n                    return (md.showAsync());\n                }\n                else {\n                    return new WinJS.Promise(function (complete, error) {\n                        var title = \"\";\n                        if (opt.title) {\n                            title = opt.title;\n                        }\n                        var commands = [];\n                        if (opt.commands && opt.commands.forEach) {\n                            //if (opt.commands.length > 2) {\n                            //    return WinJS.Promise.wrapError(\"you must specify maximum 2 commands on Cordova platforms\");\n                            //}\n                            opt.commands.forEach(function (command, index) {\n                                commands.push(command.label);\n                            });\n                        }\n                        else\n                            commands = ['Ok'];\n                        if (_global.navigator && _global.navigator.notification && _global.navigator.notification.confirm) {\n                            _global.navigator.notification.confirm(opt.content, function (res) {\n                                if (opt.commands && opt.commands[res - 1] && opt.commands[res - 1].callback) {\n                                    var c = opt.commands[res - 1].callback();\n                                    if (c && c.then) {\n                                        c.then(function () {\n                                            complete(true);\n                                        });\n                                    }\n                                    else {\n                                        complete(true);\n                                    }\n                                }\n                                else if (res != 0)\n                                    complete(true);\n                                else\n                                    complete(false);\n                            }, title, commands // buttonLabels\n                            );\n                        }\n                        else {\n                            if (window.confirm(title))\n                                complete(true);\n                            else\n                                complete(false);\n                        }\n                    });\n                }\n            }\n            return WinJS.Promise.wrapError(\"you must specify commands as an array of objects with properties text and callback such as {text: '', callback: function(c){}}\");\n        }\n        Alerts.messageBox = messageBox;\n        ;\n        /**\n         * show system alert box\n         * @function WinJSContrib.Alerts.message\n         * @param {string} title title of the alert\n         * @param {string} content text for the alert\n         * @returns {WinJS.Promise}\n         */\n        function message(title, content) {\n            return WinJSContrib.Alerts.messageBox({ title: title, content: content });\n        }\n        Alerts.message = message;\n        /**\n         * show system alert box\n         * @function WinJSContrib.Alerts.confirm\n         * @param {string} title title of the alert\n         * @param {string} content text for the alert\n         * @param {string} yes text for yes\n         * @param {string} no text for no\n         * @returns {WinJS.Promise}\n         */\n        function confirm(title, content, yes, no) {\n            return new WinJS.Promise(function (complete, error) {\n                WinJSContrib.Alerts.messageBox({\n                    title: title,\n                    content: content,\n                    commands: [\n                        {\n                            label: yes,\n                            callback: function (e) {\n                                complete(true);\n                            },\n                            isDefault: true\n                        },\n                        {\n                            label: no,\n                            callback: function (e) {\n                                complete(false);\n                            }\n                        }\n                    ]\n                });\n            });\n        }\n        Alerts.confirm = confirm;\n        /**\n         * show system toast notification\n         * @function WinJSContrib.Alerts.toastNotification\n         * @param {Object} data toast options\n         */\n        function toastNotification(data) {\n            if (Windows) {\n                var notifications = Windows.UI.Notifications;\n                var template = data.template || (data.picture ? notifications.ToastTemplateType.toastImageAndText01 : notifications.ToastTemplateType.toastText01);\n                //var template = notifications.ToastTemplateType[data.template]; //toastImageAndText01;\n                var toastXml = notifications.ToastNotificationManager.getTemplateContent(template);\n                var toastTextElements = toastXml.getElementsByTagName(\"text\");\n                var toastImageElements = toastXml.getElementsByTagName(\"image\");\n                if (data.launch) {\n                    var toastElements = toastXml.getElementsByTagName(\"toast\");\n                    toastElements[0].setAttribute(\"launch\", JSON.stringify(data.launch));\n                }\n                toastTextElements[0].appendChild(toastXml.createTextNode(data.text));\n                if (data.text2 && toastTextElements.length > 1) {\n                    toastTextElements[1].appendChild(toastXml.createTextNode(data.text2));\n                }\n                if (data.text3 && toastTextElements.length > 1) {\n                    toastTextElements[2].appendChild(toastXml.createTextNode(data.text3));\n                }\n                if (data.picture) {\n                    toastImageElements[0].setAttribute(\"src\", data.picture); //\"ms-appx:///images/logo.png\"\n                }\n                var toast = new notifications.ToastNotification(toastXml);\n                var toastNotifier = notifications.ToastNotificationManager.createToastNotifier();\n                toastNotifier.show(toast);\n            }\n            else {\n                throw \"No notification plugin found\";\n            }\n        }\n        Alerts.toastNotification = toastNotification;\n        /**\n         * show system toast notification\n         * @function WinJSContrib.Alerts.toast\n         * @param {string} text text displayed in the toast\n         * @param {string} picture path to a picture to display in the toast\n         */\n        function toast(text, picture) {\n            WinJSContrib.Alerts.toastNotification({ text: text, picture: picture });\n        }\n        Alerts.toast = toast;\n    })(Alerts = WinJSContrib.Alerts || (WinJSContrib.Alerts = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\n//# sourceMappingURL=../../Sources/WinRT/winjscontrib.winrt.core.js.map","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib = WinJSContrib || {};\r\nWinJSContrib.UPnP = WinJSContrib.UPnP || {};\r\n\r\n(function (global) {\r\n\r\n    WinJSContrib.UPnP.deviceTypes = {\r\n        ContentDirectory1: 'urn:schemas-upnp-org:service:ContentDirectory:1',\r\n        ContentDirectory2: 'urn:schemas-upnp-org:service:ContentDirectory:2',\r\n        ContentDirectory3: 'urn:schemas-upnp-org:service:ContentDirectory:3',\r\n        ContentDirectory4: 'urn:schemas-upnp-org:service:ContentDirectory:4',\r\n        MediaRenderer1: 'urn:schemas-upnp-org:device:MediaRenderer:1',\r\n        MediaRenderer2: 'urn:schemas-upnp-org:device:MediaRenderer:2',\r\n        MediaRenderer3: 'urn:schemas-upnp-org:device:MediaRenderer:3',\r\n        MediaRenderer4: 'urn:schemas-upnp-org:device:MediaRenderer:4',\r\n        MediaServer1: 'urn:schemas-upnp-org:device:MediaServer:1',\r\n        MediaServer2: 'urn:schemas-upnp-org:device:MediaServer:2',\r\n        MediaServer3: 'urn:schemas-upnp-org:device:MediaServer:3',\r\n        MediaServer4: 'urn:schemas-upnp-org:device:MediaServer:4',\r\n        AVTransport1:'urn:schemas-upnp-org:service:AVTransport:1',\r\n        AVTransport2: 'urn:schemas-upnp-org:service:AVTransport:2',\r\n        ConnectionManager1: 'urn:schemas-upnp-org:service:ConnectionManager:1',\r\n        ConnectionManager2: 'urn:schemas-upnp-org:service:ConnectionManager:2',\r\n        ConnectionManager3: 'urn:schemas-upnp-org:service:ConnectionManager:3'\r\n    };\r\n\r\n    WinJSContrib.UPnP.devicesDiscovery = function devicesDiscovery(filter, callback, timeout) {\r\n        var hostName;\r\n        try {\r\n            hostName = new Windows.Networking.HostName(\"239.255.255.250\");\r\n        } catch (ex) {\r\n            error({ message: \"Invalid host name.\" });\r\n            return;\r\n        }\r\n\r\n        var devices = new WinJS.Binding.List();\r\n\r\n        var discovery = {\r\n            devices: devices,\r\n            hasError: null,\r\n            promise: null,\r\n        };\r\n\r\n        function exists(url) {\r\n            var matches = devices.filter(function (d) {\r\n                return (url == d.deviceDescriptionUrl);\r\n            });\r\n            return matches.length > 0;\r\n        }\r\n\r\n        function discover(filter) {\r\n            return new WinJS.Promise(function (complete, error) {\r\n                var clientSocket = new Windows.Networking.Sockets.DatagramSocket();\r\n\r\n                function onsuccess(err) {\r\n                    try {\r\n                        if (clientSocket)\r\n                            clientSocket.close();\r\n                    } catch (ex) {\r\n                    }\r\n                    complete(devices);\r\n                }\r\n\r\n                function onerror(err) {\r\n                    try {\r\n                        if (clientSocket)\r\n                            clientSocket.close();\r\n                    } catch (ex) {\r\n                    }\r\n                    error(err);\r\n                }\r\n\r\n                clientSocket.onmessagereceived = function (args) {\r\n                    var e = args;\r\n                    var reader = args.getDataReader();\r\n                    var count = reader.unconsumedBufferLength;\r\n                    var data = reader.readString(count);\r\n                    var completed = false;\r\n\r\n                    if (data) {\r\n                        var items = data.split('\\n');\r\n                        items.forEach(function (item) {\r\n                            if (!completed && item.toLowerCase().indexOf('location:') == 0) {\r\n                                var url = item.substr(9, item.length - 9);\r\n                                completed = true;\r\n                                if (!exists(url)) {\r\n                                    WinJS.xhr({ url: url }).then(function (r) {\r\n\r\n                                        var rawdevice = xmlToJson(r.responseXML);\r\n                                        var device = rawdevice.root.device;\r\n\r\n                                        device.deviceDescriptionUrl = url;\r\n                                        device.rootUrl = url.substr(0, url.indexOf('/', 8));\r\n                                        if (!exists(url)) {\r\n                                            devices.push(new WinJSContrib.UPnP.UPnPDevice(device));\r\n                                        }\r\n\r\n                                        if (callback)\r\n                                            callback(device, url);\r\n                                    }, function (err) {\r\n                                        console.error('calling device failed');\r\n                                        console.error(err);\r\n                                    });\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n\r\n                }\r\n\r\n                clientSocket.getOutputStreamAsync(hostName, \"1900\").then(function (outputStream) {\r\n                    var message = \"M-SEARCH * HTTP/1.1\\r\\n\" +\r\n                                        \"HOST: 239.255.255.250:1900\\r\\n\" +\r\n                                          \"ST:\" + (filter || \"upnp:rootdevice\") + \"\\r\\n\" +\r\n                                          \"MAN:\\\"ssdp:discover\\\"\\r\\n\" +\r\n                                          \"MX:3\\r\\n\\r\\n\";\r\n\r\n\r\n                    var writer = new Windows.Storage.Streams.DataWriter(outputStream);\r\n                    writer.unicodeEncoding = Windows.Storage.Streams.UnicodeEncoding.Utf8;\r\n                    writer.writeString(message);\r\n                    return writer.storeAsync();\r\n                }).then(function () {\r\n                    return WinJS.Promise.timeout(timeout || 20000);\r\n                }).then(onsuccess, onerror);\r\n            }).then(function (res) {\r\n                discovery.hasError = false;\r\n            }, function (err) {\r\n                discovery.hasError = true;\r\n                discovery.error = err;\r\n            });\r\n        }\r\n\r\n        var promises = [];\r\n\r\n        if (!filter || (typeof filter == 'string')) {\r\n            promises.push(discover(filter));\r\n        }\r\n        else if (filter && typeof filter != 'string' && filter.length) {\r\n            for (var i = 0 ; i < filter.length; i++) {\r\n                promises.push(discover(filter[i]));\r\n            }\r\n        }\r\n\r\n        discovery.promise = WinJS.Promise.join(promises);\r\n\r\n        return discovery;\r\n    }\r\n\r\n    function endsWith(text, search) {\r\n        return text.indexOf(search) == text.length - search.length;\r\n    }\r\n\r\n    WinJSContrib.UPnP.getContentType = function (url, extension) {\r\n        var lowerUrl = url.toLowerCase();\r\n\r\n        if (extension == \"mp3\" || endsWith(lowerUrl, \".mp3\"))\r\n            return \"audio/mp3\";\r\n\r\n        if (extension == \"mp4\" || endsWith(lowerUrl, \".mp4\"))\r\n            return \"video/mp4\";\r\n\r\n        if (extension == \"avi\" || endsWith(lowerUrl, \".avi\"))\r\n            return \"video/avi\";\r\n\r\n        if (extension == \"mkv\" || endsWith(lowerUrl, \".mkv\"))\r\n            return \"video/x-matroska\";\r\n    }\r\n\r\n    function xmlToJson(xml) {\r\n\r\n        // Create the return object\r\n        var obj = {};\r\n\r\n        if (xml.nodeType == 1) { // element\r\n            // do attributes\r\n            if (xml.attributes.length > 0) {\r\n                obj[\"@attributes\"] = {};\r\n                for (var j = 0; j < xml.attributes.length; j++) {\r\n                    var attribute = xml.attributes.item(j);\r\n\r\n                    obj[\"@attributes\"][attribute.nodeName] = attribute.nodeValue;\r\n                }\r\n            }\r\n        } else if (xml.nodeType == 3) { // text\r\n            obj = xml.nodeValue;\r\n        }\r\n\r\n        // do children\r\n        if (xml.hasChildNodes()) {\r\n            var properties = 0;\r\n            for (var i = 0; i < xml.childNodes.length; i++) {\r\n                var item = xml.childNodes.item(i);\r\n                var nodeName = item.nodeName;\r\n                if (typeof (obj[nodeName]) == \"undefined\") {\r\n                    var tmp = xmlToJson(item);\r\n                    var colonIdx = nodeName.indexOf(':');\r\n                    if (colonIdx > 0) {\r\n                        var clearNode = nodeName.substr(colonIdx + 1, nodeName.length - colonIdx - 1);\r\n\r\n                    }\r\n\r\n                    if (clearNode && !obj[clearNode]) {\r\n                        obj[clearNode] = tmp;\r\n                    } else {\r\n                        obj[nodeName] = tmp;\r\n                    }\r\n\r\n                    properties++;\r\n                } else {\r\n                    if (typeof (obj[nodeName].push) == \"undefined\") {\r\n                        var old = obj[nodeName];\r\n                        obj[nodeName] = [];\r\n                        obj[nodeName].push(old);\r\n                    }\r\n                    obj[nodeName].push(xmlToJson(item));\r\n                    properties++;\r\n                }\r\n            }\r\n\r\n            if (obj['#text'] && typeof obj['#text'] == 'string') {\r\n                obj['#text'] = obj['#text'].trim();\r\n            }\r\n            if (properties == 1 && obj['#text'] && typeof obj['#text'] == 'string') {\r\n                obj = obj['#text'];\r\n            }\r\n        }\r\n\r\n        for (var e in obj[\"@attributes\"]) {\r\n            if (!obj[e])\r\n                obj[e] = obj[\"@attributes\"][e];\r\n        }\r\n\r\n        return obj;\r\n    };\r\n\r\n    /**\r\n     * UPnP device\r\n     * @class\r\n     */\r\n    WinJSContrib.UPnP.UPnPDevice = function (deviceObj) {\r\n        for (var p in deviceObj) {\r\n            this[p] = deviceObj[p];\r\n        }\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getService = function (serviceType) {\r\n        var device = this;\r\n        var service = null;\r\n\r\n        if (typeof serviceType == 'string')\r\n            serviceType = [serviceType];\r\n\r\n        if (device.serviceList && device.serviceList.service) {\r\n            service = device.serviceList.service.filter(function (s) {\r\n                return serviceType.indexOf(s.serviceType) >= 0;\r\n            })[0];\r\n\r\n            if (!service && device.deviceList) {\r\n                device.deviceList.device.forEach(function (childdevice) {\r\n                    var childService = childdevice.serviceList.service.filter(function (s) {\r\n                        return serviceType.indexOf(s.serviceType) >= 0;\r\n                    })[0];\r\n\r\n                    if (childService)\r\n                        service = childService;\r\n                });\r\n            }\r\n        }\r\n\r\n        if (service) {\r\n            service.rootUrl = device.rootUrl;\r\n            service.url = device.rootUrl + service.controlURL;\r\n        }\r\n\r\n        return service;\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getAVTransport = function () {\r\n        var service = this.getService([WinJSContrib.UPnP.deviceTypes.AVTransport1, WinJSContrib.UPnP.deviceTypes.AVTransport2]);\r\n        if (service) {\r\n            return new WinJSContrib.UPnP.UPnPAVTransport(service);\r\n        }\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getContentDirectory = function () {\r\n        var service = this.getService([WinJSContrib.UPnP.deviceTypes.ContentDirectory1, WinJSContrib.UPnP.deviceTypes.ContentDirectory2, WinJSContrib.UPnP.deviceTypes.ContentDirectory3, WinJSContrib.UPnP.deviceTypes.ContentDirectory4]);\r\n        if (service) {\r\n            return new WinJSContrib.UPnP.UPnPContentDirectory(service);\r\n        }\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getConnectionManager = function () {\r\n        var service = this.getService([WinJSContrib.UPnP.deviceTypes.ConnectionManager1, WinJSContrib.UPnP.deviceTypes.ConnectionManager2, WinJSContrib.UPnP.deviceTypes.ConnectionManager3]);\r\n        if (service) {\r\n            return new WinJSContrib.UPnP.UPnPConnectionManager(service);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Code largely from https://github.com/richtr/plug.play.js\r\n     */\r\n\r\n    WinJSContrib.UPnP.UPnPService = function (serviceObj, opts) {\r\n\r\n        this.options = opts || { debug: false };\r\n        this.svc = serviceObj;\r\n\r\n        // API stub\r\n        this.action = function () { };\r\n\r\n        //if (!this.svc || !(this.svc instanceof NetworkService)) {\r\n\r\n        //    this.debugLog('First argument provided in constructor MUST be a valid NetworkService object');\r\n\r\n        //    return this;\r\n        //}\r\n\r\n        //if (!this.svc.type || this.svc.type.indexOf('upnp:') !== 0) {\r\n\r\n        //    this.debugLog('First argument provided in constructor MUST be a _UPnP_ NetworkService object');\r\n\r\n        //    return this;\r\n\r\n        //}\r\n\r\n        //this.svcType = this.svc.type.replace('upnp:', '');\r\n        this.svcType = this.svc.serviceType;\r\n        this.svcUrl = this.svc.url;\r\n\r\n        var self = this;\r\n\r\n        // Full API\r\n        this.action = function (upnpAction, upnpParameters, callback) {\r\n\r\n            return new WinJS.Promise(function (promiseComplete, promiseError) {\r\n\r\n                // Handle .action( name, callback )\r\n                if (!callback && Object.prototype.toString.call(upnpParameters) == '[object Function]') {\r\n                    callback = upnpParameters;\r\n                    upnpParameters = {};\r\n                }\r\n\r\n                // Generate a callback stub if a Function has not been provided\r\n                if (!callback || Object.prototype.toString.call(callback) !== '[object Function]') {\r\n                    callback = function (e, response) { };\r\n                }\r\n\r\n                // Create a UPnP XML Request message\r\n                var svcMsg = self.createRequest(self.svcType, upnpAction, upnpParameters);\r\n\r\n                // Send the UPnP XML Request message to the current service\r\n                self.sendRequest(self.svcType, upnpAction, self.svcUrl, svcMsg, function (e, xmlResponse) {\r\n\r\n                    if (e !== null) {\r\n                        callback.apply(self, [e, null]);\r\n                        promiseError(e);\r\n                        return;\r\n                    }\r\n\r\n                    // Parse UPnP XML Response message\r\n                    self.handleResponse(upnpAction, xmlResponse.responseXML || \"\", upnpParameters, function (e, upnpResponse) {\r\n\r\n                        // Fire callback\r\n                        callback.apply(self, [e, upnpResponse]);\r\n\r\n                        // Fire promise\r\n                        if (e !== null) {\r\n                            promiseError(e);\r\n                        } else {\r\n                            promiseComplete(upnpResponse);\r\n                        }\r\n\r\n                    });\r\n\r\n                });\r\n            });\r\n        }\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.constructor = WinJSContrib.UPnP.UPnPService;\r\n\r\n    // UPnP XML MESSAGING TEMPLATES\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.requestTemplate = \"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?>\\n\" +\r\n     \"<s:Envelope s:encodingStyle=\\\"http://schemas.xmlsoap.org/soap/encoding/\\\" \" +\r\n       \"xmlns:s=\\\"http://schemas.xmlsoap.org/soap/envelope/\\\">\\n\" +\r\n       \"\\t<s:Body>\\n\" +\r\n         \"\\t\\t<u:{ACTION_NAME} xmlns:u=\\\"{ACTION_TYPE}\\\">\\n\" +\r\n           \"{ACTION_VARS}\" +\r\n         \"\\t\\t</u:{ACTION_NAME}>\\n\" +\r\n       \"\\t</s:Body>\\n\" +\r\n     \"</s:Envelope>\\n\";\r\n\r\n    // UPNP PRIMITIVE VARIABLE TYPE CHECKERS\r\n    // from http://upnp.org/specs/arch/UPnP-arch-DeviceArchitecture-v1.0.pdf\r\n    WinJSContrib.UPnP.UPnPService.prototype.types = {\r\n\r\n        \"i1\": function (val, allowedValues, toNative) {\r\n            var i8 = new Int8Array(1);\r\n            i8[0] = val;\r\n\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(i8[0], allowedValues);\r\n\r\n        },\r\n\r\n        \"i2\": function (val, allowedValues, toNative) {\r\n            var i16 = new Int16Array(1);\r\n            i16[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(i16[0], allowedValues);\r\n        },\r\n\r\n        \"i4\": function (val, allowedValues, toNative) {\r\n            var i32 = new Int32Array(1);\r\n            i32[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(i32[0], allowedValues);\r\n        },\r\n\r\n        \"ui1\": function (val, allowedValues, toNative) {\r\n            var ui8 = new Uint8Array(1);\r\n            ui8[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(ui8[0], allowedValues);\r\n        },\r\n\r\n        \"ui2\": function (val, allowedValues, toNative) {\r\n            var ui16 = new Uint16Array(1);\r\n            ui16[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(ui16[0], allowedValues);\r\n        },\r\n\r\n        \"ui4\": function (val, allowedValues, toNative) {\r\n            var ui32 = new Uint32Array(1);\r\n            ui32[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(ui32[0], allowedValues);\r\n        },\r\n\r\n        \"int\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || isNaN(val)) {\r\n                val = 0;\r\n            } else if (typeof val !== 'number') {\r\n                if (val === true) {\r\n                    val = 1;\r\n                } else {\r\n                    val = parseInt(val + \"\", 10);\r\n                }\r\n            }\r\n            if (!toNative) {\r\n                val = expandExponential(val + \"\");\r\n            }\r\n            if (isNaN(val)) val = 0;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n        },\r\n\r\n        \"r4\": function (val, allowedValues, toNative) {\r\n            var f32 = new Float32Array(1);\r\n            f32[0] = val;\r\n            if (!toNative) {\r\n                return f32[0] ? expandExponential(f32[0] + \"\") : \"0\";\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(f32[0], allowedValues);\r\n        },\r\n\r\n        \"r8\": function (val, allowedValues, toNative) {\r\n            var f64 = new Float64Array(1);\r\n            f64[0] = val;\r\n            if (!toNative) {\r\n                return f64[0] ? expandExponential(f64[0] + \"\") : \"0\";\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(f64[0], allowedValues);\r\n        },\r\n\r\n        \"number\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['r8'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"fixed_14_4\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['float'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"float\": function (val, allowedValues, toNative) {\r\n            var _float = parseFloat(val);\r\n            if (!toNative) {\r\n                return _float ? expandExponential(_float + \"\") : \"0\";\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(_float, allowedValues);\r\n        },\r\n\r\n        \"char\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            } else if (val === false || val === true || val == \"true\" || val == \"yes\" || val == \"false\" || val == \"no\") {\r\n                val = (val === true || val == \"true\" || val == \"yes\") ? \"1\" : \"0\";\r\n            } else {\r\n                val = val.toString();\r\n            }\r\n            if (val.length > 0) {\r\n                val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n                return val.charAt(0);\r\n            }\r\n            return val;\r\n        },\r\n\r\n        \"string\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            val = val + \"\";\r\n\r\n            val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n            return val;\r\n        },\r\n\r\n        \"xmlObj\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            val = val + \"\";\r\n\r\n            val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n            try {\r\n                var s = '';\r\n\r\n                var currentPos = val.indexOf('&');\r\n                while (currentPos > 0) {\r\n                    var idx = val.indexOf(';', currentPos);\r\n                    if (idx < 0 || (idx - currentPos) > 5) {\r\n                        val = val.substr(0, currentPos) + \"&amp;\" + val.substr(currentPos + 1, val.length - (currentPos + 1));\r\n                    }\r\n                    currentPos = val.indexOf('&', currentPos + 1);\r\n                }\r\n\r\n                var xml = parseXML(val);\r\n                return xmlToJson(xml);\r\n            } catch (exception) {\r\n                console.error(exception);\r\n                return val;\r\n            }\r\n        },\r\n\r\n        \"date\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"dateTime\": function (val, allowedValues, toNative) {\r\n            if (toNative) { // Parse to ECMA Date object\r\n                if (Object.prototype.toString.call(val) == '[object String]') {\r\n                    val = new Date(parseDate(val));\r\n                    if (isNaN(val)) val = \"\";\r\n                } else if (Object.prototype.toString.call(val) == '[object Date]') {\r\n                    val = val;\r\n                }\r\n            } else { // Parse to ISO-8601 string\r\n                if (Object.prototype.toString.call(val) == '[object String]') {\r\n                    val = val + \"\";\r\n                } else if (Object.prototype.toString.call(val) == '[object Date]') {\r\n                    if (val.toString() == \"Invalid Date\") { // opera specific functionality\r\n                        val = \"\";\r\n                    } else {\r\n                        val = val.toISOString();\r\n                    }\r\n                }\r\n            }\r\n            val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n            return val;\r\n        },\r\n\r\n        \"dateTime_tz\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"time\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"time_tz\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"boolean\": function (val, allowedValues, toNative) {\r\n            if (val == 'false' || val == 'f' || val == 'no' || val == 'n' || val instanceof RegExp || val <= 0 || !val) {\r\n                if (toNative) {\r\n                    val = false;\r\n                } else {\r\n                    val = \"0\";\r\n                }\r\n            } else {\r\n                if (toNative) {\r\n                    val = true;\r\n                } else {\r\n                    val = \"1\";\r\n                }\r\n            }\r\n            return val;\r\n        },\r\n\r\n        \"bin_base64\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            if (val === true || val === false) {\r\n                val = val === true ? \"1\" : \"0\";\r\n            }\r\n            if (toNative) { // convert to string\r\n                val = atob(val + \"\");\r\n            } else { // convert to base64\r\n                val = btoa(val + \"\");\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n        },\r\n\r\n        \"bin_hex\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            if (val === true || val === false) {\r\n                val = val === true ? \"1\" : \"0\";\r\n            }\r\n            if (toNative) { // convert to string\r\n                val = htoa(val + \"\");\r\n            } else { // convert to hex\r\n                val = atoh(val + \"\");\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n        },\r\n\r\n        \"uri\": function (val, allowedValues, toNative) {\r\n            if (toNative) {\r\n                val = decodeURI(val + \"\");\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['string'](val, allowedValues); // No URI syntax checking\r\n        },\r\n\r\n        \"uuid\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['string'](val, allowedValues); // No UUID syntax checking\r\n        }\r\n\r\n    };\r\n\r\n    // Override .types toString function\r\n    for (var type in WinJSContrib.UPnP.UPnPService.prototype.types) {\r\n        WinJSContrib.UPnP.UPnPService.prototype.types[type]._name = type;\r\n        WinJSContrib.UPnP.UPnPService.prototype.types[type][\"toString\"] = function () { return this._name; };\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.createRequest = function (upnpServiceType, upnpActionName, parameters) {\r\n\r\n        parameters = this.formatParameters(parameters);\r\n\r\n        this.debugLog('Creating UPnP XML Control Message for [' + upnpActionName + '] with parameters:');\r\n        this.debugLog(JSON ? JSON.stringify(parameters) : null);\r\n\r\n        // Build basic part of XML request\r\n        var svcMsg = this.requestTemplate.replace(/\\{ACTION_TYPE\\}/g, encodeXML(trim(upnpServiceType)));\r\n\r\n        svcMsg = svcMsg.replace(/\\{ACTION_NAME\\}/g, encodeXML(trim(upnpActionName)));\r\n\r\n        var svcInParams = parameters['request'],\r\n            svcInParams_xml = \"\";\r\n\r\n        if (svcInParams) {\r\n\r\n            // Generate XML parameters syntax\r\n            for (var svcParam in svcInParams) {\r\n\r\n                // Perform type checking sanitization\r\n                if (svcInParams[svcParam]['type'] !== undefined && svcInParams[svcParam]['type'] !== null) {\r\n\r\n                    // get the primitive sanitization function\r\n                    var typeCheck = this.types[svcInParams[svcParam]['type']];\r\n\r\n                    if (typeCheck) {\r\n                        svcInParams[svcParam]['value'] = typeCheck(svcInParams[svcParam]['value'], svcInParams[svcParam]['allowedValueList'], false);\r\n                    }\r\n\r\n                }\r\n\r\n                if (svcInParams[svcParam]['value'] === null || svcInParams[svcParam]['value'] === undefined) {\r\n\r\n                    svcInParams[svcParam]['value'] = \"\"; // pass through empty value\r\n\r\n                }\r\n\r\n                svcInParams_xml += \"\\t\\t\\t<\" + svcParam + \">\" + encodeXML(trim(svcInParams[svcParam]['value'] + \"\")) + \"</\" + svcParam + \">\\n\";\r\n\r\n            }\r\n\r\n        }\r\n\r\n        // Add ACTION_VARS, if any\r\n        svcMsg = svcMsg.replace(/\\{ACTION_VARS\\}/g, svcInParams_xml);\r\n\r\n        // DEBUG\r\n        this.debugLog('[REQUEST] (SOAPAction: ' + upnpServiceType + '#' + upnpActionName + ') ' + svcMsg);\r\n\r\n        return svcMsg;\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.sendRequest = function (upnpServiceType, upnpActionName, upnpEndpointURL, upnpRequestXML, onUPnPResponse) {\r\n\r\n        var soapaction = '\\\"' + upnpServiceType.replace(/[\\\"\\#]/g, '') + '#' + upnpActionName.replace(/[\\\"\\#]/g, '') + '\\\"'\r\n        var httpClient = new Windows.Web.Http.HttpClient();\r\n        var uri = new Windows.Foundation.Uri(upnpEndpointURL);\r\n        var request = new Windows.Web.Http.HttpRequestMessage(Windows.Web.Http.HttpMethod.post, uri);\r\n        request.headers.append('SOAPACTION', soapaction);\r\n        //request.headers.append('Content-Type', 'text/xml; charset=\"utf-8\";');        \r\n\r\n        request.content = new Windows.Web.Http.HttpStringContent(upnpRequestXML, Windows.Storage.Streams.UnicodeEncoding.utf8, \"text/xml\");\r\n\r\n        httpClient.sendRequestAsync(request).then(function (r) {\r\n            var content = r.content.readAsStringAsync().then(function (text) {\r\n                var xml = parseXML(text);\r\n                var r = {\r\n                    status: 200,\r\n                    responseText: text,\r\n                    responseXML: xml\r\n                };\r\n                onUPnPResponse.apply(this, [null, r]);\r\n            });\r\n\r\n        }, function (err) {\r\n            onUPnPResponse.apply(undefined, [new UPnPError('XmlHttpRequest failed'), null]);\r\n        });\r\n\r\n        return this;\r\n\r\n        try {\r\n\r\n            var xhr = new XMLHttpRequest();\r\n\r\n            xhr.open('POST', upnpEndpointURL);\r\n            xhr.setRequestHeader('Content-Type', 'text/xml; charset=\"utf-8\";');\r\n            xhr.setRequestHeader('action', soapaction);\r\n            xhr.setRequestHeader('zurgl', soapaction);\r\n            xhr.setRequestHeader('SOAPAction', soapaction);\r\n\r\n            xhr.onabort = xhr.onerror = function () {\r\n\r\n                onUPnPResponse.apply(undefined, [new UPnPError('XmlHttpRequest failed'), null]);\r\n\r\n                //xhrManager.release(xhr);\r\n\r\n            };\r\n\r\n            var self = this;\r\n\r\n            xhr.onreadystatechange = function () {\r\n\r\n                if (this.readyState < 4) return;\r\n\r\n                if (this.status !== 200) {\r\n\r\n                    onUPnPResponse.apply(undefined, [new UPnPError('XmlHttpRequest expected 200 OK. Received ' + this.status + ' response.'), null]);\r\n\r\n                    self.debugLog(\"[ERROR-RESPONSE] \" + this.responseText);\r\n\r\n                    //xhrManager.release(xhr);\r\n\r\n                    return;\r\n\r\n                }\r\n\r\n                self.debugLog(\"[SUCCESS-RESPONSE] \" + this.responseText);\r\n\r\n                onUPnPResponse.apply(this, [null, this]);\r\n\r\n                //xhrManager.release(xhr);\r\n\r\n            };\r\n\r\n            xhr.send(upnpRequestXML);\r\n\r\n        } catch (e) {\r\n\r\n            onUPnPResponse.apply(undefined, [new UPnPError(e), null]);\r\n\r\n        }\r\n\r\n        return this; // allow method chaining\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.handleResponse = function (upnpActionName, upnpResponseXML, parameters, onUPnPResolved) {\r\n\r\n        parameters = this.formatParameters(parameters);\r\n\r\n        var svcOutParams = parameters['response'];\r\n\r\n        var responseJSON = {};\r\n\r\n        // Process all XML response variables\r\n        var responseContainer = upnpResponseXML.getElementsByTagName ?\r\n                                  upnpResponseXML.getElementsByTagName(upnpActionName + \"Response\") : null;\r\n\r\n        // If we don't have any response variables, try again with the namespace attached (required for lib to work in Firefox)\r\n        if (responseContainer === null || responseContainer.length <= 0) {\r\n            responseContainer = upnpResponseXML.getElementsByTagName ?\r\n                                      upnpResponseXML.getElementsByTagName(\"u:\" + upnpActionName + \"Response\") : null;\r\n        }\r\n\r\n        if (responseContainer !== null && responseContainer.length > 0) {\r\n\r\n            var responseVars = responseContainer[0].childNodes;\r\n\r\n            if (responseVars && responseVars.length > 0) {\r\n\r\n                for (var i = 0, l = responseVars.length; i < l; i++) {\r\n\r\n                    var varName = responseVars[i].nodeName;\r\n                    var varVal = responseVars[i].firstChild ? trim(decodeXML(responseVars[i].firstChild.nodeValue + \"\")) : null;\r\n\r\n                    // Perform type checking sanitization if requested\r\n                    if (svcOutParams[varName] && svcOutParams[varName]['type'] !== undefined && svcOutParams[varName]['type'] !== null) {\r\n\r\n                        // get the primitive sanitization function\r\n                        var typeCheck = this.types[svcOutParams[varName]['type']];\r\n\r\n                        if (typeCheck) {\r\n                            varVal = typeCheck(varVal, svcOutParams[varName]['allowedValueList'] || null, true);\r\n                        }\r\n\r\n                    }\r\n\r\n                    responseJSON[varName] = (varVal !== undefined && varVal !== null) ? varVal : \"\";\r\n\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n\r\n        // Fire callback with the parsed action response data\r\n        onUPnPResolved.apply(undefined, [null, { data: responseJSON }]);\r\n\r\n        return this; // allow method chaining\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.formatParameter = function (parameter) {\r\n\r\n        var param = {};\r\n\r\n        if (parameter['type'] !== undefined || parameter['value'] !== undefined || parameter['allowedValueList'] !== undefined) {\r\n\r\n            param = parameter;\r\n\r\n            if (parameter['allowedValueList'] !== undefined && typeof parameter['allowedValueList'] !== 'array') {\r\n                parameter['allowedValueList'] = [];\r\n            }\r\n\r\n        } else {\r\n\r\n            param = { value: parameter };\r\n\r\n        }\r\n\r\n        // check type is valid, otherwise discard requested type\r\n        if (param['type'] !== undefined && param['type'] !== null) {\r\n\r\n            if (!this.types[(param['type'] + \"\")]) {\r\n\r\n                delete param['type'];\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return param;\r\n\r\n    };\r\n\r\n    // Normalize the input parameters argument\r\n    WinJSContrib.UPnP.UPnPService.prototype.formatParameters = function (parameters) {\r\n\r\n        if (parameters === undefined || parameters === null) {\r\n            parameters = {};\r\n        }\r\n\r\n        if (!parameters['request']) {\r\n            parameters['request'] = {};\r\n        }\r\n\r\n        if (!parameters['response']) {\r\n            parameters['response'] = {};\r\n        }\r\n\r\n        for (var param in parameters) {\r\n\r\n            if (param === 'request' || param === 'response') {\r\n\r\n                for (var processParam in parameters[param]) {\r\n\r\n                    parameters[param][processParam] = this.formatParameter(parameters[param][processParam]);\r\n\r\n                }\r\n\r\n            } else { // append as 'request' parameter and remove from root object\r\n\r\n                parameters['request'][param] = this.formatParameter(parameters[param]);\r\n\r\n                delete parameters[param];\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return parameters;\r\n\r\n    };\r\n\r\n    // ALLOWED VALUE LIST CHECKER\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues = function (val, allowedValueList) {\r\n\r\n        // Check against allowedValues if provided\r\n        if (val && allowedValueList && Object.prototype.toString.call(allowedValueList) == '[object Array]') {\r\n\r\n            var matchFound = false;\r\n\r\n            for (var i = 0, l = allowedValueList.length; i < l; i++) {\r\n\r\n                if (val == allowedValueList[i]) {\r\n\r\n                    matchFound = true;\r\n                    break;\r\n\r\n                }\r\n            }\r\n\r\n            if (!matchFound) {\r\n                return \"\";\r\n            }\r\n        }\r\n\r\n        return val;\r\n\r\n    };\r\n\r\n    // UPnP DEBUGGER\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.debugLog = function (msg, level) {\r\n        if ((this.options && this.options.debug)) {\r\n            console[level || 'log'](\"Plug.UPnP: \" + msg);\r\n        }\r\n    };\r\n\r\n    // UPnP ERROR OBJECT\r\n\r\n    var UPnPError = function (description) {\r\n        return {\r\n            'description': description\r\n        };\r\n    };\r\n\r\n    function parseXML(text) {\r\n        return (new DOMParser()).parseFromString(text, \"text/xml\");\r\n    }\r\n\r\n    // *** CUSTOM TYPE FUNCTIONS ***\r\n\r\n    // BASE64 FUNCTIONS\r\n    // (forked from https://github.com/dankogai/js-base64/blob/master/base64.js)\r\n\r\n    var b64chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\r\n\r\n    var b64tab = (function (bin) {\r\n        var t = {};\r\n        for (var i = 0, l = bin.length; i < l; i++) t[bin.charAt(i)] = i;\r\n        return t;\r\n    })(b64chars);\r\n\r\n    var cb_encode = function (ccc) {\r\n        var padlen = [0, 2, 1][ccc.length % 3],\r\n            ord = ccc.charCodeAt(0) << 16\r\n                | ((ccc.length > 1 ? ccc.charCodeAt(1) : 0) << 8)\r\n                | ((ccc.length > 2 ? ccc.charCodeAt(2) : 0)),\r\n            chars = [\r\n                b64chars.charAt(ord >>> 18),\r\n                b64chars.charAt((ord >>> 12) & 63),\r\n                padlen >= 2 ? '=' : b64chars.charAt((ord >>> 6) & 63),\r\n                padlen >= 1 ? '=' : b64chars.charAt(ord & 63)\r\n            ];\r\n        return chars.join('');\r\n    };\r\n\r\n    var cb_decode = function (cccc) {\r\n        var len = cccc.length,\r\n            padlen = len % 4,\r\n            n = (len > 0 ? b64tab[cccc.charAt(0)] << 18 : 0)\r\n              | (len > 1 ? b64tab[cccc.charAt(1)] << 12 : 0)\r\n              | (len > 2 ? b64tab[cccc.charAt(2)] << 6 : 0)\r\n              | (len > 3 ? b64tab[cccc.charAt(3)] : 0),\r\n            chars = [\r\n                String.fromCharCode(n >>> 16),\r\n                String.fromCharCode((n >>> 8) & 0xff),\r\n                String.fromCharCode(n & 0xff)\r\n            ];\r\n        chars.length -= [0, 0, 2, 1][padlen];\r\n        return chars.join('');\r\n    };\r\n\r\n    var btoa = global.btoa || function (b) {\r\n        return b.replace(/[\\s\\S]{1,3}/g, cb_encode);\r\n    };\r\n\r\n    var atob = global.atob || function (a) {\r\n        return a.replace(/[\\s\\S]{1,4}/g, cb_decode);\r\n    };\r\n\r\n    // HEX FUNCTIONS\r\n\r\n    var hexChars = '0123456789abcdef';\r\n\r\n    var hextab = (function (bin) {\r\n        var t = {};\r\n        for (var i = 0, l = bin.length; i < l; i++) t[i] = bin.charAt(i);\r\n        return t;\r\n    })(hexChars);\r\n\r\n    function toHex(n) {\r\n        var result = ''\r\n        var start = true;\r\n        for (var i = 32; i > 0;) {\r\n            i -= 4;\r\n            var digit = (n >> i) & 0xf;\r\n            if (!start || digit != 0) {\r\n                start = false;\r\n                result += hextab[digit];\r\n            }\r\n        }\r\n        return (result == '' ? '0' : result);\r\n    }\r\n\r\n    function pad(str, len, pad) {\r\n        var result = str;\r\n        for (var i = str.length; i < len; i++) {\r\n            result = pad + result;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function ntos(n) {\r\n        n = n.toString(16);\r\n        if (n.length == 1) n = \"0\" + n;\r\n        n = \"%\" + n;\r\n        return unescape(n);\r\n    }\r\n\r\n    function htoa(str) {\r\n        str = str.toUpperCase().replace(new RegExp(\"s/[^0-9A-Z]//g\"));\r\n        var result = \"\";\r\n        var nextchar = \"\";\r\n        for (var i = 0; i < str.length; i++) {\r\n            nextchar += str.charAt(i);\r\n            if (nextchar.length == 2) {\r\n                result += ntos(parseInt(nextchar, 16));\r\n                nextchar = \"\";\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function atoh(str) {\r\n        var result = \"\";\r\n        for (var i = 0; i < str.length; i++) {\r\n            result += pad(toHex(str.charCodeAt(i) & 0xff), 2, '0');\r\n        }\r\n        return result;\r\n    }\r\n\r\n    // NUMBER FUNCTIONS\r\n\r\n    function expandExponential(str) {\r\n        return str.replace(/^([+-])?(\\d+).?(\\d*)[eE]([-+]?\\d+)$/, function (x, s, n, f, c) {\r\n            var l = +c < 0, i = n.length + +c, x = (l ? n : f).length,\r\n            c = ((c = Math.abs(c)) >= x ? c - x + l : 0),\r\n            z = (new Array(c + 1)).join(\"0\"), r = n + f;\r\n            return (s || \"\") + (l ? r = z + r : r += z).substr(0, i += l ? z.length : 0) + (i < r.length ? \".\" + r.substr(i) : \"\");\r\n        });\r\n    };\r\n\r\n    // STRING FUNCTIONS\r\n\r\n    var trim = function (str) {\r\n        if (String.prototype.trim) {\r\n            return str.trim();\r\n        } else {\r\n            return str.replace(/^\\s+|\\s+$/g, \"\");\r\n        }\r\n    };\r\n\r\n    var encodeXML = function (str) {\r\n        return str.replace(/\\&/g, '&amp;')\r\n                   .replace(/</g, '&lt;')\r\n                   .replace(/>/g, '&gt;')\r\n                   .replace(/'/g, '&#39;')\r\n                   .replace(/\"/g, '&quot;');\r\n    };\r\n\r\n    var decodeXML = function (str) {\r\n        return str.replace(/\\&quot;/g, '\"')\r\n                   .replace(/\\&\\#39;/g, '\\'')\r\n                   .replace(/\\&gt;/g, '>')\r\n                   .replace(/\\&lt;/g, '<')\r\n                   .replace(/\\&amp;/g, '&');\r\n    };\r\n\r\n    /**\r\n     * Date.parse with progressive enhancement for ISO 8601 <https://github.com/csnover/js-iso8601>\r\n     * © 2011 Colin Snover <http://zetafleet.com>\r\n     * Released under MIT license.\r\n     *\r\n     * 2012 - Modifications to accept times without dates - by Rich Tibbett\r\n     */\r\n\r\n    var parseDate = function (date) {\r\n        var timestamp, struct, minutesOffset = 0, numericKeys = [1, 4, 5, 6, 7, 10, 11];\r\n\r\n        if (typeof date !== 'string') date += \"\";\r\n\r\n        if ((struct = /^((\\d{4}|[+\\-]\\d{6})(?:-(\\d{2})(?:-(\\d{2}))?)?)?(?:[T\\s]?(\\d{2}):(\\d{2})(?::(\\d{2})(?:\\.(\\d{3}))?)?(?:(Z)|([+\\-])(\\d{4}))?)?$/.exec(date))) {\r\n\r\n            struct = struct.slice(1, struct.length);\r\n\r\n            // avoid NaN timestamps caused by “undefined” values being passed to Date.UTC\r\n            for (var i = 0, k; (k = numericKeys[i]) ; ++i) {\r\n                struct[k] = +struct[k] || 0;\r\n            }\r\n\r\n            // allow undefined days and months\r\n            struct[2] = (+struct[2] || 1) - 1;\r\n            struct[3] = +struct[3] || 1;\r\n\r\n            if (struct[8] !== 'Z' && struct[9] !== undefined) {\r\n                minutesOffset = ((struct[10] / 100) - ((struct[10] / 100) % 1)) * 60 + (struct[10] % 100);\r\n\r\n                if (struct[9] === '+') {\r\n                    minutesOffset = 0 - minutesOffset;\r\n                }\r\n            }\r\n\r\n            timestamp = Date.UTC(struct[1], struct[2], struct[3], struct[4], struct[5] + minutesOffset, struct[6], struct[7]);\r\n        }\r\n        else {\r\n            timestamp = Date.parse ? Date.parse(date) : NaN;\r\n        }\r\n\r\n        return timestamp;\r\n    };\r\n\r\n    var allowedContentDirectoryTypes = {\r\n        'urn:schemas-upnp-org:service:ContentDirectory:1': true,\r\n        'urn:schemas-upnp-org:service:ContentDirectory:2': true,\r\n        'urn:schemas-upnp-org:service:ContentDirectory:3': true,\r\n        'urn:schemas-upnp-org:service:ContentDirectory:4': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPContentDirectory = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedContentDirectoryTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Media Server Service\");\r\n            return;\r\n        }\r\n\r\n        // *** ContentDirectory:1 methods\r\n\r\n        this.getSystemUpdateId = function (callback) {\r\n\r\n            return this.action('GetSystemUpdateID', {\r\n                request: {},\r\n                response: {\r\n                    Id: {\r\n                        type: this.types.ui4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getSearchCapabilities = function (callback) {\r\n\r\n            return this.action('GetSearchCapabilities', {\r\n                request: {},\r\n                response: {\r\n                    SearchCaps: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getSortCapabilities = function (callback) {\r\n\r\n            return this.action('GetSortCapabilities', {\r\n                request: {},\r\n                response: {\r\n                    SortCaps: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.browse = function (objectId, browseFlag, filter, startingIndex, requestedCount, sortCriteria, callback) {\r\n\r\n            return this.action('Browse', {\r\n                request: {\r\n                    ObjectID: {\r\n                        value: objectId || '0',\r\n                        type: this.types.string\r\n                    },\r\n                    BrowseFlag: {\r\n                        value: browseFlag || 'BrowseDirectChildren',\r\n                        type: this.types.string\r\n                    },\r\n                    Filter: {\r\n                        value: filter || '*',\r\n                        type: this.types.string\r\n                    },\r\n                    StartingIndex: {\r\n                        value: startingIndex || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    RequestedCount: {\r\n                        value: requestedCount || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    SortCriteria: {\r\n                        value: sortCriteria,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    Result: {\r\n                        type: this.types.xmlObj\r\n                    },\r\n                    NumberReturned: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    TotalMatches: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    UpdateID: {\r\n                        type: this.types.ui4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.search = function (objectId, browseFlag, filter, startingIndex, requestedCount, sortCriteria, callback) {\r\n\r\n            return this.action('Search', {\r\n                request: {\r\n                    ObjectID: {\r\n                        value: objectId || '0',\r\n                        type: this.types.string\r\n                    },\r\n                    BrowseFlag: {\r\n                        value: browseFlag || 'BrowseDirectChildren',\r\n                        type: this.types.string\r\n                    },\r\n                    Filter: {\r\n                        value: filter || '*',\r\n                        type: this.types.string\r\n                    },\r\n                    StartingIndex: {\r\n                        value: startingIndex || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    RequestedCount: {\r\n                        value: requestedCount || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    SortCriteria: {\r\n                        value: sortCriteria,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    Result: {\r\n                        type: this.types.xmlObj\r\n                    },\r\n                    NumberReturned: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    TotalMatches: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    UpdateID: {\r\n                        type: this.types.ui4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n\r\n        // *** ContentDirectory:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ContentDirectory:2') {\r\n\r\n            // TODO: GetFeatureList, GetSortExtensionCapabilities, MoveObject\r\n\r\n        }\r\n\r\n\r\n        // *** ContentDirectory:3 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ContentDirectory:3') {\r\n\r\n            // TODO\r\n\r\n        }\r\n\r\n        // *** ContentDirectory:4 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ContentDirectory:4') {\r\n            // TODO\r\n        }\r\n    };\r\n    WinJSContrib.UPnP.UPnPContentDirectory.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n    var allowedConnectionManagerTypes = {\r\n        'urn:schemas-upnp-org:service:ConnectionManager:1': true,\r\n        'urn:schemas-upnp-org:service:ConnectionManager:2': true,\r\n        'urn:schemas-upnp-org:service:ConnectionManager:3': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPConnectionManager = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedConnectionManagerTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Service\");\r\n            return;\r\n        }\r\n\r\n        // *** ConnectionManager:1 methods\r\n\r\n        this.getCurrentConnectionIDs = function (callback) {\r\n\r\n            return this.action('GetCurrentConnectionIDs', {\r\n                request: {},\r\n                response: {\r\n                    ConnectionIDs: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getCurrentConnectionInfo = function (connectionId, callback) {\r\n\r\n            return this.action('GetCurrentConnectionInfo', {\r\n                request: {\r\n                    ConnectionID: {\r\n                        value: connectionId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    RcsID: {\r\n                        type: this.types.i4\r\n                    },\r\n                    AVTransportID: {\r\n                        type: this.types.i4\r\n                    },\r\n                    ProtocolInfo: {\r\n                        type: this.types.string\r\n                    },\r\n                    PeerConnectionManager: {\r\n                        type: this.types.string\r\n                    },\r\n                    PeerConnectionID: {\r\n                        type: this.types.i4\r\n                    },\r\n                    Direction: {\r\n                        type: this.types.string\r\n                    },\r\n                    Status: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getProtocolInfo = function (callback) {\r\n\r\n            return this.action('GetProtocolInfo', {\r\n                request: {},\r\n                response: {\r\n                    Source: {\r\n                        type: this.types.string\r\n                    },\r\n                    Sink: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        // *** ConnectionManager:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ConnectionManager:2') {\r\n            // TODO\r\n        }\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPConnectionManager.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n    var allowedAVTransportTypes = {\r\n        'urn:schemas-upnp-org:service:AVTransport:1': true,\r\n        'urn:schemas-upnp-org:service:AVTransport:2': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPAVTransport = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedAVTransportTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Media Renderer Service\");\r\n            return;\r\n        }\r\n\r\n        // *** AVTransport:1 methods\r\n\r\n        this.getDeviceCapabilities = function (instanceId, callback) {\r\n\r\n            return this.action('GetDeviceCapabilities', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    PlayMedia: {\r\n                        type: this.types.string\r\n                    },\r\n                    RecMedia: {\r\n                        type: this.types.string\r\n                    },\r\n                    RecQualityModes: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getMediaInfo = function (instanceId, callback) {\r\n\r\n            return this.action('GetMediaInfo', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    NrTracks: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    MediaDuration: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentURI: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentURIMetaData: {\r\n                        type: this.types.string\r\n                    },\r\n                    NextURI: {\r\n                        type: this.types.string\r\n                    },\r\n                    NextURIMetaData: {\r\n                        type: this.types.string\r\n                    },\r\n                    PlayMedium: {\r\n                        type: this.types.string\r\n                    },\r\n                    RecordMedium: {\r\n                        type: this.types.string\r\n                    },\r\n                    WriteStatus: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getPositionInfo = function (instanceId, callback) {\r\n\r\n            return this.action('GetPositionInfo', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    Track: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    TrackDuration: {\r\n                        type: this.types.string\r\n                    },\r\n                    TrackMetaData: {\r\n                        type: this.types.xmlObj\r\n                    },\r\n                    TrackURI: {\r\n                        type: this.types.string\r\n                    },\r\n                    RelTime: {\r\n                        type: this.types.string\r\n                    },\r\n                    AbsTime: {\r\n                        type: this.types.string\r\n                    },\r\n                    RelCount: {\r\n                        type: this.types.i4\r\n                    },\r\n                    AbsCount: {\r\n                        type: this.types.i4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getTransportInfo = function (instanceId, callback) {\r\n\r\n            return this.action('GetTransportInfo', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentTransportState: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentTransportStatus: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentSpeed: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getTransportSettings = function (instanceId, callback) {\r\n\r\n            return this.action('GetTransportSettings', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    PlayMode: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    RecQualityMode: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setAVTransportURI = function (instanceId, currentURI, currentURIMetaData, callback) {\r\n\r\n            return this.action('SetAVTransportURI', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    CurrentURI: {\r\n                        value: currentURI,\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentURIMetaData: {\r\n                        value: currentURIMetaData,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.play = function (instanceId, speed, callback) {\r\n\r\n            return this.action('Play', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Speed: {\r\n                        value: speed || '1',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.pause = function (instanceId, callback) {\r\n\r\n            return this.action('Pause', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.stop = function (instanceId, callback) {\r\n\r\n            return this.action('Stop', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.next = function (instanceId, callback) {\r\n\r\n            return this.action('Next', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.previous = function (instanceId, callback) {\r\n\r\n            return this.action('Previous', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.seek = function (instanceId, unit, target, callback) {\r\n\r\n            return this.action('Seek', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Unit: {\r\n                        value: unit,\r\n                        type: this.types.string\r\n                    },\r\n                    Target: {\r\n                        value: target,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        // *** AVTransport:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:AVTransport:2') {\r\n\r\n            // TODO\r\n\r\n        }\r\n    };\r\n    WinJSContrib.UPnP.UPnPAVTransport.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n    var allowedRenderingControlTypes = {\r\n        'urn:schemas-upnp-org:service:RenderingControl:1': true,\r\n        'urn:schemas-upnp-org:service:RenderingControl:2': true,\r\n        'urn:schemas-upnp-org:service:RenderingControl:3': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPRenderingControl = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedRenderingControlTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Media Renderer Service\");\r\n            return;\r\n        }\r\n\r\n        // *** RenderingControl:1 methods\r\n\r\n        this.listPresets = function (instanceId, callback) {\r\n\r\n            return this.action('ListPresets', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentPresetNameList: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.selectPreset = function (instanceId, presetName, callback) {\r\n\r\n            return this.action('SelectPreset', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    PresetName: {\r\n                        value: presetName || \"FactoryDefaults\",\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBrightness = function (instanceId, callback) {\r\n\r\n            return this.action('GetBrightness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBrightness: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setBrightness = function (instanceId, desiredBrightness, callback) {\r\n\r\n            return this.action('SetBrightness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredBrightness: {\r\n                        value: desiredBrightness,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getContrast = function (instanceId, callback) {\r\n\r\n            return this.action('GetContrast', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentContrast: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setContrast = function (instanceId, desiredContrast, callback) {\r\n\r\n            return this.action('SetContrast', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredContrast: {\r\n                        value: desiredContrast,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getSharpness = function (instanceId, callback) {\r\n\r\n            return this.action('GetSharpness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentSharpness: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setSharpness = function (instanceId, desiredSharpness, callback) {\r\n\r\n            return this.action('SetSharpness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredSharpness: {\r\n                        value: desiredSharpness,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getRedVideoGain = function (instanceId, callback) {\r\n\r\n            return this.action('GetRedVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentRedVideoGain: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setRedVideoGain = function (instanceId, desiredRedVideoGain, callback) {\r\n\r\n            return this.action('SetRedVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredRedVideoGain: {\r\n                        value: desiredRedVideoGain,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getGreenVideoGain = function (instanceId, callback) {\r\n\r\n            return this.action('GetGreenVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentGreenVideoGain: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setGreenVideoGain = function (instanceId, desiredGreenVideoGain, callback) {\r\n\r\n            return this.action('SetGreenVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredGreenVideoGain: {\r\n                        value: desiredGreenVideoGain,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBlueVideoGain = function (instanceId, callback) {\r\n\r\n            return this.action('GetBlueVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBlueVideoGain: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setBlueVideoGain = function (instanceId, desiredBlueVideoGain, callback) {\r\n\r\n            return this.action('SetBlueVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredBlueVideoGain: {\r\n                        value: desiredBlueVideoGain,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getRedVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetRedVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentRedVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setRedVideoBlackLevel = function (instanceId, desiredRedVideoBlackLevel, callback) {\r\n\r\n            return this.action('SetRedVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredRedVideoBlackLevel: {\r\n                        value: desiredRedVideoBlackLevel,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getGreenVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetGreenVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentGreenVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setGreenVideoBlackLevel = function (instanceId, desiredGreenVideoBlackLevel, callback) {\r\n\r\n            return this.action('SetGreenVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredGreenVideoBlackLevel: {\r\n                        value: desiredGreenVideoBlackLevel,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBlueVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetBlueVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBlueVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setBlueVideoBlackLevel = function (instanceId, desiredBlueVideoBlackLevel, callback) {\r\n\r\n            return this.action('SetBlueVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredBlueVideoBlackLevel: {\r\n                        value: desiredBlueVideoBlackLevel,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBlueVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetBlueVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBlueVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getColorTemperature = function (instanceId, callback) {\r\n\r\n            return this.action('GetColorTemperature', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentColorTemperature: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setColorTemperature = function (instanceId, desiredColorTemperature, callback) {\r\n\r\n            return this.action('SetColorTemperature', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredColorTemperature: {\r\n                        value: desiredColorTemperature,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getHorizontalKeystone = function (instanceId, callback) {\r\n\r\n            return this.action('GetHorizontalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentHorizontalKeystone: {\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setHorizontalKeystone = function (instanceId, desiredHorizontalKeystone, callback) {\r\n\r\n            return this.action('SetHorizontalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredHorizontalKeystone: {\r\n                        value: desiredHorizontalKeystone,\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVerticalKeystone = function (instanceId, callback) {\r\n\r\n            return this.action('GetVerticalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentVerticalKeystone: {\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setVerticalKeystone = function (instanceId, desiredVerticalKeystone, callback) {\r\n\r\n            return this.action('SetVerticalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredVerticalKeystone: {\r\n                        value: desiredVerticalKeystone,\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getMute = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetMute', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentMute: {\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setMute = function (instanceId, channel, desiredMute, callback) {\r\n\r\n            return this.action('SetMute', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredMute: {\r\n                        value: desiredMute,\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVolume = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetVolume', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentVolume: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setVolume = function (instanceId, channel, desiredVolume, callback) {\r\n\r\n            return this.action('SetVolume', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredVolume: {\r\n                        value: desiredVolume,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVolumeDB = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetVolumeDB', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentVolume: {\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setVolumeDB = function (instanceId, channel, desiredVolume, callback) {\r\n\r\n            return this.action('SetVolumeDB', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredVolume: {\r\n                        value: desiredVolume,\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVolumeDBRange = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetVolumeDBRange', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    MinValue: {\r\n                        type: this.types.i2\r\n                    },\r\n                    MaxValue: {\r\n                        type: this.types.i2\r\n                    },\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getLoudness = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetLoudness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentLoudness: {\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setLoudness = function (instanceId, channel, desiredLoudness, callback) {\r\n\r\n            return this.action('SetLoudness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredLoudness: {\r\n                        value: desiredLoudness,\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        // *** RenderingControl:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:RenderingControl:2' ||\r\n              this.upnpType === 'urn:schemas-upnp-org:service:RenderingControl:3') {\r\n\r\n            this.getStateVariables = function (instanceId, stateVariableList, callback) {\r\n\r\n                return this.action('GetStateVariables', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        },\r\n                        StateVariableList: {\r\n                            value: stateVariableList,\r\n                            type: this.types.string\r\n                        }\r\n                    },\r\n                    response: {\r\n                        StateVariableValuePairs: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.setStateVariables = function (instanceId, renderingControlUDN, serviceType, serviceId, stateVariableValuePairs, callback) {\r\n\r\n                return this.action('SetStateVariables', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        },\r\n                        RenderingControlUDN: {\r\n                            value: renderingControlUDN,\r\n                            type: this.types.string\r\n                        },\r\n                        ServiceType: {\r\n                            value: serviceType,\r\n                            type: this.types.string\r\n                        },\r\n                        ServiceId: {\r\n                            value: serviceId,\r\n                            type: this.types.string\r\n                        },\r\n                        StateVariableValuePairs: {\r\n                            value: stateVariableValuePairs,\r\n                            type: this.types.string\r\n                        }\r\n                    },\r\n                    response: {\r\n                        StateVariableList: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n        }\r\n\r\n        // *** RenderingControl:3 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:RenderingControl:3') {\r\n\r\n            this.getAllowedTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetAllowedTransforms', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        }\r\n                    },\r\n                    response: {\r\n                        CurrentAllowedTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetTransforms', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        }\r\n                    },\r\n                    response: {\r\n                        CurrentTransformValues: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.setTransforms = function (instanceId, desiredTransformValues, callback) {\r\n\r\n                return this.action('SetTransforms', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        },\r\n                        DesiredTransformValues: {\r\n                            value: desiredTransformValues,\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getAllAvailableTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetAllAvailableTransforms', {\r\n                    response: {\r\n                        AllAllowedTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getAllowedDefaultTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetAllowedDefaultTransforms', {\r\n                    response: {\r\n                        AllowedDefaultTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getDefaultTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetDefaultTransforms', {\r\n                    response: {\r\n                        CurrentDefaultTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.setDefaultTransforms = function (instanceId, desiredDefaultTransformSettings, callback) {\r\n\r\n                return this.action('SetDefaultTransforms', {\r\n                    request: {\r\n                        DesiredDefaultTransformSettings: {\r\n                            value: desiredDefaultTransformSettings,\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n        }\r\n\r\n    };\r\n    WinJSContrib.UPnP.UPnPRenderingControl.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n})(window);","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib;\r\n(function (WinJSContrib) {\r\n    'use strict';\r\n\r\n    /**\r\n     * Custom WinJS Bindings\r\n     * @namespace WinJSContrib.Bindings\r\n     */\r\n    (function (Bindings) {\r\n\r\n        /**\r\n         * path for default picture\r\n         */\r\n        WinJSContrib.Bindings.pictureUnavailable = '/images/unavailable.png';\r\n\r\n        /**\r\n         * Helper for reading arguments for an element\r\n         * @param {HTMLElement} element\r\n         * @param {string} argument name\r\n         */\r\n        WinJSContrib.Bindings.bindingArguments = function bindingArguments(elt, argname) {\r\n            var data;\r\n            if (WinJS.UI._optionsParser) {\r\n                var text = elt.getAttribute(\"data-win-bind-args\");\r\n                if (text) {\r\n                    data = WinJS.UI.optionsParser(text, window);\r\n                }\r\n            } else {\r\n                data = elt.dataset.winBindArgs;\r\n            }\r\n\r\n            if (data) {\r\n                if (argname) {\r\n                    return data[argname];\r\n                } else {\r\n                    return data;\r\n                }\r\n            }\r\n        };\r\n        var bindingArguments = WinJSContrib.Bindings.bindingArguments;\r\n\r\n        /**\r\n         * Binding function to remove HTML from data and add it to destination\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.removeHTML = WinJS.Binding.initializer(function (source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            var elt = document.createElement('DIV');\r\n            elt.innerHTML = data;\r\n            WinJS.Binding.oneTime({ value: elt.innerText }, ['value'], dest, [destProperty]);\r\n        });\r\n\r\n        /**\r\n         * Binding function to remove HTML from data and add it to destination with an ellipse after X characters. The number of characters is specified with \"ellipsisize\" argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.removeHTMLAndEllipsisize = WinJS.Binding.initializer(function (source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            var elt = document.createElement('DIV');\r\n            elt.innerHTML = data;\r\n            var textRes = elt.innerText;\r\n            var size = bindingArguments(dest, 'ellipsisize');\r\n\r\n            if (size)\r\n                textRes = toStaticHTML(WinJSContrib.Utils.ellipsisizeString(elt.innerText, size, true));\r\n            WinJS.Binding.oneTime({ value: textRes }, ['value'], dest, [destProperty]);\r\n        });\r\n\r\n        /**\r\n         * Binding function to remove HTML from data and add it to destination with an ellipse after X characters. The number of characters is specified with \"ellipsisize\" argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.staticHTML = WinJS.Binding.initializer(function (source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            dest[destProperty] = toStaticHTML(data);\r\n        });\r\n\r\n        /**\r\n         * Binding function to add a data-* attribute to the element. Use the destination name to specifiy attribute name\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         * @example\r\n         * //assuming object is { myproperty: 42 }\r\n         * <div data-win-bind=\"foo : myproperty WinJSContrib.Bindings.dataAttr\"></div>\r\n         * //will result to\r\n         * <div data-foo=\"42\" data-win-bind=\"foo : myproperty WinJSContrib.Bindings.dataAttr\"></div>\r\n         */\r\n        WinJSContrib.Bindings.dataAttr = WinJS.Binding.initializer(function dataAttrBinding(source, sourceProperty, dest, destProperty) {\r\n        \tvar data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n        \tdest.setAttribute('data-' + destProperty, data)\r\n        });\r\n\r\n        /**\r\n         * Binding function to add css class named after object property. You could format class by using a \"format\" argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.addClass = WinJS.Binding.initializer(function addClassBinding(source, sourceProperty, dest, destProperty) {\r\n            function setClass(newval, oldval) {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                var formatParameter = bindingArguments(dest, 'format');\r\n                if (formatParameter) {\r\n                    dest.classList.remove(formatParameter.format(oldval));\r\n                    dest.classList.add(formatParameter.format(data));\r\n                }\r\n                else {\r\n                    dest.classList.remove(oldval);\r\n                    dest.classList.add(data);\r\n                }\r\n            }\r\n\r\n            var bindingDesc = {};\r\n            bindingDesc[sourceProperty] = setClass;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * add css class based on a prefix defined with destProperty and the value from the source object\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.asClass = WinJS.Binding.initializer(function asClassBinding(source, sourceProperty, dest, destProperty) {\r\n            function setClass(newval, oldval) {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                dest.classList.remove(destProperty + '-' + oldval);\r\n                dest.classList.add(destProperty + '-' + data);\r\n            }\r\n            var bindingDesc = {};\r\n            bindingDesc[sourceProperty] = setClass;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * convert a url string for use as a background image url\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.toBgImage = WinJS.Binding.initializer(function toBgImageBinding(source, sourceProperty, dest, destProperty) {\r\n            function setImage() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data || !data.length) {\r\n                    dest.style.backgroundImage = '';\r\n                    return;\r\n                }\r\n                dest.style.backgroundImage = 'url(\"' + data + '\")';\r\n            }\r\n\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setImage;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n\r\n        WinJSContrib.Bindings.ToRealDate = WinJS.Binding.initializer(function ToRealDateBinding(source, sourceProperty, dest, destProperty) {\r\n            var date = new Date(source.date * 1000);\r\n            dest.innerHTML = date.toLocaleDateString();\r\n        });\r\n\r\n        function _setPic(dest, url) {\r\n            if (dest.nodeName.toLowerCase() == 'img') {\r\n                dest.src = url;\r\n            }\r\n            else {\r\n                dest.style.backgroundImage = 'url(\"' + url + '\")';\r\n            }\r\n            dest.classList.add('imageLoaded');\r\n        }\r\n\r\n        /**\r\n         * Asynchronously load a picture (using src for image tag and background-image for other elements) from url path, and add 'imageLoaded' css class once picture is ready. \r\n         * You could rely on '.imageLoaded' to add transitions for image loading\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.picture = WinJS.Binding.initializer(function toSmartBgImageBinding(source, sourceProperty, dest, destProperty) {\r\n            function setImage() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data || !data.length) {\r\n                    data = Bindings.pictureUnavailable;\r\n                }\r\n\r\n                dest.classList.remove('imageLoaded');\r\n                setTimeout(function () {\r\n                    WinJSContrib.UI.loadImage(data).done(function () {\r\n                        _setPic(dest, data);\r\n                    }, function () {\r\n                        _setPic(dest, Bindings.pictureUnavailable);\r\n                        WinJS.Utilities.addClass(dest, 'imageLoaded');\r\n                    });\r\n                }, 200);\r\n            }\r\n\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setImage;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n        WinJSContrib.Bindings.toSmartBgImage = WinJSContrib.Bindings.picture; //deprecated method name\r\n\r\n        /**\r\n         * show element if property is filled or true. The dest property can be used to choose what to use for showing/hiding object (opacity, visibility, or display)\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.showIf = WinJS.Binding.initializer(function hideUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.classList.remove('mcn-show');\r\n                    dest.classList.add('mcn-hide');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '0';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = 'hidden';\r\n                    } else {\r\n                        dest.style.display = 'none';\r\n                    }\r\n                } else {\r\n                    dest.classList.remove('mcn-hide');\r\n                    dest.classList.add('mcn-show');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = '';\r\n                    } else {\r\n                        dest.style.display = '';\r\n                    }\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * Alias for {@link WinJSContrib.Bindings.showIf}, just for semantic purpose\r\n         * @function\r\n         * @see WinJSContrib.Bindings.showIf\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.hideIfNot = WinJSContrib.Bindings.showIf;\r\n        WinJSContrib.Bindings.hideIfNotDefined = WinJSContrib.Bindings.showIf;//warning, deprecated\r\n\r\n        /**\r\n         * hide element if property is filled or true. The dest property can be used to choose what to use for showing/hiding object (opacity, visibility, or display)\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.hideIf = WinJS.Binding.initializer(function showUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.classList.remove('mcn-hide');\r\n                    dest.classList.add('mcn-show');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = '';\r\n                    } else {\r\n                        dest.style.display = '';\r\n                    }\r\n                } else {\r\n                    dest.classList.remove('mcn-show');\r\n                    dest.classList.add('mcn-hide');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '0';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = 'hidden';\r\n                    } else {\r\n                        dest.style.display = 'none';\r\n                    }\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * Alias for {@link WinJSContrib.Bindings.hideIf}, just for semantic purpose\r\n         * @function\r\n         * @see WinJSContrib.Bindings.hideIf\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.showIfNot = WinJSContrib.Bindings.hideIf; //warning, deprecated\r\n\r\n        WinJSContrib.Bindings.showIfNotDefined = WinJSContrib.Bindings.hideIf; //warning, deprecated\r\n\r\n        /**\r\n         * enable element if property is filled or true\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.enableIf = WinJS.Binding.initializer(function disableUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.disabled = true;\r\n                } else {\r\n                    dest.disabled = false;\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n        WinJSContrib.Bindings.disableIfNot = WinJSContrib.Bindings.enableIf;\r\n\r\n        /**\r\n         * disable element if property is filled or true\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.disableIf = WinJS.Binding.initializer(function enableUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.disabled = false;\r\n                } else {\r\n                    dest.disabled = true;\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n        WinJSContrib.Bindings.enableIfNot = WinJSContrib.Bindings.disableIf;\r\n\r\n        /**\r\n         * apply a percent number as width (in percent) on the element\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.toWidth = WinJS.Binding.initializer(function progressToWidth(source, sourceProperty, dest, destProperty) {\r\n            function setWidth() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.style.width = '';\r\n                } else {\r\n                    dest.style.width = data + '%';\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setWidth;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * truncate a string and add ellipse to the text if string is longer than a limit. The max size of text is determined by a 'ellipsisize' argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         * @example {@lang xml}\r\n         * <p data-win-bind=\"innerText : someLongText WinJSContrib.Bindings.ellipsisize\" data-win-bind-args='{ \"ellipsisize\" : 50}'></p>\r\n         */\r\n        WinJSContrib.Bindings.ellipsisize = WinJS.Binding.initializer(function toEllipsisizedBinding(source, sourceProperty, dest, destProperty) {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            var size = bindingArguments(dest, 'ellipsisize');\r\n            dest[destProperty] = toStaticHTML(WinJSContrib.Utils.ellipsisizeString(sourcedata, size, true));\r\n        });\r\n        WinJSContrib.Bindings.toEllipsisized = WinJSContrib.Bindings.ellipsisize; //deprecated name\r\n\r\n        WinJSContrib.Bindings.emptyIfNull = WinJS.Binding.initializer(function emptyIfNull(source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (typeof data === \"undefined\" || data === null) {\r\n                dest[destProperty] = \"\";\r\n            } else {\r\n                dest[destProperty] = data;\r\n            }\r\n        });\r\n\r\n\r\n        /**\r\n         * Two way binding triggered by \"change\" event on inputs\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.twoWayOnChange = WinJS.Binding.initializer(function twoWayOnChangeBinding(source, sourceProperty, dest, destProperty) {\r\n            function setVal() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                WinJSContrib.Utils.writeProperty(dest, destProperty, data || '');\r\n            }\r\n\r\n            function getVal() {\r\n                var val = WinJSContrib.Utils.getProperty(dest, destProperty);\r\n                WinJSContrib.Utils.writeProperty(source, sourceProperty, val.propValue);\r\n            }\r\n\r\n            dest.addEventListener('change', getVal, false);\r\n            if (!dest.winControl) {\r\n                dest.classList.add('win-disposable');\r\n                dest.winControl = {\r\n                    dispose: function () {\r\n                        dest.removeEventListener('change', getVal);\r\n                    }\r\n                };\r\n            }\r\n\r\n            var bindingDesc = {\r\n            };\r\n\r\n            bindingDesc[sourceProperty] = setVal;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /** \r\n         * cleans up a binding list by returning its items as non-observable \r\n         * @function \r\n         * @param {Object[]} bindingList binding list to clean up \r\n         * @returns {Object[]} array containing the cleaned up items \r\n         */\r\n        Bindings.cleanUpBindingList = function (bindingList) {\r\n            var result = [];\r\n\r\n            bindingList.forEach(function (item) {\r\n                var unwrappedItem = WinJS.Binding.unwrap(item);\r\n                result.push(unwrappedItem);\r\n            });\r\n\r\n            return result;\r\n        };\r\n\r\n\r\n    })(WinJSContrib.Bindings || (WinJSContrib.Bindings = {}));\r\n    var Bindings = WinJSContrib.Bindings;\r\n})(WinJSContrib || (WinJSContrib = {}));\r\n","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/// <reference path=\"WinJSContrib.binding.utils.js\" />\r\n/// <reference path=\"moment.min.js\" />\r\n\r\nvar WinJSContrib;\r\nWinJSContrib.Utils = WinJSContrib.Utils || {};\r\nWinJSContrib.Bindings = WinJSContrib.Bindings || {};\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    /** \r\n     * format date using binding argument 'formatDate'\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.formatDate = WinJS.Utilities.markSupportedForProcessing(function formatDateBinding(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                var arg = WinJSContrib.Bindings.bindingArguments(dest, 'formatDate') || 'L';\r\n                dest.innerText = moment(sourcedata).format(arg);\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n    /** \r\n     * format date using calendar function\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.calendar = WinJS.Utilities.markSupportedForProcessing(function formatDateBinding(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                dest.innerText = moment(sourcedata).calendar();\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n    function daysSince(m, d, y) {\r\n        if (d == '' || m == '' || y == '') {\r\n            //alert(\"All fields must be entered\");\r\n            return;\r\n        }\r\n\r\n        if (isNaN(m) || isNaN(y) || isNaN(d)) {\r\n            //alert(\"Only numbers .\");\r\n            return;\r\n        }\r\n\r\n        var myDate = new Date();\r\n        var yourDate = new Date(y, m - 1, d);\r\n\r\n        var secondsInADay = 1000 * 60 * 60 * 24;\r\n        var diff = Math.floor((myDate.getTime() - yourDate.getTime()) / secondsInADay);\r\n        return diff;\r\n    }\r\n\r\n\r\n    /**\r\n     * display number of days since a date\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.daysSinceDate = WinJS.Utilities.markSupportedForProcessing(function daysSinceDateBinding(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                sourcedata = new Date(sourcedata);\r\n                var m = sourcedata.getMonth() + 1, d = sourcedata.getDate(), y = sourcedata.getFullYear();\r\n                var fromdate = daysSince(m, d, y);\r\n                dest.innerText = fromdate;\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n    /**\r\n     * apply moment.js humanize formatting on a date. Use 'humanizeFormat' and 'addSuffix' arguments to configure binding\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.humanizeDate = WinJS.Utilities.markSupportedForProcessing(function humanizeDate(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                var arg = WinJSContrib.Bindings.bindingArguments(dest, \"humanizeFormat\"),\r\n                    addSuffix = WinJSContrib.Bindings.bindingArguments(dest, \"addSuffix\");\r\n                dest.innerText = moment.duration(sourcedata, arg).humanize(addSuffix);\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n\r\n})();","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib = WinJSContrib || {};\r\n\r\n(function () {\r\n\r\n    function Messenger(receiver, sender) {\r\n        var messenger = this;\r\n        messenger.isWorker = receiver.document === undefined;\r\n        messenger._pendings = {};\r\n        messenger._receiver = receiver;\r\n        messenger._sender = sender || receiver;\r\n        messenger._bindedProcessEvent = messenger._processEvent.bind(messenger);\r\n\r\n        if (messenger._receiver)\r\n            messenger._receiver.addEventListener('message', messenger._bindedProcessEvent);\r\n    };\r\n\r\n    /**\r\n     * @classdesc\r\n     * Wrapper for messaging between main code and iframe or web worker. All returns are wrapped as WinJS.Promise to enable asynchronous scenarios     \r\n     * @class\r\n     * @param {DOMElement} receiver element that will receive messages\r\n     * @param {DOMElement} sender element that will send messages\r\n     */\r\n    WinJSContrib.Messenger = WinJS.Class.mix(Messenger, WinJS.Utilities.eventMixin);\r\n\r\n    /**\r\n     * default path for smart worker js file\r\n     */\r\n    WinJSContrib.Messenger.SmartWorkerPath = '/scripts/winjscontrib/winjscontrib.messenger.worker.js';\r\n\r\n    /**\r\n     * @classdesc\r\n     * Wrapper for {@link WinJSContrib.Messenger} when using it with a webworker\r\n     * @class\r\n     * @param {string} [path] path to web worker file\r\n     */\r\n    WinJSContrib.Messenger.SmartWorker = function (path) {\r\n        if (window.Worker) {\r\n            var w = new window.Worker(path || WinJSContrib.Messenger.SmartWorkerPath);\r\n            return new WinJSContrib.Messenger(w, w);\r\n        }\r\n\r\n        return new WinJSContrib.Messenger(null, null);\r\n    }\r\n\r\n\r\n    WinJSContrib.Messenger.prototype._send = function (obj) {\r\n        if (this.isWorker) {\r\n            this._sender.postMessage(JSON.stringify(obj));\r\n        }\r\n        else {\r\n            this._sender.postMessage(JSON.stringify(obj), '*');\r\n        }\r\n    };\r\n\r\n    /**\r\n     * import script files\r\n     * @param {Array} scriptPaths an array of string paths to js files\r\n     */\r\n    WinJSContrib.Messenger.prototype.importScripts = function (scriptPaths) {\r\n        if (!this._receiver)\r\n            return WinJS.Promise.wrap();\r\n\r\n        return this.start('_doImportScripts', scriptPaths);\r\n    }\r\n\r\n    WinJSContrib.Messenger.prototype._doImportScripts = function (scriptPaths) {\r\n        return new WinJS.Promise(function (c) {\r\n            if (typeof scriptPaths == 'string') {\r\n                importScripts(scriptPaths);\r\n            } else if (scriptPaths.length) {\r\n                for (var i = 0 ; i < scriptPaths.length ; i++) {\r\n                    importScripts(scriptPaths[i]);\r\n                }\r\n            }\r\n            c();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * run the callback in the web worker. The callback is serialized to string so you must pass all variable used inside the function as arguments\r\n     * @param {function} func function callback\r\n     * @param {...Object} args\r\n     * @returns {WinJS.Promise}\r\n     */\r\n    WinJSContrib.Messenger.prototype.execute = function (func) {\r\n        var messenger = this;\r\n        var args = [];\r\n        if (arguments.length > 1) {\r\n            for (var i = 1 ; i < arguments.length; i++) {\r\n                args.push(arguments[i]);\r\n            }\r\n        }\r\n\r\n        if (messenger._receiver) {\r\n            var f = 'var messengerFunction=' + func;\r\n\r\n            return this.start('_runFunction', { f: f, args: args });\r\n        }\r\n        else {\r\n            return WinJS.Promise.timeout(0).then(function () {\r\n                return func.apply(null, args);\r\n            });\r\n        }\r\n    }\r\n\r\n    WinJSContrib.Messenger.prototype._runFunction = function (functionArgs) {\r\n        var messenger = this;\r\n        return new WinJS.Promise(function (c, e) {\r\n            try {\r\n                eval(functionArgs.f);\r\n                var res = messengerFunction.apply(null, functionArgs.args);\r\n                c(res);\r\n            } catch (exception) {\r\n                e(exception);\r\n            }\r\n        });\r\n    }\r\n\r\n    WinJSContrib.Messenger.prototype.map = function (object, functions) {\r\n        var messenger = this;\r\n        functions.forEach(function (name) {\r\n            messenger[name] = function () {\r\n                var f = object[name];\r\n                return f.apply(object, arguments);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * start an operation within iframe or worker and get a promise for completion\r\n     * @param {string} eventName name of the event/function to call\r\n     * @param {Object} data event/function passed as argument\r\n     * @returns {WinJS.Promise}\r\n     */\r\n    WinJSContrib.Messenger.prototype.start = function (eventName, data, asArgs) {\r\n        var messenger = this;\r\n\r\n        if (!messenger._receiver)\r\n            return WinJS.Promise.wrapError('worker not supported');\r\n\r\n        var wrapper = {\r\n            id: WinJSContrib.Utils.guid(),\r\n            complete: null, error: null, progress: null, promise: null\r\n        }\r\n\r\n        var event = {\r\n            name: eventName,\r\n            id: wrapper.id,\r\n            type: 'run',\r\n            data: data,\r\n            asArgs: asArgs,\r\n            sender: 'WinJSContrib.WinJSContrib.Messenger'\r\n        };\r\n\r\n        wrapper.promise = new WinJS.Promise(function (c, e, p) {\r\n            wrapper.complete = c;\r\n            wrapper.error = e;\r\n            wrapper.progress = p;\r\n        }, function oncancel() {\r\n            console.warn('message canceled');\r\n            event.type = 'cancel';\r\n            messenger._send(event);\r\n        });\r\n\r\n        messenger._pendings[wrapper.id] = wrapper;\r\n        var cleanUp = function () {\r\n            delete messenger._pendings[wrapper.id];\r\n        }\r\n        wrapper.promise.done(cleanUp, cleanUp);\r\n        messenger._send(event);\r\n\r\n        return wrapper.promise;\r\n    };\r\n\r\n    WinJSContrib.Messenger.prototype._processEvent = function (arg) {\r\n        var messenger = this;\r\n       \r\n        var details = typeof (arg.data) == 'string' ? JSON.parse(arg.data) : arg.data;\r\n        var name = details.name;\r\n        var data = details.data;\r\n        var asArgs = details.asArgs;\r\n\r\n        if (details.id) {\r\n            var wrapper = messenger._pendings[details.id];\r\n            if (wrapper && wrapper[details.type]) {\r\n                wrapper[details.type](data);\r\n                return;\r\n            }\r\n\r\n            if (details.type === 'cancel') {\r\n                var current = messenger._pendings[details.id];\r\n                if (current) {\r\n                    current.promise.cancel();\r\n                    delete messenger._pendings[details.id];\r\n                }\r\n            }\r\n            else if (details.type==='run' && name && messenger[name]) {\r\n                try {\r\n                    var p = null;\r\n                    if (asArgs) {\r\n                        p = WinJS.Promise.as(messenger[name].apply(messenger[name], data));\r\n                    } else {\r\n                        p = WinJS.Promise.as(messenger[name](data));\r\n                    }\r\n\r\n                   messenger._pendings[details.id] = { promise: p, details: details };\r\n\r\n                    p.then(function (arg) {\r\n                        messenger._send({ name: name, id: details.id, type: 'complete', sender: 'WinJSContrib.WinJSContrib.Messenger', data: arg });\r\n                    }, function (arg) {\r\n                        messenger._send({ name: name, id: details.id, type: 'error', sender: 'WinJSContrib.WinJSContrib.Messenger', data: arg });\r\n                    }, function (arg) {\r\n                        messenger._send({ name: name, id: details.id, type: 'progress', sender: 'WinJSContrib.WinJSContrib.Messenger', data: arg });\r\n                    }).then(function () {\r\n                        delete messenger._pendings[details.id];\r\n                    });\r\n                } catch (exception) {\r\n                    delete messenger._pendings[details.id];\r\n                    messenger._send({ name: name, id: details.id, type: 'error', sender: 'WinJSContrib.WinJSContrib.Messenger', data: { description: exception.description, message: exception.message, stack: exception.stack } });\r\n                }\r\n\r\n                return;\r\n            }\r\n            else {\r\n                messenger._send({ name: name, id: details.id, type: 'error', sender: 'WinJSContrib.WinJSContrib.Messenger', data: { message: 'callback function not found' } });\r\n            }\r\n        } else {\r\n            if (name && messenger[name]) {\r\n                messenger[name](data);\r\n                return;\r\n            }\r\n            messenger.dispatchEvent(name, data);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * release messenger and associated resources (if using webworker, worker is terminated\r\n     */\r\n    WinJSContrib.Messenger.prototype.dispose = function () {\r\n        var messenger = this;\r\n        if (messenger._receiver) {\r\n            if (messenger._receiver.terminate)\r\n                messenger._receiver.terminate();\r\n\r\n            messenger._receiver.removeEventListener('message', messenger._bindedProcessEvent);\r\n        }\r\n    };\r\n})();","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar __global = this;\r\nvar WinJSContrib;\r\n(function (WinJSContrib) {\r\n    var DataContainer;\r\n    (function (DataContainer) {\r\n        DataContainer.current = WinJSContrib.DataContainer.current || null;\r\n        var containerLogger = WinJSContrib.Logs.getLogger(\"WinJSContrib.DataContainer.WinRT\");\r\n        var WinRTFilesContainer = (function () {\r\n            function WinRTFilesContainer(key, options, parent) {\r\n                var container = this;\r\n                container.key = key;\r\n                container.options = options || {};\r\n                container.parent = parent;\r\n                container.folderPromise;\r\n                container.useDataCache = container.options.useDataCache || false;\r\n                container.dataCache = {};\r\n                container.childs = {};\r\n                if (!__global.Windows)\r\n                    throw \"WinRT is required !\";\r\n                if (!key) {\r\n                    container.folder = Windows.Storage.ApplicationData.current.localFolder;\r\n                    container.folderPromise = WinJS.Promise.wrap(container.folder);\r\n                }\r\n                else if (parent) {\r\n                    container.folderPromise = parent.folderPromise.then(function (parentfolder) {\r\n                        if (container.options.logger)\r\n                            container.options.logger.debug(\"open folder \" + key);\r\n                        return parentfolder.createFolderAsync(key, Windows.Storage.CreationCollisionOption.openIfExists);\r\n                    }).then(function (folder) {\r\n                        container.folder = folder;\r\n                        return folder;\r\n                    });\r\n                }\r\n            }\r\n            WinRTFilesContainer.makeCurrent = function (key, options) {\r\n                WinJSContrib.DataContainer.current = new WinRTFilesContainer(key, options);\r\n            };\r\n            WinRTFilesContainer.prototype.read = function (itemkey) {\r\n                var container = this;\r\n                if (container.useDataCache) {\r\n                    var data = container.dataCache[itemkey];\r\n                    if (data) {\r\n                        //clone object to avoid unintended object alteration\r\n                        var clone = JSON.parse(JSON.stringify(data));\r\n                        return WinJS.Promise.wrap(clone);\r\n                    }\r\n                }\r\n                return container.folderPromise.then(function (folder) {\r\n                    return readFileAsync(folder, itemkey, container.options.encrypted, Windows.Storage.CreationCollisionOption.openIfExists, 0, container.options.logger).then(function (data) {\r\n                        if (container.useDataCache) {\r\n                            container.dataCache[itemkey] = data;\r\n                        }\r\n                        return data;\r\n                    });\r\n                });\r\n            };\r\n            WinRTFilesContainer.prototype.save = function (itemkey, obj) {\r\n                var container = this;\r\n                if (container.useDataCache) {\r\n                    container.dataCache[itemkey] = obj;\r\n                }\r\n                return container.folderPromise.then(function (folder) {\r\n                    return writeFileAsync(folder, itemkey, obj, container.options.encrypted, Windows.Storage.CreationCollisionOption.replaceExisting, 0, container.options.logger);\r\n                });\r\n            };\r\n            WinRTFilesContainer.prototype.remove = function (itemkey) {\r\n                var container = this;\r\n                return container.folderPromise.then(function (folder) {\r\n                    return deleteItemIfExistsAsync(folder, itemkey, container.options.logger);\r\n                });\r\n            };\r\n            WinRTFilesContainer.prototype.listKeys = function () {\r\n                var container = this;\r\n                return container.folderPromise.then(function (folder) {\r\n                    return folder.getFilesAsync().then(function (files) {\r\n                        return files.map(function (f) {\r\n                            var key = f.path.substr(folder.path.length + 1);\r\n                            var ext = key.indexOf('.json');\r\n                            if (ext > 0) {\r\n                                key = key.substr(0, ext);\r\n                            }\r\n                            return key;\r\n                        });\r\n                    });\r\n                });\r\n            };\r\n            WinRTFilesContainer.prototype.list = function () {\r\n                var container = this;\r\n                return container.folderPromise.then(function (folder) {\r\n                    return folder.getFilesAsync();\r\n                });\r\n            };\r\n            WinRTFilesContainer.prototype.child = function (key) {\r\n                if (this.childs[key])\r\n                    return this.childs[key];\r\n                var res = new WinRTFilesContainer(key, this.options, this);\r\n                this.childs[key] = res;\r\n                return res;\r\n            };\r\n            WinRTFilesContainer.prototype.childWithTransaction = function (key, process) {\r\n                var current = this;\r\n                return this.child(key + \"-tmp\").folderPromise.then(function (winrtfolder) {\r\n                    return winrtfolder.deleteAsync().then(function () {\r\n                        return current.child(key + \"-tmp\");\r\n                    });\r\n                }).then(function (folder) {\r\n                    return process(folder).then(function (data) {\r\n                        return folder.folderPromise.then(function (winrtfolder) {\r\n                            return winrtfolder.renameAsync(key, Windows.Storage.NameCollisionOption.replaceExisting).then(function () {\r\n                                current.childs[key] = null;\r\n                                current.childs[key + \"-tmp\"] = null;\r\n                                return current.child(key);\r\n                            });\r\n                        });\r\n                    });\r\n                });\r\n            };\r\n            WinRTFilesContainer.prototype.deleteContainer = function () {\r\n                var container = this;\r\n                return container.folderPromise.then(function (folder) {\r\n                    return folder.deleteAsync();\r\n                });\r\n            };\r\n            WinRTFilesContainer.prototype.clearAllCache = function () {\r\n                var container = this;\r\n                container.clearCache();\r\n                container.clearDataCache();\r\n            };\r\n            WinRTFilesContainer.prototype.clearCache = function () {\r\n                var container = this;\r\n                container.childs = {};\r\n                for (var k in container.childs) {\r\n                    if (container.childs.hasOwnProperty(k)) {\r\n                        container.childs[k].clearCache();\r\n                    }\r\n                }\r\n            };\r\n            WinRTFilesContainer.prototype.clearDataCache = function () {\r\n                var container = this;\r\n                container.dataCache = {};\r\n                for (var k in container.childs) {\r\n                    if (container.childs.hasOwnProperty(k)) {\r\n                        container.childs[k].clearDataCache();\r\n                    }\r\n                }\r\n            };\r\n            return WinRTFilesContainer;\r\n        })();\r\n        DataContainer.WinRTFilesContainer = WinRTFilesContainer;\r\n        function toJSONFileName(fileName) {\r\n            return encodeURIComponent(fileName) + \".json\";\r\n        }\r\n        function deleteItemIfExistsAsync(folder, itemName, logger) {\r\n            return folder.getItemAsync(toJSONFileName(itemName)).then(function (item) {\r\n                return item;\r\n            }, function () {\r\n            }).then(function (item) {\r\n                if (item) {\r\n                    return item.deleteAsync().then(function () {\r\n                        if (logger)\r\n                            logger.debug(\"item deleted \" + item.path);\r\n                    }, function (err) {\r\n                        if (logger)\r\n                            logger.error(\"cannot delete item \" + item.path);\r\n                    });\r\n                }\r\n                else {\r\n                    return WinJS.Promise.wrap([]);\r\n                }\r\n            });\r\n        }\r\n        function getFileContentAsJSONAsync(file, encrypted) {\r\n            return Windows.Storage.FileIO.readBufferAsync(file).then(function (cypheredText) {\r\n                if (!encrypted)\r\n                    return cypheredText;\r\n                // On vérifie que le fichier n'est pas vide\r\n                if (cypheredText.length) {\r\n                    var provider = new Windows.Security.Cryptography.DataProtection.DataProtectionProvider();\r\n                    return provider.unprotectAsync(cypheredText);\r\n                }\r\n                else {\r\n                    return null;\r\n                }\r\n            }).then(function (unprotectedData) {\r\n                var obj = null;\r\n                if (unprotectedData !== null && unprotectedData !== undefined) {\r\n                    var rawText = Windows.Security.Cryptography.CryptographicBuffer.convertBinaryToString(Windows.Security.Cryptography.BinaryStringEncoding.utf8, unprotectedData);\r\n                    if (rawText) {\r\n                        try {\r\n                            obj = JSON.parse(rawText);\r\n                        }\r\n                        catch (exception) { }\r\n                    }\r\n                }\r\n                return obj;\r\n            });\r\n        }\r\n        function readFileAsync(folder, fileName, encrypted, creationCollisionOption, retry, logger) {\r\n            logger = logger || containerLogger;\r\n            return new WinJS.Promise(function (readComplete, readError) {\r\n                retry = retry || 0;\r\n                creationCollisionOption = creationCollisionOption || Windows.Storage.CreationCollisionOption.openIfExists;\r\n                var filename = toJSONFileName(fileName);\r\n                //folder.getFilesAsync(filename).then(function(file){})\r\n                folder.getFileAsync(filename).then(function (file) {\r\n                    return getFileContentAsJSONAsync(file, encrypted);\r\n                }).then(function (res) {\r\n                    logger.verbose(\"read \" + folder.path + '\\\\' + toJSONFileName(fileName));\r\n                    readComplete(res);\r\n                }, function (err) {\r\n                    if (err.number == -2147024894) {\r\n                        logger.debug(\"read empty \" + folder.path + '\\\\' + toJSONFileName(fileName));\r\n                        readComplete();\r\n                        return;\r\n                    }\r\n                    logger.warn(\"error reading \" + folder.path + '\\\\' + toJSONFileName(fileName));\r\n                    if (retry < 2) {\r\n                        setImmediate(function () {\r\n                            logger.info(\"retry reading \" + folder.path + '\\\\' + toJSONFileName(fileName));\r\n                            readFileAsync(folder, fileName, encrypted, creationCollisionOption, retry + 1, logger).then(readComplete, readError);\r\n                        });\r\n                    }\r\n                    else {\r\n                        readError({ message: 'fatal error reading ' + folder.path + '\\\\' + toJSONFileName(fileName), exception: err });\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        function writeFileAsync(folder, fileName, objectGraph, encrypt, creationCollisionOption, retry, logger) {\r\n            logger = logger || containerLogger;\r\n            return new WinJS.Promise(function (writeComplete, writeError) {\r\n                retry = retry || 0;\r\n                creationCollisionOption = creationCollisionOption || Windows.Storage.CreationCollisionOption.replaceExisting;\r\n                var bufferedText = Windows.Security.Cryptography.CryptographicBuffer.convertStringToBinary(JSON.stringify(objectGraph), Windows.Security.Cryptography.BinaryStringEncoding.utf8);\r\n                if (encrypt) {\r\n                    var provider = new Windows.Security.Cryptography.DataProtection.DataProtectionProvider(\"Local=user\");\r\n                }\r\n                function manageError(err) {\r\n                    logger.warn(\"error writing \" + folder.path + '\\\\' + toJSONFileName(fileName));\r\n                    if (retry < 2) {\r\n                        setImmediate(function () {\r\n                            logger.info(\"retry writing \" + folder.path + '\\\\' + toJSONFileName(fileName));\r\n                            writeFileAsync(folder, fileName, objectGraph, encrypt, creationCollisionOption, retry + 1, logger).then(writeComplete, writeError);\r\n                        });\r\n                    }\r\n                    else {\r\n                        writeError({ message: \"fatal error writing \" + folder.path + '\\\\' + toJSONFileName(fileName) + '\\r\\n', exception: err });\r\n                    }\r\n                }\r\n                // Ces deux opérations ne sont pas dépendantes l'une de l'autre et peuvent s'exécuter en parallèle\r\n                var filePromise = folder.createFileAsync(toJSONFileName(fileName), creationCollisionOption);\r\n                var protectionPromise = encrypt ? provider.protectAsync(bufferedText) : WinJS.Promise.wrap(bufferedText);\r\n                WinJS.Promise.join([filePromise, protectionPromise]).then(function (data) {\r\n                    var file = data[0];\r\n                    var protectedData = data[1];\r\n                    Windows.Storage.FileIO.writeBufferAsync(file, protectedData).then(function () {\r\n                        logger.verbose(\"file written \" + file.path);\r\n                        //setImmediate(function () {\r\n                        writeComplete(file);\r\n                        //});\r\n                    }, manageError);\r\n                }, manageError);\r\n            });\r\n        }\r\n    })(DataContainer = WinJSContrib.DataContainer || (WinJSContrib.DataContainer = {}));\r\n})(WinJSContrib || (WinJSContrib = {}));\r\n","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/**\r\n * @namespace\r\n */\r\nvar WinJSContrib = WinJSContrib || {};\r\n\r\n/**\r\n * @namespace\r\n */\r\nWinJSContrib.UI = WinJSContrib.UI || {};\r\n\r\n/**\r\n * @namespace\r\n */\r\nWinJSContrib.Utils = WinJSContrib.Utils || {};\r\n\r\n/// <reference path=\"winjscontrib.core.js\" />\r\nfunction HSL(hVal, sVal, lVal) {\r\n    var res = {\r\n        h: hVal,\r\n        s: sVal,\r\n        l: lVal,\r\n        addH: function (increment) {\r\n            this.h = this.h + increment;\r\n        },\r\n        addS: function (increment) {\r\n            this.s = this.s + increment;\r\n        },\r\n        addL: function (increment) {\r\n            this.l = this.l + increment;\r\n        },\r\n        toString: function () {\r\n            return 'hsl(' + this.h + ',' + this.s + '%, ' + this.l + '%)';\r\n        },\r\n        clone: function (hInc, sInc, lInc) {\r\n            var res = new HSL(this.h, this.s, this.l);\r\n            res.addH(hInc);\r\n            res.addS(sInc);\r\n            res.addL(lInc);\r\n            return res;\r\n        }\r\n    };\r\n\r\n    return res;\r\n}\r\n\r\n(function ($) {\r\n    $.fn.winControl = function () {\r\n        return this[0].winControl;\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.tap = function (callback, options) {\r\n        var opt = options || {};\r\n\r\n        return this.each(function () {\r\n        \tWinJSContrib.UI.tap(this, callback, options);\r\n        });\r\n    };\r\n\r\n    $.fn.untap = function (callback) {\r\n        return this.each(function () {\r\n            WinJSContrib.UI.untap(this);            \r\n        });\r\n    };\r\n\r\n    jQuery.fn.hatchShow = function () {\r\n        $('.hsjs').css('visibility', 'hidden').css('font-size', '').css('display', 'inner-block').css('white-space', 'pre').each(function () {\r\n            var t = $(this);\r\n            var parent = t.parent();\r\n            if (parent.hasClass('hatchshow_temp')) {\r\n                //t = parent;\r\n                parent = parent.parent();\r\n            }\r\n            else {\r\n                t.wrap(\"<span class='hatchshow_temp' style='display:block'>\");\r\n            }\r\n            var pw = parent.width();\r\n            var w = t.width();\r\n            while (t.width() < pw) {\r\n                var fsize = t.fontSize();\r\n                if (fsize > 200)\r\n                    break;\r\n                t.css('font-size', (fsize + 1) + \"px\"),\r\n                  function () {\r\n                      while (t.width() > pw) {\r\n                          var fsize = t.fontSize();\r\n                          if (fsize < 8)\r\n                              break;\r\n                          t.css('font-size', (fsize - .1) + \"px\")\r\n                      }\r\n                  };\r\n            };\r\n        }).hide().css('visibility', '').fadeIn();\r\n    };\r\n\r\n\r\n    jQuery.fn.fontSize = function () { return parseInt($(this).css('font-size').replace('px', '')); };\r\n\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.pressEnterDefaultTo = function (eltSelector, scope) {\r\n        return this.each(function () {\r\n            var $this = $(this);\r\n            $this.keypress(function (e) {\r\n                var key = e.which ? e.which : e.keyCode;\r\n                if (key == 13) {\r\n                    var $elt = scope ? $(eltSelector, scope) : $(eltSelector);\r\n                    jQuery(this).blur();\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    if ($elt[0].mcnTapTracking && $elt[0].mcnTapTracking.callback) {\r\n                        $elt[0].mcnTapTracking.callback($elt[0]);\r\n                    }\r\n                    $elt.focus().click();\r\n                }\r\n            });\r\n        });\r\n    };\r\n\r\n    $.fn.onPressEnter = function (callback) {\r\n        return this.each(function () {\r\n            var $this = $(this);\r\n            $this.keypress(function (e) {\r\n                var key = e.which ? e.which : e.keyCode;\r\n                if (key == 13) {\r\n                    jQuery(this).blur();\r\n                    e.preventDefault();\r\n                    if (callback) callback();\r\n                }\r\n            });\r\n        });\r\n    };\r\n\r\n    $.fn.throttleTextChanged = function (throttling, callback) {\r\n        return this.each(function () {\r\n            var elt = this;\r\n            var $this = $(this);\r\n            var lastval = elt.value;\r\n            $this.keydown(function (e) {\r\n                clearTimeout(elt.mcnTxtThrottling);\r\n                elt.mcnTxtThrottling = setTimeout(function () {\r\n                    lastval = elt.value;\r\n                    callback(elt, elt.value);\r\n                }, throttling);\r\n            });\r\n\r\n            $this.blur(function (e) {\r\n                if (lastval != elt.value) {\r\n                    lastval = elt.value;\r\n                    callback(elt, elt.value);\r\n                }\r\n            });\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.transitionProperties = function (properties, delay, targetValueCallback) {\r\n        var that = $(this);\r\n        //-ms-transition: all @transdur ease-in-out;\r\n        return new WinJS.Promise(function (complete, error) {\r\n            var val = properties + ' ' + delay + 'ms ease-out';\r\n            var res = that.css('transition', val);\r\n\r\n            if (targetValueCallback) {\r\n                targetValueCallback(res);\r\n            }\r\n            res.delay(delay + 10).promise().done(function () {\r\n                that.css('-ms-transition', '');\r\n                complete(res);\r\n            },\r\n            function () {\r\n                that.css('-ms-transition', '');\r\n                error(res);\r\n            });\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.toWinJSPromise = function () {\r\n        return new WinJS.Promise(function (complete, error) {\r\n            var res = this.promise().done(function () {\r\n                complete(res);\r\n            },\r\n            function () {\r\n                error(res);\r\n            });\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.renderWith = function (templateSelector, object) {\r\n        var template = $(templateSelector).get(0);\r\n        if (template)\r\n            template = template.winControl;\r\n\r\n        return this.each(function () {\r\n            var $this = $(this);\r\n            if (template) {\r\n                template.render(null, object).done(function (elt) {\r\n                    $this.append(elt.children[0]);\r\n                });\r\n            }\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.renderWithEach = function (templateSelector, objectArray, itemCallback) {\r\n        var template = $(templateSelector).get(0);\r\n        if (template)\r\n            template = template.winControl;\r\n\r\n        return this.each(function () {\r\n            var $this = $(this);\r\n            if (template) {\r\n                objectArray.forEach(function (element, index) {\r\n                    template.render(null, element).done(function (elt) {\r\n                        var templatedElt = elt.children[0];\r\n                        $this.append(templatedElt);\r\n                        if (itemCallback)\r\n                            itemCallback(element, templatedElt);\r\n                    });\r\n                });\r\n            }\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.scrollInView = function (offset, animate) {\r\n        var viewState = Windows.UI.ViewManagement.ApplicationView.value;\r\n        var horizontal = true;\r\n        if (viewState === Windows.UI.ViewManagement.ApplicationViewState.snapped || viewState === Windows.UI.ViewManagement.ApplicationViewState.fullScreenPortrait)\r\n            horizontal = false;\r\n\r\n        return this.each(function () {\r\n            var $this = $(this);\r\n            if (horizontal) {\r\n                this.offsetParent.scrollLeft = this.offsetLeft - (offset ? offset : 0);\r\n            } else {\r\n                this.offsetParent.scrollTop = this.offsetTop - (offset ? offset : 0);\r\n            }\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.scrollInParentView = function (offset, animate) {\r\n        var viewState = Windows.UI.ViewManagement.ApplicationView.value;\r\n        var horizontal = true;\r\n        if (viewState === Windows.UI.ViewManagement.ApplicationViewState.snapped || viewState === Windows.UI.ViewManagement.ApplicationViewState.fullScreenPortrait)\r\n            horizontal = false;\r\n\r\n        return this.each(function () {\r\n            if (horizontal) {\r\n                this.offsetParent.offsetParent.scrollLeft = this.offsetLeft - (offset ? offset : 0);\r\n            } else {\r\n                this.offsetParent.offsetParent.scrollTop = this.offsetTop - (offset ? offset : 0);\r\n            }\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.loadedPromises = function (callback) {\r\n        var res = [];\r\n        this.each(function () {\r\n            var $this = $(this);\r\n            var that = this;\r\n            var promise = new WinJS.Promise(function (complete, error) {\r\n                function onerror(e) {\r\n                    that.removeEventListener('error', onerror);\r\n                    that.removeEventListener('load', onloaded);\r\n                    error({ message: 'element not loaded', elt: e.currentTarget });\r\n                }\r\n\r\n                function onloaded() {\r\n                    that.removeEventListener('error', onerror);\r\n                    that.removeEventListener('load', onloaded);\r\n                    complete(that);\r\n                    if (callback)\r\n                        callback(that);\r\n                }\r\n\r\n                that.addEventListener('error', onerror);\r\n                that.addEventListener('load', onloaded, false);\r\n\r\n                if (that.naturalWidth > 0) {\r\n                    onloaded();\r\n                }\r\n            });\r\n            res.push(promise);\r\n        });\r\n\r\n        return res;\r\n    };\r\n\r\n    $.fn.whenLoaded = function (callback) {\r\n        var promises = this.loadedPromises();\r\n        if (callback) {\r\n            WinJS.Promise.join(promises).done(function (res) {\r\n                callback(res);\r\n            });\r\n        } else {\r\n            return WinJS.Promise.join(promises);\r\n        }\r\n    };\r\n\r\n    $.fn.afterTransition = function (callback, timeout) {\r\n        var promises = [];\r\n        var completed = false;\r\n\r\n        this.each(function () {\r\n            var currentElement = this;\r\n\r\n            var prom = new WinJS.Promise(function (complete, error) {\r\n                var onaftertransition = function (event) {\r\n                    if (event.srcElement === currentElement) {\r\n                        close();\r\n                    }\r\n                };\r\n                var close = function () {\r\n                    clearTimeout(timeOutRef);\r\n                    currentElement.removeEventListener(\"transitionend\", onaftertransition, false);\r\n                    complete();\r\n                }\r\n\r\n                currentElement.addEventListener(\"transitionend\", onaftertransition, false);\r\n                timeOutRef = setTimeout(close, timeout || 1000);\r\n            });\r\n            promises.push(prom);\r\n        });\r\n\r\n        var success = null, error = null;\r\n        var resultPromise = new WinJS.Promise(function (c, e) {\r\n            success = c;\r\n            error = e;\r\n        });\r\n\r\n        var p = WinJS.Promise.join(promises);\r\n        p.done(function () {\r\n            if (!completed) {\r\n                completed = true;\r\n                if (callback) {\r\n                    callback();\r\n                }\r\n                success();\r\n                return;\r\n            }\r\n            p.cancel();\r\n            error();\r\n        }, error);\r\n\r\n        return resultPromise;\r\n    };\r\n\r\n    $.fn.afterAnimation = function (callback) {\r\n        var promises = [];\r\n        this.each(function () {\r\n            var ctrl = this;\r\n            var prom = new WinJS.Promise(function (complete, error) {\r\n                function ontransition(event) {\r\n                    if (event.srcElement === currentElement) {\r\n                        ctrl.removeEventListener(\"animationend\", ontransition);\r\n                        complete();\r\n                    }\r\n                }\r\n\r\n                ctrl.addEventListener(\"animationend\", ontransition);\r\n            });\r\n            promises.push(prom);\r\n        });\r\n\r\n        WinJS.Promise.join(promises).done(function () {\r\n            if (callback)\r\n                callback();\r\n        });\r\n\r\n        return this;\r\n    };\r\n\r\n    $.fn.classBasedAnimation = function (classname) {\r\n        var promises = [];\r\n        return this.each(function () {\r\n            var ctrl = this;\r\n            $(ctrl).afterAnimation(function () {\r\n                $(ctrl).removeClass(classname);\r\n            });\r\n\r\n            $(ctrl).addClass(classname);\r\n        });\r\n    };\r\n})(jQuery);","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n(function () {\r\n    'use strict';\r\n    \r\n    var DataFormState = WinJS.Class.mix(WinJS.Class.define(function () {\r\n        this._initObservable();\r\n    }, {\r\n    }), WinJS.Binding.mixin, WinJS.Binding.expandProperties({ isValid: false, updated: false }));\r\n\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        DataForm: WinJS.Class.mix(WinJS.Class.define(\r\n            /**\r\n             * @class WinJSContrib.UI.DataForm\r\n             * @classdesc\r\n             * This control enhance data form management by adding validation mecanism and form state helpers. It must be placed on a form element.\r\n             * Input fields must use {@link WinJSContrib.UI.DataFormBinding} to bind object properties to input\r\n             * @param {HTMLElement} element DOM element containing the control\r\n             * @param {Object} options\r\n             */\r\n            function ctor(element, options) {\r\n                var ctrl = this;\r\n                this.element = element || document.createElement('FORM');\r\n                //$(this.element).submit(function (e) {\r\n                //    e.preventDefault()\r\n                //})\r\n                options = options || {};\r\n                this.groups = options.groups;\r\n                this.messages = options.messages;\r\n                this.rules = options.rules;\r\n                /**\r\n                 * state of the form\r\n                 * @field\r\n                 * @type {Object}\r\n                 */\r\n                this.state = new DataFormState();\r\n                this.state.item = {};\r\n                this.allowTooltip = options.allowTooltip || true;\r\n                this.workOnCopy = options.workOnCopy || true;\r\n                this.tooltipDelay = options.tooltipDelay || 4000;\r\n                this.tooltipPosition = options.tooltipPosition || 'right';\r\n                this.tooltipTheme = options.tooltipTheme || 'tooltipster-error';\r\n                this.initValidator();\r\n                this.element.winControl = this;\r\n                this.element.mcnDataForm = true;\r\n                this.element.classList.add('win-disposable');\r\n                if (WinJSContrib.CrossPlatform && WinJSContrib.CrossPlatform.crossPlatformClass)\r\n                    WinJSContrib.CrossPlatform.crossPlatformClass(this.element);\r\n                WinJS.UI.setOptions(this, options);\r\n                WinJS.UI.processAll(this.element).done(function () {\r\n                    WinJS.Binding.processAll(ctrl.element, ctrl.state);\r\n                });\r\n\r\n                $('.mcn-dataform-cancel', this.element).click(function (arg) {\r\n                    arg.preventDefault();\r\n                    ctrl.cancel();\r\n                });\r\n            },\r\n            /**\r\n             * @lends WinJSContrib.UI.DataForm.prototype\r\n             */\r\n        {\r\n            /**\r\n             * @member {Array}\r\n             */\r\n            messages: {\r\n                get: function () {\r\n                    return this._messages;\r\n                },\r\n                set: function (val) {\r\n                    this._messages = val;\r\n                }\r\n            },\r\n            /**\r\n             * @member {Array}\r\n             */\r\n            rules: {\r\n                get: function () {\r\n                    return this._rules;\r\n                },\r\n                set: function (val) {\r\n                    this._rules = val;\r\n                }\r\n            },\r\n            /**\r\n             * @member {Array}\r\n             */\r\n            groups: {\r\n                get: function () {\r\n                    return this._groups;\r\n                },\r\n                set: function (val) {\r\n                    this._groups = val;\r\n                }\r\n            },\r\n            /**\r\n             * object bound to data form\r\n             * @member {Object}\r\n             */\r\n            item: {\r\n                get: function () {\r\n                    return this.state.item;\r\n                },\r\n                set: function (val) {\r\n                    var dataform = this;\r\n                    if (dataform.workOnCopy) {\r\n                        dataform.state.item = $.extend(true, {}, val);\r\n                        dataform.state.refItem = val;\r\n                    }\r\n                    else {\r\n                        dataform.state.item = val;\r\n                    }\r\n\r\n                    \r\n                    dataform.validator.resetForm();\r\n\r\n                    dataform.autobindFields();\r\n                    WinJS.Binding.processAll(this.element, this.state).done(function () {\r\n                        var tooltips = dataform.allowTooltip;\r\n                        dataform.allowTooltip = false;\r\n                        dataform.validator.form();\r\n                        dataform.allowTooltip = tooltips;\r\n                        dataform.checkState();\r\n                        dataform.initValidator();\r\n                        dataform.state.updated = false;\r\n                    });\r\n                    dataform.dispatchEvent(\"itemchanged\", { dataform: this, item: val });\r\n                }\r\n            },\r\n            /**\r\n             * indicate if form has updates\r\n             * @member {boolean}\r\n             */\r\n            updated: {\r\n                get: function () {\r\n                    return this.state.updated;\r\n                },\r\n                set: function (val) {\r\n                    this.state.updated = val;\r\n                    this.dispatchEvent(\"haschanges\");\r\n                }\r\n            },\r\n\r\n            autobindFields: function () {\r\n                var ctrl = this;\r\n                $('[data-formfield]', ctrl.element).each(function () {\r\n                    var fieldElt = this;\r\n                    var srcProperty = $(fieldElt).data('formfield');\r\n                    var destFieldType = 'value';\r\n                    if (fieldElt.type == 'checkbox') {\r\n                        destFieldType = 'checked';\r\n                    }\r\n                    WinJSContrib.UI.DataFormBinding(ctrl.state.item, srcProperty.split('.'), fieldElt, [destFieldType]);\r\n                });\r\n            },\r\n\r\n            /**\r\n             * check form state\r\n             */\r\n            checkState: function () {\r\n                var nbInvalids = this.validator.numberOfInvalids();\r\n                this.state.isValid = nbInvalids == 0;\r\n            },\r\n\r\n            /**\r\n             * cancel updates on form item\r\n             */\r\n            cancel: function () {\r\n                var dataform = this;\r\n                if (dataform.workOnCopy) {\r\n                    dataform.item = $.extend(true, {}, dataform.state.refItem);\r\n                }\r\n            },\r\n\r\n            /**\r\n             * apply changes to source object (relevant only if using workOnCopy)\r\n             */\r\n            save: function () {\r\n                var dataform = this;\r\n                if (dataform.workOnCopy) {\r\n                    dataform.state.updated = false;\r\n                    dataform.state.refItem = $.extend(true, {}, dataform.state.item);\r\n                }\r\n            },\r\n\r\n            initValidator: function () {\r\n                var dataform = this;\r\n\r\n                this.validator = $(this.element).validate({\r\n                    groups: this.groups,\r\n                    rules: this.rules,\r\n                    submitHandler: function (form) {\r\n                        dataform.dispatchEvent('submitted', { item: dataform.state.item });\r\n                    },\r\n\r\n                    invalidHandler: function (form, validator) {\r\n                        dataform.checkState();\r\n                    },\r\n\r\n                    errorPlacement: function (error, element) {\r\n                        dataform.checkState();\r\n                        if (!dataform.allowTooltip)\r\n                            return;\r\n\r\n                        var $e = $(element);\r\n                        $e.tooltipster({\r\n                            trigger: 'custom',\r\n                            onlyOne: false,\r\n                            position: dataform.tooltipPosition,\r\n                            theme: dataform.tooltipTheme\r\n                        });\r\n\r\n                        var lastError = $e.data('lastError'),\r\n                            newError = $(error).text();\r\n\r\n                        $e.data('lastError', newError);\r\n\r\n                        if (newError !== '' && newError !== lastError) {\r\n                            $e.tooltipster('content', newError);\r\n                            $e.tooltipster('show');\r\n                            $e[0].tooltipsterValidationTimeout = setTimeout(function () {\r\n                                $e[0].tooltipsterValidationTimeout = null;\r\n                                if ($e.hasClass('tooltipster'))\r\n                                    $e.tooltipster('hide');\r\n                            }, dataform.tooltipDelay);\r\n                        }\r\n                    },\r\n\r\n                    success: function (label, element) {\r\n                        dataform.checkState();\r\n                        var $e = $(element);\r\n                        if ($e[0].tooltipsterValidationTimeout) {\r\n                            clearTimeout($e[0].tooltipsterValidationTimeout);\r\n                            $e[0].tooltipsterValidationTimeout = null;\r\n                        }\r\n\r\n                        if ($e.hasClass('tooltipstered')) {\r\n                            $e.tooltipster('hide');\r\n                        }\r\n                    }\r\n\r\n                });\r\n            },\r\n\r\n            /**\r\n             * validate form\r\n             */\r\n            validate: function () {\r\n                var res = this.validator.form();\r\n                return res;\r\n            },\r\n\r\n            /**\r\n             * release form\r\n             */\r\n            dispose: function () {\r\n                WinJS.Utilities.disposeSubTree(this.element);\r\n            }\r\n        },\r\n        /**\r\n         * @lends WinJSContrib.UI.DataForm\r\n         */\r\n        {\r\n            /**\r\n             * @namespace WinJSContrib.UI.DataForm.defaultBindingOptions\r\n             */\r\n            DefaultBindingOptions: {\r\n                trimText: true,\r\n                convertEmptyToNull: true,\r\n            },\r\n\r\n            /**\r\n             * @namespace WinJSContrib.UI.DataForm.Converters\r\n             */\r\n            Converters: {\r\n                /**\r\n                 * @member\r\n                 */\r\n                \"none\": {\r\n                    fromObject: function (val, options) {\r\n                        return val.toString();\r\n                    },\r\n                    fromInput: function (val, options) {\r\n                        return val;\r\n                    }\r\n                },\r\n                /**\r\n                 * @member\r\n                 */\r\n                \"text\": {\r\n                    fromObject: function (val, options) {\r\n                        if (typeof val === \"undefined\" || val === null)\r\n                            return '';\r\n\r\n                        var res = val.toString();\r\n                        \r\n                        return res;\r\n                    },\r\n                    fromInput: function (val, options) {\r\n                        var res = val;\r\n                        if (res && options && options.trimText) {\r\n                            res = res.trim();\r\n                        }\r\n                        if (options && options.convertEmptyToNull) {\r\n                            res = (res === '') ? null : res;\r\n                        }\r\n                        return res;\r\n                    }\r\n                },\r\n                /**\r\n                 * @member\r\n                 */\r\n                \"number\": {\r\n                    fromObject: function (val, options) {\r\n                        if (typeof val !== \"number\")\r\n                            return '';\r\n\r\n                        return val.toString();\r\n                    },\r\n                    fromInput: function (val, options) {\r\n                        if (typeof val !== \"undefined\" && val !== null)\r\n                            return parseFloat(val);\r\n\r\n                        return null;\r\n                    }\r\n                },\r\n                /**\r\n                 * @member\r\n                 */\r\n                \"boolean\": {\r\n                    fromObject: function (val, options) {\r\n                        if (typeof val === \"undefined\" || val === null)\r\n                            return '';\r\n\r\n                        return val.toString();\r\n                    },\r\n                    fromInput: function (val, options) {\r\n                        if (val === 'true')\r\n                            return true;\r\n                        if (val === 'false')\r\n                            return false;\r\n\r\n                        return null;\r\n                    }\r\n                },\r\n                /**\r\n                 * @member\r\n                 */\r\n                \"object\": {\r\n                    fromObject: function (val, options) {\r\n                        return val;\r\n                    },\r\n                    fromInput: function (val, options) {\r\n                        return val;\r\n                    }\r\n                },\r\n                /**\r\n                 * @member\r\n                 */\r\n                \"stringifiedObject\": {\r\n                    fromObject: function (val, options) {\r\n                        return JSON.stringify(val);\r\n                    },\r\n                    fromInput: function (val, options) {\r\n                        return JSON.parse(val);\r\n                    }\r\n                }\r\n            }\r\n        }),\r\n        WinJS.UI.DOMEventMixin,\r\n        WinJS.Utilities.createEventProperties(\"itemchanged\", \"haschanges\", \"submitted\")),\r\n\r\n        parentDataForm: function (element) {\r\n            var current = element.parentNode;\r\n\r\n            while (current) {\r\n                if (current.mcnDataForm) {\r\n                    return current.winControl;\r\n                }\r\n                current = current.parentNode;\r\n            }\r\n        },\r\n\r\n        \r\n\r\n        /**\r\n         * bi-directional binding for working with input fields and custom input controls. This binding expect a {@link WinJSContrib.UI.DataForm} to be found on the parent form\r\n         * @function WinJSContrib.UI.DataFormBinding\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        DataFormBinding: WinJS.Binding.initializer(function (source, sourceProperty, dest, destProperty) {\r\n            var dataform = WinJSContrib.UI.parentDataForm(dest);\r\n            var options = WinJSContrib.UI.DataForm.DefaultBindingOptions;\r\n            var optionsText = dest.getAttribute(\"data-formfield-options\");\r\n            if (optionsText) {\r\n                options = WinJS.UI.optionsParser(optionsText, window);\r\n            }\r\n            var inputType = \"\";\r\n            var inputOption = dest.getAttribute(\"data-forminput\");\r\n            if (inputOption) {\r\n                inputType = inputOption;\r\n            }\r\n\r\n            var fieldUpdated = false;\r\n            dest.classList.add('mcn-dataform-field');\r\n\r\n            //si le noeud n'est pas un champ input html, on renseigne la propriété form, sinon plantage de jquery validate\r\n            if (!dest.form) {\r\n                dest.form = dataform.element;\r\n            }\r\n\r\n            var inputType = 'text';\r\n            if ($(dest).data('formfield-type')) {\r\n                inputType = $(dest).data('formfield-type');\r\n            }\r\n            else if (dest.nodeName !== \"TEXTAREA\" && typeof dest.type !== \"undefined\") {\r\n                inputType = dest.type;\r\n            }\r\n            var converter = WinJSContrib.UI.DataForm.Converters[inputType] || WinJSContrib.UI.DataForm.Converters['text'];\r\n\r\n            function updateInputFromObject() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (typeof data === \"undefined\")\r\n                    data = null;\r\n\r\n                data = converter.fromObject(data, options);\r\n\r\n                WinJSContrib.Utils.writeProperty(dest, destProperty, data);\r\n            }\r\n\r\n            function updateObjectFromInput() {\r\n                dataform.checkState();\r\n                dataform.updated = true;\r\n                fieldUpdated = true;\r\n\r\n                if (!dest.id || dataform.validator.element(dest)) {\r\n                    var val = WinJSContrib.Utils.getProperty(dest, destProperty).propValue;\r\n                    if (val !== undefined)\r\n                        val = converter.fromInput(val, options);\r\n\r\n                    WinJSContrib.Utils.writeProperty(source, sourceProperty, val);\r\n                }\r\n            }\r\n\r\n            function validateObjectOnBlur() {\r\n                if (fieldUpdated)\r\n                    dataform.validator.element(dest);\r\n            }\r\n\r\n            \r\n            if (inputType) {\r\n                dest.addEventListener(inputType, updateObjectFromInput);\r\n            }\r\n\r\n            dest.addEventListener(\"change\", updateObjectFromInput);\r\n            if (dest.id) {\r\n                dest.addEventListener(\"blur\", validateObjectOnBlur);\r\n            }\r\n            if (dest.eventAdded && dest.winControl) {\r\n                dest.winControl.dispose();\r\n            }\r\n            if (!dest.winControl) {\r\n                dest.eventAdded = true;\r\n                dest.classList.add('win-disposable');\r\n                dest.winControl = {\r\n                    dispose: function () {\r\n                        dest.removeEventListener(\"change\", updateObjectFromInput);\r\n                        dest.removeEventListener(\"blur\", validateObjectOnBlur);\r\n                        if (inputType) {\r\n                            dest.removeEventListener(inputType, updateObjectFromInput);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            var bindingDesc = {\r\n            };\r\n\r\n            bindingDesc[sourceProperty] = updateInputFromObject;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        })\r\n    });\r\n})();\r\n","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/// <reference path=\"WinJSContrib.core.js\" />\r\n\r\n(function () {\r\n    \"use strict\";\r\n\r\n    var appView = null;\r\n    if (window.Windows && window.Windows.UI && window.Windows.UI.ViewManagement && window.Windows.UI.ViewManagement.ApplicationView)\r\n        appView = window.Windows.UI.ViewManagement.ApplicationView;\r\n\r\n    var nav = WinJS.Navigation;\r\n\r\n    var defaultExitPageAnimation = function (elt) {\r\n        return WinJS.UI.Animation.exitPage(elt)\r\n    }\r\n\r\n    var defaultEnterPageAnimation = function (elt) {\r\n        return WinJS.UI.Animation.enterPage(elt);\r\n    }\r\n\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        parentNavigator: function (element) {\r\n            var current = element.parentNode;\r\n\r\n            while (current) {\r\n                if (current.mcnNavigator) {\r\n                    return current.winControl;\r\n                }\r\n                current = current.parentNode;\r\n            }\r\n        },\r\n\r\n        PageControlNavigator: WinJS.Class.mix(WinJS.Class.define(\r\n            /**\r\n             * @class WinJSContrib.UI.PageControlNavigator\r\n             * @param {HTMLElement} element DOM element containing the control\r\n             * @param {Object} options\r\n             */\r\n            function PageControlNavigator(element, options) {\r\n                var options = options || {};\r\n                var navigator = this;\r\n                this.element = element || document.createElement(\"div\");\r\n                this.element.winControl = this;\r\n                this.element.mcnNavigator = true;\r\n                this.element.classList.add('mcn-navigator');\r\n                this.element.classList.add('mcn-navigation-ctrl');\r\n                this.eventTracker = new WinJSContrib.UI.EventTracker();\r\n                this.delay = options.delay || 0;\r\n                this.disableHistory = options.disableHistory || false;\r\n                this.animationWaitForPreviousPageClose = options.animationWaitForPreviousPageClose || true;\r\n                this.animations = {};\r\n                this.locks = 0;\r\n\r\n                if (options.enterPageAnimation) {\r\n                    this.animations.enterPage = WinJSContrib.Utils.resolveMethod(element, options.enterPageAnimation);\r\n                }\r\n                if (!this.animations.enterPage)\r\n                    this.animations.enterPage = defaultEnterPageAnimation;\r\n\r\n                if (options.exitPageAnimation) {\r\n                    this.animations.exitPage = WinJSContrib.Utils.resolveMethod(element, options.exitPageAnimation);\r\n                }\r\n                if (!this.animations.exitPage)\r\n                    this.animations.exitPage = defaultExitPageAnimation;\r\n                this.home = options.home;\r\n                if (appView)\r\n                    this._lastViewstate = appView.value;\r\n\r\n                this.global = options.global !== undefined ? options.global : true;\r\n                if (this.global) { //navigation classique \r\n                    document.body.onkeyup = this._keyupHandler.bind(this);\r\n                    document.body.onkeypress = this._keypressHandler.bind(this);\r\n                    document.body.onmspointerup = this._mspointerupHandler.bind(this);\r\n\r\n                    WinJSContrib.UI.Application = WinJSContrib.UI.Application || {};\r\n                    WinJSContrib.UI.Application.navigator = this;\r\n\r\n                    this.eventTracker.addEvent(nav, 'beforenavigate', this._beforeNavigate.bind(this));\r\n                    this.eventTracker.addEvent(nav, 'navigated', this._navigated.bind(this));\r\n\r\n                    var systemNavigationManager = null;\r\n                    if (WinJSContrib.UI.enableSystemBackButton && window.Windows && window.Windows.UI && window.Windows.UI.Core && window.Windows.UI.Core.SystemNavigationManager) {\r\n                        systemNavigationManager = window.Windows.UI.Core.SystemNavigationManager.getForCurrentView();\r\n                    }\r\n\r\n                    if (systemNavigationManager && WinJSContrib.UI.enableSystemBackButton) {\r\n                        this.eventTracker.addEvent(systemNavigationManager, 'backrequested', function (arg) {\r\n                            if (WinJS.Navigation.canGoBack) {\r\n                                navigator.back();\r\n                                arg.handled = true;\r\n                            }\r\n                        });\r\n\r\n                    }\r\n                }\r\n                else {\r\n                    if (options.navigationEvents) {\r\n                        this.addNavigationEvents();\r\n                    }\r\n                    this._history = { backstack: [] };\r\n                }\r\n\r\n                this.eventTracker.addEvent(window, 'resize', function (args) {\r\n                    if (navigator.resizeHandler)\r\n                        cancelAnimationFrame(navigator.resizeHandler);\r\n\r\n                    navigator.resizeHandler = requestAnimationFrame(function () {\r\n                        navigator.resizeHandler = null;\r\n                        navigator._resized(args);\r\n                    });\r\n                });\r\n            },\r\n                /**\r\n                 * @lends WinJSContrib.UI.PageControlNavigator.prototype\r\n                 */\r\n                {\r\n                    home: \"\",\r\n                    /// <field domElement=\"true\" />\r\n                    element: null,\r\n                    _lastNavigationPromise: WinJS.Promise.as(),\r\n                    _lastViewstate: 0,\r\n\r\n                    // This is the currently loaded Page object.\r\n                    pageControl: {\r\n                        get: function () {\r\n                            return this.pageElement ? this.pageElement.winControl : null;\r\n                        }\r\n                    },\r\n\r\n                    // This is the root element of the current page.\r\n                    pageElement: {\r\n                        get: function () {\r\n                            return this._pageElement || this.element.lastElementChild;\r\n                        }\r\n                    },\r\n\r\n                    history: {\r\n                        get: function () {\r\n                            if (this.global)\r\n                                return WinJS.Navigation.history;\r\n                            else\r\n                                return this._history;\r\n                        }\r\n                    },\r\n\r\n                    addLock: function () {\r\n                        this.locks++;\r\n                    },\r\n\r\n                    removeLock: function () {\r\n                        this.locks--;\r\n                    },\r\n\r\n                    // Creates a container for a new page to be loaded into.\r\n                    _createPageElement: function () {\r\n                        var element = document.createElement(\"div\");\r\n                        element.setAttribute(\"dir\", window.getComputedStyle(this.element, null).direction);\r\n                        //element.style.width = \"100%\";\r\n                        //element.style.height = \"100%\";\r\n                        //element.style.position = 'relative';\r\n                        return element;\r\n                    },\r\n\r\n                    // This function disposes the page navigator and its contents.\r\n                    dispose: function () {\r\n                        if (this._disposed) {\r\n                            return;\r\n                        }\r\n                        this._disposed = true;\r\n                        this.removeNavigationEvents();\r\n                        if (WinJS.Utilities.disposeSubTree)\r\n                            WinJS.Utilities.disposeSubTree(this.element);\r\n\r\n                        this.eventTracker.dispose();\r\n                    },\r\n\r\n                    //check back navigation in the context of navigation events.\r\n                    _checkBackNavigation: function (arg) {\r\n                        var navigator = this;\r\n                        var currentPage = navigator.pageControl;\r\n                        var confirm = function () {\r\n                            arg.handled = true;\r\n                            if (arg.preventDefault)\r\n                                arg.preventDefault();\r\n                        }\r\n                        var check = function () {\r\n                            if (navigator.canGoBack) {\r\n                                navigator.back();\r\n                                confirm();\r\n                                return true;\r\n                            };\r\n                        }\r\n\r\n                        if (currentPage.canClose) {\r\n                            var res = currentPage.canClose();\r\n                            if (WinJS.Promise.is(res)) {\r\n                                res.then(function (canClose) {\r\n                                    if (!canClose) {\r\n                                        confirm();\r\n                                        return true;\r\n                                    }\r\n                                    return check();\r\n                                });\r\n                            } else {\r\n                                if (!res) {\r\n                                    confirm();\r\n                                    return true;\r\n                                }\r\n                                return check();\r\n                            }\r\n\r\n                        } else {\r\n                            return check();\r\n                        }\r\n                    },\r\n\r\n                    //register hardware backbutton. unecessary if navigator is global\r\n                    addNavigationEvents: function () {\r\n                        var navigator = this;\r\n                        this.navigationEvents = WinJSContrib.UI.registerNavigationEvents(this, function (arg) {\r\n                            navigator._checkBackNavigation(arg);\r\n                        });\r\n                    },\r\n\r\n                    removeNavigationEvents: function () {\r\n                        if (this.navigationEvents) {\r\n                            this.navigationEvents();\r\n                            this.navigationEvents = null;\r\n                        }\r\n                    },\r\n\r\n                    // Retrieves a list of animation elements for the current page.\r\n                    // If the page does not define a list, animate the entire page.\r\n                    _getAnimationElements: function (isExit) {\r\n                        if (this.pageControl && this.pageControl.getAnimationElements) {\r\n                            return this.pageControl.getAnimationElements(isExit);\r\n                        }\r\n                        return this.pageElement;\r\n                    },\r\n\r\n                    // Navigates back whenever the backspace key is pressed and\r\n                    // not captured by an input field.\r\n                    _keypressHandler: function (args) {\r\n                        if (this.locks > 0)\r\n                            return;\r\n\r\n                        if (args.key === \"Backspace\") {\r\n                            this.back();\r\n                        }\r\n                    },\r\n\r\n                    // Navigates back or forward when alt + left or alt + right\r\n                    // key combinations are pressed.\r\n                    _keyupHandler: function (args) {\r\n                        if (this.locks > 0)\r\n                            return;\r\n\r\n                        if ((args.key === \"Left\" && args.altKey) || (args.key === \"BrowserBack\")) {\r\n                            this.back();\r\n                        }/* else if ((args.key === \"Right\" && args.altKey) || (args.key === \"BrowserForward\")) {\r\n                        nav.forward();\r\n                    }*/\r\n                    },\r\n\r\n                    // This function responds to clicks to enable navigation using\r\n                    // back and forward mouse buttons.\r\n                    _mspointerupHandler: function (args) {\r\n                        if (args.button === 3) {\r\n                            nav.back();\r\n                        } else if (args.button === 4) {\r\n                            nav.forward();\r\n                        }\r\n                    },\r\n\r\n                    navigate: function (location, initialState, skipHistory, isback, stacked) {\r\n                        var nav = this;\r\n                        if (this.global) {\r\n                            return WinJS.Navigation.navigate(location, initialState);\r\n                        } else {\r\n                            var arg = {\r\n                                skipHistory: skipHistory,\r\n                                detail: {\r\n                                    location: location,\r\n                                    state: initialState,\r\n                                    navigateStacked : stacked,\r\n                                    setPromise: function (promise) {\r\n                                        this.pagePromise = promise;\r\n                                    }\r\n                                }\r\n                            };\r\n                            nav._beforeNavigate(arg);\r\n                            arg.detail.pagePromise = arg.detail.pagePromise || WinJS.Promise.wrap();\r\n                            nav._history.current = { state: initialState, location: location };\r\n                            return arg.detail.pagePromise.then(function () {\r\n                                if (isback) {\r\n                                    nav._history.backstack.splice(nav._history.backstack.length - 1, 1);\r\n                                }\r\n                                nav._navigated(arg);\r\n                                return arg.detail.pagePromise;\r\n                            });\r\n                        }\r\n                    },\r\n\r\n                    clearHistory: function () {\r\n                        if (this.global) {\r\n                            WinJS.Navigation.history.backStack = [];\r\n                        } else {\r\n                            this._history.backstack = [];\r\n                            this._history.current = null;\r\n                        }\r\n                    },\r\n\r\n                    closeAllPages: function () {\r\n                        var navigator = this;\r\n                        var pages = navigator.element.children;\r\n                        \r\n                        for (var i = pages.length-1 ; i >= 0 ; i--) {\r\n                            var page = pages[i];\r\n                            if (page.classList.contains(\"pagecontrol\")) {\r\n                                navigator.element.removeChild(page);\r\n                                page.winControl.dispose();\r\n                            }\r\n                        }\r\n                    },\r\n\r\n                    clear: function () {\r\n                        this.clearHistory();\r\n                        this.closeAllPages();\r\n                        this._pageElement = null;\r\n                        this.element.innerHTML = '';\r\n                    },\r\n\r\n                    //warning, deprecated...\r\n                    open: function (uri, options) {\r\n                        return this.navigate(uri, options);\r\n                    },\r\n\r\n                    pick: function (uri, options) {\r\n                        options = options || {};\r\n                        options.navigateStacked = true;\r\n                        return this.navigate(uri, options);\r\n                    },\r\n\r\n                    canGoBack: {\r\n                        get: function () {\r\n                            if (this.global)\r\n                                return nav.canGoBack;\r\n                            else\r\n                                return this._history.backstack.length > 0;\r\n                        }\r\n                    },\r\n\r\n                    _handleStackedBack: function () {\r\n                        var navigator = this;\r\n                        if (navigator.global) {\r\n                            var isStacked = navigator.stackNavigation == true || (WinJS.Navigation.history.current.state && WinJS.Navigation.history.current.state.navigateStacked);\r\n                            if (isStacked) {\r\n                                var previousPage = navigator.element.children[navigator.element.children.length - 2];\r\n                                if (previousPage) {\r\n                                    WinJS.Navigation.history.backStack.splice(WinJS.Navigation.history.backStack.length - 1, 1);\r\n\r\n                                    return navigator.closePage(navigator.pageControl.element).then(function () {\r\n                                        navigator._updateBackButton(previousPage.winControl.element);\r\n                                        if (previousPage.winControl && previousPage.winControl.navactivate) {\r\n                                            previousPage.winControl.navactivate();\r\n                                        }\r\n                                    });\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n\r\n                    back: function (distance) {\r\n                        var navigator = this;\r\n                        \r\n                        if (navigator.global) {\r\n                            //navigator._handleBack();\r\n\r\n                            return WinJS.Navigation.back(distance);\r\n                        }\r\n                        else {\r\n                            if (navigator._history.backstack.length) {\r\n                                var pageindex = navigator._history.backstack.length - 1;\r\n                                var previousPage = navigator._history.backstack[pageindex];\r\n\r\n                                return navigator.navigate(previousPage.location, previousPage.state, true, true);\r\n                            }\r\n                        }\r\n                    },\r\n\r\n                    _beforeNavigate: function (args) {\r\n                        var navigator = this;\r\n                        var page = this.pageElement;\r\n                        var navlocation = args.detail.location;\r\n                        var navstate = args.detail.state;\r\n\r\n                        args.detail.state = args.detail.state || {};\r\n                        var openStacked = navigator.stackNavigation == true || args.detail.navigateStacked || args.detail.state.navigateStacked;\r\n\r\n                        if (navigator.global && page && page.winControl && page.winControl.navigationState && page.winControl.navigationState.state && page.winControl.navigationState.state.navigateStacked) {\r\n                            var history = WinJS.Navigation.history.backStack[WinJS.Navigation.history.backStack.length - 1];\r\n                            if (navlocation == history.location && navstate == history.state) {\r\n                                var res = navigator._handleStackedBack();\r\n                                if (WinJS.Promise.is(res)) {\r\n                                    WinJS.Navigation.history.current = history;\r\n                                    args.detail.setPromise(res.then(function () {\r\n                                        var p = new WinJS.Promise(function (c) { });\r\n                                        args.detail.setPromise(p);\r\n                                        p.cancel();\r\n                                        return p;\r\n                                    }));\r\n                                    return;\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        if (this.locks > 0) {\r\n                            var p = new WinJS.Promise(function (c) { });\r\n                            args.detail.setPromise(p);\r\n                            p.cancel();\r\n                            return;\r\n                        }\r\n                        else if (page && page.winControl && !openStacked && page.winControl.canClose) {\r\n                            var completeCallback = null;\r\n                            var p = new WinJS.Promise(function (c) {\r\n                                completeCallback = c;\r\n                            });\r\n                            setImmediate(function () {\r\n                                WinJS.Promise.wrap(page.winControl.canClose()).then(function (res) {\r\n                                    if (!res) {\r\n                                        p.cancel();\r\n                                    }\r\n                                    else {\r\n                                        navigator.triggerPageExit(openStacked);\r\n                                        completeCallback();\r\n                                    }\r\n                                });\r\n                            });\r\n                            args.detail.setPromise(p);\r\n\r\n                            return;\r\n                        }\r\n\r\n                        if (openStacked && !args.detail.state.mcnNavigationDetails && page && page.winControl) {\r\n                            if (page.winControl.navdeactivate) {\r\n                                args.detail.setPromise(WinJS.Promise.as(page.winControl.navdeactivate.apply(page.winControl)));\r\n                                return;\r\n                            }\r\n                            return;\r\n                        }\r\n\r\n                        if (navigator.global && !openStacked && WinJS.Navigation.history.current.state && WinJS.Navigation.history.current.state.navigateStacked) {\r\n                            navigator.closeAllPages();\r\n                            var backstack = WinJS.Navigation.history.backStack;\r\n                            for (var i = backstack.length - 1 ; i >= 0 ; i--) {\r\n                                if (backstack[i].state && backstack[i].state.navigateStacked) {\r\n                                    backstack.splice(i, 1);\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        navigator.triggerPageExit();\r\n                    },\r\n\r\n                    triggerPageExit: function (openStacked) {\r\n                        var navigator = this;\r\n                        var page = this.pageElement;\r\n                        if (openStacked) {\r\n                            if (page.winControl.navdeactivate) {\r\n                                page.winControl.exitPagePromise = WinJS.Promise.as(page.winControl.navdeactivate());\r\n                            } else {\r\n                                page.winControl.exitPagePromise = WinJS.Promise.wrap();\r\n                            }\r\n                            return;\r\n                        }\r\n                        var hidepage = function () {\r\n                            if (!openStacked) {\r\n                                page.style.display = 'none';\r\n                                page.style.visibility = 'hidden';\r\n                                page.style.opacity = '';\r\n                            }\r\n                        }\r\n                        if (page && page.winControl && !page.winControl.exitPagePromise) {\r\n                            if (page.winControl.exitPage) {\r\n                                var exitPageResult = page.winControl.exitPage();\r\n                                if (exitPageResult) {\r\n                                    var res = WinJS.Promise.as(exitPageResult);\r\n                                    page.winControl.exitPagePromise = res.then(function () {\r\n                                        if (page.winControl.exitPageAnimation) {\r\n                                            return WinJS.Promise.as(page.winControl.exitPageAnimation());\r\n                                        }\r\n                                    }).then(hidepage);\r\n                                } else {\r\n                                    if (page.winControl.exitPageAnimation) {\r\n                                        page.winControl.exitPagePromise = WinJS.Promise.as(page.winControl.exitPageAnimation()).then(hidepage);\r\n                                    } else {\r\n                                        page.winControl.exitPagePromise = WinJS.Promise.as(navigator.animations.exitPage(navigator._getAnimationElements(true))).then(hidepage);\r\n                                    }\r\n                                }\r\n                            } else {\r\n                                if (page.winControl.exitPageAnimation) {\r\n                                    page.winControl.exitPagePromise = WinJS.Promise.as(page.winControl.exitPageAnimation()).then(hidepage);\r\n                                } else {\r\n                                    page.winControl.exitPagePromise = WinJS.Promise.as(navigator.animations.exitPage(navigator._getAnimationElements(true))).then(hidepage);\r\n                                }\r\n                            }\r\n\r\n                            var layoutCtrls = page.querySelectorAll('.mcn-layout-ctrl');\r\n                            if (layoutCtrls && layoutCtrls.length) {\r\n                                for (var i = 0 ; i < layoutCtrls.length; i++) {\r\n                                    var ctrl = layoutCtrls[i].winControl;\r\n                                    if (ctrl.exitPage)\r\n                                        ctrl.exitPage();\r\n                                }\r\n                            }\r\n\r\n                            if (WinJSContrib.UI.Application.progress)\r\n                                WinJSContrib.UI.Application.progress.show();\r\n                        }\r\n                    },\r\n\r\n                    closePage: function (pageElementToClose, args) {\r\n                        var navigator = this;\r\n                        args = args || {};\r\n                        var pagecontainer = navigator.element;\r\n                        var oldElement = pageElementToClose || this.pageElement;\r\n                        if (oldElement) {\r\n                            WinJSContrib.UI.untapAll(oldElement);\r\n                        }\r\n                        var oldPageExitPromise = (oldElement && oldElement.winControl && oldElement.winControl.exitPagePromise) ? oldElement.winControl.exitPagePromise : WinJS.Promise.wrap()\r\n                        navigator.dispatchEvent('closingPage', { page: oldElement });\r\n\r\n                        if (oldElement && oldElement.winControl) {\r\n                            oldElement.winControl.pageLifeCycle.stop();\r\n                            oldElement.winControl.dispatchEvent('closing', { youpla: 'boom' });\r\n\r\n                            if (oldElement.winControl.cancelPromises) {\r\n                                oldElement.winControl.cancelPromises();\r\n                            }\r\n                        }\r\n\r\n                        if (!navigator.global && !navigator.disableHistory && oldElement && oldElement.winControl && oldElement.winControl.navigationState && !args.skipHistory) {\r\n                            navigator._history.backstack.push(oldElement.winControl.navigationState);\r\n                        }\r\n\r\n                        navigator._pageElement = null;\r\n                        return oldPageExitPromise.then(function () {\r\n                            if (oldElement) {\r\n                                oldElement.style.opacity = '0';\r\n                                oldElement.style.display = 'none';\r\n                                //    }\r\n                                //    return WinJS.Promise.timeout();\r\n                                //}).then(function () {\r\n                                //    if (oldElement) {\r\n                                if (oldElement.winControl) {\r\n                                    oldElement.winControl.stackedOn = null;\r\n                                    oldElement.winControl.stackedBy = null;\r\n                                    if (oldElement.winControl.eventTracker) {\r\n                                        oldElement.winControl.eventTracker.dispose();\r\n                                    }\r\n\r\n                                    if (oldElement.winControl.unload) {\r\n                                        oldElement.winControl.unload();\r\n                                    }\r\n                                }\r\n\r\n                                if (WinJS.Utilities.disposeSubTree)\r\n                                    WinJS.Utilities.disposeSubTree(oldElement);\r\n\r\n                                //oldElement.innerHTML = '';\r\n                                //setImmediate(function () {\r\n                                try {\r\n                                    if (oldElement.parentElement) oldElement.parentElement.removeChild(oldElement);\r\n                                }\r\n                                catch (exception) {\r\n                                    console.log('cannot remove page, WTF ????????')\r\n                                }\r\n                                //});\r\n                            }\r\n                        });\r\n                    },\r\n\r\n                    // Responds to navigation by adding new pages to the DOM.\r\n                    _navigated: function (args) {\r\n                        var navigator = this;\r\n                        \r\n\r\n                        args.detail.state = args.detail.state || {};\r\n                        var pagecontainer = navigator.element;\r\n                        var oldPage = this.pageControl;\r\n                        var oldElement = this.pageElement;\r\n                        var openStacked = navigator.stackNavigation == true || args.detail.navigateStacked || (args.detail.state && args.detail.state.navigateStacked);\r\n\r\n                        if (this._lastNavigationPromise) {\r\n                            this._lastNavigationPromise.cancel();\r\n\r\n                            if (WinJSContrib.UI.Application.progress)\r\n                                WinJSContrib.UI.Application.progress.hide();\r\n                        }\r\n\r\n                        if (oldPage && oldPage.stackedOn && args.detail.state.mcnNavigationDetails) {//back en nav stacked\r\n                            var closeOldPagePromise = navigator.closePage(oldElement, args);\r\n                            this._lastNavigationPromise = closeOldPagePromise;\r\n                            args.detail.setPromise(closeOldPagePromise);\r\n                            if (WinJSContrib.UI.Application.progress)\r\n                                WinJSContrib.UI.Application.progress.hide();\r\n                            return;\r\n                        }\r\n                        else if (openStacked) {\r\n                            if (!navigator.global && !navigator.disableHistory && oldElement && oldElement.winControl && oldElement.winControl.navigationState && !args.skipHistory) {\r\n                                navigator._history.backstack.push(oldElement.winControl.navigationState);\r\n                            }\r\n                            \r\n                            var closeOldPagePromise = WinJS.Promise.wrap();\r\n                        }\r\n                        else {\r\n                            var closeOldPagePromise = navigator.closePage(oldElement, args);\r\n                        }\r\n\r\n                        if (navigator.global && !openStacked) {\r\n                            var backstack = WinJS.Navigation.history.backStack;\r\n                            for (var i = backstack.length - 1 ; i >= 0 ; i--) {\r\n                                if (backstack[i].state && backstack[i].state.navigateStacked) {\r\n                                    backstack.splice(i, 1);\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        //if (this._handleSystemBackBtn && Windows && Windows.UI && Windows.UI.Core && Windows.UI.Core.SystemNavigationManager) {\r\n                        //    if (navigator.canGoBack)\r\n                        //        Windows.UI.Core.SystemNavigationManager.getForCurrentView().appViewBackButtonVisibility = Windows.UI.Core.AppViewBackButtonVisibility.visible;\r\n                        //    else\r\n                        //        Windows.UI.Core.SystemNavigationManager.getForCurrentView().appViewBackButtonVisibility = Windows.UI.Core.AppViewBackButtonVisibility.collapsed;\r\n                        //}\r\n                        args.detail.state.mcnNavigationDetails = {\r\n                            id: WinJSContrib.Utils.guid(),\r\n                            date: new Date()\r\n                        };\r\n\r\n                        //var newElement = null; //this._createPageElement();\r\n                        //var newElementCtrl = null;\r\n                        var parentedComplete;\r\n                        var parented = new WinJS.Promise(function (c) { parentedComplete = c; });\r\n                        //newElement.style.opacity = '0';\r\n                        var layoutCtrls = [];\r\n\r\n\r\n                        //if (navigator.animationWaitForPreviousPageClose) {\r\n                        //    var tempo = closeOldPagePromise.then(function () {\r\n                        //        return WinJS.Promise.timeout(navigator.delay);\r\n                        //    });\r\n                        //} else {\r\n                        //    var tempo = WinJS.Promise.timeout(navigator.delay);\r\n                        //}\r\n\r\n                        navigator.currentPageDetails = args.detail;\r\n\r\n                        var openNewPagePromise = WinJSContrib.UI.Pages.renderFragment(pagecontainer, args.detail.location, args.detail.state, {\r\n                            //delay: tempo,\r\n                            enterPage: navigator.animations.enterPage,\r\n\r\n                            //parented: closeOldPagePromise.then(function () {\r\n                            //  return parented;\r\n                            //}),\r\n\r\n                            getFragmentElement : navigator.fragmentInjector,\r\n\r\n                            closeOldPagePromise: closeOldPagePromise.then(function () { }, function () { }),\r\n\r\n                            oninit: function (element, options) {\r\n                                if (!element) return;\r\n                                var control = element.winControl;\r\n                                control.navigator = navigator;\r\n                                control.element.mcnPage = true;\r\n                                if (openStacked) {\r\n                                    control.stackedOn = oldPage;\r\n                                    if (oldPage) {\r\n                                        oldPage.stackedBy = control;\r\n                                    }\r\n                                }\r\n                                control.renderComplete = control.renderComplete.then(function () {\r\n                                    parentedComplete();\r\n                                });\r\n                            },\r\n\r\n                            onrender: function (element, options) {\r\n                                if (args.detail.state && args.detail.state.clearNavigationHistory) {\r\n                                    if (navigator.global) {\r\n                                        WinJS.Navigation.history.backStack = [];\r\n\r\n                                        var systemNavigationManager = null;\r\n                                        if (WinJSContrib.UI.enableSystemBackButton && window.Windows && window.Windows.UI && window.Windows.UI.Core && window.Windows.UI.Core.SystemNavigationManager) {\r\n                                            systemNavigationManager = window.Windows.UI.Core.SystemNavigationManager.getForCurrentView();\r\n                                            if (systemNavigationManager) {\r\n                                                systemNavigationManager.appViewBackButtonVisibility = window.Windows.UI.Core.AppViewBackButtonVisibility.collapsed;\r\n                                            }\r\n                                        }\r\n                                    } else {\r\n                                        navigator._history.backstack = [];\r\n                                    }\r\n                                }\r\n                                navigator._updateBackButton(element);\r\n                            },\r\n\r\n                            onready: function (element, options) {\r\n                                navigator.dispatchEvent('pageContentReady', { page: element.winControl });\r\n                                if (WinJSContrib.UI.Application.progress)\r\n                                    WinJSContrib.UI.Application.progress.hide();\r\n                            }\r\n                        }).then(function () {\r\n                            navigator._lastNavigationPromise = undefined;\r\n                        });\r\n\r\n                        this._lastNavigationPromise = openNewPagePromise;\r\n\r\n\r\n                        args.detail.setPromise(WinJS.Promise.join([closeOldPagePromise, openNewPagePromise]));\r\n                    },\r\n\r\n                    // Responds to resize events and call the updateLayout function\r\n                    // on the currently loaded page.\r\n                    _resized: function (args) {\r\n                        var navigator = this;\r\n                        if (this.pageControl && this.pageControl.element) {\r\n                            var navigator = this;\r\n                            var control = this.pageControl;\r\n                            var element = control.element;\r\n\r\n                            //navigator.pageControl.element.opacity = '0';\r\n                            cancelAnimationFrame(navigator.layoutProcess);\r\n                            navigator.layoutProcess = requestAnimationFrame(function () {\r\n                                var vw = appView ? appView.value : null;\r\n                                for (var i = 0, l = navigator.element.children.length; i < l; i++) {\r\n                                    var control = navigator.element.children[i].winControl;\r\n                                    if (control) {\r\n                                        if (control.__checkLayout) {\r\n                                            control.__checkLayout(element, vw, navigator._lastViewstate);\r\n                                        }\r\n                                        else {\r\n                                            if (control.updateLayout) {\r\n                                                control.updateLayout.call(control, element, vw, navigator._lastViewstate);\r\n                                            }\r\n                                            var layoutCtrls = element.querySelectorAll('.mcn-layout-ctrl');\r\n                                            if (layoutCtrls && layoutCtrls.length) {\r\n                                                for (var i = 0 ; i < layoutCtrls.length; i++) {\r\n                                                    var ctrl = layoutCtrls[i].winControl;\r\n                                                    if (ctrl.updateLayout)\r\n                                                        ctrl.updateLayout(ctrl.element, vw, navigator._lastViewstate);\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                                //WinJS.UI.Animation.fadeIn(navigator.pageControl.element);\r\n                            });\r\n                        }\r\n                        this._lastViewstate = appView ? appView.value : null;\r\n                    },\r\n\r\n                    _handleBack: function () {\r\n                        nav.back();\r\n                    },\r\n\r\n                    // Updates the back button state. Called after navigation has\r\n                    // completed.\r\n                    _updateBackButton: function (element) {\r\n                        var ctrl = this;\r\n                        var canGoBack = ctrl.canGoBack;\r\n\r\n                        var systemNavigationManager = null;\r\n\r\n                        if (WinJSContrib.UI.enableSystemBackButton && window.Windows && window.Windows.UI && window.Windows.UI.Core && window.Windows.UI.Core.SystemNavigationManager) {\r\n                            systemNavigationManager = window.Windows.UI.Core.SystemNavigationManager.getForCurrentView();\r\n                        }\r\n                        if (ctrl.global && systemNavigationManager && WinJSContrib.UI.enableSystemBackButton) {\r\n                            if (!canGoBack)\r\n                                systemNavigationManager.appViewBackButtonVisibility = window.Windows.UI.Core.AppViewBackButtonVisibility.collapsed;\r\n                            else\r\n                                systemNavigationManager.appViewBackButtonVisibility = window.Windows.UI.Core.AppViewBackButtonVisibility.visible;\r\n                        }\r\n\r\n                        var backButtons = element.querySelectorAll(\".win-backbutton, .back-button, .win-navigation-backbutton\");\r\n                        //var backButton = this.pageElement.querySelector(\"header[role=banner] .win-backbutton\");\r\n\r\n                        if (backButtons && backButtons.length > 0) {\r\n                            var clearNav = false;\r\n                            //console.log('nav:' + JSON.stringify(args.detail.state))\r\n                            //if (args && args.detail && args.detail.state && args.detail.state.clearNavigationHistory)\r\n                            //    clearNav = args.detail.state.clearNavigationHistory;\r\n\r\n                            for (var i = 0, l = backButtons.length; i < l ; i++) {\r\n                                var btn = backButtons[i];\r\n                                if (canGoBack && !clearNav) {\r\n                                    btn.classList.remove('disabled');\r\n                                    btn.disabled = false;\r\n                                } else {\r\n                                    btn.classList.add('disabled');\r\n                                    btn.disabled = true;\r\n                                }\r\n\r\n                                btn.onclick = function (arg) {\r\n                                    if (ctrl.global) {\r\n                                        nav.back();\r\n                                    }\r\n                                    else {\r\n                                        var navigator = WinJSContrib.UI.parentNavigator(arg.currentTarget);\r\n                                        navigator.back();\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            ), WinJS.Utilities.eventMixin)\r\n    });\r\n\r\n    if (WinJSContrib.UI.WebComponents) {\r\n        WinJSContrib.UI.WebComponents.register('mcn-navigator', WinJSContrib.UI.PageControlNavigator, {\r\n            properties: ['global'],\r\n            map: {\r\n                \"ENTERPAGEANIMATION\": {\r\n                    attribute: \"enterPageAnimation\",\r\n                    property: \"animations.enterPage\",\r\n                    resolve: true\r\n                },\r\n                \"EXITPAGEANIMATION\": {\r\n                    attribute: \"exitPageAnimation\",\r\n                    property: \"animations.exitPage\",\r\n                    resolve: true\r\n                }\r\n            }\r\n        });\r\n    }\r\n})();\r\n","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/**\n * @namespace WinJSContrib.UI.Animation\n */\n/**\n */\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var UI;\n    (function (UI) {\n        var Animation;\n        (function (Animation) {\n            /**\n             * @enum\n             * @memberof WinJSContrib.UI.Animation\n             */\n            Animation.Easings = {\n                /**\n                 * Quad ease in\n                 */\n                easeInQuad: 'cubic-bezier(0.550, 0.085, 0.680, 0.530)',\n                /**\n                 * Cubic ease in\n                 */\n                easeInCubic: 'cubic-bezier(0.550, 0.055, 0.675, 0.190)',\n                /**\n                 * Quart ease in\n                 */\n                easeInQuart: 'cubic-bezier(0.895, 0.030, 0.685, 0.220)',\n                /**\n                 * Quint ease in\n                 */\n                easeInQuint: 'cubic-bezier(0.755, 0.050, 0.855, 0.060)',\n                /**\n                 * Sine ease in\n                 */\n                easeInSine: 'cubic-bezier(0.470, 0.000, 0.745, 0.715)',\n                /**\n                 * Expo ease in\n                 */\n                easeInExpo: 'cubic-bezier(0.950, 0.050, 0.795, 0.035)',\n                /**\n                 * Circ ease in\n                 */\n                easeInCirc: 'cubic-bezier(0.600, 0.040, 0.980, 0.335)',\n                /**\n                 * Back ease in\n                 */\n                easeInBack: 'cubic-bezier(0.600, -0.280, 0.735, 0.045)',\n                /**\n                 * Quad ease out\n                 */\n                easeOutQuad: 'cubic-bezier(0.250, 0.460, 0.450, 0.940)',\n                /**\n                 * Cubic ease out\n                 */\n                easeOutCubic: 'cubic-bezier(0.215, 0.610, 0.355, 1.000)',\n                /**\n                 * Quart ease out\n                 */\n                easeOutQuart: 'cubic-bezier(0.165, 0.840, 0.440, 1.000)',\n                /**\n                 * Quint ease out\n                 */\n                easeOutQuint: 'cubic-bezier(0.230, 1.000, 0.320, 1.000)',\n                /**\n                 * Sine ease out\n                 */\n                easeOutSine: 'cubic-bezier(0.390, 0.575, 0.565, 1.000)',\n                /**\n                 * Expo ease out\n                 */\n                easeOutExpo: 'cubic-bezier(0.190, 1.000, 0.220, 1.000)',\n                /**\n                 * Circ ease out\n                 */\n                easeOutCirc: 'cubic-bezier(0.075, 0.820, 0.165, 1.000)',\n                /**\n                 * Back ease out\n                 */\n                easeOutBack: 'cubic-bezier(0.175, 0.885, 0.320, 1.275)',\n                /**\n                 * Quad ease in-out\n                 */\n                easeInOutQuad: 'cubic-bezier(0.455, 0.030, 0.515, 0.955)',\n                /**\n                 * Cubic ease in-out\n                 */\n                easeInOutCubic: 'cubic-bezier(0.645, 0.045, 0.355, 1.000)',\n                /**\n                 * Quart ease in-out\n                 */\n                easeInOutQuart: 'cubic-bezier(0.770, 0.000, 0.175, 1.000)',\n                /**\n                 * Quint ease in-out\n                 */\n                easeInOutQuint: 'cubic-bezier(0.860, 0.000, 0.070, 1.000)',\n                /**\n                 * Sine ease in-out\n                 */\n                easeInOutSine: 'cubic-bezier(0.445, 0.050, 0.550, 0.950)',\n                /**\n                 * Expo ease in-out\n                 */\n                easeInOutExpo: 'cubic-bezier(1.000, 0.000, 0.000, 1.000)',\n                /**\n                 * Circ ease in-out\n                 */\n                easeInOutCirc: 'cubic-bezier(0.785, 0.135, 0.150, 0.860)',\n                /**\n                 * Back ease in-out\n                 */\n                easeInOutBack: 'cubic-bezier(0.680, -0.550, 0.265, 1.550)',\n            };\n            var equivalents = WinJS.Utilities._browserStyleEquivalents || { transform: { cssName: 'transform' } };\n            function getOpt(options) {\n                if (options && typeof options == 'number')\n                    return { duration: options };\n                else\n                    return options || {};\n            }\n            /**\n             * configurable fade out\n             * @function WinJSContrib.UI.Animation.fadeOut\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function fadeOut(elements, options) {\n                options = getOpt(options);\n                var args = {\n                    property: \"opacity\",\n                    delay: staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333),\n                    duration: options.duration || 167,\n                    timing: options.easing || \"ease-in-out\",\n                    to: 0\n                };\n                return WinJS.UI.executeTransition(elements, args);\n            }\n            Animation.fadeOut = fadeOut;\n            /**\n             * configurable fade in\n             * @function WinJSContrib.UI.Animation.fadeIn\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function fadeIn(elements, options) {\n                options = getOpt(options);\n                return WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333),\n                    duration: options.duration || 167,\n                    timing: options.easing || \"ease-in-out\",\n                    to: 1\n                });\n            }\n            Animation.fadeIn = fadeIn;\n            function staggerDelay(initialDelay, extraDelay, delayFactor, delayCap) {\n                return function (i) {\n                    var ret = initialDelay;\n                    for (var j = 0; j < i; j++) {\n                        extraDelay *= delayFactor;\n                        ret += extraDelay;\n                    }\n                    if (delayCap) {\n                        ret = Math.min(ret, delayCap);\n                    }\n                    return ret;\n                };\n            }\n            /**\n             * configurable page exit effect\n             * @function WinJSContrib.UI.Animation.pageExit\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function pageExit(elements, options) {\n                options = getOpt(options);\n                var args = {\n                    property: \"opacity\",\n                    delay: staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333),\n                    duration: options.duration || 160,\n                    timing: options.easing || \"ease-in\",\n                    to: 0\n                };\n                return WinJS.UI.executeTransition(elements, args);\n            }\n            Animation.pageExit = pageExit;\n            /**\n             * configurable page enter effect\n             * @function WinJSContrib.UI.Animation.enterPage\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function enterPage(elements, options) {\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 120, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var animationParams = {\n                    keyframe: 'WinJSContrib-EnterPage',\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: options.duration || 600,\n                    timing: options.easing || \"cubic-bezier(0.1, 0.9, 0.2, 1)\"\n                };\n                var promise1 = WinJS.UI.executeAnimation(elements, animationParams);\n                var args = {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: options.duration || 600,\n                    timing: options.easing || \"ease-out\",\n                    to: 1\n                };\n                var promise2 = WinJS.UI.executeTransition(elements, args);\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.enterPage = enterPage;\n            function slideAnim(element, keyframeName, isIn, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var duration = options.duration || isIn ? 250 : 150;\n                var delay = options.delay || 5;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var easing = WinJSContrib.UI.Animation.Easings.easeInQuad;\n                if (isIn)\n                    easing = WinJSContrib.UI.Animation.Easings.easeOutQuad;\n                var animationParams = {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: duration,\n                    timing: options.easing || easing\n                };\n                var promise1 = WinJS.UI.executeAnimation(element, animationParams);\n                var transitionParams = {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: duration / 2,\n                    timing: easing,\n                    from: 0,\n                    to: 1\n                };\n                if (!isIn) {\n                    transitionParams.from = 1;\n                    transitionParams.to = 0;\n                    if (transitionParams.delay < duration / 2)\n                        transitionParams.delay = duration / 2;\n                }\n                var promise2 = WinJS.UI.executeTransition(element, transitionParams);\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromBottom\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromBottom(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromBottom', true, options);\n            }\n            Animation.slideFromBottom = slideFromBottom;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromTop\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromTop(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromTop', true, options);\n            }\n            Animation.slideFromTop = slideFromTop;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromLeft\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromLeft(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromLeft', true, options);\n            }\n            Animation.slideFromLeft = slideFromLeft;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromRight\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromRight(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromRight', true, options);\n            }\n            Animation.slideFromRight = slideFromRight;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToBottom\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToBottom(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToBottom', false, options);\n            }\n            Animation.slideToBottom = slideToBottom;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToTop\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToTop(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToTop', false, options);\n            }\n            Animation.slideToTop = slideToTop;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToLeft\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToLeft(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToLeft', false, options);\n            }\n            Animation.slideToLeft = slideToLeft;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToRight\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToRight(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToRight', false, options);\n            }\n            Animation.slideToRight = slideToRight;\n            /**\n             * animation for tab exit\n             * @function WinJSContrib.UI.Animation.tabExitPage\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function tabExitPage(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var animationParams = {\n                    keyframe: \"WinJSContrib-tabExitPage\",\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: options.duration || 160,\n                    timing: \"ease-in\"\n                };\n                var promise1 = WinJS.UI.executeAnimation(elements, animationParams);\n                var transitionParams = {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: options.duration || 160,\n                    timing: \"linear\",\n                    from: 1,\n                    to: 0\n                };\n                var promise2 = WinJS.UI.executeTransition(elements, transitionParams);\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.tabExitPage = tabExitPage;\n            /**\n             * animation for tab exit\n             * @function WinJSContrib.UI.Animation.tabEnterPage\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function tabEnterPage(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: \"WinJSContrib-tabEnterPage\",\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: options.duration || 250,\n                    timing: WinJSContrib.UI.Animation.Easings.easeOutQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: options.duration || 250,\n                    timing: \"ease-out\",\n                    from: 0,\n                    to: 1\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.tabEnterPage = tabEnterPage;\n            /**\n             * exit and grow animation\n             * @function WinJSContrib.UI.Animation.exitGrow\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function exitGrow(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-exitGrow\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var dur = options.duration || 250;\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeInQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeInQuint,\n                    from: 1,\n                    to: 0\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.exitGrow = exitGrow;\n            /**\n             * exit and shrink animation\n             * @function WinJSContrib.UI.Animation.exitShrink\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function exitShrink(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-exitShrink\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var dur = options.duration || 250;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 10, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeInQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: WinJSContrib.UI.Animation.Easings.easeInQuint,\n                    from: 1,\n                    to: 0\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.exitShrink = exitShrink;\n            /**\n             * shrink and fall animation\n             * @function WinJSContrib.UI.Animation.shrinkAndFall\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function shrinkAndFall(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var dur = options.duration || 250;\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: \"WinJSContrib-shrinkAndFall\",\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || \"ease-in\"\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: \"ease-in\",\n                    from: 1,\n                    to: 0\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.shrinkAndFall = shrinkAndFall;\n            /**\n             * enter and shrink animation\n             * @function WinJSContrib.UI.Animation.enterShrink\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function enterShrink(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-enterShrink\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var dur = options.duration || 350;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeOutQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeOutQuint,\n                    from: 0,\n                    to: 1\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.enterShrink = enterShrink;\n            /**\n             * enter and shrink animation\n             * @function WinJSContrib.UI.Animation.enterGrow\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function enterGrow(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-enterGrow\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var dur = options.duration || 350;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeOutQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: WinJSContrib.UI.Animation.Easings.easeOutQuint,\n                    from: 0,\n                    to: 1\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.enterGrow = enterGrow;\n        })(Animation = UI.Animation || (UI.Animation = {}));\n    })(UI = WinJSContrib.UI || (WinJSContrib.UI = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\n//# sourceMappingURL=../../Sources/Common/winjscontrib.ui.animation.js.map","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n//this control requires snap.svg\r\n\r\n(function () {\r\n    'use strict';\r\n    var elasticbuttonkinds = {\r\n        rectangle: {\r\n            morphpath: 'M286,113c0,0-68.8,6-136,6c-78.2,0-137-6-137-6S6,97.198,6,62.5C6,33.999,13,12,13,12s59-7,137-7c85,0,136,7,136,7s8,17.598,8,52C294,96.398,286,113,286,113z',\r\n            svg: '<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 300 125\" preserveAspectRatio=\"none\"><path d=\"M286.5,113c0,0-104,0-136.5,0c-35.75,0-136.5,0-136.5,0s0-39.417,0-52.5c0-12.167,0-48.5,0-48.5s101.833,0,136.5,0c33.583,0,136.5,0,136.5,0s0,35.917,0,48.5C286.5,73.167,286.5,113,286.5,113z\"/></svg>'\r\n        },\r\n        roundedrectangle: {\r\n            morphpath: 'M287,95.25c0,11.046-5.954,19.75-17,19.75c0,0-90-4-120-4s-120,4-120,4c-11.046,0-17.25-9.5-17.25-20.5c0-8.715,0.25-10.75,0.25-34s-0.681-26.257-1-33.75C11.5,15,18.954,10,30,10c0,0,90,3,120,3s120-3,120-3c11.046,0,17.75,6.5,17,20c-0.402,7.239,0,6.75,0,30.5C287,83.5,287,84.75,287,95.25z',\r\n            svg: '<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 300 125\" preserveAspectRatio=\"none\"><path d=\"M290,95c0,11.046-8.954,20-20,20c0,0-90,0-120,0s-120,0-120,0c-11.046,0-20-9-20-20c0-8.715,0-25.875,0-34.5c0-7.625,0-22.774,0-30.5c0-11.625,8.954-20,20-20c0,0,90,0,120,0s120,0,120,0c11.046,0,20,8.954,20,20c0,7.25,0,22.875,0,30.5C290,69.125,290,84.5,290,95z\"/></svg>'\r\n        },\r\n        round: {\r\n            morphpath: 'M251,150c0,93.5-29.203,143-101,143S49,243.5,49,150C49,52.5,78.203,7,150,7S251,51.5,251,150z',\r\n            svg: '<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 300 300\" preserveAspectRatio=\"none\"><path d=\"M281,150c0,71.797-59.203,131-131,131S19,221.797,19,150S78.203,19,150,19S281,78.203,281,150z\"/></svg>'\r\n        },\r\n    };\r\n\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        ElasticButton: WinJS.Class.mix(WinJS.Class.define(function ctor(element, options) {\r\n            this.element = element || document.createElement('DIV');\r\n            options = options || {};\r\n            this.element.winControl = this;\r\n            this.behavior = {\r\n                speed: { reset: 800, active: 150 },\r\n                easing: { reset: mina.elastic, active: mina.easein }\r\n            };\r\n\r\n            this.element.classList.add('mcn-elasticbutton');\r\n            this.element.classList.add('win-disposable');\r\n            WinJS.UI.setOptions(this, options);\r\n        }, {\r\n            kind: {\r\n                get: function () {\r\n                    return this._kind;\r\n                },\r\n                set: function (val) {\r\n                    this._kind = val;\r\n                    this.render();\r\n                }\r\n            },\r\n\r\n            render: function () {\r\n                var ctrl = this;\r\n                this.element.classList.add('mcn-elasticbutton-' + ctrl.kind);\r\n                var contentCreated = false;\r\n                if (!ctrl.contentElement) {\r\n                    ctrl.contentElement = document.createElement('DIV');\r\n                    ctrl.contentElement.className = 'mcn-elasticbutton-content';\r\n                    WinJSContrib.Utils.moveChilds(ctrl.element, ctrl.contentElement);\r\n                    contentCreated = true;\r\n                }\r\n\r\n                if (!ctrl.bgElement) {\r\n                    ctrl.bgElement = document.createElement('DIV');\r\n                    ctrl.bgElement.className = 'mcn-elasticbutton-bg';\r\n                    ctrl.element.appendChild(ctrl.bgElement);\r\n                }\r\n\r\n                if (contentCreated) {\r\n                    ctrl.element.appendChild(ctrl.contentElement);\r\n                }\r\n\r\n                if (!ctrl.contentElement) {\r\n                    ctrl.contentElement = document.createElement('DIV');\r\n                    ctrl.contentElement.className = 'mcn-elasticbutton-content';\r\n                    while (ctrl.element.children.length > 0) {\r\n                        ctrl.contentElement.appendChild(ctrl.element.children[0]);\r\n                    }\r\n                    ctrl.element.appendChild(ctrl.contentElement);\r\n                }\r\n\r\n                ctrl.currentKind = elasticbuttonkinds[this.kind];\r\n                if (ctrl.currentKind) {\r\n                    ctrl.bgElement.innerHTML = ctrl.currentKind.svg;\r\n                    ctrl.snap = Snap(ctrl.bgElement.querySelector('svg'));\r\n                    ctrl.pathEl = ctrl.snap.select('path');\r\n                    ctrl.paths = {\r\n                        reset: ctrl.pathEl.attr('d'),\r\n                        active: ctrl.currentKind.morphpath\r\n                    };\r\n                    if (ctrl.eventTracker)\r\n                        ctrl.eventTracker.dispose();\r\n                    ctrl.eventTracker = new WinJSContrib.UI.EventTracker();\r\n                    ctrl.eventTracker.addEvent(ctrl.element, 'pointerdown', function (arg) { ctrl._ptdown(arg); });\r\n                    ctrl.eventTracker.addEvent(ctrl.element, 'pointerup', function (arg) { ctrl._ptup(arg); });\r\n                    ctrl.eventTracker.addEvent(ctrl.element, 'pointerleave', function (arg) { ctrl._ptup(arg); })\r\n                }\r\n            },\r\n\r\n            _ptdown: function (arg) {\r\n                this.element.classList.add(\"pressed\");\r\n                this.pathEl.stop().animate({ 'path': this.paths.active }, this.behavior.speed.active, this.behavior.easing.active);\r\n            },\r\n\r\n            _ptup: function (arg) {\r\n                this.element.classList.remove(\"pressed\");\r\n                this.pathEl.stop().animate({ 'path': this.paths.reset }, this.behavior.speed.reset, this.behavior.easing.reset);\r\n            },\r\n\r\n            dispose: function () {\r\n                if (this.eventTracker) this.eventTracker.dispose();\r\n                WinJS.Utilities.disposeSubTree(this.element);\r\n                this.element = null;\r\n            }\r\n        }),\r\n\t\tWinJS.Utilities.eventMixin,\r\n\t\tWinJS.Utilities.createEventProperties(\"myevent\"))\r\n    });\r\n})();","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/// <reference path=\"winjscontrib.core.js\" />\r\n\r\n//this controls requires snap.svg\r\n\r\n(function () {\r\n    'use strict';\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        FOWrapper: WinJS.Class.mix(WinJS.Class.define(function ctor(element, options) {\r\n            this.element = element || document.createElement('DIV');\r\n            options = options || {};\r\n            this.element.winControl = this;\r\n            this.element.classList.add('mcn-fowrapper');\r\n            this.element.classList.add('mcn-layout-ctrl');\r\n            this.element.classList.add('win-disposable');\r\n            WinJS.UI.setOptions(this, options);\r\n            this.render();\r\n        }, {\r\n            someProperty: {\r\n                get: function () {\r\n                    return this._someProperty;\r\n                },\r\n                set: function (val) {\r\n                    this._someProperty = val;\r\n                }\r\n            },\r\n\r\n            render: function () {\r\n                var ctrl = this;\r\n                ctrl.wrapperId = WinJSContrib.Utils.guid();\r\n                var body = document.createElement(\"BODY\");\r\n                body.className = \"mcn-fowrapper-content\";\r\n                body.style.width = '100%';\r\n                body.style.height = '100%';\r\n                WinJSContrib.Utils.moveChilds(ctrl.element, body);\r\n                ctrl.element.innerHTML = '<svg id=\"' + ctrl.wrapperId + '\" class=\"mcn-fowrapper-svg\" xmlns=\"http://www.w3.org/2000/svg\" style=\"width:100%; height: 100%\">' +\r\n                    '<defs>' +\r\n                        '<filter id=\"blur-' + ctrl.wrapperId + '\" x=\"0\" y=\"0\"><feGaussianBlur class=\"gblur\" in=\"SourceGraphic\" stdDeviation=\"0\" /></filter>' +\r\n                    '</defs>' +\r\n                    '<foreignObject class=\"fowrapper\" width=\"100%\" height=\"100%\" requiredExtensions=\"http://www.w3.org/1999/xhtml\" filter=\"url(#blur-' + ctrl.wrapperId + ')\">' +\r\n                    '</foreignObject>' +\r\n                '</svg>';\r\n                var container = ctrl.element.querySelector(\".fowrapper\");\r\n                ctrl.svg = ctrl.element.querySelector(\"svg\");\r\n                ctrl.container = container;\r\n                ctrl.content = body;\r\n                ctrl.blurFilter = ctrl.element.querySelector(\".gblur\");\r\n                ctrl.sblurFilter = Snap(ctrl.blurFilter);\r\n                container.appendChild(body);\r\n            },\r\n\r\n            blurTo: function (blur, duration, easing) {\r\n                var ctrl = this;\r\n\r\n                ctrl.sblurFilter.stop();\r\n                if (!duration) {\r\n                    ctrl.blurFilter.setAttribute(\"stdDeviation\", blur);                    \r\n                    return;\r\n                }\r\n\r\n                ctrl.sblurFilter.animate({ stdDeviation: blur }, duration, easing || mina.easeout);\r\n                ctrl.dispatchEvent('blur');\r\n            },\r\n\r\n            updateLayout: function () {\r\n                if (this.container) {\r\n                    this.container.setAttribute(\"width\", \"100%\");\r\n                    this.container.setAttribute(\"height\", \"100%\");\r\n                }\r\n            },\r\n\r\n            dispose: function () {\r\n                WinJS.Utilities.disposeSubTree(this.element);                \r\n                this.element = null;\r\n            }\r\n        }),\r\n        WinJS.Utilities.eventMixin,\r\n        WinJS.Utilities.createEventProperties(\"blur\"))\r\n    });\r\n})();","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib = WinJSContrib || {};\r\nWinJSContrib.UI = WinJSContrib.UI || {};\r\n\r\n(function () {\r\n    \"use strict\";\r\n\r\n    WinJSContrib.UI.MultiPassRenderer = WinJS.Class.define(\r\n    /**\r\n     * This control manage multi-pass rendering for improving performances when showing a list of items.\r\n     * The renderer will render \"shells\" for the items to enable page layout, and render items content on demand, or when items scrolls to view.  \r\n     * @class WinJSContrib.UI.MultiPassRenderer\r\n     */\r\n    function (element, options) {\r\n        options = options || {};\r\n        this.items = [];\r\n        this.element = element;\r\n        this._scrollProcessor = null;\r\n        this._tolerance = 1;\r\n        this._virtualize = false;\r\n        this._scrollContainer = options.scrollContainer || null;\r\n        this._multipass = options.multipass || false;\r\n        this._orientation = options.orientation || '';\r\n        this.itemClassName = options.itemClass || options.className || options.itemClassName;\r\n        this.itemTemplate = WinJSContrib.Utils.getTemplate(options.template || options.itemTemplate);\r\n        this.itemInvoked = options.invoked || options.itemInvoked;\r\n        this.onitemContent = options.onitemContent;\r\n        this._onScrollBinded = this._onScroll.bind(this);\r\n\r\n        if (element) {\r\n            element.className = element.className + ' mcn-items-ctrl mcn-layout-ctrl win-disposable';\r\n        }\r\n\r\n        //element.mcnRenderer = this;\r\n        //WinJS.UI.setOptions(this, options);\r\n    },\r\n    /**\r\n      * @lends WinJSContrib.UI.MultiPassRenderer.prototype\r\n      */\r\n    {\r\n        dispose : function(){\r\n            var ctrl = this;\r\n            WinJSContrib.UI.untapAll(ctrl.element);\r\n            WinJS.Utilities.disposeSubTree(ctrl.element);\r\n            ctrl._unregisterScrollEvents();\r\n            ctrl._scrollContainer = null;\r\n            ctrl.element = null;\r\n            ctrl._scrollProcessor = null;\r\n            ctrl.rect = null;           \r\n            ctrl.items = [];\r\n        },\r\n\r\n        clear: function () {\r\n            var ctrl = this;\r\n            WinJS.Utilities.disposeSubTree(ctrl.element);\r\n            ctrl.element.innerHTML = '';\r\n        },\r\n\r\n        /**\r\n         * kind of multipass, can be 'section', or 'item'\r\n         * @type {String}\r\n         * @field\r\n         */\r\n        multipass: {\r\n            get: function () {\r\n                return this._multipass;\r\n            },\r\n            set: function (val) {\r\n                this._multipass = val;\r\n                this.refreshScrollEvents();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * tolerance for determining if the rendering should apply. Tolerance is expressed in scroll container proportion. For example, 1 means that tolerance is equal to scroll container size\r\n         * @type {number}\r\n         * @field\r\n         */\r\n        tolerance: {\r\n            get: function () {\r\n                return this._tolerance;\r\n            },\r\n            set: function (val) {\r\n                this._tolerance = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * indicate if renderer empty items out of sight\r\n         * @type {boolean}\r\n         * @field\r\n         */\r\n        virtualize: {\r\n            get: function () {\r\n                return this._virtualize;\r\n            },\r\n            set: function (val) {\r\n                this._virtualize = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * could be 'vertical' or 'horizontal'\r\n         * @type {String}\r\n         * @field\r\n         */\r\n        orientation: {\r\n            get: function () {\r\n                return this._orientation;\r\n            },\r\n            set: function (val) {\r\n                this._orientation = val;\r\n                this.refreshScrollEvents();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Element containing scroll. If scrollContainer is filled, items content will get rendered when coming into view\r\n         * @type {HTMLElement}\r\n         * @field\r\n         */\r\n        scrollContainer: {\r\n            get: function () {\r\n                return this._scrollContainer;\r\n            },\r\n            set: function (val) {\r\n                this._unregisterScrollEvents();\r\n                this._scrollContainer = val;\r\n                this._registerScrollEvents();\r\n                //this.checkRendering();\r\n            }\r\n        },\r\n\r\n        _onScroll: function () {\r\n            var ctrl = this;\r\n            if (ctrl.scrollContainer && ctrl._scrollProcessor) {\r\n                if (ctrl._scrollRequest) {\r\n                    cancelAnimationFrame(ctrl._scrollRequest);\r\n                }\r\n\r\n                ctrl._scrollRequest = requestAnimationFrame(function () {\r\n                    ctrl.checkRendering();\r\n                });\r\n            }\r\n        },\r\n\r\n        _unregisterScrollEvents: function () {\r\n            this._scrollProcessor = null;\r\n            this.clearOffsets();\r\n            if (this.scrollContainer) {\r\n                this.scrollContainer.removeEventListener('scroll', this._onScrollBinded);\r\n            }\r\n        },\r\n\r\n        _registerScrollEvents: function () {\r\n            var ctrl = this;\r\n            if (ctrl.scrollContainer) {\r\n                this.scrollContainer.addEventListener('scroll', this._onScrollBinded);\r\n\r\n                if (ctrl.orientation == 'vertical') {\r\n                    if (ctrl.multipass == 'section') {\r\n                        ctrl._scrollProcessor = function () { ctrl._checkSection(ctrl._vIsInView); }\r\n                    } else if (ctrl.multipass == 'item') {\r\n                        ctrl._scrollProcessor = function () { ctrl._checkItem(ctrl._vIsInView); }\r\n                    }\r\n                } else {\r\n                    if (ctrl.multipass == 'section') {\r\n                        ctrl._scrollProcessor = function () { ctrl._checkSection(ctrl._hIsInView); }\r\n                    } else if (ctrl.multipass == 'item') {\r\n                        ctrl._scrollProcessor = function () { ctrl._checkItem(ctrl._hIsInView); }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * refresh scroll events associated to multi pass renderer\r\n         */\r\n        refreshScrollEvents: function () {\r\n            this._unregisterScrollEvents();\r\n            this._registerScrollEvents();\r\n            this.clearOffsets();\r\n        },\r\n\r\n        _vIsInView: function (rect, scrollContainer, tolerance) {\r\n            var pxTolerance = scrollContainer.clientHeight * tolerance;\r\n            if (rect.y >= scrollContainer.scrollTop - pxTolerance && rect.y <= scrollContainer.scrollTop + scrollContainer.clientHeight + pxTolerance)\r\n                return true;\r\n\r\n            if (rect.y + rect.height >= scrollContainer.scrollTop - pxTolerance && rect.y + rect.height <= scrollContainer.scrollTop + scrollContainer.clientHeight + pxTolerance)\r\n                return true;\r\n\r\n            if (rect.y <= scrollContainer.scrollTop - pxTolerance && rect.y + rect.height >= scrollContainer.scrollTop + scrollContainer.clientHeight + pxTolerance)\r\n                return true;\r\n\r\n            return false;\r\n        },\r\n\r\n        _hIsInView: function (rect, scrollContainer, tolerance) {\r\n            var pxTolerance = scrollContainer.clientWidth * (tolerance || 0);\r\n            if (rect.x >= scrollContainer.scrollLeft - pxTolerance && rect.x <= scrollContainer.scrollLeft + scrollContainer.clientWidth + pxTolerance)\r\n                return true;\r\n\r\n            if (rect.x + rect.width >= scrollContainer.scrollLeft - pxTolerance && rect.x + rect.width <= scrollContainer.scrollLeft + scrollContainer.clientWidth + pxTolerance)\r\n                return true;\r\n\r\n            if (rect.x <= scrollContainer.scrollLeft - pxTolerance && rect.x + rect.width >= scrollContainer.scrollLeft + scrollContainer.clientWidth + pxTolerance)\r\n                return true;\r\n\r\n            return false;\r\n        },\r\n\r\n        /**\r\n         * Clear cached offsets for bloc and for items\r\n         */\r\n        clearOffsets: function () {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n            \r\n            ctrl.rect = null;\r\n            ctrl.items.forEach(function (item) {\r\n                item.rect = null;\r\n            });\r\n        },\r\n\r\n        /**\r\n         * update ui related properties like cached offsets, scroll events, ...\r\n         */\r\n        updateLayout: function () {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n            ctrl.refreshScrollEvents();\r\n        },\r\n\r\n        _checkSection: function (check, tolerance, noRender) {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n            tolerance = tolerance || 0;\r\n\r\n            if (!ctrl.rect && ctrl.items && ctrl.items.length) {\r\n                ctrl.rect = WinJSContrib.UI.offsetFrom(ctrl.element, ctrl.scrollContainer);\r\n            } else {\r\n                ctrl.rect = ctrl.rect || { x: 0, y: 0, width: 0, height: 0 };\r\n                ctrl.rect.width = ctrl.element.clientWidth;\r\n                ctrl.rect.height = ctrl.element.clientHeight;\r\n            }\r\n\r\n            if (check(ctrl.rect, ctrl.scrollContainer, tolerance)) {\r\n                if (noRender)\r\n                    return true;\r\n\r\n                ctrl.renderItemsContent();\r\n                if (ctrl.onrendersection) {\r\n                    ctrl.onrendersection();\r\n                }\r\n            } else if (ctrl.virtualize && tolerance > 0 && ctrl.items && ctrl.items.length && ctrl.items[0].rendered) {\r\n                ctrl.items.forEach(function (item) {\r\n                    item.empty();\r\n                });\r\n            }\r\n\r\n            if (tolerance == 0 && ctrl.tolerance > 0) {\r\n                setImmediate(function () {\r\n                    ctrl._checkSection(check, ctrl.tolerance);\r\n                });\r\n            }\r\n        },\r\n\r\n        _checkItem: function (check, tolerance) {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n            tolerance = tolerance || 0;\r\n            var allRendered = true;\r\n\r\n            var countR = function () {\r\n                var countRendered = 0;\r\n                ctrl.items.forEach(function (item) {\r\n                    if (item.rendered) {\r\n                        countRendered++;\r\n                    }\r\n                });\r\n                console.log('rendered ' + countRendered);\r\n            }\r\n\r\n            if (ctrl._checkSection(check, tolerance, true)) {\r\n                ctrl.items.forEach(function (item) {\r\n                    if (!item.rect) {\r\n                        item.rect = WinJSContrib.UI.offsetFrom(item.element, ctrl.scrollContainer);\r\n                    }\r\n                    allRendered = allRendered & item.rendered;\r\n\r\n                    if (!item.rendered && check(item.rect, ctrl.scrollContainer, tolerance)) {\r\n                        item.render();\r\n                    } else if (item.rendered && ctrl.virtualize && tolerance > 0 && !check(item.rect, ctrl.scrollContainer, tolerance)) {\r\n                        item.empty();\r\n                    }\r\n                });\r\n                ctrl.allRendered = allRendered;\r\n                //countR();\r\n            } else if (tolerance > 0 && ctrl.items.length && (ctrl.items[0].rendered || ctrl.items[ctrl.items.length - 1].rendered)) {\r\n                ctrl.items.forEach(function (item) {\r\n                    if (!item.rect) {\r\n                        item.rect = WinJSContrib.UI.offsetFrom(item.element, ctrl.scrollContainer);\r\n                    }\r\n                    if (ctrl.virtualize && !check(item.rect, ctrl.scrollContainer, tolerance)) {\r\n                        item.empty();\r\n                    }\r\n                });\r\n                //countR();\r\n            }\r\n\r\n            if (tolerance == 0 && ctrl.tolerance > 0) {\r\n                setImmediate(function () {\r\n                    ctrl._checkItem(check, ctrl.tolerance);\r\n                });\r\n            }\r\n\r\n\r\n        },\r\n\r\n        /**\r\n         * render items shells to the page\r\n         * @param {Array} items array of items to render\r\n         * @param {Object} renderOptions options for rendering items, can override control options like item template\r\n         */\r\n        prepareItems: function (items, renderOptions) {\r\n            var ctrl = this;\r\n            items = items || [];\r\n            renderOptions = renderOptions || {};\r\n            var numItems = items.length;\r\n\r\n            var itemInvoked = renderOptions.itemInvoked || ctrl.itemInvoked;\r\n            if (typeof itemInvoked == 'string')\r\n                itemInvoked = WinJSContrib.Utils.resolveMethod(ctrl.element, itemInvoked);\r\n            var template = WinJSContrib.Utils.getTemplate(renderOptions.template) || ctrl.itemTemplate;\r\n            var className = renderOptions.itemClassName || ctrl.itemClassName;\r\n            var onitemInit = renderOptions.onitemInit || ctrl.onitemInit;\r\n            var onitemContent = renderOptions.onitemContent || ctrl.onitemContent;\r\n            var container = ctrl.element;\r\n            var registereditems = ctrl.items;\r\n\r\n            items.forEach(function (itemdata) {\r\n                var item = new WinJSContrib.UI.MultiPassItem(ctrl, null, {\r\n                    data: itemdata,\r\n                    template: template,\r\n                    className: className,\r\n                    itemInvoked: itemInvoked,\r\n                    onitemInit: onitemInit,\r\n                    onitemContent: onitemContent\r\n                });\r\n                registereditems.push(item);\r\n                container.appendChild(item.element);\r\n            });\r\n            //for (var i = 0 ; i < numItems; i++) {\r\n            //    var itemdata = items[i];\r\n            //    var item = new WinJSContrib.UI.MultiPassItem(ctrl, null, {\r\n            //        data: itemdata,\r\n            //        template: template,\r\n            //        className: className,\r\n            //        itemInvoked: itemInvoked,\r\n            //        onitemInit: onitemInit,\r\n            //        onitemContent: onitemContent\r\n            //    });\r\n            //    registereditems.push(item);\r\n            //    container.appendChild(item.element);\r\n            //}\r\n\r\n            if (renderOptions.renderItems || !this.multipass) {\r\n                ctrl.renderItemsContent();\r\n            }\r\n            //ctrl.element.style.display = '';\r\n        },\r\n\r\n        /**\r\n         * check rendering of items, based on multipass configuration (force items on screen to render)\r\n         */\r\n        checkRendering: function () {\r\n            var ctrl = this;\r\n            if (ctrl.element && ctrl._scrollProcessor)\r\n                ctrl._scrollProcessor();\r\n        },\r\n\r\n        /**\r\n         * force rendering of all unrendered items\r\n         */\r\n        renderItemsContent: function () {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n\r\n            ctrl.items.forEach(function (item) {\r\n                if (!item.rendered) {\r\n                    //setImmediate(function () {\r\n                    item.render();\r\n                    //});\r\n                }\r\n            });\r\n            ctrl.allRendered = true;\r\n        }\r\n    });\r\n\r\n    WinJSContrib.UI.MultiPassItem = WinJS.Class.define(\r\n        /**\r\n         * Item for multipass rendering\r\n         * @class WinJSContrib.UI.MultiPassItem\r\n         */\r\n    function (renderer, element, options) {\r\n        options = options || {};\r\n        var item = this;\r\n        item.renderer = renderer;\r\n        item.element = element || document.createElement('DIV');\r\n        item.element.className = item.element.className + ' ' + options.className + ' mcn-multipass-item unloaded win-disposable';\r\n        item.element.winControl = item;\r\n\r\n        item.itemInvoked = options.itemInvoked;\r\n        item.itemDataPromise = WinJS.Promise.as(options.data);\r\n\r\n        item.itemTemplate = options.template;\r\n        item.rendered = false;\r\n        item.onitemContent = options.onitemContent;\r\n        if (options.onitemInit) {\r\n            options.onitemInit(this);\r\n        }\r\n    },\r\n    /**\r\n     * @lends WinJSContrib.UI.MultiPassItem\r\n     */\r\n    {\r\n        dispose: function () {\r\n            var item = this;\r\n            item.renderer = null;\r\n            item.element = null;\r\n            item.itemInvoked = null;\r\n            item.itemData = null;\r\n            item.itemDataPromise = null;\r\n            item.itemTemplate = null;\r\n            item.onitemContent = null;\r\n        },\r\n\r\n        /**\r\n         * render item content\r\n         */\r\n        render: function (delayed) {\r\n            var ctrl = this;\r\n\r\n            if (ctrl.element && ctrl.itemTemplate && !ctrl.rendered) {\r\n\r\n                ctrl.rendered = true;\r\n                return ctrl._renderContent();\r\n            }\r\n\r\n            return WinJS.Promise.wrap(ctrl.contentElement);\r\n        },\r\n\r\n        /**\r\n         * empty item and mark it as unrendered\r\n         */\r\n        empty: function () {\r\n            var ctrl = this;\r\n            if (ctrl.element && ctrl.rendered) {\r\n                WinJSContrib.UI.untapAll(ctrl.element);\r\n                ctrl.element.classList.remove('loaded');\r\n                ctrl.element.innerHTML = '';\r\n                ctrl.rendered = false;\r\n            }\r\n        },\r\n\r\n        _renderItemContent: function (rendered) {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n\r\n            ctrl.element.appendChild(rendered);\r\n\r\n            if (ctrl.itemInvoked) {\r\n                if (typeof ctrl.itemInvoked == 'string')\r\n                    ctrl.itemInvoked = WinJSContrib.Utils.resolveMethod(ctrl.element, ctrl.itemInvoked);\r\n\r\n                if (ctrl.itemInvoked) {\r\n                    WinJSContrib.UI.tap(ctrl.element, function (arg) {\r\n                        ctrl.itemInvoked(ctrl);\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (ctrl.onitemContent) {\r\n                ctrl.onitemContent(ctrl.itemData, rendered);\r\n            }\r\n            else if (ctrl.renderer.onitemContent) {\r\n                ctrl.renderer.onitemContent(ctrl.itemData, rendered);\r\n            }\r\n\r\n            setImmediate(function () {\r\n                if (ctrl.element) {\r\n                    ctrl.element.classList.remove('unloaded');\r\n                    ctrl.element.classList.add('loaded');\r\n                }\r\n            });\r\n\r\n            ctrl.rendered = true;\r\n            ctrl.contentElement = rendered;\r\n            return rendered;\r\n        },\r\n\r\n        _renderContent: function () {\r\n            var ctrl = this;\r\n\r\n            if (ctrl.element && ctrl.itemTemplate) {\r\n                return ctrl.itemDataPromise.then(function (data) {\r\n                    ctrl.itemData = data;\r\n                    return ctrl.itemTemplate.render(data).then(function (rendered) {\r\n                        ctrl._renderItemContent(rendered);\r\n                    });\r\n                });\r\n            }\r\n\r\n            return WinJS.Promise.wrap();\r\n        }\r\n    });\r\n})();","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n(function () {\r\n\r\n\t\"use strict\";\r\n\r\n\t/**\r\n     * Object representing a layout configuration for the grid control\r\n     * @typedef {Object} WinJSContrib.UI.GridControlLayout\r\n     * @property {string} layout layout algorythm to apply (horizontal | vertical | flexhorizontal | flexvertical | hbloc\r\n     * @property {number} cellSpace space between grid cells\r\n     * @property {number} cellWidth width of grid cells\r\n     * @property {number} cellHeight height of grid cells\r\n     * @property {number} itemsPerColumn number of cells per column if using a layout with a fixed number of cells\r\n     * @property {number} itemsPerRow number of cells per row if using a layout with a fixed number of cells\r\n     * @example\r\n     * {\r\n     *     layout: 'horizontal',\r\n     *     itemsPerColumn: (options.itemsPerColumn) ? options.itemsPerColumn : undefined,\r\n     *     itemsPerRow: (options.itemsPerRow) ? options.itemsPerRow : undefined,\r\n     *     cellSpace: 10,\r\n     *     cellWidth: (options.cellWidth) ? options.cellWidth : undefined,\r\n     *     cellHeight: (options.cellHeight) ? options.cellHeight : undefined,\r\n     * }\r\n     */\r\n\r\n\tWinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n\t\tGridControl: WinJS.Class.define(\r\n            /**\r\n             * @classdesc\r\n             * Control that layout it's children with different algorythms. Used with {@link WinJSContrib.UI.Hub}, The Grid could rely on multipass rendering to optimize large hub pages load.\r\n             * @class WinJSContrib.UI.GridControl\r\n             * @param {HTMLElement} element DOM element containing the control\r\n             * @param {Object} options\r\n             */\r\n            function GridControl(element, options) {\r\n            \tvar grid = this;\r\n            \toptions = options || {};\r\n            \tgrid.element = element;\r\n\r\n            \tgrid.element.className = grid.element.className + ' mcn-grid-ctrl mcn-layout-ctrl win-disposable';\r\n            \tgrid.element.winControl = grid;\r\n\r\n\r\n            \t/**\r\n                 * multipass renderer for the grid\r\n                 * @field\r\n                 * @type WinJSContrib.UI.MultiPassRenderer\r\n                 */\r\n            \tgrid.renderer = new WinJSContrib.UI.MultiPassRenderer(grid.element, {\r\n            \t\tmultipass: options.multipass,\r\n            \t\titemClassName: options.itemClassName,\r\n            \t\titemTemplate: options.itemTemplate,\r\n            \t\titemInvoked: options.itemInvoked,\r\n            \t});\r\n\r\n\r\n            \tgrid.layouts = options.layouts;\r\n\r\n            \t/**\r\n                 * default layout definitions for the grid\r\n                 * @field\r\n                 * @type WinJSContrib.UI.GridControlLayout\r\n                 */\r\n            \tgrid.defaultLayout = {\r\n            \t\tlayout: options.layout || 'none',\r\n            \t\titemsPerColumn: (options.itemsPerColumn) ? options.itemsPerColumn : undefined,\r\n            \t\titemsPerRow: (options.itemsPerRow) ? options.itemsPerRow : undefined,\r\n            \t\tcellSpace: (options.cellSpace) ? options.cellSpace : 10,\r\n            \t\tcellWidth: (options.cellWidth) ? options.cellWidth : undefined,\r\n            \t\tcellHeight: (options.cellHeight) ? options.cellHeight : undefined,\r\n            \t};\r\n\r\n            \t/**\r\n                 * indicate if grid accept layout event from the page (if you use WinJS Contrib page events)\r\n                 * @field\r\n                 * @type boolean\r\n                 */\r\n            \tgrid.autolayout = options.autolayout || true;\r\n\r\n            \tvar parent = WinJSContrib.Utils.getScopeControl(grid.element);\r\n            \tif (parent && parent.pageLifeCycle) {\r\n            \t\tparent.pageLifeCycle.steps.layout.attach(function () {\r\n            \t\t\tif (grid.autolayout) {\r\n            \t\t\t\tgrid.layout();\r\n            \t\t\t}\r\n            \t\t});\r\n            \t}\r\n            \telse if (parent && parent.elementReady) {\r\n            \t\tparent.elementReady.then(function () {\r\n            \t\t\tparent.readyComplete.then(function () {\r\n            \t\t\t\tif (grid.autolayout) {\r\n            \t\t\t\t\tgrid.layout();\r\n            \t\t\t\t}\r\n            \t\t\t});\r\n            \t\t});\r\n            \t}\r\n            },\r\n            /**\r\n             * @lends WinJSContrib.UI.GridControl.prototype\r\n             */\r\n            {\r\n            \t/**\r\n                 * scroll element containing the grid. Required for multi pass rendering\r\n                 * @field\r\n                 * @type HTMLElement\r\n                 */\r\n            \tscrollContainer: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.scrollContainer;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.scrollContainer = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * indicate if grid layout itself according to the page lifecycle (default to true)\r\n                 * @field\r\n                 * @type boolean\r\n                 */\r\n            \tautolayout: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this._autolayout;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis._autolayout = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * layout definitions for the grid. It's an object containing several grid layout options. See {@link WinJSContrib.UI.GridControlLayout}\r\n                 * @field\r\n                 * @type Object\r\n                 */\r\n            \tlayouts: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.gridLayouts;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.gridLayouts = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * indicate the kind of multipass treatment\r\n                 * @field\r\n                 * @type string\r\n                 */\r\n            \tmultipass: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.multipass;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.multipass = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * callback triggered when clicking on an item\r\n                 * @field\r\n                 * @type HTMLElement\r\n                 */\r\n            \titemInvoked: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.itemInvoked;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.itemInvoked = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * item template (WinJS Template or template function)\r\n                 * @field\r\n                 * @type Object\r\n                 */\r\n            \titemTemplate: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.itemTemplate;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.itemTemplate = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * css class added on item's placeholder\r\n                 * @field\r\n                 * @type Object\r\n                 */\r\n            \titemClassName: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.itemClassName;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.itemClassName = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * items to render\r\n                 * @field\r\n                 * @type Object\r\n                 */\r\n            \titems: {\r\n            \t\tget: function () {\r\n            \t\t\treturn;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n\t\t\t\t\t\tif (val && val.length)\r\n            \t\t\t\tthis.prepareItems(val);\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * render HTML for items\r\n                 * @param {Array} items array of items to render\r\n                 * @param {Object} renderOptions\r\n                 */\r\n            \tprepareItems: function (items, renderOptions) {\r\n                    if (!this.element)\r\n                        return;\r\n                    \r\n            \t\tvar parent = WinJSContrib.Utils.getParentControlByClass('mcn-layout-ctrl', this.element);\r\n            \t\tvar parentMultipass = undefined;\r\n            \t\tif (!this.renderer.multipass && parent && parent.multipass) {\r\n            \t\t\tthis.renderer.multipass = parent.multipass;\r\n            \t\t}\r\n\r\n            \t\tthis.renderer.prepareItems(items, renderOptions);\r\n            \t},\r\n\r\n            \t/**\r\n                 * force items content to render\r\n                 */\r\n            \trenderItemsContent: function () {\r\n            \t\tif (!this.renderer)\r\n                        return;\r\n                    this.renderer.renderItemsContent();\r\n            \t},\r\n\r\n            \tresetElement: function (elt, isItem) {\r\n            \t\tvar style = elt.style;\r\n            \t\tif (isItem && style.position) style.position = '';\r\n            \t\tif (!isItem && style.display) style.display = '';\r\n            \t\tif (style.width) style.width = '';\r\n            \t\tif (style.height) style.height = '';\r\n            \t\tif (style.minWidth) style.minWidth = '';\r\n            \t\tif (style.minHeight) style.minHeight = '';\r\n            \t\tif (style.left) style.left = '';\r\n            \t\tif (style.top) style.top = '';\r\n            \t},\r\n\r\n            \tclearContent: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\tctrl.renderer.clear();\r\n            \t},\r\n\r\n            \t/**\r\n                 * Clear all layout and position styles on items\r\n                 */\r\n            \tclearLayout: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\t\r\n            \t\tctrl.resetElement(ctrl.element, false);\r\n            \t\tif (ctrl.element.children.length) {\r\n            \t\t\tfor (var i = 0, l = ctrl.element.children.length; i < l; i++) {\r\n            \t\t\t\tctrl.resetElement(ctrl.element.children[i], true);\r\n            \t\t\t}\r\n            \t\t}\r\n            \t},\r\n\r\n            \tfill: function (matrix, x, y, w, h) {\r\n            \t\tif (matrix.length < x + w) {\r\n            \t\t\tfor (var i = matrix.length ; i < x + w ; i++) {\r\n            \t\t\t\tmatrix.push([]);\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\tfor (var i = x ; i < x + w ; i++) {\r\n            \t\t\tvar col = matrix[i];\r\n            \t\t\tif (col.length < y + h) {\r\n            \t\t\t\tfor (var j = col.length ; j < y + h ; j++) {\r\n            \t\t\t\t\tcol.push(false);\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n\r\n            \t\t\tfor (var j = y ; j < y + h ; j++) {\r\n            \t\t\t\tcol[j] = true;\r\n            \t\t\t}\r\n            \t\t}\r\n            \t},\r\n\r\n            \tfit: function (matrix, x, y, w, h, maxW, maxH) {\r\n            \t\t//items to big\r\n            \t\tif (maxH && h > maxH && y === 0)\r\n            \t\t\treturn true;\r\n            \t\tif (maxW && w > maxW && x === 0)\r\n            \t\t\treturn true;\r\n\r\n            \t\t//overflow grid capacity\r\n            \t\tif (maxW && (x + w) > maxW)\r\n            \t\t\treturn false;\r\n            \t\tif (maxH && (y + h) > maxH)\r\n            \t\t\treturn false;\r\n\r\n            \t\tfor (var i = x ; i < x + w ; i++) {\r\n            \t\t\tvar col = matrix[i];\r\n            \t\t\tif (col) {\r\n            \t\t\t\tfor (var j = y ; j < y + h ; j++) {\r\n            \t\t\t\t\tif (col[j] === true)\r\n            \t\t\t\t\t\treturn false;\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\treturn true;\r\n            \t},\r\n\r\n            \tfirstFit: function (matrix, w, h, maxH, numItems) {\r\n            \t\tvar ctrl = this;\r\n            \t\tfor (var i = 0 ; i < numItems * maxH * 2 ; i++) {\r\n            \t\t\tvar col = matrix[i];\r\n            \t\t\tif (col) {\r\n            \t\t\t\tfor (var j = 0 ; j < maxH ; j++) {\r\n            \t\t\t\t\tif (col[j] !== true && ctrl.fit(matrix, i, j, w, h, undefined, maxH)) {\r\n            \t\t\t\t\t\treturn { x: i, y: j };\r\n            \t\t\t\t\t}\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n            \t\t\telse {\r\n            \t\t\t\treturn { x: i, y: 0 };\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\treturn undefined;\r\n            \t},\r\n\r\n            \tvisibleChilds: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\tvar res = [];\r\n\r\n            \t\tfor (var i = 0, l = ctrl.element.children.length; i < l ; i++) {\r\n            \t\t\tvar item = ctrl.element.children[i];\r\n            \t\t\tvar st = window.getComputedStyle(item);\r\n            \t\t\tif (st.display != 'none' && st.visibility != 'hidden') {\r\n            \t\t\t\tres.push(item);\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\treturn res;\r\n            \t},\r\n\r\n            \t/**\r\n                 * Layouts algorythm implementations\r\n                 */\r\n            \tGridLayoutsImpl: {\r\n            \t\tnone: function () {\r\n            \t\t},\r\n\r\n            \t\tflexhorizontal: function () {\r\n            \t\t\tvar ctrl = this;\r\n            \t\t\tctrl.renderer.orientation = 'horizontal';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\tctrl.element.style.display = 'flex';\r\n            \t\t\tctrl.element.style.flexFlow = 'column wrap';\r\n            \t\t\tctrl.element.style.alignContent = 'flex-start';\r\n            \t\t\t//ctrl.element.style.alignContent = 'flex-start';\r\n\r\n            \t\t\tif (ctrl.element.style.width)\r\n            \t\t\t\tctrl.element.style.width = '';\r\n\r\n            \t\t\tctrl.element.style.height = '';\r\n\r\n            \t\t\tif (ctrl.element.clientHeight)\r\n            \t\t\t\tctrl.element.style.height = ctrl.element.clientHeight + 'px';\r\n            \t\t\telse\r\n            \t\t\t\tctrl.element.style.height = '';\r\n\r\n            \t\t\tvar _itemsPerColumn = Math.floor(ctrl.element.clientHeight / (ctrl.data.cellHeight + ctrl.data.cellSpace));\r\n            \t\t\tif (_itemsPerColumn) {\r\n            \t\t\t\tvar visibleitems = ctrl.visibleChilds();\r\n            \t\t\t\tvar columns = Math.ceil(visibleitems.length / _itemsPerColumn);\r\n            \t\t\t\tctrl.element.style.minWidth = ((ctrl.data.cellWidth + ctrl.data.cellSpace) * columns) + 'px';\r\n            \t\t\t}\r\n            \t\t},\r\n\r\n            \t\tflexvertical: function () {\r\n            \t\t    var ctrl = this;\r\n                        ctrl.renderer.orientation = 'vertical';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\tctrl.element.style.display = 'flex';\r\n            \t\t\tctrl.element.style.flexFlow = 'row wrap';\r\n            \t\t\tctrl.element.style.alignContent = 'flex-start';\r\n\r\n            \t\t\tctrl.element.style.width = '';\r\n            \t\t\tif (ctrl.element.clientWidth)\r\n            \t\t\t\tctrl.element.style.width = ctrl.element.clientWidth + 'px';\r\n            \t\t\telse\r\n            \t\t\t\tctrl.element.style.width = '';\r\n\r\n            \t\t\tif (ctrl.element.style.height)\r\n            \t\t\t\tctrl.element.style.height = '';\r\n            \t\t},\r\n\r\n            \t\thbloc: function () {\r\n            \t\t\tvar ctrl = this;\r\n            \t\t\tctrl.renderer.orientation = 'horizontal';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\tctrl.element.style.height = '';\r\n            \t\t\tvar _containerH = ctrl.element.clientHeight;\r\n            \t\t\tif (!_containerH)\r\n            \t\t\t\treturn;\r\n\r\n            \t\t\tvar cellW = ctrl.data.cellWidth;\r\n            \t\t\tvar space = ctrl.data.cellSpace;\r\n            \t\t\tvar colCount = 1;\r\n            \t\t\tvar colOffset = 0;\r\n            \t\t\tvar topOffset = 0;\r\n\r\n            \t\t\tvar childs = ctrl.visibleChilds();\r\n            \t\t\tchilds.forEach(function (elt) {\r\n            \t\t\t\tif (elt.style.position != 'absolute')\r\n            \t\t\t\t\telt.style.position = 'absolute';\r\n            \t\t\t\tvar eltH = elt.clientHeight;\r\n            \t\t\t\tif (topOffset + eltH > _containerH) {\r\n            \t\t\t\t\tcolCount++;\r\n            \t\t\t\t\tcolOffset = colOffset + space + cellW;\r\n            \t\t\t\t\ttopOffset = 0;\r\n            \t\t\t\t}\r\n\r\n            \t\t\t\tif (elt.style.left != colOffset + 'px')\r\n            \t\t\t\t\telt.style.left = colOffset + 'px';\r\n            \t\t\t\tif (elt.style.top != topOffset + 'px')\r\n            \t\t\t\t\telt.style.top = topOffset + 'px';\r\n\r\n            \t\t\t\ttopOffset += eltH;\r\n            \t\t\t});\r\n\r\n            \t\t\tcolOffset = colOffset + cellW;\r\n            \t\t\tif (ctrl.element.style.width != colOffset + 'px')\r\n            \t\t\t\tctrl.element.style.width = colOffset + 'px';\r\n            \t\t},\r\n\r\n            \t\thorizontal: function () {\r\n            \t\t\tvar ctrl = this;\r\n            \t\t\tctrl.renderer.orientation = 'horizontal';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\tctrl.element.style.height = '';\r\n            \t\t\tvar _containerH = ctrl.element.clientHeight;\r\n            \t\t\tif (!_containerH)\r\n            \t\t\t\treturn;\r\n\r\n            \t\t\tvar _itemsPerColumn = Math.floor(_containerH / (ctrl.data.cellHeight + ctrl.data.cellSpace));\r\n            \t\t\tif (_itemsPerColumn <= 0)\r\n            \t\t\t\t_itemsPerColumn = 1;\r\n\r\n            \t\t\tvar cellW = ctrl.data.cellWidth;\r\n            \t\t\tvar cellH = ctrl.data.cellHeight;\r\n            \t\t\tvar space = ctrl.data.cellSpace;\r\n            \t\t\tvar aspectRatio = cellW / cellH;\r\n            \t\t\tvar ratioW = 1;\r\n            \t\t\tvar ratioH = 1;\r\n\r\n            \t\t\tif (ctrl.data.itemsPerColumn) {\r\n            \t\t\t\t_itemsPerColumn = ctrl.data.itemsPerColumn;\r\n            \t\t\t\tcellH = ((_containerH - ((_itemsPerColumn - 1) * space)) / _itemsPerColumn) >> 0;\r\n            \t\t\t\tcellW = (ctrl.data.cellWidth * cellH / ctrl.data.cellHeight) >> 0;\r\n            \t\t\t\tratioW = cellW / ctrl.data.cellWidth;\r\n            \t\t\t\tratioH = cellH / ctrl.data.cellHeight;\r\n            \t\t\t}\r\n\r\n            \t\t\tvar gridCellsMatrix = [[]];\r\n            \t\t\tvar childs = ctrl.visibleChilds();\r\n            \t\t\tchilds.forEach(function (elt) {\r\n            \t\t\t\telt.style.position = 'absolute';\r\n            \t\t\t\tvar eltW = elt.offsetWidth * ratioW;\r\n            \t\t\t\tvar eltH = elt.offsetHeight * ratioH;\r\n            \t\t\t\tvar eltColumns = (eltW / cellW) >> 0;\r\n            \t\t\t\tvar eltRows = (eltH / cellH) >> 0;\r\n\r\n            \t\t\t\tvar pos = ctrl.firstFit(gridCellsMatrix, eltColumns, eltRows, _itemsPerColumn, ctrl.element.children.length);\r\n            \t\t\t\tif (!pos)\r\n            \t\t\t\t\tpos = { x: 0, y: 0 };\r\n            \t\t\t\tctrl.fill(gridCellsMatrix, pos.x, pos.y, eltColumns, eltRows);\r\n\r\n            \t\t\t\tvar left = pos.x * (cellW + space);\r\n            \t\t\t\tvar top = pos.y * (cellH + space);\r\n            \t\t\t\tvar w = (eltColumns * cellW + ((eltColumns - 1) * space));\r\n            \t\t\t\tvar h = (eltRows * cellH + ((eltRows - 1) * space));\r\n            \t\t\t\telt.style.left = left + 'px';\r\n            \t\t\t\telt.style.top = top + 'px';\r\n            \t\t\t\telt.style.width = w + 'px';\r\n            \t\t\t\telt.style.height = h + 'px';\r\n            \t\t\t});\r\n\r\n            \t\t\tvar elementWidth = gridCellsMatrix.length * (cellW + space);\r\n            \t\t\tctrl.element.style.width = elementWidth + 'px';\r\n            \t\t},\r\n\r\n            \t\tvertical: function (plugin) {\r\n            \t\t\tvar ctrl = this;\r\n            \t\t\tctrl.renderer.orientation = 'vertical';\r\n            \t\t\tctrl.element.style.width = '';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\t//Be aware that in this case, we invert the matrix to crawl data in lines\r\n            \t\t\tvar _containerW = ctrl.element.clientWidth;\r\n            \t\t\tif (!_containerW)\r\n            \t\t\t\treturn;\r\n\r\n            \t\t\tvar _itemsPerLine = Math.floor(_containerW / (ctrl.data.cellWidth + ctrl.data.cellSpace));\r\n            \t\t\tif (_itemsPerLine <= 0)\r\n            \t\t\t\t_itemsPerLine = 1;\r\n\r\n            \t\t\tvar cellW = ctrl.data.cellWidth;\r\n            \t\t\tvar cellH = ctrl.data.cellHeight;\r\n            \t\t\tvar space = ctrl.data.cellSpace;\r\n            \t\t\tvar aspectRatio = cellW / cellH;\r\n            \t\t\tvar ratioW = 1;\r\n            \t\t\tvar ratioH = 1;\r\n\r\n            \t\t\tif (ctrl.data.itemsPerRow) {\r\n            \t\t\t\t_itemsPerLine = ctrl.data.itemsPerRow;\r\n            \t\t\t\tcellW = ((_containerW - ((_itemsPerLine - 1) * space)) / _itemsPerLine) >> 0;\r\n            \t\t\t\tcellH = (ctrl.data.cellHeight * cellW / ctrl.data.cellWidth) >> 0;\r\n            \t\t\t\tratioW = cellW / ctrl.data.cellWidth;\r\n            \t\t\t\tratioH = cellH / ctrl.data.cellHeight;\r\n            \t\t\t}\r\n\r\n            \t\t\tvar gridCellsMatrix = [[]];\r\n            \t\t\tvar childs = ctrl.visibleChilds();\r\n            \t\t\tchilds.forEach(function (elt) {\r\n            \t\t\t\telt.style.position = 'absolute';\r\n\r\n            \t\t\t\tvar eltW = elt.offsetWidth * ratioW;\r\n            \t\t\t\tvar eltH = elt.offsetHeight * ratioH;\r\n            \t\t\t\tvar eltColumns = (eltW / cellW) >> 0;\r\n            \t\t\t\tvar eltRows = (eltH / cellH) >> 0;\r\n\r\n            \t\t\t\tvar pos = ctrl.firstFit(gridCellsMatrix, eltRows, eltColumns, _itemsPerLine, ctrl.element.children.length);\r\n            \t\t\t\t//if (!pos)\r\n            \t\t\t\t//    return;\r\n\r\n            \t\t\t\tctrl.fill(gridCellsMatrix, pos.x, pos.y, eltRows, eltColumns);\r\n\r\n            \t\t\t\tvar left = pos.y * (cellW + space);\r\n            \t\t\t\tvar top = pos.x * (cellH + space);\r\n            \t\t\t\telt.style.left = left + 'px';\r\n            \t\t\t\telt.style.top = top + 'px';\r\n            \t\t\t\telt.style.width = (eltColumns * cellW + ((eltColumns - 1) * space)) + 'px';\r\n            \t\t\t\telt.style.height = (eltRows * cellH + ((eltRows - 1) * space)) + 'px';\r\n\r\n            \t\t\t});\r\n\r\n            \t\t\tvar elementHeight = gridCellsMatrix.length * (cellH + space);\r\n            \t\t\tctrl.element.style.height = elementHeight + 'px';\r\n            \t\t},\r\n            \t},\r\n\r\n            \t/**\r\n                 * layout content items\r\n                 */\r\n            \tlayout: function () {\r\n            \t    var ctrl = this;\r\n            \t    if (!ctrl.element)\r\n            \t        return;\r\n            \t\tvar oldlayout = ctrl.data;\r\n            \t\tctrl.data = ctrl.getLayout();\r\n\r\n            \t\tif (ctrl.data) {\r\n            \t\t\t//if (ctrl.data == oldlayout && ctrl.data.applyed)\r\n            \t\t\t//    return;\r\n\r\n            \t\t\tctrl.data.cellSpace = (ctrl.data.cellSpace != undefined ? ctrl.data.cellSpace : (ctrl.defaultLayout.cellSpace != undefined ? ctrl.defaultLayout.cellSpace : 10));\r\n            \t\t\tctrl.data.cellWidth = ctrl.data.cellWidth || ctrl.defaultLayout.cellWidth || 0;\r\n            \t\t\tctrl.data.cellHeight = ctrl.data.cellHeight || ctrl.defaultLayout.cellHeight || 0;\r\n\r\n            \t\t\t//if cell dimensions are not defined, take it from last child\r\n            \t\t\tif (!ctrl.data.cellWidth || !ctrl.data.cellHeight) {\r\n            \t\t\t    if (ctrl.element && ctrl.element.childNodes && ctrl.element.children.length > 0) {\r\n            \t\t\t\t\tvar childs = ctrl.visibleChilds();\r\n            \t\t\t\t\tif (childs && childs.length) {\r\n            \t\t\t\t\t\tvar firstChild = childs[0];\r\n            \t\t\t\t\t\tvar w = firstChild.clientWidth;\r\n            \t\t\t\t\t\tvar h = firstChild.clientHeight;\r\n            \t\t\t\t\t\tvar l = childs.length;\r\n            \t\t\t\t\t\tif (l > 10) l = 10;\r\n            \t\t\t\t\t\tfor (var i = 0, l = childs.length; i < l ; i++) {\r\n            \t\t\t\t\t\t\tvar item = childs[i];\r\n            \t\t\t\t\t\t\tif (w == 0 || item.clientWidth < w) {\r\n            \t\t\t\t\t\t\t\tw = item.clientWidth;\r\n            \t\t\t\t\t\t\t}\r\n            \t\t\t\t\t\t\tif (h == 0 || item.clientHeight < h) {\r\n            \t\t\t\t\t\t\t\th = item.clientHeight;\r\n            \t\t\t\t\t\t\t}\r\n            \t\t\t\t\t\t}\r\n            \t\t\t\t\t\tctrl.data.cellWidth = w;\r\n            \t\t\t\t\t\tctrl.data.cellHeight = h;\r\n            \t\t\t\t\t}\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n\r\n            \t\t\tvar layoutChanged = !oldlayout || ctrl.data.layout !== oldlayout.layout;\r\n            \t\t\tif (ctrl.data.layout) {\r\n            \t\t\t\tvar layoutfunc = ctrl.GridLayoutsImpl[ctrl.data.layout.toLowerCase()];\r\n            \t\t\t\tif (layoutfunc) {\r\n            \t\t\t\t\tif (layoutChanged)\r\n            \t\t\t\t\t\tctrl.changeLayout();\r\n\r\n            \t\t\t\t\tlayoutfunc.bind(ctrl)(layoutChanged);\r\n            \t\t\t\t\tctrl.data.applyed = true;\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n            \t\t\tctrl.renderer.checkRendering();\r\n            \t\t}\r\n            \t},\r\n\r\n            \tchangeLayout: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\tctrl.clearLayout();\r\n            \t\tctrl.renderer.updateLayout();\r\n            \t},\r\n\r\n            \t/**\r\n                 * update grid layout\r\n                 */\r\n            \tupdateLayout: function (element, viewState, lastViewState) {\r\n            \t    var ctrl = this;\r\n            \t    if (!ctrl.element)\r\n            \t        return;\r\n            \t\tctrl.layout();\r\n            \t},\r\n\r\n            \t/**\r\n                 * get layout applicable to the current context\r\n                 */\r\n            \tgetLayout: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\tvar matchingLayout = undefined;\r\n            \t\tif (ctrl.gridLayouts) {\r\n            \t\t\tfor (var name in ctrl.gridLayouts) {\r\n            \t\t\t\tvar layout = ctrl.gridLayouts[name];\r\n            \t\t\t\tif (ctrl.gridLayouts.hasOwnProperty(name)) {\r\n            \t\t\t\t\tif (layout.query) {\r\n            \t\t\t\t\t\tvar mq = window.matchMedia(layout.query);\r\n            \t\t\t\t\t\tif (mq.matches) {\r\n            \t\t\t\t\t\t\tmatchingLayout = layout;\r\n            \t\t\t\t\t\t}\r\n            \t\t\t\t\t} else if (!matchingLayout) {\r\n            \t\t\t\t\t\tmatchingLayout = layout;\r\n            \t\t\t\t\t}\r\n            \t\t\t\t}\r\n            \t\t\t\telse if (!matchingLayout) {\r\n            \t\t\t\t\tmatchingLayout = layout;\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\tif (!matchingLayout) {\r\n            \t\t\tmatchingLayout = ctrl.defaultLayout;\r\n            \t\t}\r\n\r\n            \t\treturn JSON.parse(JSON.stringify(matchingLayout));\r\n            \t},\r\n\r\n            \t/**\r\n                 * Release grid resources\r\n                 */\r\n            \tdispose: function () {\r\n            \t\tthis.element = null;\r\n            \t\tthis.renderer.dispose();\r\n            \t\tif (WinJS.Utilities.disposeSubTree)\r\n            \t\t\tWinJS.Utilities.disposeSubTree(this.element);\r\n            \t}\r\n            })\r\n\t});\r\n\r\n\tif (WinJSContrib.UI.WebComponents) {\r\n\t\tWinJSContrib.UI.WebComponents.register('mcn-grid', WinJSContrib.UI.GridControl, {\r\n\t\t\tproperties: ['multipass', 'autolayout', 'layouts', 'itemInvoked', 'itemTemplate', 'itemClassName', 'items']\r\n\t\t});\r\n\t}\r\n})();","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/// <reference path=\"winjscontrib.core.js\" />\r\n(function () {\r\n    'use strict';\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        AspectRatio: WinJS.Class.mix(WinJS.Class.define(function ctor(element, options) {\r\n            this.element = element || document.createElement('DIV');\r\n            options = options || {};\r\n            this.element.winControl = this;\r\n            this.element.style.display = 'none';\r\n            this.element.classList.add('mcn-aspectratio');\r\n            this.element.classList.add('win-disposable');\r\n            this.element.classList.add('mcn-layout-ctrl');\r\n            WinJS.UI.setOptions(this, options);\r\n            this.render();\r\n        }, {\r\n            baseWidth: {\r\n                get: function () {\r\n                    return this._baseWidth;\r\n                },\r\n                set: function (val) {\r\n                    this._baseWidth = val;\r\n                }\r\n            },\r\n\r\n            baseWidthMin: {\r\n                get: function () {\r\n                    return this._baseWidthMin;\r\n                },\r\n                set: function (val) {\r\n                    this._baseWidthMin = val;\r\n                }\r\n            },\r\n\r\n            baseWidthMargin: {\r\n                get: function () {\r\n                    return this._baseWidthMargin || 0;\r\n                },\r\n                set: function (val) {\r\n                    this._baseWidthMargin = val;\r\n                }\r\n            },\r\n\r\n            baseHeight: {\r\n                get: function () {\r\n                    return this._baseHeight;\r\n                },\r\n                set: function (val) {\r\n                    this._baseHeight = val;\r\n                }\r\n            },\r\n\r\n            baseHeightMin: {\r\n                get: function () {\r\n                    return this._baseHeightMin;\r\n                },\r\n                set: function (val) {\r\n                    this._baseHeightMin = val;\r\n                }\r\n            },\r\n\r\n            baseHeightMargin: {\r\n                get: function () {\r\n                    return this._baseHeightMargin || 0;\r\n                },\r\n                set: function (val) {\r\n                    this._baseHeightMargin = val;\r\n                }\r\n            },\r\n\r\n            ratio: {\r\n                get: function () {\r\n                    return this._ratio;\r\n                },\r\n                set: function (val) {\r\n                    this._ratio = val;\r\n                }\r\n            },\r\n\r\n            basedOn: {\r\n                get: function () {\r\n                    return this._basedOn;\r\n                },\r\n                set: function (val) {\r\n                    this._basedOn = val;\r\n                }\r\n            },\r\n\r\n            target: {\r\n                get: function () {\r\n                    return this._target;\r\n                },\r\n                set: function (val) {\r\n                    this._target = val;\r\n                }\r\n            },\r\n\r\n            render: function () {\r\n                var ctrl = this;\r\n                if (!ctrl.styleElt) {\r\n                    ctrl.styleElt = document.createElement('STYLE');\r\n                    ctrl.element.appendChild(ctrl.styleElt);\r\n                }\r\n                ctrl.updateLayout();\r\n            },\r\n\r\n            pageLayout: function () {\r\n                this.updateLayout();\r\n            },\r\n\r\n            updateLayout: function () {\r\n                var ctrl = this;\r\n\r\n                if (!ctrl.parentpage)\r\n                    ctrl.parentpage = WinJSContrib.Utils.getScopeControl(ctrl.element);\r\n\r\n                if (!ctrl.container)\r\n                    ctrl.container = ctrl.element.parentElement;\r\n\r\n                if (ctrl.container && ctrl.target) {\r\n                    if (ctrl.basedOn == \"height\") {\r\n                        ctrl.updateLayoutBasedOnHeight();\r\n                    } else {\r\n                        ctrl.updateLayoutBasedOnWidth();\r\n                    }\r\n                }\r\n            },\r\n\r\n            updateLayoutBasedOnWidth: function () {\r\n                var ctrl = this;\r\n\r\n                var classname = ctrl.target;\r\n                if (ctrl.prefix) {\r\n                    classname = ctrl.prefix + ' ' + classname;\r\n                }\r\n\r\n                var container = ctrl.parentpage.element;\r\n                if (ctrl.baseWidth) {\r\n                    var nbitems = ((ctrl.container.clientWidth / ctrl.baseWidth) << 0) + 1;\r\n                    var itemW = ((ctrl.container.clientWidth / nbitems) << 0) - ctrl.baseWidthMargin - 0.25;\r\n                    if (ctrl.ratio) {\r\n                        var targetH = (itemW / ctrl.ratio) << 0;\r\n                        ctrl.styleElt.innerHTML = classname + \"{ width: \" + itemW + \"px; height:\" + targetH + \"px}\";\r\n                    } else {\r\n                        ctrl.styleElt.innerHTML = classname + \"{ width: \" + itemW + \"px; }\";\r\n                    }\r\n                } else if (ctrl.ratio) {\r\n                    var elements = ctrl.container.querySelectorAll(ctrl.target);\r\n                    var eltW = elements[0].clientWidth;\r\n                    var eltH = elements[0].clientHeight;\r\n\r\n                    if (eltW > 0) {\r\n                        var targetH = (eltW / ctrl.ratio) << 0;\r\n                        if (ctrl.max) {\r\n                            var maxH = (container.clientHeight * ctrl.max / 100) << 0;\r\n                            if (targetH > maxH) {\r\n                                targetH = maxH;\r\n                            }\r\n                        }\r\n                        ctrl.styleElt.innerHTML = classname + \"{ height:\" + targetH + \"px}\";\r\n                    }\r\n                } else {\r\n                    console.warn(\"aspect ratio control must have baseWidth and/or ratio\")\r\n                }\r\n            },\r\n\r\n            updateLayoutBasedOnHeight: function () {\r\n                var ctrl = this;\r\n\r\n                var classname = ctrl.target;\r\n                if (ctrl.prefix) {\r\n                    classname = ctrl.prefix + ' ' + classname;\r\n                }\r\n\r\n                if (ctrl.baseHeight) {\r\n                    var nbitems = ((ctrl.container.clientHeight / ctrl.baseHeight) << 0) + 1;\r\n                    var itemH = ((ctrl.container.clientHeight / nbitems) << 0) - ctrl.baseHeightMargin;\r\n                    var targetW = (itemH / ctrl.ratio) << 0;\r\n                    ctrl.styleElt.innerHTML = classname + \"{ width: \" + targetW + \"px; height:\" + itemH + \"px}\";\r\n                } else {\r\n                    var elements = ctrl.container.querySelectorAll(ctrl.target);\r\n                    var eltW = elements[0].clientWidth;\r\n                    var eltH = elements[0].clientHeight;\r\n\r\n                    if (eltH > 0) {\r\n                        var targetW = (eltH * ctrl.ratio) << 0;\r\n                        if (ctrl.max) {\r\n                            var maxW = (ctrl.container.clientWidth * ctrl.max / 100) << 0;\r\n                            if (targetW > maxW) {\r\n                                targetW = maxW;\r\n                            }\r\n                        }\r\n                        ctrl.styleElt.innerHTML = classname + \"{ width:\" + targetW + \"px}\";\r\n                    }\r\n                }\r\n            },\r\n\r\n            dispose: function () {\r\n                var ctrl = this;\r\n                ctrl.parentpage = null;\r\n                ctrl.container = null;\r\n                ctrl.styleElt.parentElement.removeChild(ctrl.styleElt);\r\n                WinJS.Utilities.disposeSubTree(this.element);\r\n                this.element = null;\r\n            }\r\n        }),\r\n\t\tWinJS.Utilities.eventMixin,\r\n\t\tWinJS.Utilities.createEventProperties(\"myevent\"))\r\n    });\r\n})();","/* \r\n * WinJS Contrib v2.1.0.4\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n(function () {\r\n    'use strict';\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        VisualState: WinJS.Class.mix(WinJS.Class.define(function ctor(element, options) {\r\n            this.element = element || document.createElement('DIV');\r\n            options = options || {};\r\n            this.element.winControl = this;\r\n            this.element.style.display = \"none\";\r\n            this.element.classList.add('mcn-visualstate');\r\n            this.element.classList.add('mcn-layout-ctrl');\r\n            this.element.classList.add('win-disposable');\r\n            WinJS.UI.setOptions(this, options);\r\n        }, {\r\n            states: {\r\n                get: function () {\r\n                    return this._states;\r\n                },\r\n                set: function (val) {\r\n                    this._states = val;\r\n                }\r\n            },\r\n\r\n            target: {\r\n                get: function () {\r\n                    return this._target;\r\n                },\r\n                set: function (val) {\r\n                    this._target = val;\r\n                }\r\n            },\r\n\r\n            checkAllStates: function (name, state) {\r\n                var ctrl = this;\r\n                if (ctrl.states) {\r\n                    for (var n in ctrl.states) {\r\n                        ctrl.checkState(n, ctrl.states[n]);\r\n                    }\r\n                }\r\n            },\r\n\r\n            checkState: function (name, state) {\r\n                var ctrl = this;\r\n                if (!ctrl.element)\r\n                    return;\r\n\r\n                var target = ctrl.target || ctrl.element.parentElement;\r\n                var targetW = target.clientWidth;\r\n                var targetH = target.clientHeight;\r\n                var evaluate = true;\r\n                if (state.wGt)\r\n                    evaluate = evaluate && targetW > state.wGt;\r\n                if (state.wLt)\r\n                    evaluate = evaluate && targetW < state.wLt;\r\n                if (state.hGt)\r\n                    evaluate = evaluate && targetH > state.hGt;\r\n                if (state.hLt)\r\n                    evaluate = evaluate && targetH < state.hLt;\r\n\r\n                if (evaluate) {\r\n                    state.active = true;\r\n                    target.classList.add(\"state-\" + name);\r\n                } else {\r\n                    state.active = false;\r\n                    target.classList.remove(\"state-\" + name);\r\n                }\r\n            },\r\n\r\n            pageLayout: function () {\r\n                var ctrl = this;\r\n                ctrl.checkAllStates();\r\n            },\r\n\r\n            updateLayout: function () {\r\n                var ctrl = this;\r\n                ctrl.checkAllStates();\r\n            },\r\n\r\n            dispose: function () {\r\n                WinJS.Utilities.disposeSubTree(this.element);\r\n                this.element = null;\r\n            }\r\n        }),\r\n\t\tWinJS.Utilities.eventMixin,\r\n\t\tWinJS.Utilities.createEventProperties(\"myevent\"))\r\n    });\r\n})();"],"sourceRoot":" "}