{"version":3,"sources":["loader.ts"],"names":["BtPo","BtPo.UI","BtPo.UI.DataLoaderControl","BtPo.UI.DataLoaderControl.constructor","BtPo.UI.DataLoaderControl.processed","BtPo.UI.DataLoaderControl.ready"],"mappings":"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","file":"BringThePopcorn/controls/loader/loader.js","sourcesContent":["module BtPo.UI {\r\n    export class DataLoaderControl {\r\n        public static url = \"/controls/loader/loader.html\";\r\n        element: HTMLElement;\r\n        message: HTMLElement;\r\n        container: HTMLElement;\r\n        content: HTMLElement;\r\n\r\n        processed(element, options) {\r\n        }\r\n\r\n        ready(element, options) {\r\n            var page = this;\r\n           \r\n            var p = WinJS.Promise.wrap().then(() => {\r\n                WinJSContrib.UI.Application.navigator.closeAllPages();\r\n                Kodi.API.Websocket.init(Kodi.API.currentSettings);\r\n                WinJS.Navigation.history.backstack = [];\r\n            });\r\n\r\n            if (options && options.transitionIn) {\r\n                p = p.then(() => {\r\n                    return WinJSContrib.UI.Animation.fadeIn(element);\r\n                });\r\n            }\r\n\r\n            p.then(function () {\r\n                return WinJSContrib.UI.Animation.enterGrow(page.content, { easing: WinJSContrib.UI.Animation.Easings.easeOutBack }).then(function () {\r\n                    return WinJS.Promise.join({\r\n                        mintime: WinJS.Promise.timeout(1000),\r\n                        data: Kodi.Data.loadRootData(true)\r\n                    })\r\n                })\r\n            }).then(function (data) {\r\n                document.body.classList.remove(\"unconnected\");\r\n                Kodi.NowPlaying.init();\r\n                \r\n                return WinJS.Navigation.navigate(\"/pages/home/home.html\", { clearNavigationHistory: true })\r\n            }, function (err) {\r\n                document.body.classList.add(\"unconnected\");\r\n                return WinJS.Navigation.navigate(\"/pages/startup/startup.html\", { clearNavigationHistory: true });\r\n            }).then(function () {\r\n                WinJS.Application.queueEvent({ type: \"ServerChanged\" });\r\n                WinJS.UI.Animation.fadeOut(page.message);\r\n                page.container.classList.add('exit');\r\n                //return WinJSContrib.UI.afterTransition(page.container);\r\n                return WinJS.Promise.timeout(700);\r\n            }).then(function () {\r\n                $(page.element).remove();\r\n                (<any>page).dispose();\r\n                currentLoader = null;\r\n            });\r\n        }\r\n    }\r\n\r\n    export var DataLoader = <any>WinJS.UI.Pages.define(DataLoaderControl.url, DataLoaderControl);\r\n    var currentLoader = null;\r\n    DataLoader.showLoader = function (transitionIn, startupArgs) {\r\n        if (currentLoader)\r\n            return;\r\n\r\n        var e = <HTMLElement>document.createElement(\"DIV\");\r\n        e.className = \"page-loader-wrapper\";\r\n        if (transitionIn)\r\n            e.style.opacity = '0';\r\n\r\n        document.body.appendChild(e);\r\n        var loader = new BtPo.UI.DataLoader(e, { transitionIn: transitionIn, startupArgs: startupArgs });\r\n        currentLoader = loader;\r\n    }\r\n}\r\n"],"sourceRoot":" "}