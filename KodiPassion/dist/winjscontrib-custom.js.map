{"version":3,"sources":["../scripts/winjscontrib/js/winjscontrib.core.js","../scripts/winjscontrib/js/winjscontrib.ui.webcomponents.js","../scripts/winjscontrib/js/winjscontrib.winrt.core.js","../scripts/winjscontrib/js/winjscontrib.winrt.upnp.js","../scripts/winjscontrib/js/winjscontrib.bindings.js","../scripts/winjscontrib/js/winjscontrib.date.utils.js","../scripts/winjscontrib/js/winjscontrib.ui.animation.js","../scripts/winjscontrib/js/winjscontrib.ui.elasticbutton.js","../scripts/winjscontrib/js/winjscontrib.ui.fowrapper.js","../scripts/winjscontrib/js/winjscontrib.ui.multipass-renderer.js","../scripts/winjscontrib/js/winjscontrib.ui.grid.js","../scripts/winjscontrib/js/winjscontrib.search.js","../scripts/winjscontrib/js/winjscontrib.ui.datasourcemanager.js"],"names":["_global","this","setImmediate","callback","args","_i","arguments","length","setTimeout","toStaticHTML","text","msapp","MSApp","execUnsafeLocalFunction","c","Object","map","obj","mapping","mapped","key","val","keys","forEach","transmuted","apply","String","prototype","format","replace","match","number","padLeft","leadingChar","undefined","WinJSContrib","Promise","waterfall","dataArray","promiseCallback","resultPromise","WinJS","wrap","results","dataPromise","as","then","items","queueP","p","item","r","push","i","l","getItem","parallel","promises","join","batch","batchSize","batcheditems","hasErrors","queueBatch","concat","errors","wrapError","Utils","extend","hasOwnProperty","startsWith","str","strToMatch","asyncForEach","array","batchsize","j","endsWith","queryStringFrom","encodeURIComponent","rawValue","value","hasValue","triggerEvent","element","eventName","bubbles","cancellable","eventToTrigger","document","createEvent","initEvent","dispatchEvent","triggerCustomEvent","data","initCustomEvent","getobject","prop","baseValue","idx","indexOf","end","substr","parseInt","setobject","setProperty","intval","readProperty","source","properties","getProperty","propValue","split","parent","previousDescriptor","descriptor","PropertyDescriptor","writeProperty","randomFromInterval","from","to","Math","random","alphabeticSort","a","b","distinctArray","property","ignorecase","sFind","sMatchedItems","foundCounter","newArray","toLowerCase","getDistinctPropertyValues","removeAccents","s","RegExp","removePageFromHistory","pageLoc","history","Navigation","backStack","page","location","pad2","ellipsisizeString","maxSize","useWordBoundary","toLong","text_","lastIndexOf","guid","d","Date","getTime","uuid","floor","toString","inherit","parentElement","current","winControl","moveChilds","target","childs","childNodes","elt","appendChild","getParent","parentNode","getParentControlByClass","className","classList","contains","getParentPage","getScopeControl","msParentSelectorScope","scope","scopeControl","getTemplate","template","templatetype","Binding","Template","href","render","res","resolveMethod","resolveValue","readValue","context","name","parser","ValueParsers","applyValue","targetPath","tmp","mcnMustResolve","formatXHRError","xhr","status","statusText","responseText","unwrapJoinError","errorCallback","errorArray","unwrappedError","tentativeError","inject","k","parentDescriptor","keyProp","ensureParent","defineProperty","get","set","enumerable","configurable","navpage","control","UI","Application","navigator","pageControl","parentControl","method","bind","ctrl","select","selector","querySelector","optionsParser","window","Utilities","markSupportedForProcessing","prom","list","List","dataSource","global","templ","Templates","event","eventTracker","addEvent","addEventListener","uri","cache","interactive","makeInteractive","message","itemPromise","rendered","tap","n","arg","click","onclick","offsetFrom","xPosition","yPosition","w","clientWidth","h","clientHeight","offsetLeft","scrollLeft","clientLeft","offsetTop","scrollTop","clientTop","offsetParent","x","y","width","height","appbarsOpen","querySelectorAll","e","show","appbarsClose","hide","appbarsDisable","disabled","appbarsEnable","elements","el","elementLoaded","url","complete","error","onerror","onload","onreadystatechange","naturalWidth","src","loadImage","imgUrl","image","path","Image","listElementsAfterMe","passed","children","removeElementAnimation","remainings","anim","Animation","createDeleteFromListAnimation","style","position","opacity","execute","done","bindAction","add","actionName","dataset","pageAction","getAttribute","action","eltarg","actionArgs","pageActionArgs","exception","bindPageActions","bindLink","applink","pageLink","options","pageActionOptions","parentNavigator","nav","navigate","bindPageLinks","mcnNavigator","bindMember","memberName","pageMember","id","bindMembers","bindActions","registerNavigationEvents","cancelNavigation","detail","setPromise","cancel","registration","registeredNavigationStack","backhandler","handled","Windows","Phone","Input","HardwareButtons","keypress","body","addLock","removeLock","splice","removeEventListener","untap","mcnTapTracking","dispose","untapAll","taps","ptDown","currentTarget","tracking","button","allowRickClickTap","lock","pointerId","setPointerCapture","stopPropagation","preventDefault","addClass","pointerdown","changedTouches","clientX","clientY","animDown","tapOnDown","ptOut","removeClass","releasePointerCapture","console","disableAnimation","animUp","ptUp","resolveTap","dX","abs","dY","stopImmediatePropagation","is","awaitAnim","attroptions","opt","EventTracker","defaultTapBehavior","pointerModel","onpointerdown","Touch","noWebkitTouch","cancelMouse","afterTransition","timeout","timeOutRef","onaftertransition","srcElement","close","clearTimeout","disableAutoResources","events","handler","capture","tracker","unregister","addBinding","unbind","MediaTrigger","linkedControl","queries","query","registerMediaEvent","q","mq","matchMedia","internalQuery","f","matches","_mediaEvent","addListener","removeListener","setOptions","check","type","listener","useCapture","eventProperties","Class","mix","eventMixin","pointerDown","pointerUp","FluentDOM","nodeType","parentElt","createElement","fragment","createDocumentFragment","classname","display","visibility","textContent","html","innerHTML","attr","setAttribute","styles","st","appendTo","append","child","createChild","ctor","__global","profiler","msWriteProfilerMark","Pages","broadcast","before","after","index","childctrl","pageLifeCycle","steps","layout","promise","__checkLayout","renderFragment","container","preparePageControl","elementCtrl","getFragmentElement","injectToPage","navigationState","state","oncreate","oninit","init","attach","enterPageAnimation","enterPage","_enterAnimation","elts","getAnimationElements","onrender","process","Resources","processAll","closeOldPagePromise","ready","onready","fragmentCompleted","fragmentError","getComputedStyle","direction","fragmentPromise","parented","pageConstructor","defaultFragmentMixins","$","_element","qAll","slice","call","_promises","cancelPromises","addPromise","_eventTracker","PageLifeCycleStep","stepName","_this","queue","isDone","_resolvePromise","_rejectPromise","resolve","closeStep","step","reject","_Pages","_Global","_Base","_CorePages","_BaseUtils","_ElementUtilities","_WriteProfilerMark","Fragments","ControlProcessor","selfhost","injectMixin","base","mixin","mergeJavaScriptClass","baseCtor","classDef","addMembers","members","_attachedConstructor","that","parentedPromise","initialDisplay","profilerMarkIdentifier","_getProfilerMarkIdentifier","WebComponents","observer","watch","load","loadResult","realControl","dismissed","renderCalled","initResult","result","elementReady","renderComplete","processed","callComplete","layoutComplete","getBoundingClientRect","pageLayout","readyComplete","ended","delta","created","log","err","_value","updateLayoutArgs","updateLayout","getPageConstructor","refUri","viewMap","define","stop","disconnect","_disposed","msSourceLocation","parentedComplete","_mixinBase","DOMEventMixin","Pages_define","_viewMap","_corePages","Ctor","remove","clearCache","disposeSubTree","renderCopy","_remove","pageOverride","Namespace","_moduleDefine","HtmlControl","inspect","node","customElement","ctrlName","nodeName","attributes","registered","toUpperCase","mcnComponent","observeMutations","polyfill","MutationObserver","mutations","mutation","addedNodes","observe","childList","subtree","definition","getControlInstance","constructor","mcnWebComponent","ctx","applyAttribute","winOptions","getWinJSOptions","optionsCallback","applyAll","applyMapping","tagname","contextData","attrcontext","attrvalue","attribute","controls","ctKey","controlDefinition","mapKey","controlmap","registerElement","register","override","existing","proto","create","HTMLElement","createdCallback","attachedCallback","attributeChangedCallback","attrName","oldValue","newValue","AppBar","AutoSuggestBox","BackButton","ContentDialog","DatePicker","FlipView","Flyout","Hub","HubSection","ItemContainer","ListView","Menu","Pivot","PivotItem","Rating","Repeater","SearchBox","SemanticZoom","SplitView","TimePicker","ToggleSwitch","ToolBar","Tooltip","ViewBox","WinRT","readProtocol","kind","ApplicationModel","Activation","ActivationKind","protocol","navArgs","protocolArgs","queryargs","decodeURIComponent","host","isConnected","nlvl","Networking","Connectivity","NetworkConnectivityLevel","profile","NetworkInformation","getInternetConnectionProfile","level","getNetworkConnectivityLevel","constrainedInternetAccess","internetAccess","hasInternetAccess","onInternetStatusChanged","network","Alerts","messageBox","md","Popups","MessageDialog","content","title","commands","command","cmd","UICommand","label","invoked","isDefault","defaultCommandIndex","showAsync","notification","confirm","yes","no","toastNotification","notifications","Notifications","picture","ToastTemplateType","toastImageAndText01","toastText01","toastXml","ToastNotificationManager","getTemplateContent","toastTextElements","getElementsByTagName","toastImageElements","launch","toastElements","JSON","stringify","createTextNode","text2","text3","toast","ToastNotification","toastNotifier","createToastNotifier","UPnP","search","xmlToJson","xml","nodeValue","hasChildNodes","colonIdx","clearNode","old","trim","parseXML","DOMParser","parseFromString","toHex","start","digit","hextab","pad","len","ntos","unescape","htoa","nextchar","charAt","atoh","charCodeAt","expandExponential","z","Array","deviceTypes","ContentDirectory1","ContentDirectory2","ContentDirectory3","ContentDirectory4","MediaRenderer1","MediaRenderer2","MediaRenderer3","MediaRenderer4","MediaServer1","MediaServer2","MediaServer3","MediaServer4","AVTransport1","AVTransport2","ConnectionManager1","ConnectionManager2","ConnectionManager3","devicesDiscovery","filter","exists","devices","deviceDescriptionUrl","discover","onsuccess","clientSocket","ex","Sockets","DatagramSocket","onmessagereceived","reader","getDataReader","count","unconsumedBufferLength","readString","completed","rawdevice","responseXML","device","root","rootUrl","UPnPDevice","getOutputStreamAsync","hostName","outputStream","writer","Storage","Streams","DataWriter","unicodeEncoding","UnicodeEncoding","Utf8","writeString","storeAsync","discovery","hasError","HostName","getContentType","extension","lowerUrl","deviceObj","getService","serviceType","service","serviceList","deviceList","childdevice","childService","controlURL","getAVTransport","UPnPAVTransport","getContentDirectory","UPnPContentDirectory","getConnectionManager","UPnPConnectionManager","UPnPService","serviceObj","opts","debug","svc","svcType","svcUrl","self","upnpAction","upnpParameters","promiseComplete","promiseError","response","svcMsg","createRequest","sendRequest","xmlResponse","handleResponse","upnpResponse","requestTemplate","types","i1","allowedValues","toNative","i8","Int8Array","checkAllowedValues","i2","i16","Int16Array","i4","i32","Int32Array","ui1","ui8","Uint8Array","ui2","ui16","Uint16Array","ui4","ui32","Uint32Array","int","isNaN","r4","f32","Float32Array","r8","f64","Float64Array","fixed_14_4","float","_float","parseFloat","char","string","xmlObj","currentPos","date","dateTime","parseDate","toISOString","dateTime_tz","time","time_tz","boolean","bin_base64","atob","btoa","bin_hex","decodeURI","_name","upnpServiceType","upnpActionName","parameters","formatParameters","debugLog","encodeXML","svcInParams","svcInParams_xml","svcParam","typeCheck","upnpEndpointURL","upnpRequestXML","onUPnPResponse","soapaction","httpClient","Web","Http","HttpClient","Foundation","Uri","request","HttpRequestMessage","HttpMethod","post","headers","HttpStringContent","utf8","sendRequestAsync","readAsStringAsync","UPnPError","upnpResponseXML","onUPnPResolved","svcOutParams","responseJSON","responseContainer","responseVars","varName","varVal","firstChild","decodeXML","formatParameter","parameter","param","processParam","allowedValueList","matchFound","msg","description","b64chars","b64tab","bin","t","cb_encode","ccc","padlen","ord","chars","cb_decode","cccc","fromCharCode","hexChars","timestamp","struct","minutesOffset","numericKeys","exec","UTC","parse","NaN","allowedContentDirectoryTypes","urn:schemas-upnp-org:service:ContentDirectory:1","urn:schemas-upnp-org:service:ContentDirectory:2","urn:schemas-upnp-org:service:ContentDirectory:3","urn:schemas-upnp-org:service:ContentDirectory:4","upnpType","getSystemUpdateId","Id","getSearchCapabilities","SearchCaps","getSortCapabilities","SortCaps","browse","objectId","browseFlag","startingIndex","requestedCount","sortCriteria","ObjectID","BrowseFlag","Filter","StartingIndex","RequestedCount","SortCriteria","Result","NumberReturned","TotalMatches","UpdateID","allowedConnectionManagerTypes","urn:schemas-upnp-org:service:ConnectionManager:1","urn:schemas-upnp-org:service:ConnectionManager:2","urn:schemas-upnp-org:service:ConnectionManager:3","getCurrentConnectionIDs","ConnectionIDs","getCurrentConnectionInfo","connectionId","ConnectionID","RcsID","AVTransportID","ProtocolInfo","PeerConnectionManager","PeerConnectionID","Direction","Status","getProtocolInfo","Source","Sink","allowedAVTransportTypes","urn:schemas-upnp-org:service:AVTransport:1","urn:schemas-upnp-org:service:AVTransport:2","getDeviceCapabilities","instanceId","InstanceID","PlayMedia","RecMedia","RecQualityModes","getMediaInfo","NrTracks","MediaDuration","CurrentURI","CurrentURIMetaData","NextURI","NextURIMetaData","PlayMedium","RecordMedium","WriteStatus","getPositionInfo","Track","TrackDuration","TrackMetaData","TrackURI","RelTime","AbsTime","RelCount","AbsCount","getTransportInfo","CurrentTransportState","CurrentTransportStatus","CurrentSpeed","getTransportSettings","PlayMode","RecQualityMode","setAVTransportURI","currentURI","currentURIMetaData","play","speed","Speed","pause","next","previous","seek","unit","Unit","Target","allowedRenderingControlTypes","urn:schemas-upnp-org:service:RenderingControl:1","urn:schemas-upnp-org:service:RenderingControl:2","urn:schemas-upnp-org:service:RenderingControl:3","UPnPRenderingControl","listPresets","InstanceId","CurrentPresetNameList","selectPreset","presetName","PresetName","getBrightness","CurrentBrightness","setBrightness","desiredBrightness","DesiredBrightness","getContrast","CurrentContrast","setContrast","desiredContrast","DesiredContrast","getSharpness","CurrentSharpness","setSharpness","desiredSharpness","DesiredSharpness","getRedVideoGain","CurrentRedVideoGain","setRedVideoGain","desiredRedVideoGain","DesiredRedVideoGain","getGreenVideoGain","CurrentGreenVideoGain","setGreenVideoGain","desiredGreenVideoGain","DesiredGreenVideoGain","getBlueVideoGain","CurrentBlueVideoGain","setBlueVideoGain","desiredBlueVideoGain","DesiredBlueVideoGain","getRedVideoBlackLevel","CurrentRedVideoBlackLevel","setRedVideoBlackLevel","desiredRedVideoBlackLevel","DesiredRedVideoBlackLevel","getGreenVideoBlackLevel","CurrentGreenVideoBlackLevel","setGreenVideoBlackLevel","desiredGreenVideoBlackLevel","DesiredGreenVideoBlackLevel","getBlueVideoBlackLevel","CurrentBlueVideoBlackLevel","setBlueVideoBlackLevel","desiredBlueVideoBlackLevel","DesiredBlueVideoBlackLevel","getColorTemperature","CurrentColorTemperature","setColorTemperature","desiredColorTemperature","DesiredColorTemperature","getHorizontalKeystone","CurrentHorizontalKeystone","setHorizontalKeystone","desiredHorizontalKeystone","DesiredHorizontalKeystone","getVerticalKeystone","CurrentVerticalKeystone","setVerticalKeystone","desiredVerticalKeystone","DesiredVerticalKeystone","getMute","channel","Channel","CurrentMute","setMute","desiredMute","DesiredMute","getVolume","CurrentVolume","setVolume","desiredVolume","DesiredVolume","getVolumeDB","setVolumeDB","getVolumeDBRange","MinValue","MaxValue","getLoudness","CurrentLoudness","setLoudness","desiredLoudness","DesiredLoudness","getStateVariables","stateVariableList","StateVariableList","StateVariableValuePairs","setStateVariables","renderingControlUDN","serviceId","stateVariableValuePairs","RenderingControlUDN","ServiceType","ServiceId","getAllowedTransforms","CurrentAllowedTransformSettings","getTransforms","CurrentTransformValues","setTransforms","desiredTransformValues","DesiredTransformValues","getAllAvailableTransforms","AllAllowedTransformSettings","getAllowedDefaultTransforms","AllowedDefaultTransformSettings","getDefaultTransforms","CurrentDefaultTransformSettings","setDefaultTransforms","desiredDefaultTransformSettings","DesiredDefaultTransformSettings","Bindings","_setPic","dest","backgroundImage","pictureUnavailable","bindingArguments","argname","_optionsParser","winBindArgs","removeHTML","initializer","sourceProperty","destProperty","oneTime","innerText","removeHTMLAndEllipsisize","textRes","size","staticHTML","dataAttr","setClass","newval","oldval","bindingDesc","asClass","toBgImage","setImage","ToRealDate","toLocaleDateString","toSmartBgImage","showIf","setVisibility","hideIfNot","hideIfNotDefined","hideIf","showIfNot","showIfNotDefined","enableIf","disableIfNot","disableIf","enableIfNot","toWidth","setWidth","ellipsisize","sourcedata","toEllipsisized","emptyIfNull","twoWayOnChange","setVal","getVal","cleanUpBindingList","bindingList","unwrappedItem","unwrap","daysSince","m","myDate","yourDate","secondsInADay","diff","formatDate","setDate","moment","calendar","daysSinceDate","getMonth","getDate","getFullYear","fromdate","humanizeDate","addSuffix","duration","humanize","getOpt","fadeOut","delay","staggerDelay","itemdelay","maxdelay","timing","easing","executeTransition","fadeIn","initialDelay","extraDelay","delayFactor","delayCap","ret","min","pageExit","stagger","animationParams","keyframe","equivalents","transform","cssName","promise1","executeAnimation","promise2","slideAnim","keyframeName","isIn","Easings","easeInQuad","easeOutQuad","transitionParams","slideFromBottom","slideFromTop","slideFromLeft","slideFromRight","slideToBottom","slideToTop","slideToLeft","slideToRight","tabExitPage","tabEnterPage","exitGrow","exagerated","dur","easeInQuint","exitShrink","shrinkAndFall","enterShrink","easeOutQuint","enterGrow","easeInCubic","easeInQuart","easeInSine","easeInExpo","easeInCirc","easeInBack","easeOutCubic","easeOutQuart","easeOutSine","easeOutExpo","easeOutCirc","easeOutBack","easeInOutQuad","easeInOutCubic","easeInOutQuart","easeInOutQuint","easeInOutSine","easeInOutExpo","easeInOutCirc","easeInOutBack","_browserStyleEquivalents","elasticbuttonkinds","rectangle","morphpath","svg","roundedrectangle","round","ElasticButton","behavior","reset","active","mina","elastic","easein","_kind","contentCreated","contentElement","bgElement","currentKind","snap","Snap","pathEl","paths","_ptdown","_ptup","animate","createEventProperties","FOWrapper","someProperty","_someProperty","wrapperId","blurFilter","sblurFilter","blurTo","blur","stdDeviation","easeout","MultiPassRenderer","_scrollProcessor","_tolerance","_virtualize","_scrollContainer","scrollContainer","_multipass","multipass","_orientation","orientation","itemClassName","itemClass","itemTemplate","itemInvoked","onitemContent","_onScrollBinded","_onScroll","_unregisterScrollEvents","rect","clear","refreshScrollEvents","tolerance","virtualize","_registerScrollEvents","_scrollRequest","cancelAnimationFrame","requestAnimationFrame","checkRendering","clearOffsets","_checkSection","_vIsInView","_checkItem","_hIsInView","pxTolerance","noRender","renderItemsContent","onrendersection","empty","allRendered","prepareItems","renderOptions","onitemInit","registereditems","itemdata","MultiPassItem","renderItems","renderer","itemDataPromise","itemData","delayed","_renderContent","_renderItemContent","GridControl","grid","layouts","defaultLayout","itemsPerColumn","itemsPerRow","cellSpace","cellWidth","cellHeight","autolayout","_autolayout","gridLayouts","resetElement","isItem","minWidth","minHeight","left","top","clearContent","clearLayout","fill","matrix","col","fit","maxW","maxH","firstFit","numItems","visibleChilds","GridLayoutsImpl","none","flexhorizontal","flexFlow","alignContent","_itemsPerColumn","visibleitems","columns","ceil","flexvertical","hbloc","_containerH","cellW","space","colCount","colOffset","topOffset","eltH","horizontal","cellH","ratioW","ratioH","gridCellsMatrix","eltW","offsetWidth","offsetHeight","eltColumns","eltRows","pos","elementWidth","vertical","plugin","_containerW","_itemsPerLine","elementHeight","oldlayout","getLayout","layoutChanged","layoutfunc","changeLayout","applyed","viewState","lastViewState","matchingLayout","Search","writeFile","folder","fileName","CreationCollisionOption","objectGraph","createFileAsync","docfile","FileIO","writeTextAsync","openFile","openIfExists","file","readTextAsync","workerPath","Index","storeData","onprogress","stopWords","Stemming","StopWords","common","pipeline","Pipeline","folderPromise","ApplicationData","localFolder","createFolderAsync","loadData","indexString","fields","reload","save","exp","replaceExisting","filename","savedidx","_runSearch","querytext","preparedTokens","processText","searchResult","lastprogress","itemResult","_searchItem","progressPercent","sort","rank","limit","searchtokens","indexitem","points","tokenitem","untokenized","tokens","weight","token","stoken","rawdata","_add","def","addRange","arr","progress","indexed","refresh","tokenize","txt","run","checkWord","words","IndexGroup","definitions","indexes","useworker","IndexWorkerProxy","addIndex","async","addRangefunction","searchindex","searchItemType","searchresult","allResults","hasResult","workerpath","wrapper","worker","Messenger","SmartWorker","searchTerm","pipe","sets","Presets","ops","Op","_processors","processorNames","stemming","standard","processor","full","lowerCase","dedup","dropInitialLetters","dropBafterMAtEnd","cTransform","dTransform","dropG","transformG","dropH","transformCK","transformPH","transformQ","transformS","transformT","dropT","transformV","transformWH","dropW","transformX","dropY","transformZ","dropVowels","removeDiacritics","DataSources","ds","gr","DataSourceManager","groupedList","defaultGroupLimit","filters","onitemchanged","oniteminserted","onitemremoved","field","groupKind","defaultGroupName","compareGroups","getGroupKey","getGroupData","listview","zoomedOutListView","_field","_defaultGroupLimit","_groupKind","_listview","detach","_groupedList","_filter","_items","filteredlist","_filterItems","addFilter","newFilter","getAt","dontAttach","filterCallback","createFiltered","createGrouped","g","groups","_groupItems","grp","_groupsProjection","groupSize","groupCount","itemDataSource","groupDataSource","semzoom","parentSemanticZoom","locked","SemanticListViews","_initControl","semanticZoom","_semanticZoom","zoomedOutListview","_zoomedOutListview","dataManager","_dataManager","semanticPlaceholder","listviewPlaceholder","zoomedOutListviewPlaceholder","semanticzoom","dataOptions","Grouping","DEFAULTGROUPLIMIT","GROUPKIND","FIELD","ITEMS","alphabetic","right","dataItem","byField","byYear","setMonth","setHours","byMonth","byDay"],"mappings":"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ACA,SACA,OACA,KACA,QACA,KACA,MACA,MACA,MACA,KACA,KACA,KACA,UACA,OACA,MACA,KACA,MACA,SACA,QACA,OACA,MACA,KACA,OACA,SACA,OACA,OACA,QACA,MACA,OACA,MACA,MACA,MACA,MACA,OACA,KACA,MACA,OACA,MACA,MACA,MACA,UACA,IACA,KACA,KACA,OACA,KACA,KACA,MACA,OACA,QACA,MACA,OACA,SACA,MACA,KACA,QACA,OACA,OACA,KACA,UACA,KACA,MACA,MACA,KACA,MACA,QACA,KACA,OACA,KACA,QACA,MACA,MACA,SACA,OACA,MACA,OACA,MACA,SACA,QACA,KACA,OACA,OACA,OACA,MACA,QACA,OACA,OACA,QACA,QACA,OACA,OACA,MACA,KACA,MACA,OACA,KACA,QACA,MACA,KACA,OACA,OACA,OACA,QACA,QACA,QACA,MACA,OACA,MACA,OACA,OACA,QACA,MACA,MACA,SAELD,EAAYD,EAASC,YAAcD,EAASC,gBAChDD,EAAWnB,EAAOmB,WAAanB,EAAOmB,eAC1CnB,EAAS/8C,EAAa+8C,SAAW/8C,EAAa+8C,aAClD/8C,eAAiBA,iBACpB,IAAIA,eACJ,SAAWA,GACP,GAAI+8C,IACJ,SAAWA,GACP,GAAImB,IACJ,SAAWA,GACP,GAAI2E,IACJ,SAAWA,GAQP,QAASO,GAAU7C,GACf,MAAKA,GAEEA,EAAMr6C,cAFb,OAQJ,QAASm9C,GAAM9C,GACX,MAAKA,GAEEA,EAAM7gD,QAAQ,YAAa,MAFlC,OAQJ,QAAS4jD,GAAmB/C,GACxB,MAAKA,GAEDA,EAAM5gD,MAAM,qBACL4gD,EAAMp8C,OAAO,EAAGo8C,EAAMniD,OAAS,GACnCmiD,EAJP,OAUJ,QAASgD,GAAiBhD,GACtB,MAAKA,GAEEA,EAAM7gD,QAAQ,MAAO,KAF5B,OAQJ,QAAS8jD,GAAWjD,GAChB,MAAKA,IAELA,EAAQA,EAAM7gD,QAAQ,kBAAmB,SAAS+tB,OAClD8yB,EAAQA,EAAM7gD,QAAQ,OAAQ,OAC9B6gD,EAAQA,EAAM7gD,QAAQ,YAAa,OA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","file":"winjscontrib-custom.js","sourcesContent":["/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n(function (_global) {\n    //polyfill setimmediate\n    if (!this.setImmediate) {\n        this.setImmediate = function (callback) {\n            var args = [];\n            for (var _i = 1; _i < arguments.length; _i++) {\n                args[_i - 1] = arguments[_i];\n            }\n            setTimeout(callback, 0);\n            return 0;\n        };\n    }\n    //Windows 10 doesn't have it anymore, polyfill for backward compat\n    if (!this.toStaticHTML) {\n        this.toStaticHTML = function (text) {\n            return text;\n        };\n    }\n    var msapp = _global.MSApp;\n    if (msapp && !msapp.execUnsafeLocalFunction) {\n        msapp.execUnsafeLocalFunction = function (c) { c(); };\n    }\n})(this);\nif (!Object.map) {\n    Object.map = function (obj, mapping) {\n        var mapped = {};\n        if (typeof obj !== 'object') {\n            return mapped;\n        }\n        if (typeof mapping !== 'function') {\n            // We could just return obj but that wouldn't be\n            // consistent with the rest of the interface which always returns\n            // a new object.\n            mapping = function (key, val) {\n                return [key, val];\n            };\n        }\n        Object.keys(obj).forEach(function (key) {\n            var transmuted = mapping.apply(obj, [key, obj[key]]);\n            if (transmuted && transmuted.length) {\n                mapped[transmuted[0] || key] = transmuted[1];\n            }\n        });\n        return mapped;\n    };\n}\nif (!String.prototype.format) {\n    String.prototype.format = function () {\n        var args = arguments;\n        return this.replace(/{(\\d+)}/g, function (match, number) {\n            return typeof args[number] !== 'undefined' ? args[number] : match;\n        });\n    };\n}\nif (!String.prototype.padLeft) {\n    String.prototype.padLeft = function padLeft(length, leadingChar) {\n        if (leadingChar === undefined) {\n            leadingChar = \"0\";\n        }\n        return this.length < length ? (leadingChar + this).padLeft(length, leadingChar) : this;\n    };\n}\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Promise;\n    (function (Promise) {\n        /**\n         * apply callback for each item in the array in waterfall\n         * @function WinJSContrib.Promise.waterfall\n         * @param {Array} dataArray items to process with async tasks\n         * @param {function} promiseCallback function applyed to each item (could return a promise for item callback completion)\n         * @returns {WinJS.Promise}\n         */\n        function waterfall(dataArray, promiseCallback) {\n            var resultPromise = WinJS.Promise.wrap();\n            var results = [];\n            if (!dataArray) {\n                return WinJS.Promise.wrap([]);\n            }\n            var dataPromise = WinJS.Promise.as(dataArray);\n            return dataPromise.then(function (items) {\n                var queueP = function (p, item) {\n                    return p.then(function (r) {\n                        return WinJS.Promise.as(promiseCallback(item)).then(function (r) {\n                            results.push(r);\n                        });\n                    });\n                };\n                for (var i = 0, l = items.length; i < l; i++) {\n                    var item = items[i];\n                    if (!item && items.getItem) {\n                        item = items.getItem(i);\n                    }\n                    resultPromise = queueP(resultPromise, item);\n                }\n                return resultPromise.then(function (r) {\n                    return results;\n                });\n            });\n        }\n        Promise.waterfall = waterfall;\n        function promises(dataArray, promiseCallback) {\n            if (!dataArray) {\n                return WinJS.Promise.wrap([]);\n            }\n            var dataPromise = WinJS.Promise.as(dataArray);\n            return dataPromise.then(function (items) {\n                var promises = [];\n                for (var i = 0, l = items.length; i < l; i++) {\n                    var item = items[i];\n                    if (!item && items.getItem) {\n                        item = items.getItem(i);\n                    }\n                    promises.push(WinJS.Promise.as(promiseCallback(item)));\n                }\n                return promises;\n            });\n        }\n        /**\n         * apply callback for each item in the array in parallel (equivalent to WinJS.Promise.join)\n         * @function WinJSContrib.Promise.parallel\n         * @param {Array} dataArray items to process with async tasks\n         * @param {function} promiseCallback function applyed to each item (could return a promise for item callback completion)\n         * @returns {WinJS.Promise}\n         */\n        function parallel(dataArray, promiseCallback) {\n            if (!dataArray) {\n                return WinJS.Promise.wrap([]);\n            }\n            var dataPromise = WinJS.Promise.as(dataArray);\n            return dataPromise.then(function (items) {\n                var promises = [];\n                for (var i = 0, l = items.length; i < l; i++) {\n                    var item = items[i];\n                    if (!item && items.getItem) {\n                        item = items.getItem(i);\n                    }\n                    promises.push(WinJS.Promise.as(promiseCallback(item)));\n                }\n                return WinJS.Promise.join(promises);\n            });\n        }\n        Promise.parallel = parallel;\n        /**\n         * apply callback for each item in the array in batch of X parallel items\n         * @function WinJSContrib.Promise.batch\n         * @param {Array} dataArray items to process with async tasks\n         * @param {number} batchSize number of items to batch\n         * @param {function} promiseCallback function applyed to each item (could return a promise for item callback completion)\n         * @returns {WinJS.Promise}\n         */\n        function batch(dataArray, batchSize, promiseCallback) {\n            if (!dataArray) {\n                return WinJS.Promise.wrap([]);\n            }\n            var dataPromise = WinJS.Promise.as(dataArray);\n            return dataPromise.then(function (items) {\n                var resultPromise = WinJS.Promise.wrap();\n                var batcheditems = [];\n                var results = [];\n                var hasErrors = false;\n                var queueBatch = function (p, items) {\n                    //var batchresults = [];\n                    return p.then(function (r) {\n                        return WinJS.Promise.join(items.map(function (item) { return WinJS.Promise.as(promiseCallback(item)); })).then(function (results) {\n                            results = results.concat(results);\n                        }, function (errors) {\n                            results = results.concat(errors);\n                            hasErrors = true;\n                        });\n                    });\n                };\n                for (var i = 0, l = items.length; i < l; i++) {\n                    var item = items[i];\n                    if (!item && items.getItem) {\n                        item = items.getItem(i);\n                    }\n                    batcheditems.push(item);\n                    if (i > 0 && i % batchSize === 0) {\n                        resultPromise = queueBatch(resultPromise, batcheditems);\n                        batcheditems = [];\n                    }\n                }\n                if (batcheditems.length) {\n                    resultPromise = queueBatch(resultPromise, batcheditems);\n                }\n                return resultPromise.then(function () {\n                    if (hasErrors)\n                        return WinJS.Promise.wrapError(results);\n                    return results;\n                });\n            });\n        }\n        Promise.batch = batch;\n    })(Promise = WinJSContrib.Promise || (WinJSContrib.Promise = {}));\n})(WinJSContrib || (WinJSContrib = {}));\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Utils;\n    (function (Utils) {\n        /**\n         * extend an object with properties from subsequent objects\n         * @function WinJSContrib.Utils.extend\n         * @returns {Object} composite object\n         */\n        function extend() {\n            for (var i = 1; i < arguments.length; i++)\n                for (var key in arguments[i])\n                    if (arguments[i].hasOwnProperty(key))\n                        arguments[0][key] = arguments[i][key];\n            return arguments[0];\n        }\n        Utils.extend = extend;\n        /** indicate if string starts with featured characters\n         * @function WinJSContrib.Utils.startsWith\n         * @param {string} str string to search within\n         * @param {string} strToMatch match string\n         * @returns {boolean} true if string starts with strToMatch\n         */\n        function startsWith(str, strToMatch) {\n            if (!strToMatch) {\n                return false;\n            }\n            var match = (str.match(\"^\" + strToMatch) == strToMatch);\n            return match;\n        }\n        Utils.startsWith = startsWith;\n        if (!String.prototype.startsWith) {\n            String.prototype.startsWith = function (str) {\n                return WinJSContrib.Utils.startsWith(this, str);\n            };\n        }\n        function asyncForEach(array, callback, batchsize) {\n            if (batchsize === void 0) { batchsize = 1; }\n            var i = 0;\n            while (i < array.length) {\n                setImmediate(function () {\n                    for (var j = 0; j < batchsize && i < array.length; j++) {\n                        i++;\n                        callback(array[i]);\n                    }\n                });\n            }\n        }\n        Utils.asyncForEach = asyncForEach;\n        /** indicate if string ends with featured characters\n         * @function WinJSContrib.Utils.endsWith\n         * @param {string} str string to search within\n         * @param {string} strToMatch match string\n         * @returns {boolean} true if string starts with strToMatch\n         */\n        function endsWith(str, strToMatch) {\n            if (!strToMatch) {\n                return false;\n            }\n            return (str.match(strToMatch + \"$\") == strToMatch);\n        }\n        Utils.endsWith = endsWith;\n        if (!String.prototype.endsWith) {\n            String.prototype.endsWith = function (str) {\n                return WinJSContrib.Utils.endsWith(this, str);\n            };\n        }\n        /**\n         * generate a string formatted as a query string from object properties\n         * @function WinJSContrib.Utils.queryStringFrom\n         * @param {Object} obj object to format\n         * @returns {string}\n         */\n        function queryStringFrom(obj) {\n            var str = [];\n            for (var p in obj)\n                if (obj.hasOwnProperty(p)) {\n                    var key = encodeURIComponent(p);\n                    var rawValue = obj[p];\n                    var value = WinJSContrib.Utils.hasValue(rawValue) ? encodeURIComponent(rawValue) : \"\";\n                    str.push(key + \"=\" + value);\n                }\n            return str.join(\"&\");\n        }\n        Utils.queryStringFrom = queryStringFrom;\n        /**\n         * trigger an event on a DOM node\n         * @function WinJSContrib.Utils.triggerEvent\n         * @param {HTMLElement} element receiving the event\n         * @param {string} eventName name of the event\n         * @param {boolean} bubbles indicate if event should bubble\n         * @param {boolean} cancellable indicate if event can be cancelled\n         */\n        function triggerEvent(element, eventName, bubbles, cancellable) {\n            var eventToTrigger = document.createEvent(\"Event\");\n            eventToTrigger.initEvent(eventName, bubbles, cancellable);\n            element.dispatchEvent(eventToTrigger);\n        }\n        Utils.triggerEvent = triggerEvent;\n        /**\n         * @function WinJSContrib.Utils.triggerCustomEvent\n         * @param {HTMLElement} element receiving the event\n         * @param {string} eventName name of the event\n         * @param {boolean} bubbles indicate if event should bubble\n         * @param {boolean} cancellable indicate if event can be cancelled\n         */\n        function triggerCustomEvent(element, eventName, bubbles, cancellable, data) {\n            var eventToTrigger = document.createEvent(\"CustomEvent\");\n            eventToTrigger.initCustomEvent(eventName, bubbles, cancellable, data);\n            element.dispatchEvent(eventToTrigger);\n        }\n        Utils.triggerCustomEvent = triggerCustomEvent;\n        /*\n        Core object properties features\n        */\n        //return object value based on property name. Property name is a string containing the name of the property, \n        //or the name of the property with an indexer, ex: myproperty[2] (to get item in a array)\n        function getobject(obj, prop) {\n            if (!obj)\n                return;\n            if (prop === 'this')\n                return obj;\n            var baseValue = obj[prop];\n            if (typeof baseValue !== \"undefined\")\n                return baseValue;\n            var idx = prop.indexOf('[');\n            if (idx < 0)\n                return;\n            var end = prop.indexOf(']', idx);\n            if (end < 0)\n                return;\n            var val = prop.substr(idx + 1, end - idx);\n            val = parseInt(val);\n            return obj[val];\n        }\n        //set object property value based on property name. Property name is a string containing the name of the property, \n        //or the name of the property with an indexer, ex: myproperty[2] (to get item in a array)\n        function setobject(obj, prop, data) {\n            if (!obj)\n                return;\n            if (WinJSContrib.Utils.hasValue(prop)) {\n                if (obj.setProperty) {\n                    obj.setProperty(prop, data);\n                    return;\n                }\n                obj[prop] = data;\n                return;\n            }\n            if (typeof prop === \"string\") {\n                var idx = prop.indexOf('[');\n                if (idx < 0)\n                    return;\n                var end = prop.indexOf(']', idx);\n                if (end < 0)\n                    return;\n                var val = prop.substr(idx + 1, end - idx);\n                var intval = parseInt(val);\n                obj[intval] = data;\n            }\n        }\n        /** Read property value on an object based on expression\n        * @function WinJSContrib.Utils.readProperty\n        * @param {Object} source the object containing data\n        * @param {Object} properties property descriptor. could be a string in js notation ex: 'myProp.myChildProp,\n        * or an array of strings ['myProp', 'myChildProp']. String notation can contain indexers\n        * @returns {Object} property value\n        */\n        function readProperty(source, properties) {\n            if (typeof properties == 'string' && source[properties])\n                return source[properties];\n            if (!properties || !properties.length)\n                return source;\n            var prop = WinJSContrib.Utils.getProperty(source, properties);\n            if (prop) {\n                return prop.propValue;\n            }\n        }\n        Utils.readProperty = readProperty;\n        var PropertyDescriptor = (function () {\n            function PropertyDescriptor(parent, parentDescriptor, keyProp) {\n                this.parent = parent;\n                this.parentDescriptor = parentDescriptor;\n                this.keyProp = keyProp;\n            }\n            PropertyDescriptor.prototype.ensureParent = function () {\n                if (parent) {\n                    return parent;\n                }\n                else {\n                    if (this.parentDescriptor) {\n                        this.parentDescriptor.ensureParent();\n                        if (!this.parentDescriptor.parent[this.parentDescriptor.keyProp]) {\n                            this.parentDescriptor.parent[this.parentDescriptor.keyProp] = {};\n                            this.parent = this.parentDescriptor.parent[this.parentDescriptor.keyProp];\n                        }\n                    }\n                }\n            };\n            Object.defineProperty(PropertyDescriptor.prototype, \"propValue\", {\n                get: function () {\n                    return getobject(this.parent, this.keyProp);\n                },\n                set: function (val) {\n                    this.ensureParent();\n                    setobject(this.parent, this.keyProp, val);\n                },\n                enumerable: true,\n                configurable: true\n            });\n            return PropertyDescriptor;\n        })();\n        Utils.PropertyDescriptor = PropertyDescriptor;\n        /**\n         * return a propery descriptor for an object based on expression\n         * @function WinJSContrib.Utils.getProperty\n         * @param {Object} source the object containing data\n         * @param {string[]} properties property descriptor. could be a string in js notation ex: 'myProp.myChildProp,\n         * or an array of strings ['myProp', 'myChildProp']. String notation can contain indexers\n         * @returns {Object} property descriptor\n         */\n        function getProperty(source, properties) {\n            if (typeof properties == 'string') {\n                properties = properties.split('.');\n            }\n            if (!properties || !properties.length) {\n                properties = ['this'];\n            }\n            var parent = source;\n            var previousDescriptor = null;\n            for (var i = 0; i < properties.length; i++) {\n                var descriptor = new PropertyDescriptor(parent, previousDescriptor, properties[i]);\n                previousDescriptor = descriptor;\n                if (i == properties.length - 1) {\n                    return descriptor;\n                }\n                parent = getobject(parent, properties[i]);\n            }\n            return;\n        }\n        Utils.getProperty = getProperty;\n        /**\n         * Write property value on an object based on expression\n         * @function WinJSContrib.Utils.writeProperty\n         * @param {Object} source the object containing data\n         * @param {string[]} properties property descriptor. could be a string in js notation ex: 'myProp.myChildProp,\n         * or an array of strings ['myProp', 'myChildProp']. String notation can contain indexers\n         * @param {Object} data data to feed to the property\n         */\n        function writeProperty(source, properties, data) {\n            var prop = WinJSContrib.Utils.getProperty(source, properties);\n            if (prop) {\n                prop.propValue = data;\n            }\n        }\n        Utils.writeProperty = writeProperty;\n        /** generate a random value between two numbers\n         * @function WinJSContrib.Utils.randomFromInterval\n         * @param {number} from lower limit\n         * @param {number} to upper limit\n         * @returns {number}\n         */\n        function randomFromInterval(from, to) {\n            return (Math.random() * (to - from + 1) + from) << 0;\n        }\n        Utils.randomFromInterval = randomFromInterval;\n        /**\n         * function to use as a callback for Array.sort when you want the array to be sorted alphabetically\n         * @function WinJSContrib.Utils.alphabeticSort\n         * @param {string} a\n         * @param {string} b\n         * @returns {number}\n         */\n        function alphabeticSort(a, b) {\n            if (a > b)\n                return 1;\n            if (a < b)\n                return -1;\n            return 0;\n        }\n        Utils.alphabeticSort = alphabeticSort;\n        /**\n         * generate an array with only distinct elements\n         * @function WinJSContrib.Utils.distinctArray\n         * @param {Array} array\n         * @param {string} path to array's item property used for checking items\n         * @param {boolean} ignorecase indicate if comparison should ignore case when using string\n         * @returns {Array}\n         */\n        function distinctArray(array, property, ignorecase) {\n            if (array === null || array.length === 0)\n                return array;\n            if (typeof ignorecase == \"undefined\")\n                ignorecase = false;\n            var sMatchedItems = \"\";\n            var foundCounter = 0;\n            var newArray = [];\n            var sFind;\n            var i;\n            if (ignorecase) {\n                for (i = 0; i < array.length; i++) {\n                    if (property) {\n                        var data = WinJSContrib.Utils.readProperty(array[i], property.split('.'));\n                        sFind = data;\n                        if (!data)\n                            sFind = data;\n                        if (data && data.toLowerCase)\n                            sFind = data.toLowerCase();\n                    }\n                    else {\n                        sFind = array[i];\n                    }\n                    if (sMatchedItems.indexOf(\"|\" + sFind + \"|\") < 0) {\n                        sMatchedItems += \"|\" + sFind + \"|\";\n                        newArray[foundCounter++] = array[i];\n                    }\n                }\n            }\n            else {\n                for (i = 0; i < array.length; i++) {\n                    if (property) {\n                        sFind = WinJSContrib.Utils.readProperty(array[i], property.split('.'));\n                    }\n                    else {\n                        sFind = array[i];\n                    }\n                    if (sMatchedItems.indexOf(\"|\" + sFind + \"|\") < 0) {\n                        sMatchedItems += \"|\" + sFind + \"|\";\n                        newArray[foundCounter++] = array[i];\n                    }\n                }\n            }\n            return newArray;\n        }\n        Utils.distinctArray = distinctArray;\n        /**\n         * get distinct values from an array of items\n         * @function WinJSContrib.Utils.getDistinctPropertyValues\n         * @param {Array} array items array\n         * @param {string} property property path for values\n         * @param {boolean} ignorecase ignore case for comparisons\n         */\n        function getDistinctPropertyValues(array, property, ignorecase) {\n            return Utils.distinctArray(array, property, ignorecase).map(function (item) {\n                return WinJSContrib.Utils.readProperty(item, property.split('.'));\n            });\n        }\n        Utils.getDistinctPropertyValues = getDistinctPropertyValues;\n        /**\n         * Remove all accented characters from a string and replace them with their non-accented counterpart for ex: replace \"é\" with \"e\"\n         * @function WinJSContrib.Utils.removeAccents\n         * @param {string} s\n         * @returns {string}\n         */\n        function removeAccents(s) {\n            var r = s.toLowerCase();\n            r = r.replace(new RegExp(\"[àáâãäå]\", 'g'), \"a\");\n            r = r.replace(new RegExp(\"æ\", 'g'), \"ae\");\n            r = r.replace(new RegExp(\"ç\", 'g'), \"c\");\n            r = r.replace(new RegExp(\"[èéêë]\", 'g'), \"e\");\n            r = r.replace(new RegExp(\"[ìíîï]\", 'g'), \"i\");\n            r = r.replace(new RegExp(\"ñ\", 'g'), \"n\");\n            r = r.replace(new RegExp(\"[òóôõö]\", 'g'), \"o\");\n            r = r.replace(new RegExp(\"œ\", 'g'), \"oe\");\n            r = r.replace(new RegExp(\"[ùúûü]\", 'g'), \"u\");\n            r = r.replace(new RegExp(\"[ýÿ]\", 'g'), \"y\");\n            return r;\n        }\n        Utils.removeAccents = removeAccents;\n        /**\n         * remove a page from navigation history\n         * @function WinJSContrib.Utils.removePageFromHistory\n         * @param {string} pageLocation page url\n         */\n        function removePageFromHistory(pageLoc) {\n            var history = [];\n            if (WinJS.Navigation.history && WinJS.Navigation.history.backStack && WinJS.Navigation.history.backStack.length) {\n                WinJS.Navigation.history.backStack.forEach(function (page) {\n                    if (page.location !== pageLoc) {\n                        history.push(page);\n                    }\n                });\n            }\n            WinJS.Navigation.history.backStack = history;\n        }\n        Utils.removePageFromHistory = removePageFromHistory;\n        /**\n         * format a number on 2 digits\n         * @function WinJSContrib.Utils.pad2\n         * @param {number} number\n         */\n        function pad2(number) {\n            return (number < 10 ? '0' : '') + number;\n        }\n        Utils.pad2 = pad2;\n        /**\n         * truncate a string and add ellipse if text if greater than certain size\n         * @function WinJSContrib.Utils.ellipsisizeString\n         * @param {string} text text to truncate\n         * @param {number} maxSize maximum size for text\n         * @param {boolean} useWordBoundary indicate if truncate should happen on the closest word boundary (like space)\n         */\n        function ellipsisizeString(text, maxSize, useWordBoundary) {\n            if (!text) {\n                return '';\n            }\n            var toLong = text.length > maxSize, text_ = toLong ? text.substr(0, maxSize - 1) : text;\n            text_ = useWordBoundary && toLong ? text_.substr(0, text_.lastIndexOf(' ')) : text_;\n            return toLong ? text_ + '...' : text_;\n        }\n        Utils.ellipsisizeString = ellipsisizeString;\n        /**\n         * generate a new Guid\n         * @function WinJSContrib.Utils.guid\n         * @returns {string}\n         */\n        function guid() {\n            var d = new Date().getTime();\n            var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n                var r = (d + Math.random() * 16) % 16 | 0;\n                d = Math.floor(d / 16);\n                return (c == 'x' ? r : (r & 0x7 | 0x8)).toString(16);\n            });\n            return uuid;\n        }\n        Utils.guid = guid;\n        /**\n         * inherit property from parent WinJS controls\n         * @function WinJSContrib.Utils.inherit\n         * @param {HTMLElement} element\n         * @param {string} property property name\n         */\n        function inherit(element, property) {\n            if (element && element.parentElement) {\n                var current = element.parentElement;\n                while (current) {\n                    if (current.winControl) {\n                        if (current.winControl[property] !== undefined) {\n                            return current.winControl[property];\n                        }\n                    }\n                    current = current.parentElement;\n                }\n            }\n        }\n        Utils.inherit = inherit;\n        /**\n         * move DOM childrens form one node to the other\n         * @function WinJSContrib.Utils.moveChilds\n         * @param {HTMLElement} source source node containing elements to move\n         * @param {HTMLElement} target target node for moved elements\n         */\n        function moveChilds(source, target) {\n            if (!source || !target)\n                return;\n            var childs = [];\n            for (var i = 0; i < source.childNodes.length; i++) {\n                childs.push(source.childNodes[i]);\n            }\n            childs.forEach(function (elt) {\n                target.appendChild(elt);\n            });\n        }\n        Utils.moveChilds = moveChilds;\n        /**\n         * get parent control identifyed by a property attached on DOM element\n         * @function WinJSContrib.Utils.getParent\n         * @param {string} property property attached to control's DOM element, for ex: msParentSelectorScope\n         * @param {HTMLElement} element DOM element to scan\n         * @returns {Object} WinJS control\n         */\n        function getParent(property, element) {\n            if (!element)\n                return;\n            var current = element.parentNode;\n            while (current) {\n                if (current[property] && current.winControl) {\n                    return current.winControl;\n                }\n                current = current.parentNode;\n            }\n        }\n        Utils.getParent = getParent;\n        /**\n         * get parent control identifyed by a css class\n         * @function WinJSContrib.Utils.getParentControlByClass\n         * @param {string} className css class name\n         * @param {HTMLElement} element DOM element to scan\n         * @returns {Object} WinJS control\n         */\n        function getParentControlByClass(className, element) {\n            if (!element)\n                return;\n            var current = element.parentNode;\n            while (current) {\n                if (current.classList && current.classList.contains(className) && current.winControl) {\n                    return current.winControl;\n                }\n                current = current.parentNode;\n            }\n        }\n        Utils.getParentControlByClass = getParentControlByClass;\n        /**\n         * get parent page control (work only with WinJSContrib.UI.PageControlNavigator\n         * @function WinJSContrib.Utils.getParentPage\n         * @param {HTMLElement} element DOM element to scan\n         * @returns {Object} WinJS control\n         */\n        function getParentPage(element) {\n            return WinJSContrib.Utils.getParent('mcnPage', element);\n        }\n        Utils.getParentPage = getParentPage;\n        /**\n         * get parent scope control (based on msParentSelectorScope)\n         * @function WinJSContrib.Utils.getScopeControl\n         * @param {HTMLElement} element DOM element to scan\n         * @returns {Object} WinJS control\n         */\n        function getScopeControl(element) {\n            var current = element.parentNode;\n            while (current) {\n                if (current.msParentSelectorScope) {\n                    var scope = current.parentNode;\n                    if (scope) {\n                        var scopeControl = scope.winControl;\n                        if (scopeControl) {\n                            return scopeControl;\n                        }\n                    }\n                }\n                current = current.parentNode;\n            }\n        }\n        Utils.getScopeControl = getScopeControl;\n        /**\n         * get WinJS.Binding.Template like control from a path, a control, a function or a DOM element\n         * @function WinJSContrib.Utils.getTemplate\n         * @param {Object} template template input\n         * @returns {Object} WinJS.Binding.Template or template-like object (object with a render function)\n         */\n        function getTemplate(template) {\n            if (template) {\n                var templatetype = typeof template;\n                if (templatetype == 'string') {\n                    return new WinJS.Binding.Template(null, { href: template });\n                }\n                if (templatetype == 'function') {\n                    return {\n                        render: function (data, elt) {\n                            var res = template(data, elt);\n                            return WinJS.Promise.as(res);\n                        }\n                    };\n                }\n                else if (template.winControl) {\n                    return template.winControl;\n                }\n                else if (template.render) {\n                    return template;\n                }\n            }\n        }\n        Utils.getTemplate = getTemplate;\n        /**\n         * get a function from an expression, for example 'page:myAction' will return the myAction function from the parent page.\n         * The returned function will be bound to it's owner. This function relies on {link WinJSContrib.Utils.resolveValue}, see this for details about how data are crawled\n         * @function WinJSContrib.Utils.resolveMethod\n         * @param {HTMLElement} element DOM element to look\n         * @param {string} text expression like 'page:something' or 'ctrl:something' or 'something'\n         * @returns {function}\n         */\n        function resolveMethod(element, text) {\n            var res = WinJSContrib.Utils.resolveValue(element, text);\n            if (res && typeof res == 'function')\n                return res;\n            return undefined;\n        }\n        Utils.resolveMethod = resolveMethod;\n        function readValue(element, text) {\n            var res = WinJSContrib.Utils.resolveValue(element, text);\n            if (res) {\n                if (typeof res == 'function')\n                    return res(element);\n                else\n                    return res;\n            }\n            return undefined;\n        }\n        Utils.readValue = readValue;\n        /**\n         * Utility functions used by WinJSContrib.Utils.resolveValue and WinJSContrib.Utils.applyValue\n         * @namespace WinJSContrib.Utils.ValueParsers\n         */\n        Utils.ValueParsers = {\n            /**\n             * Get value from current page in parent navigator\n             * @function WinJSContrib.Utils.ValueParsers.navpage\n             */\n            \"navpage\": function (element, text, context) {\n                var control = (context && context.data) ? context.data.navpage : null;\n                if (!control) {\n                    if (WinJSContrib.Utils.getParentPage) {\n                        control = WinJSContrib.Utils.getParentPage(element);\n                        if (context && context.data)\n                            context.data.navpage = control;\n                    }\n                    if (!control && WinJSContrib.UI.Application.navigator) {\n                        control = WinJSContrib.UI.Application.navigator.pageControl;\n                        if (context && context.data)\n                            context.data.navpage = control;\n                    }\n                }\n                if (!control)\n                    return;\n                if (context)\n                    context.parentControl = control;\n                var method = WinJSContrib.Utils.readProperty(control, text);\n                if (method && typeof method === 'function')\n                    return method.bind(control);\n                else\n                    return method;\n            },\n            /**\n             * Get value from parent element with 'pagecontrol' class\n             * @function WinJSContrib.Utils.ValueParsers.page\n             */\n            \"page\": function (element, text, context) {\n                var control = (context && context.data) ? context.data.page : null;\n                if (!control) {\n                    control = WinJSContrib.Utils.getParentControlByClass('pagecontrol', element);\n                    if (context && context.data)\n                        context.data.page = control;\n                }\n                if (!control)\n                    return;\n                if (context)\n                    context.parentControl = control;\n                var method = WinJSContrib.Utils.readProperty(control, text);\n                if (method && typeof method === 'function')\n                    return method.bind(control);\n                else\n                    return method;\n            },\n            /**\n             * Get value from parent scope\n             * @function WinJSContrib.Utils.ValueParsers.ctrl\n             */\n            \"ctrl\": function (element, text, context) {\n                var control = (context && context.data) ? context.data.scope : null;\n                if (!control) {\n                    control = WinJSContrib.Utils.getScopeControl(element);\n                    if (context && context.data)\n                        context.data.scope = control;\n                }\n                if (!control)\n                    return;\n                if (context)\n                    context.parentControl = control;\n                var method = WinJSContrib.Utils.readProperty(control, text);\n                if (method && typeof method === 'function')\n                    return method.bind(control);\n                else\n                    return method;\n            },\n            /**\n             * select a node from DOM\n             * @function WinJSContrib.Utils.ValueParsers.select\n             */\n            \"select\": function (element, text, context) {\n                var control = (context && context.data) ? context.data.scope : null;\n                if (!control) {\n                    control = WinJSContrib.Utils.getScopeControl(element);\n                    if (context && context.data)\n                        context.data.scope = control;\n                }\n                var element = null;\n                var items = text.split('|');\n                var selector = items[0];\n                if (control) {\n                    element = control.element.querySelector(selector);\n                }\n                if (!element)\n                    element = document.querySelector(selector);\n                if (items.length == 1) {\n                    return element;\n                }\n                else if (items.length > 1) {\n                    var val = readProperty(element, text.substr(items[0].length + 1));\n                    return val;\n                }\n            },\n            /**\n             * get an object formatted as JSON\n             * @function WinJSContrib.Utils.ValueParsers.obj\n             */\n            \"obj\": function (element, text, context) {\n                return WinJS.UI.optionsParser(text, window, {\n                    select: WinJS.Utilities.markSupportedForProcessing(function (text) {\n                        var parent = WinJSContrib.Utils.getScopeControl(element);\n                        if (parent) {\n                            return parent.element.querySelector(text);\n                        }\n                        else {\n                            return document.querySelector(text);\n                        }\n                    })\n                });\n            },\n            /**\n             * mark a promise for resolution (if used in applyValue, the promise will get resolved and the promise's result will be affected)\n             * @function WinJSContrib.Utils.ValueParsers.prom\n             */\n            \"prom\": function (element, text, context) {\n                var res = resolveValue(element, text, context);\n                if (res.then) {\n                    res = res.then(null, null);\n                    res.mcnMustResolve = true;\n                }\n                return res;\n            },\n            /**\n             * wrap result in WinJS.Binding.List().dataSource\n             * usefull for ListViews\n             * @function WinJSContrib.Utils.ValueParsers.list\n             */\n            \"list\": function (element, text, context) {\n                var res = resolveValue(element, text, context);\n                if (res) {\n                    if (res.then) {\n                        var p = res.then(function (data) {\n                            return new WinJS.Binding.List(data).dataSource;\n                        });\n                        p.mcnMustResolve = true;\n                        return p;\n                    }\n                    return new WinJS.Binding.List(res).dataSource;\n                }\n            },\n            /**\n             * get value from global scope\n             * @function WinJSContrib.Utils.ValueParsers.global\n             */\n            \"global\": function (element, text, context) {\n                return WinJSContrib.Utils.readProperty(window, text);\n            },\n            /**\n             * get a template from uri\n             * @function WinJSContrib.Utils.ValueParsers.templ\n             */\n            \"templ\": function (element, text, context) {\n                return WinJSContrib.Templates.get(text);\n            },\n            /**\n             * return element property\n             * @function WinJSContrib.Utils.ValueParsers.element\n             */\n            \"element\": function (element, text, context) {\n                var res = resolveValue(element, text, context);\n                if (res)\n                    return res.element;\n            },\n            \"event\": function (element, text, context) {\n                var res = resolveValue(element, text, context);\n                var parentControl = null;\n                if (!res || !context || !context.name) {\n                    return;\n                }\n                if (context)\n                    parentControl = context.parentControl;\n                if (res && typeof res === 'function') {\n                    if (parentControl && parentControl.eventTracker) {\n                        parentControl.eventTracker.addEvent(context.control, context.name, res);\n                    }\n                    else {\n                        context.control.addEventListener(context.name, res);\n                    }\n                }\n            }\n        };\n        /**\n         * resolve value from an expression. This helper will crawl the DOM up, and provide the property or function from parent page or control.\n         * @function WinJSContrib.Utils.resolveValue\n         * @param {HTMLElement} element DOM element to look\n         * @param {string} text expression like 'page:something' or 'ctrl:something' or 'something'\n         * @returns {Object}\n         */\n        function resolveValue(element, text, context) {\n            var methodName, control, method;\n            var items = text.split(':');\n            if (items.length > 1) {\n                var name = items[0];\n                var val = text.substr(name.length + 1);\n                var parser = Utils.ValueParsers[name];\n                if (parser) {\n                    return parser(element, val, context);\n                }\n            }\n            return text; //WinJSContrib.Utils.readProperty(window, text);\n        }\n        Utils.resolveValue = resolveValue;\n        /**\n         * call resolve value and apply result to a target object\n         * @function WinJSContrib.Utils.applyValue\n         * @param {HTMLElement} element DOM element to look\n         * @param {string} text expression like 'page:something' or 'ctrl:something' or 'something'\n         * @param {string} target target object\n         * @param {string} targetPath path to dest property\n         */\n        function applyValue(element, text, target, targetPath, context) {\n            var tmp = WinJSContrib.Utils.resolveValue(element, text, context);\n            if (tmp && tmp.then && tmp.mcnMustResolve) {\n                tmp.then(function (data) {\n                    WinJSContrib.Utils.writeProperty(target, targetPath, data);\n                });\n            }\n            else {\n                WinJSContrib.Utils.writeProperty(target, targetPath, tmp);\n            }\n        }\n        Utils.applyValue = applyValue;\n        /**\n         * Checks in a safe way if an object has a value, which could be 'false', '0' or '\"\"'\n         * @function WinJSContrib.Utils.hasValue\n         * @param {Object} item The object to check.\n         * @returns {Boolean} Whether the object has a value or not.\n         */\n        function hasValue(item) {\n            return typeof item !== \"undefined\" && item !== null;\n        }\n        Utils.hasValue = hasValue;\n        /**\n         * format error from an xhr call\n         * @function WinJSContrib.Utils.formatXHRError\n         */\n        function formatXHRError(xhr) {\n            return \"{0} - {1}: {2}\".format(xhr.status, xhr.statusText, xhr.responseText);\n        }\n        Utils.formatXHRError = formatXHRError;\n        /**\n         * Unwraps the real error from a WinJS.Promise.join operation, which by design returns an array with 'undefined' for all cells,\n         * excepts the one corresponding to the promise that really faulted.\n         * @function WinJSContrib.Utils.unwrapJoinError\n         * @param {function} errorCallback The callback to use to handle the error.\n         * @returns {Function} The result of the callback being fired with the real error.\n         */\n        function unwrapJoinError(errorCallback) {\n            return function (errorArray) {\n                var unwrappedError = null;\n                for (var i = 0; i < errorArray.length; i++) {\n                    var tentativeError = errorArray[i];\n                    if (typeof tentativeError !== \"undefined\") {\n                        unwrappedError = tentativeError;\n                        break;\n                    }\n                }\n                return errorCallback(unwrappedError);\n            };\n        }\n        Utils.unwrapJoinError = unwrapJoinError;\n        /**\n         * inject properties from source object to target object\n         * @function WinJSContrib.Utils.inject\n         */\n        function inject(target, source) {\n            if (source) {\n                for (var k in source) {\n                    target[k] = source[k];\n                }\n            }\n        }\n        Utils.inject = inject;\n    })(Utils = WinJSContrib.Utils || (WinJSContrib.Utils = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n/**\n * @namespace WinJSContrib.Templates\n */\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Templates;\n    (function (Templates) {\n        var cache = {};\n        /**\n         * get a template from it's path\n         * @function get\n         * @memberof WinJSContrib.Templates\n         * @param {string} uri path to template file\n         * @returns {WinJS.Binding.Template} template object\n         */\n        function get(uri) {\n            var template = cache[uri];\n            if (cache[uri])\n                return template;\n            return new WinJS.Binding.Template(null, { href: uri });\n        }\n        Templates.get = get;\n        /**\n         * get a template and turn it to a rendering function that takes an item promise, and return a DOM element\n         * @function WinJSContrib.Templates.interactive\n         * @param {string} uri path to template file\n         * @param {Object} args definition of interactive elements\n         * @returns {function} rendering function that takes an item promise, and return a DOM element\n         */\n        function interactive(uri, args) {\n            var template = WinJSContrib.Templates.get(uri);\n            if (template) {\n                return WinJSContrib.Templates.makeInteractive(template, args);\n            }\n            else {\n                throw { message: 'template not found for ' + uri };\n            }\n        }\n        Templates.interactive = interactive;\n        /**\n         * generate a rendering function that takes an item promise, and return a DOM element\n         * @function WinJSContrib.Templates.get\n         * @param {WinJS.Binding.Template} template template object\n         * @param {Object} args definition of interactive elements\n         * @returns {function} rendering function that takes an item promise, and return a DOM element\n         */\n        function makeInteractive(template, args) {\n            return function (itemPromise) {\n                return itemPromise.then(function (item) {\n                    return template.render(item).then(function (rendered) {\n                        if (args.tap) {\n                            for (var n in args.tap) {\n                                var elt = rendered.querySelector(n);\n                                WinJSContrib.UI.tap(elt, function (arg) {\n                                    args.tap[n](arg, item);\n                                });\n                            }\n                        }\n                        if (args.click) {\n                            for (var n in args.click) {\n                                var elt = rendered.querySelector(n);\n                                elt.onclick = function (arg) {\n                                    args.click[n](arg, item);\n                                };\n                            }\n                        }\n                        return rendered;\n                    });\n                });\n            };\n        }\n        Templates.makeInteractive = makeInteractive;\n    })(Templates = WinJSContrib.Templates || (WinJSContrib.Templates = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var UI;\n    (function (UI) {\n        UI.Application = {};\n        /**\n         * indicate if fragment should not look for resources when building control\n         * @field WinJSContrib.UI.disableAutoResources\n         * @type {boolean}\n         */\n        UI.disableAutoResources = false;\n        /**\n         * Calculate offset of element relative to parent element. If parent parameter is null, offset is relative to document\n         * @function WinJSContrib.UI.offsetFrom\n         * @param {HTMLElement} element element to evaluate\n         * @param {HTMLElement} parent reference of offset\n         */\n        function offsetFrom(element, parent) {\n            var xPosition = 0;\n            var yPosition = 0;\n            var w = element.clientWidth;\n            var h = element.clientHeight;\n            while (element && element != parent) {\n                xPosition += (element.offsetLeft - element.scrollLeft + element.clientLeft);\n                yPosition += (element.offsetTop - element.scrollTop + element.clientTop);\n                element = element.offsetParent;\n            }\n            return { x: xPosition, y: yPosition, width: w, height: h };\n        }\n        UI.offsetFrom = offsetFrom;\n        var EventTracker = (function () {\n            /**\n             * @class WinJSContrib.UI.EventTracker\n             * @classdesc object to register and release events from addEventListener or bind\n             */\n            function EventTracker() {\n                this.events = [];\n            }\n            /**\n             * register an event from an object\n             * @function WinJSContrib.UI.EventTracker.prototype.addEvent\n             * @param {Object} e object containing addEventListener\n             * @param {string} eventName name of the event\n             * @param {function} handler\n             * @param {boolean} capture\n             * @returns {function} function to call for unregistering the event\n             */\n            EventTracker.prototype.addEvent = function (e, eventName, handler, capture) {\n                var tracker = this;\n                e.addEventListener(eventName, handler, capture);\n                var unregister = function () {\n                    try {\n                        e.removeEventListener(eventName, handler);\n                        var idx = tracker.events.indexOf(unregister);\n                        if (idx >= 0) {\n                            tracker.events.splice(idx, 1);\n                        }\n                    }\n                    catch (exception) {\n                        console.error('unexpected error while releasing callback ' + exception.message);\n                    }\n                };\n                this.events.push(unregister);\n                return unregister;\n            };\n            /**\n             * register binding event\n             * @function WinJSContrib.UI.EventTracker.prototype.addBinding\n             * @param {Object} e object containing bind method\n             * @param {string} eventName name of the binding event\n             * @param {function} handler\n             */\n            EventTracker.prototype.addBinding = function (e, eventName, handler) {\n                e.bind(eventName, handler);\n                var unregister = function () {\n                    e.unbind(eventName, handler);\n                };\n                this.events.push(unregister);\n                return unregister;\n            };\n            /**\n             * release all registered events\n             * @function WinJSContrib.UI.EventTracker.prototype.dispose\n             */\n            EventTracker.prototype.dispose = function () {\n                for (var i = 0; i < this.events.length; i++) {\n                    this.events[i]();\n                }\n                this.events = [];\n            };\n            return EventTracker;\n        })();\n        UI.EventTracker = EventTracker;\n        /**\n         * open all appbars\n         * @function WinJSContrib.UI.appbarsOpen\n         */\n        function appbarsOpen() {\n            var res = document.querySelectorAll('div[data-win-control=\"WinJS.UI.AppBar\"],div[data-win-control=\"WinJS.UI.NavBar\"]');\n            if (res && res.length) {\n                for (var i = 0; i < res.length; i++) {\n                    var e = res[i];\n                    if (e.winControl) {\n                        e.winControl.show();\n                    }\n                }\n            }\n        }\n        UI.appbarsOpen = appbarsOpen;\n        /**\n         * close all appbars\n         * @function WinJSContrib.UI.appbarsClose\n         */\n        function appbarsClose() {\n            var res = document.querySelectorAll('div[data-win-control=\"WinJS.UI.AppBar\"],div[data-win-control=\"WinJS.UI.NavBar\"]');\n            if (res && res.length) {\n                for (var i = 0; i < res.length; i++) {\n                    var e = res[i];\n                    if (e.winControl) {\n                        e.winControl.hide();\n                    }\n                }\n            }\n        }\n        UI.appbarsClose = appbarsClose;\n        /**\n         * disable all appbars\n         * @function WinJSContrib.UI.appbarsDisable\n         */\n        function appbarsDisable() {\n            var res = document.querySelectorAll('div[data-win-control=\"WinJS.UI.AppBar\"],div[data-win-control=\"WinJS.UI.NavBar\"]');\n            if (res && res.length) {\n                for (var i = 0; i < res.length; i++) {\n                    var e = res[i];\n                    if (e.winControl) {\n                        e.winControl.disabled = true;\n                    }\n                }\n            }\n        }\n        UI.appbarsDisable = appbarsDisable;\n        /**\n         * enable all appbars\n         * @function WinJSContrib.UI.appbarsEnable\n         */\n        function appbarsEnable() {\n            var elements = document.querySelectorAll('div[data-win-control=\"WinJS.UI.AppBar\"],div[data-win-control=\"WinJS.UI.NavBar\"]');\n            if (elements && elements.length) {\n                for (var i = 0, l = elements.length; i < l; i++) {\n                    var el = elements[i];\n                    if (el.winControl) {\n                        el.winControl.disabled = false;\n                    }\n                }\n            }\n        }\n        UI.appbarsEnable = appbarsEnable;\n        /**\n         * build a promise around element \"load\" event (work for all element with src property like images, iframes, ...)\n         * @function WinJSContrib.UI.elementLoaded\n         * @param {HTMLElement} element\n         * @param {string} url url used to feed \"src\" on element\n         * @returns {WinJS.Promise}\n         */\n        function elementLoaded(elt, url) {\n            return new WinJS.Promise(function (complete, error) {\n                function onerror(e) {\n                    elt.onload = undefined;\n                    elt.onerror = undefined;\n                    elt.onreadystatechange = undefined;\n                    error('element not loaded');\n                }\n                function onload(e) {\n                    elt.onload = undefined;\n                    elt.onerror = undefined;\n                    elt.onreadystatechange = undefined;\n                    complete({\n                        element: elt,\n                        url: url\n                    });\n                }\n                elt.onerror = onerror;\n                elt.onload = onload;\n                elt.onreadystatechange = onload;\n                if (elt.naturalWidth > 0) {\n                    onload(undefined);\n                }\n                elt.src = url;\n            });\n        }\n        UI.elementLoaded = elementLoaded;\n        /**\n         * Create a promise for getting an image object from url\n         * @function WinJSContrib.UI.loadImage\n         * @param {string} imgUrl url for the picture\n         * @returns {WinJS.Promise}\n         */\n        function loadImage(imgUrl) {\n            return new WinJS.Promise(function (complete, error) {\n                var image = new Image();\n                function onerror(e) {\n                    image.onload = undefined;\n                    image.onerror = undefined;\n                    error({ message: 'image not loaded : ' + imgUrl, path: imgUrl });\n                }\n                function onload(e) {\n                    image.onload = undefined;\n                    image.onerror = undefined;\n                    complete({\n                        element: image,\n                        url: imgUrl\n                    });\n                }\n                image.onerror = onerror;\n                image.onload = onload;\n                if (image.naturalWidth > 0) {\n                    onload(undefined);\n                }\n                image.src = imgUrl;\n            });\n        }\n        UI.loadImage = loadImage;\n        /**\n         * List all elements found after provided element\n         * @function WinJSContrib.UI.listElementsAfterMe\n         * @param {HTMLElement} elt target element\n         * @returns {Array} list of sibling elements\n         */\n        function listElementsAfterMe(elt) {\n            var res = [];\n            var passed = false;\n            if (elt.parentElement) {\n                var parent = elt.parentElement;\n                for (var i = 0; i < parent.children.length; i++) {\n                    if (parent.children[i] === elt) {\n                        passed = true;\n                    }\n                    else if (passed) {\n                        res.push(parent.children[i]);\n                    }\n                }\n            }\n            return res;\n        }\n        UI.listElementsAfterMe = listElementsAfterMe;\n        /**\n         * create an animation for removing an element from a list\n         * @function WinJSContrib.UI.removeElementAnimation\n         * @param {HTMLElement} element that will be removed\n         * @returns {WinJS.Promise}\n         */\n        function removeElementAnimation(elt) {\n            return new WinJS.Promise(function (complete, error) {\n                var remainings = WinJSContrib.UI.listElementsAfterMe(elt);\n                var anim = WinJS.UI.Animation.createDeleteFromListAnimation([\n                    elt\n                ], remainings);\n                elt.style.position = \"fixed\";\n                elt.style.opacity = '0';\n                anim.execute().done(function () {\n                    complete(elt);\n                });\n            });\n        }\n        UI.removeElementAnimation = removeElementAnimation;\n        function bindAction(el, element, control) {\n            el.classList.add('page-action');\n            var actionName = el.dataset.pageAction || el.getAttribute('tap');\n            var action = control[actionName];\n            if (action && typeof action === 'function') {\n                WinJSContrib.UI.tap(el, function (eltarg) {\n                    var p = WinJS.Promise.wrap();\n                    var actionArgs = eltarg.dataset.pageActionArgs || el.getAttribute('tap-args');\n                    if (actionArgs && typeof actionArgs == 'string') {\n                        var tmp = WinJSContrib.Utils.readValue(eltarg, actionArgs);\n                        p = WinJS.Promise.as(tmp).then(function (val) {\n                            if (typeof val === 'string') {\n                                try {\n                                    val = WinJS.UI.optionsParser(val, window);\n                                }\n                                catch (exception) {\n                                    return;\n                                }\n                            }\n                            return val;\n                        });\n                        if (tmp) {\n                            actionArgs = tmp;\n                        }\n                        else {\n                        }\n                    }\n                    return p.then(function () {\n                        return control[actionName].bind(control)({ elt: eltarg, args: actionArgs });\n                    });\n                });\n            }\n        }\n        /**\n         * setup declarative binding to parent control function. It looks for \"data-page-action\" attributes,\n         * and try to find a matching method on the supplyed control.\n         * You could add arguments with a \"page-action-args\" attribute. The argument can be an object or a function\n         * @function WinJSContrib.UI.bindPageActions\n         * @param {HTMLElement} element root node crawled for page actions\n         * @param {Object} control control owning functions to call\n         */\n        function bindPageActions(element, control) {\n            var elements = element.querySelectorAll('*[data-page-action], *[tap]');\n            if (elements && elements.length) {\n                for (var i = 0, l = elements.length; i < l; i++) {\n                    var el = elements[i];\n                    bindAction(el, element, control);\n                }\n            }\n        }\n        UI.bindPageActions = bindPageActions;\n        function bindLink(el, element) {\n            el.classList.add('page-link');\n            var applink = el.getAttribute('applink');\n            var target = el.dataset.pageLink || el.getAttribute('linkto');\n            if (target && target.indexOf('/') < 0) {\n                var tmp = WinJSContrib.Utils.readProperty(window, target);\n                if (tmp) {\n                    target = tmp;\n                }\n            }\n            if (target) {\n                var options = el.dataset.pageActionOptions || el.getAttribute('tap-options');\n                if (options) {\n                    try {\n                        options = WinJS.UI.optionsParser(options, window);\n                    }\n                    catch (exception) {\n                        return;\n                    }\n                }\n                WinJSContrib.UI.tap(el, function (eltarg) {\n                    var p = WinJS.Promise.wrap();\n                    var actionArgs = eltarg.dataset.pageActionArgs || el.getAttribute('linkto-args');\n                    if (actionArgs && typeof actionArgs == 'string') {\n                        var tmp = WinJSContrib.Utils.readValue(eltarg, actionArgs);\n                        p = WinJS.Promise.as(tmp).then(function (val) {\n                            if (typeof val === 'string') {\n                                try {\n                                    val = WinJS.UI.optionsParser(val, window);\n                                }\n                                catch (exception) {\n                                }\n                            }\n                            return val;\n                        });\n                    }\n                    return p.then(function (actionArgs) {\n                        if (!applink && WinJSContrib.UI.parentNavigator && WinJSContrib.UI.parentNavigator(eltarg)) {\n                            var nav = WinJSContrib.UI.parentNavigator(eltarg);\n                            return nav.navigate(target, actionArgs);\n                        }\n                        else {\n                            return WinJS.Navigation.navigate(target, actionArgs);\n                        }\n                    });\n                }, options);\n            }\n        }\n        /**\n         * setup declarative binding to page link. It looks for \"data-page-link\" attributes.\n         * If any the content of the attribute point toward a page. clicking that element will navigate to that page.\n         * You could add arguments with a \"page-action-args\" attribute. The argument can be an object or a function\n         * @function WinJSContrib.UI.bindPageLinks\n         * @param {HTMLElement} element root node crawled for page actions\n         */\n        function bindPageLinks(element) {\n            var elements = element.querySelectorAll('*[data-page-link], *[linkto]');\n            if (elements && elements.length) {\n                for (var i = 0, l = elements.length; i < l; i++) {\n                    var el = elements[i];\n                    bindLink(el, element);\n                }\n            }\n        }\n        UI.bindPageLinks = bindPageLinks;\n        function parentNavigator(element) {\n            var current = element.parentNode;\n            while (current) {\n                if (current.mcnNavigator) {\n                    return current.winControl;\n                }\n                current = current.parentNode;\n            }\n        }\n        UI.parentNavigator = parentNavigator;\n        function bindMember(el, element, control) {\n            el.classList.add('page-member');\n            var memberName = el.dataset.pageMember || el.getAttribute('member');\n            if (!memberName)\n                memberName = el.id;\n            if (memberName && !control[memberName]) {\n                control[memberName] = el;\n                if (el.winControl) {\n                    control[memberName] = el.winControl;\n                }\n            }\n        }\n        /**\n         * Add this element or control as member to the control. It looks for \"data-page-member\" attributes. If attribute is empty, it tooks the element id as member name.\n         * @function WinJSContrib.UI.bindMembers\n         * @param {HTMLElement} element root node crawled for page actions\n         * @param {Object} control control owning functions to call\n         */\n        function bindMembers(element, control) {\n            var elements = element.querySelectorAll('*[data-page-member], *[member]');\n            if (elements && elements.length) {\n                for (var i = 0, l = elements.length; i < l; i++) {\n                    var el = elements[i];\n                    bindMember(el, element, control);\n                }\n            }\n        }\n        UI.bindMembers = bindMembers;\n        /**\n         * setup declarative binding to parent control function and to navigation links. It internally invoke both {@link WinJSContrib.UI.bindPageActions} and {@link WinJSContrib.UI.bindPageLinks}\n         * @function WinJSContrib.UI.bindActions\n         * @param {HTMLElement} element root node crawled for page actions\n         * @param {Object} control control owning functions to call\n         */\n        function bindActions(element, control) {\n            WinJSContrib.UI.bindPageActions(element, control);\n            WinJSContrib.UI.bindPageLinks(element);\n        }\n        UI.bindActions = bindActions;\n        /**\n         * Trigger events on media queries. This class is usefull as a component for other controls to change some properties based on media queries\n         * @class WinJSContrib.UI.MediaTrigger\n         * @param {Object} items object containing one property for each query\n         * @param {Object} linkedControl control linked to media trigger\n         */\n        var MediaTrigger = (function () {\n            function MediaTrigger(items, linkedControl) {\n                var ctrl = this;\n                ctrl.queries = [];\n                ctrl.linkedControl = linkedControl;\n                for (var name in items) {\n                    var e = items[name];\n                    if (e.query) {\n                        ctrl.registerMediaEvent(name, e.query, e);\n                    }\n                }\n            }\n            /**\n             * @function WinJSContrib.UI.MediaTrigger.prototype.dispose\n             * release media trigger\n             */\n            MediaTrigger.prototype.dispose = function () {\n                var ctrl = this;\n                ctrl.linkedControl = null;\n                this.queries.forEach(function (q) {\n                    q.dispose();\n                });\n            };\n            /**\n             * register an event from a media query\n             * @function WinJSContrib.UI.MediaTrigger.prototype.registerMediaEvent\n             * @param {string} name event name\n             * @param {string} query media query\n             * @param {Object} data data associated with this query\n             */\n            MediaTrigger.prototype.registerMediaEvent = function (name, query, data) {\n                var ctrl = this;\n                var mq = window.matchMedia(query);\n                var internalQuery = {\n                    name: name,\n                    query: query,\n                    data: data,\n                    mq: mq,\n                    dispose: null\n                };\n                var f = function (arg) {\n                    if (arg.matches) {\n                        ctrl._mediaEvent(arg, internalQuery);\n                    }\n                };\n                mq.addListener(f);\n                internalQuery.dispose = function () {\n                    mq.removeListener(f);\n                };\n                ctrl.queries.push(internalQuery);\n            };\n            MediaTrigger.prototype._mediaEvent = function (arg, query) {\n                var ctrl = this;\n                if (ctrl.linkedControl) {\n                    WinJS.UI.setOptions(ctrl.linkedControl, query.data);\n                }\n                ctrl.dispatchEvent('media', query);\n            };\n            /**\n             * @function WinJSContrib.UI.MediaTrigger.prototype.check\n             * Check all registered queries\n             */\n            MediaTrigger.prototype.check = function () {\n                var ctrl = this;\n                ctrl.queries.forEach(function (q) {\n                    var mq = window.matchMedia(q.query);\n                    if (mq.matches) {\n                        ctrl._mediaEvent({ matches: true }, q);\n                    }\n                });\n            };\n            /**\n             * Adds an event listener to the control.\n             * @function WinJSContrib.UI.MediaTrigger.prototype.addEventListener\n             * @param type The type (name) of the event.\n             * @param listener The listener to invoke when the event gets raised.\n             * @param useCapture If true, initiates capture, otherwise false.\n            **/\n            MediaTrigger.prototype.addEventListener = function (type, listener, useCapture) {\n            };\n            /**\n             * Raises an event of the specified type and with the specified additional properties.\n             * @function WinJSContrib.UI.MediaTrigger.prototype.dispatchEvent\n             * @param type The type (name) of the event.\n             * @param eventProperties The set of additional properties to be attached to the event object when the event is raised.\n             * @returns true if preventDefault was called on the event.\n            **/\n            MediaTrigger.prototype.dispatchEvent = function (type, eventProperties) {\n                return false;\n            };\n            /**\n             * Removes an event listener from the control.\n             * @function WinJSContrib.UI.MediaTrigger.prototype.removeEventListener\n             * @param type The type (name) of the event.\n             * @param listener The listener to remove.\n             * @param useCapture true if capture is to be initiated, otherwise false.\n            **/\n            MediaTrigger.prototype.removeEventListener = function (type, listener, useCapture) { };\n            return MediaTrigger;\n        })();\n        UI.MediaTrigger = MediaTrigger;\n        WinJS.Class.mix(WinJSContrib.UI.MediaTrigger, WinJS.Utilities.eventMixin);\n        /**\n         * register navigation related events like hardware backbuttons. This method keeps track of previously registered navigation handlers\n         *  and disable them until the latests is closed, enablinh multi-level navigation.\n         * @function WinJSContrib.UI.registerNavigationEvents\n         * @param {Object} control control taking ownership of navigation handlers\n         * @param {function} callback callback to invoke when \"back\" is requested\n         * @returns {function} function to call for releasing navigation handlers\n         */\n        var registeredNavigationStack = [];\n        function registerNavigationEvents(control, callback) {\n            var locked = [];\n            var registration = { control: control, callback: callback };\n            registeredNavigationStack.push(registration);\n            //control.navLocks = control.navLocks || [];\n            //control.navLocks.isActive = true;\n            var backhandler = function (arg) {\n                var idx = registeredNavigationStack.indexOf(registration);\n                if (idx === registeredNavigationStack.length - 1) {\n                    registration.callback.bind(registration.control)(arg);\n                    idx--;\n                    while (idx >= 0 && !arg.handled) {\n                        var tmp = registeredNavigationStack[idx];\n                        tmp.callback.bind(tmp.control)(arg);\n                        idx--;\n                    }\n                }\n                //if (!control.navLocks || control.navLocks.length === 0) {\n                //    callback.bind(control)(arg);\n                //}\n            };\n            //var navcontrols = document.querySelectorAll('.mcn-navigation-ctrl');\n            //for (var i = 0; i < navcontrols.length; i++) {\n            //    var navigationCtrl = (<any>navcontrols[i]).winControl;\n            //    if (navigationCtrl && navigationCtrl != control) {\n            //        navigationCtrl.navLocks = navigationCtrl.navLocks || [];\n            //        if (navigationCtrl.navLocks.isActive && (!navigationCtrl.navLocks.length || navigationCtrl.navLocks.indexOf(control) < 0)) {\n            //            navigationCtrl.navLocks.push(control);\n            //            locked.push(navigationCtrl);\n            //        }\n            //    }\n            //}\n            function cancelNavigation(args) {\n                //this.eventTracker.addEvent(nav, 'beforenavigate', this._beforeNavigate.bind(this));\n                var p = new WinJS.Promise(function (c) { });\n                args.detail.setPromise(p);\n                //setImmediate(function () {\n                p.cancel();\n                //});\n            }\n            WinJS.Navigation.addEventListener('beforenavigate', cancelNavigation);\n            if (window.Windows && window.Windows.Phone)\n                window.Windows.Phone.UI.Input.HardwareButtons.addEventListener(\"backpressed\", backhandler);\n            else\n                document.addEventListener(\"backbutton\", backhandler);\n            var keypress = function (args) {\n                if (args.key === \"Esc\" || args.key === \"Backspace\") {\n                    backhandler(args);\n                }\n            };\n            document.body.addEventListener('keypress', keypress);\n            if (WinJSContrib.UI.Application && WinJSContrib.UI.Application.navigator)\n                WinJSContrib.UI.Application.navigator.addLock();\n            return function () {\n                if (WinJSContrib.UI.Application && WinJSContrib.UI.Application.navigator)\n                    WinJSContrib.UI.Application.navigator.removeLock();\n                //control.navLocks.isActive = false;\n                //locked.forEach(function (navigationCtrl) {\n                //    var idx = navigationCtrl.navLocks.indexOf(control);\n                //    if (idx >= 0)\n                //        navigationCtrl.navLocks.splice(idx, 1);\n                //});\n                var idx = registeredNavigationStack.indexOf(registration);\n                registeredNavigationStack.splice(idx, 1);\n                document.body.removeEventListener('keypress', keypress);\n                WinJS.Navigation.removeEventListener('beforenavigate', cancelNavigation);\n                if (window.Windows && window.Windows.Phone)\n                    window.Windows.Phone.UI.Input.HardwareButtons.removeEventListener(\"backpressed\", backhandler);\n                else\n                    document.removeEventListener(\"backbutton\", backhandler);\n            };\n        }\n        UI.registerNavigationEvents = registerNavigationEvents;\n        /**\n         * remove tap behavior\n         * @function WinJSContrib.UI.untap\n         * @param {HtmlElement} element element to clean\n         */\n        function untap(element) {\n            if (!element)\n                return;\n            if (element.mcnTapTracking) {\n                element.mcnTapTracking.dispose();\n                element.mcnTapTracking = null;\n            }\n        }\n        UI.untap = untap;\n        /**\n         * remove tap behavior from all childs\n         * @function WinJSContrib.UI.untapAll\n         * @param {HtmlElement} element element to clean\n         */\n        function untapAll(element) {\n            if (!element)\n                return;\n            var taps = element.querySelectorAll('.tap');\n            for (var i = 0, l = taps.length; i < l; i++) {\n                untap(taps[i]);\n            }\n        }\n        UI.untapAll = untapAll;\n        UI.defaultTapBehavior = {\n            animDown: WinJS.UI.Animation.pointerDown,\n            animUp: WinJS.UI.Animation.pointerUp,\n            disableAnimation: false,\n            awaitAnim: false\n        };\n        /**\n         * add tap behavior to an element, tap manages quirks like click delay, visual feedback, etc\n         * @function WinJSContrib.UI.tap\n         * @param {HtmlElement} element element to make \"tappable\"\n         * @param {function} callback callback function invoked on tap\n         * @param {Object} options tap options\n         */\n        function tap(element, callback, options) {\n            if (!element)\n                return;\n            var ptDown = function (event) {\n                var elt = event.currentTarget || event.target;\n                var tracking = elt.mcnTapTracking;\n                if (tracking && (event.button === undefined || event.button === 0 || (tracking.allowRickClickTap && event.button === 2))) {\n                    if (tracking.lock) {\n                        if (event.pointerId && event.currentTarget.setPointerCapture)\n                            event.currentTarget.setPointerCapture(event.pointerId);\n                        event.stopPropagation();\n                        event.preventDefault();\n                    }\n                    WinJS.Utilities.addClass(elt, 'tapped');\n                    if (event.changedTouches) {\n                        tracking.pointerdown = { x: event.changedTouches[0].clientX, y: event.changedTouches[0].clientY };\n                    }\n                    else {\n                        tracking.pointerdown = { x: event.clientX, y: event.clientY };\n                    }\n                    tracking.animDown(event.currentTarget);\n                    if (tracking.tapOnDown) {\n                        tracking.callback(elt, event);\n                    }\n                }\n            };\n            var ptOut = function (event) {\n                var elt = event.currentTarget || event.target;\n                var tracking = elt.mcnTapTracking;\n                if (tracking && tracking.pointerdown) {\n                    WinJS.Utilities.removeClass(elt, 'tapped');\n                    if (event.pointerId && elt.releasePointerCapture) {\n                        try {\n                            elt.releasePointerCapture(event.pointerId);\n                        }\n                        catch (exception) {\n                            console.error(exception);\n                        }\n                    }\n                    if (!tracking.disableAnimation)\n                        tracking.animUp(event.currentTarget);\n                }\n            };\n            var ptUp = function (event) {\n                var elt = event.currentTarget || event.target;\n                var tracking = elt.mcnTapTracking;\n                if (tracking && (event.button === undefined || event.button === 0 || (tracking.allowRickClickTap && event.button === 2))) {\n                    if (elt.releasePointerCapture) {\n                        try {\n                            elt.releasePointerCapture(event.pointerId);\n                        }\n                        catch (exception) {\n                            console.error(exception);\n                        }\n                    }\n                    if (tracking && !tracking.tapOnDown) {\n                        event.stopPropagation();\n                        var resolveTap = function () {\n                            if (tracking && tracking.pointerdown) {\n                                if (event.changedTouches) {\n                                    var dX = Math.abs(tracking.pointerdown.x - event.changedTouches[0].clientX);\n                                    var dY = Math.abs(tracking.pointerdown.y - event.changedTouches[0].clientY);\n                                }\n                                else {\n                                    var dX = Math.abs(tracking.pointerdown.x - event.clientX);\n                                    var dY = Math.abs(tracking.pointerdown.y - event.clientY);\n                                }\n                                if (tracking.callback && dX < 15 && dY < 15) {\n                                    event.stopImmediatePropagation();\n                                    event.stopPropagation();\n                                    event.preventDefault();\n                                    var res = tracking.callback(elt, event);\n                                    if (WinJS.Promise.is(res)) {\n                                        elt.disabled = true;\n                                        WinJS.Utilities.addClass(elt, 'working');\n                                        res.then(function () {\n                                            elt.disabled = false;\n                                            WinJS.Utilities.removeClass(elt, 'working');\n                                        });\n                                    }\n                                }\n                                if (tracking && tracking.pointerdown)\n                                    tracking.pointerdown = undefined;\n                            }\n                        };\n                        if (tracking.awaitAnim) {\n                            tracking.animUp(elt).done(resolveTap);\n                        }\n                        else {\n                            tracking.animUp(elt);\n                            resolveTap();\n                        }\n                    }\n                    WinJS.Utilities.removeClass(elt, 'tapped');\n                }\n            };\n            if (!options) {\n                var attroptions = element.getAttribute('tap-options');\n                if (attroptions) {\n                    try {\n                        options = WinJS.UI.optionsParser(attroptions, window);\n                    }\n                    catch (exception) {\n                        return;\n                    }\n                }\n            }\n            var opt = options || {};\n            if (element.mcnTapTracking) {\n                element.mcnTapTracking.dispose();\n            }\n            WinJS.Utilities.addClass(element, 'tap');\n            element.mcnTapTracking = element.mcnTapTracking || {};\n            element.mcnTapTracking.eventTracker = new WinJSContrib.UI.EventTracker();\n            element.mcnTapTracking.disableAnimation = opt.disableAnimation || UI.defaultTapBehavior.disableAnimation;\n            if (element.mcnTapTracking.disableAnimation) {\n                element.mcnTapTracking.animDown = function () { return WinJS.Promise.wrap(); };\n                element.mcnTapTracking.animUp = function () { return WinJS.Promise.wrap(); };\n            }\n            else {\n                element.mcnTapTracking.animDown = opt.animDown || UI.defaultTapBehavior.animDown;\n                element.mcnTapTracking.animUp = opt.animUp || UI.defaultTapBehavior.animUp;\n            }\n            element.mcnTapTracking.element = element;\n            element.mcnTapTracking.callback = callback;\n            element.mcnTapTracking.lock = opt.lock;\n            element.mcnTapTracking.awaitAnim = opt.awaitAnim || UI.defaultTapBehavior.awaitAnim;\n            element.mcnTapTracking.tapOnDown = opt.tapOnDown;\n            element.mcnTapTracking.pointerModel = 'none';\n            element.mcnTapTracking.dispose = function () {\n                WinJS.Utilities.removeClass(element, 'tap');\n                this.eventTracker.dispose();\n                element.mcnTapTracking = null;\n                element = null;\n            };\n            if (element.onpointerdown !== undefined) {\n                element.mcnTapTracking.pointerModel = 'pointers';\n                element.mcnTapTracking.eventTracker.addEvent(element, 'pointerdown', ptDown);\n                element.mcnTapTracking.eventTracker.addEvent(element, 'pointerout', ptOut);\n                element.mcnTapTracking.eventTracker.addEvent(element, 'pointerup', ptUp);\n            }\n            else if (window.Touch && !opt.noWebkitTouch) {\n                element.mcnTapTracking.pointerModel = 'touch';\n                element.mcnTapTracking.eventTracker.addEvent(element, 'touchstart', function (arg) {\n                    element.mcnTapTracking.cancelMouse = true;\n                    ptDown(arg);\n                });\n                element.mcnTapTracking.eventTracker.addEvent(element, 'touchcancel', function (arg) {\n                    setTimeout(function () {\n                        element.mcnTapTracking.cancelMouse = false;\n                    }, 1000);\n                    ptOut(arg);\n                });\n                element.mcnTapTracking.eventTracker.addEvent(element, 'touchend', function (arg) {\n                    setTimeout(function () {\n                        element.mcnTapTracking.cancelMouse = false;\n                    }, 1000);\n                    ptUp(arg);\n                });\n                element.mcnTapTracking.eventTracker.addEvent(element, 'mousedown', function (arg) {\n                    if (!element.mcnTapTracking.cancelMouse)\n                        ptDown(arg);\n                });\n                element.mcnTapTracking.eventTracker.addEvent(element, 'mouseleave', function (arg) {\n                    ptOut(arg);\n                });\n                element.mcnTapTracking.eventTracker.addEvent(element, 'mouseup', function (arg) {\n                    if (!element.mcnTapTracking.cancelMouse)\n                        ptUp(arg);\n                    else\n                        ptOut(arg);\n                });\n            }\n            else {\n                element.mcnTapTracking.pointerModel = 'mouse';\n                element.mcnTapTracking.eventTracker.addEvent(element, 'mousedown', ptDown);\n                element.mcnTapTracking.eventTracker.addEvent(element, 'mouseleave', ptOut);\n                element.mcnTapTracking.eventTracker.addEvent(element, 'mouseup', ptUp);\n            }\n        }\n        UI.tap = tap;\n        /**\n         * return a promise completed after css transition on the element is ended\n         * @function WinJSContrib.UI.afterTransition\n         * @param {HtmlElement} element element to watch\n         * @param {number} timeout timeout\n         */\n        function afterTransition(element, timeout) {\n            var timeOutRef = null;\n            return new WinJS.Promise(function (complete, error) {\n                var onaftertransition = function (event) {\n                    if (event.srcElement === element) {\n                        close();\n                    }\n                };\n                var close = function () {\n                    clearTimeout(timeOutRef);\n                    element.removeEventListener(\"transitionend\", onaftertransition, false);\n                    complete();\n                };\n                element.addEventListener(\"transitionend\", onaftertransition, false);\n                timeOutRef = setTimeout(close, timeout || 1000);\n            });\n        }\n        UI.afterTransition = afterTransition;\n        /**\n         * Utility class for building DOM elements through code with a fluent API\n         * @class WinJSContrib.UI.FluentDOM\n         * @param {string} nodeType type of DOM node (ex: 'DIV')\n         * @param className css classes\n         * @param parentElt parent DOM element\n         * @param {WinJSContrib.UI.FluentDOM} parent parent FluentDOM\n         * @example\n         * var elt = new WinJSContrib.UI.FluentDOM('DIV', 'item-content')\n         *    .text(item.title)\n         *    .display('none')\n         *    .element;\n         */\n        var FluentDOM = (function () {\n            function FluentDOM(nodeType, className, parentElt, parent) {\n                this.element = document.createElement(nodeType);\n                if (className)\n                    this.element.className = className;\n                if (parentElt)\n                    parentElt.appendChild(this.element);\n                this.parent = parent;\n                this.childs = [];\n                if (parent) {\n                    parent.childs.push(this);\n                }\n            }\n            FluentDOM.for = function (element) {\n                var res = new FluentDOM(null);\n                res.element = element;\n                return res;\n            };\n            FluentDOM.fragment = function () {\n                var res = new FluentDOM(null);\n                res.element = document.createDocumentFragment();\n                return res;\n            };\n            Object.defineProperty(FluentDOM.prototype, \"control\", {\n                get: function () {\n                    return this.element.winControl;\n                },\n                enumerable: true,\n                configurable: true\n            });\n            /**\n             * Add a css class\n             * @function WinJSContrib.UI.FluentDOM.prototype.addClass\n             * @param classname css class\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.addClass = function (classname) {\n                this.element.classList.add(classname);\n                return this;\n            };\n            /**\n             * set className\n             * @function WinJSContrib.UI.FluentDOM.prototype.className\n             * @param classname css classes\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.className = function (classname) {\n                this.element.className = classname;\n                return this;\n            };\n            /**\n             * set opacity\n             * @function WinJSContrib.UI.FluentDOM.prototype.opacity\n             * @param opacity opacity\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.opacity = function (opacity) {\n                this.element.style.opacity = opacity;\n                return this;\n            };\n            /**\n             * set display\n             * @function WinJSContrib.UI.FluentDOM.prototype.display\n             * @param display display\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.display = function (display) {\n                this.element.style.display = display;\n                return this;\n            };\n            /**\n             * set display 'none'\n             * @function WinJSContrib.UI.FluentDOM.prototype.hide\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.hide = function () {\n                this.element.style.display = 'none';\n                return this;\n            };\n            /**\n             * set visibility\n             * @function WinJSContrib.UI.FluentDOM.prototype.visibility\n             * @param visibility visibility\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.visibility = function (visibility) {\n                this.element.style.visibility = visibility;\n                return this;\n            };\n            /**\n             * set textContent\n             * @function WinJSContrib.UI.FluentDOM.prototype.text\n             * @param text text\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.text = function (text) {\n                this.element.textContent = text;\n                return this;\n            };\n            /**\n             * set innerHTML\n             * @function WinJSContrib.UI.FluentDOM.prototype.html\n             * @param text text\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.html = function (text) {\n                this.element.innerHTML = text;\n                return this;\n            };\n            /**\n             * set attribute\n             * @function WinJSContrib.UI.FluentDOM.prototype.attr\n             * @param name attribute name\n             * @param val attribute value\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.attr = function (name, val) {\n                this.element.setAttribute(name, val);\n                return this;\n            };\n            /**\n             * set style property\n             * @function WinJSContrib.UI.FluentDOM.prototype.style\n             * @param name attribute name\n             * @param val attribute value\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.style = function (name, val) {\n                this.element.style[name] = val;\n                return this;\n            };\n            /**\n             * set style property\n             * @function WinJSContrib.UI.FluentDOM.prototype.style\n             * @param name attribute name\n             * @param val attribute value\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.styles = function (obj) {\n                var st = this.element.style;\n                var keys = Object.keys(obj);\n                keys.forEach(function (k) {\n                    st[k] = obj[k];\n                });\n                return this;\n            };\n            /**\n             * append element to another DOM element\n             * @function WinJSContrib.UI.FluentDOM.prototype.appendTo\n             * @param elt parent element\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.appendTo = function (elt) {\n                elt.appendChild(this.element);\n                return this;\n            };\n            /**\n             * add tap behavior\n             * @function WinJSContrib.UI.FluentDOM.prototype.tap\n             * @param callback tap callback\n             * @param options tap options\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.tap = function (callback, options) {\n                WinJSContrib.UI.tap(this.element, callback, options);\n                return this;\n            };\n            /**\n             * create a child FluentDOM and append it to current\n             * @function WinJSContrib.UI.FluentDOM.prototype.append\n             * @param nodeType child node type\n             * @param className css classes\n             * @param callback callback receiving the new FluentDOM as an argument\n             * @returns {WinJSContrib.UI.FluentDOM} current instance (for method chaining)\n             */\n            FluentDOM.prototype.append = function (nodeType, className, callback) {\n                var child = new FluentDOM(nodeType, className, this.element, this);\n                if (callback) {\n                    callback(child);\n                }\n                return this;\n            };\n            /**\n             * create a child FluentDOM and append it to current\n             * @function WinJSContrib.UI.FluentDOM.prototype.createChild\n             * @param nodeType child node type\n             * @param className css classes\n             * @returns {WinJSContrib.UI.FluentDOM} child FluentDOM\n             */\n            FluentDOM.prototype.createChild = function (nodeType, className) {\n                var child = new FluentDOM(nodeType, className, this.element, this);\n                return child;\n            };\n            /**\n             * create a WinJS control\n             * @function WinJSContrib.UI.FluentDOM.prototype.ctrl\n             * @param ctrl constructor or full name of the control\n             * @param options control options\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.ctrl = function (ctrl, options) {\n                var ctor = ctrl;\n                if (typeof ctrl === 'string')\n                    ctor = WinJSContrib.Utils.readProperty(window, ctrl);\n                if (ctor) {\n                    new ctor(this.element, options);\n                }\n                return this;\n            };\n            return FluentDOM;\n        })();\n        UI.FluentDOM = FluentDOM;\n    })(UI = WinJSContrib.UI || (WinJSContrib.UI = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\nvar __global = this;\nvar profiler = __global.msWriteProfilerMark || function () { };\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var UI;\n    (function (UI) {\n        var Pages;\n        (function (Pages) {\n            /**\n             * List of mixins to apply to each fragment managed by WinJS Contrib (through navigator or by calling explicitely {@link WinJSContrib.UI.Pages.fragmentMixin}).\n             * @field WinJSContrib.UI.Pages.defaultFragmentMixins\n             * @type {Array}\n             */\n            Pages.defaultFragmentMixins = [{\n                    $: function (selector) {\n                        return $(selector, this.element || this._element);\n                    },\n                    q: function (selector) {\n                        if (!this.element)\n                            return;\n                        return this.element.querySelector(selector);\n                    },\n                    qAll: function (selector) {\n                        if (!this.element)\n                            return;\n                        var res = this.element.querySelectorAll(selector);\n                        if (res && !res.forEach) {\n                            res = [].slice.call(res);\n                        }\n                        return res;\n                    },\n                },\n                {\n                    dispose: function () {\n                        if (this._promises) {\n                            this.cancelPromises();\n                            this._promises = null;\n                        }\n                    },\n                    promises: {\n                        configurable: true,\n                        get: function () {\n                            if (!this._promises)\n                                this._promises = [];\n                            return this._promises;\n                        }\n                    },\n                    addPromise: function (prom) {\n                        this.promises.push(prom);\n                        return prom;\n                    },\n                    cancelPromises: function () {\n                        var page = this;\n                        if (page.promises) {\n                            for (var i = 0; i < page.promises.length; i++) {\n                                if (page.promises[i]) {\n                                    page.promises[i].cancel();\n                                }\n                            }\n                            page.promises = [];\n                        }\n                    }\n                },\n                {\n                    dispose: function () {\n                        if (this._eventTracker) {\n                            this._eventTracker.dispose();\n                            this._eventTracker = null;\n                        }\n                    },\n                    eventTracker: {\n                        configurable: true,\n                        get: function () {\n                            if (!this._eventTracker)\n                                this._eventTracker = new WinJSContrib.UI.EventTracker();\n                            return this._eventTracker;\n                        }\n                    }\n                }];\n            function broadcast(ctrl, element, eventName, args, before, after) {\n                var promises = [];\n                if (before)\n                    promises.push(WinJS.Promise.as(before.apply(ctrl, args)));\n                var query = element.querySelectorAll(\".mcn-layout-ctrl\");\n                if (query && query.length) {\n                    var index = 0;\n                    var length = query.length;\n                    while (index < length) {\n                        var childctrl = query[index];\n                        if (childctrl) {\n                            var event = childctrl.winControl[eventName];\n                            if (event) {\n                                if (childctrl.winControl.pageLifeCycle) {\n                                    promises.push(childctrl.winControl.pageLifeCycle.steps.layout.promise);\n                                }\n                                else {\n                                    promises.push(WinJS.Promise.as(event.apply(childctrl.winControl, args)));\n                                }\n                            }\n                        }\n                        // Skip descendants\n                        if (childctrl && childctrl.winControl && childctrl.winControl.pageLifeCycle) {\n                            index += childctrl.querySelectorAll(\".mcn-fragment, .mcn-layout-ctrl\").length + 1;\n                            childctrl.winControl.__checkLayout();\n                        }\n                        else {\n                            index += 1;\n                        }\n                    }\n                    //if (after)\n                    //    promises.push(WinJS.Promise.as(after.apply(ctrl, args)));\n                    return WinJS.Promise.join(promises).then(function () {\n                        if (after)\n                            return WinJS.Promise.as(after.apply(ctrl, args));\n                    });\n                }\n                else {\n                    if (after)\n                        return WinJS.Promise.as(after.apply(ctrl, args));\n                    return WinJS.Promise.wrap();\n                }\n            }\n            /**\n             * render a html fragment with winjs contrib pipeline and properties, and add WinJS Contrib page events.\n             * @function WinJSContrib.UI.Pages.renderFragment\n             * @param {HTMLElement} container element that will contain the fragment\n             * @param {string} location url for the fragment\n             * @param {Object} args arguments to the fragment\n             * @param {Object} options rendering options\n             */\n            function renderFragment(container, location, args, options) {\n                var fragmentCompleted;\n                var fragmentError;\n                options = options || {};\n                var element = document.createElement(\"div\");\n                element.setAttribute(\"dir\", __global.getComputedStyle(element, null).direction);\n                element.style.opacity = '0';\n                container.appendChild(element);\n                var fragmentPromise = new WinJS.Promise(function (c, e) { fragmentCompleted = c; fragmentError = e; });\n                var parented = options.parented ? WinJS.Promise.as(options.parented) : null;\n                var layoutCtrls = [];\n                var pageConstructor = WinJS.UI.Pages.get(location);\n                function preparePageControl(elementCtrl) {\n                    if (options.getFragmentElement) {\n                        options.getFragmentElement(elementCtrl);\n                    }\n                    if (args && args.injectToPage) {\n                        WinJSContrib.Utils.inject(elementCtrl, args.injectToPage);\n                    }\n                    elementCtrl.navigationState = { location: location, state: args };\n                    if (options.oncreate) {\n                        options.oncreate(elementCtrl.element, args);\n                    }\n                    if (options.oninit) {\n                        elementCtrl.pageLifeCycle.steps.init.attach(function () {\n                            return options.oninit(elementCtrl.element, args);\n                        });\n                    }\n                    if (elementCtrl.enterPageAnimation || options.enterPage) {\n                        if (elementCtrl.enterPageAnimation)\n                            elementCtrl._enterAnimation = elementCtrl.enterPageAnimation;\n                        else\n                            elementCtrl._enterAnimation = options.enterPage;\n                        elementCtrl.enterPageAnimation = function () {\n                            var page = this;\n                            var elts = null;\n                            element.style.opacity = '';\n                            if (page && page.getAnimationElements) {\n                                elts = page.getAnimationElements(false);\n                            }\n                            else {\n                                elts = page.element;\n                            }\n                            if (elts)\n                                return page._enterAnimation(elts);\n                        };\n                    }\n                    if (options.onrender) {\n                        elementCtrl.pageLifeCycle.steps.process.attach(function () {\n                            options.onrender(elementCtrl.element, args);\n                        });\n                    }\n                    if (!WinJSContrib.UI.disableAutoResources) {\n                        elementCtrl.pageLifeCycle.steps.process.attach(function () {\n                            return WinJS.Resources.processAll(element);\n                        });\n                    }\n                    if (options.closeOldPagePromise) {\n                        elementCtrl.pageLifeCycle.steps.ready.attach(function () {\n                            return options.closeOldPagePromise;\n                        });\n                    }\n                    elementCtrl.pageLifeCycle.steps.ready.attach(function () {\n                        if (options.onready)\n                            options.onready(elementCtrl.element, args);\n                        if (elementCtrl.enterPageAnimation) {\n                            return WinJS.Promise.as(elementCtrl.enterPageAnimation(element, options));\n                        }\n                        else {\n                            elementCtrl.element.style.opacity = '';\n                        }\n                    });\n                    elementCtrl.pageLifeCycle.steps.ready.promise.then(fragmentCompleted, fragmentError);\n                }\n                var elementCtrl = new pageConstructor(element, args, preparePageControl, parented);\n                return fragmentPromise;\n            }\n            Pages.renderFragment = renderFragment;\n            var PageLifeCycleStep = (function () {\n                function PageLifeCycleStep(page, stepName, parent) {\n                    var _this = this;\n                    this.queue = [];\n                    this.isDone = false;\n                    this.stepName = stepName;\n                    //this.created = new Date();\n                    this.promise = new WinJS.Promise(function (c, e) {\n                        _this._resolvePromise = c;\n                        _this._rejectPromise = e;\n                    });\n                    page.promises.push(this.promise);\n                    //if their is a parent page fragment, we attach step to synchronize page construction\n                    if (parent && parent.pageLifeCycle) {\n                        parent.pageLifeCycle.steps[stepName].attach(function () {\n                            return _this.promise;\n                        });\n                    }\n                }\n                PageLifeCycleStep.prototype.attach = function (callback) {\n                    if (this.queue && !this.isDone) {\n                        this.queue.push(callback);\n                        return this.promise;\n                    }\n                    else {\n                        return WinJS.Promise.as(callback());\n                    }\n                };\n                PageLifeCycleStep.prototype.resolve = function (arg) {\n                    var step = this;\n                    this.isDone = true;\n                    function closeStep() {\n                        //step.resolved = new Date();\n                        step._resolvePromise(arg);\n                        //console.log('resolved ' + step.stepName + '(' + (<any>step.resolved - <any>step.created) + 'ms)');\n                        return step.promise;\n                    }\n                    if (this.queue && this.queue.length) {\n                        var promises = [];\n                        this.queue.forEach(function (q) {\n                            promises.push(new WinJS.Promise(function (c, e) {\n                                try {\n                                    WinJS.Promise.as(q()).then(function (res) {\n                                        c(res);\n                                    }, e);\n                                }\n                                catch (exception) {\n                                    e(exception);\n                                }\n                            }));\n                        });\n                        this.queue = null;\n                        return WinJS.Promise.join(promises).then(function () {\n                            return closeStep();\n                        }, this.reject.bind(this));\n                    }\n                    else {\n                        this.queue = null;\n                        return closeStep();\n                    }\n                };\n                PageLifeCycleStep.prototype.reject = function (arg) {\n                    this.isDone = true;\n                    this.queue = null;\n                    this._rejectPromise(arg);\n                    return WinJS.Promise.wrapError(this.promise);\n                };\n                return PageLifeCycleStep;\n            })();\n            Pages.PageLifeCycleStep = PageLifeCycleStep;\n            (function (_Pages, _Global, _Base, _CorePages, _BaseUtils, _ElementUtilities, _WriteProfilerMark, Promise, Fragments, ControlProcessor) {\n                'use strict';\n                if (!_Global.document || !_CorePages)\n                    return;\n                var viewMap = _CorePages._viewMap || _CorePages.viewMap || {};\n                //this property allows defining mixins applyed to all pages\n                function abs(uri) {\n                    var a = _Global.document.createElement(\"a\");\n                    a.href = uri;\n                    return a.href;\n                }\n                function selfhost(uri) {\n                    return _Global.document.location.href.toLowerCase() === uri.toLowerCase();\n                }\n                var _mixinBase = {\n                    dispose: function () {\n                        /// <signature helpKeyword=\"WinJS.UI.Pages.dispose\">\n                        /// <summary locid=\"WinJS.UI.Pages.dispose\">\n                        /// Disposes this Page.\n                        /// </summary>\n                        /// </signature>\n                        if (this._disposed) {\n                            return;\n                        }\n                        this.pageLifeCycle.stop();\n                        this.pageLifeCycle = null;\n                        this._disposed = true;\n                        this.readyComplete.cancel();\n                        _ElementUtilities.disposeSubTree(this.element);\n                        this.element = null;\n                    },\n                    init: function () {\n                    },\n                    load: function (uri) {\n                        /// <signature helpKeyword=\"WinJS.UI.Pages._mixin.load\">\n                        /// <summary locid=\"WinJS.UI.Pages._mixin.load\">\n                        /// Creates a copy of the DOM elements from the specified URI.  In order for this override\n                        /// to be used, the page that contains the load override needs to be defined by calling\n                        /// WinJS.UI.Pages.define() before WinJS.UI.Pages.render() is called.\n                        /// </summary>\n                        /// <param name=\"uri\" locid=\"WinJS.UI.Pages._mixin.load_p:uri\">\n                        /// The URI from which to copy the DOM elements.\n                        /// </param>\n                        /// <returns type=\"WinJS.Promise\" locid=\"WinJS.UI.Pages._mixin.load_returnValue\">\n                        /// A promise whose fulfilled value is the set of unparented DOM elements, if asynchronous processing is necessary. If not, returns nothing.\n                        /// </returns>\n                        /// </signature>\n                        if (!this.selfhost) {\n                            return Fragments.renderCopy(abs(uri));\n                        }\n                    },\n                    process: function (element, options) {\n                        /// <signature helpKeyword=\"WinJS.UI.Pages._mixin.process\">\n                        /// <summary locid=\"WinJS.UI.Pages._mixin.process\">\n                        /// Processes the unparented DOM elements returned by load.\n                        /// </summary>\n                        /// <param name=\"element\" locid=\"WinJS.UI.Pages._mixin.process_p:element\">\n                        /// The DOM element that will contain all the content for the page.\n                        /// </param>\n                        /// <param name=\"options\" locid=\"WinJS.UI.Pages._mixin.process_p:options\">\n                        /// The options that are to be passed to the constructor of the page.\n                        /// </param>\n                        /// <returns type=\"WinJS.Promise\" locid=\"WinJS.UI.Pages._mixin.process_returnValue\">\n                        /// A promise that is fulfilled when processing is complete.\n                        /// </returns>\n                        /// </signature>\n                        return ControlProcessor.processAll(element);\n                    },\n                    processed: function (element, options) { },\n                    render: function (element, options, loadResult) {\n                        /// <signature helpKeyword=\"WinJS.UI.Pages._mixin.render\">\n                        /// <summary locid=\"WinJS.UI.Pages._mixin.render\">\n                        /// Renders the control, typically by adding the elements specified in the loadResult parameter to the specified element.\n                        /// </summary>\n                        /// <param name=\"element\" locid=\"WinJS.UI.Pages._mixin.render_p:element\">\n                        /// The DOM element that will contain all the content for the page.\n                        /// </param>\n                        /// <param name=\"options\" locid=\"WinJS.UI.Pages._mixin.render_p:options\">\n                        /// The options passed into the constructor of the page.\n                        /// </param>\n                        /// <param name=\"loadResult\" locid=\"WinJS.UI.Pages._mixin.render_p:loadResult\">\n                        /// The elements returned from the load method.\n                        /// </param>\n                        /// <returns type=\"WinJS.Promise\" locid=\"WinJS.UI.Pages._mixin.render_returnValue\">\n                        /// A promise that is fulfilled when rendering is complete, if asynchronous processing is necessary. If not, returns nothing.\n                        /// </returns>\n                        /// </signature>\n                        if (!this.selfhost) {\n                            element.appendChild(loadResult);\n                        }\n                        return element;\n                    },\n                    rendered: function (element, options) { },\n                    ready: function () { }\n                };\n                function injectMixin(base, mixin) {\n                    var d = base.prototype.dispose;\n                    base = _Base.Class.mix(base, mixin);\n                    //we want to allow this mixins to provide their own addition to \"dispose\"\n                    if (d && mixin.hasOwnProperty('dispose')) {\n                        base.prototype.dispose = function () {\n                            mixin.dispose.apply(this);\n                            d.apply(this);\n                        };\n                    }\n                    return base;\n                }\n                function mergeJavaScriptClass(baseCtor, classDef) {\n                    var keys = Object.keys(baseCtor.prototype);\n                    keys.forEach(function (k) {\n                        if (classDef.prototype[k] === undefined) {\n                            classDef.prototype[k] = baseCtor.prototype[k];\n                        }\n                    });\n                    return baseCtor;\n                }\n                function addMembers(ctor, members) {\n                    if (!members)\n                        return ctor;\n                    if (typeof members == 'function') {\n                        ctor.prototype._attachedConstructor = members;\n                        return mergeJavaScriptClass(ctor, members);\n                    }\n                    else if (typeof members == 'object') {\n                        return injectMixin(ctor, members);\n                    }\n                    return ctor;\n                }\n                function pageLifeCycle(that, uri, element, options, complete, parentedPromise) {\n                    if (element.style.display)\n                        that.pageLifeCycle.initialDisplay = element.style.display;\n                    element.style.display = 'none';\n                    var profilerMarkIdentifier = \" uri='\" + uri + \"'\" + _BaseUtils._getProfilerMarkIdentifier(that.element);\n                    _WriteProfilerMark(\"WinJS.UI.Pages:createPage\" + profilerMarkIdentifier + \",StartTM\");\n                    if (WinJSContrib.UI.WebComponents) {\n                        that.pageLifeCycle.observer = WinJSContrib.UI.WebComponents.watch(that.element);\n                    }\n                    var load = Promise.timeout().then(function Pages_load() {\n                        return that.load(uri);\n                    }).then(function (loadResult) {\n                        //if page is defined by Js classes, call class constructors \n                        if (that._attachedConstructor) {\n                            var realControl = new that._attachedConstructor(element, options);\n                            element.winControl = realControl;\n                            var keys = Object.keys(that);\n                            keys.forEach(function (k) {\n                                realControl[k] = that[k];\n                            });\n                            realControl.pageLifeCycle.page = realControl;\n                            that.pageControl = realControl;\n                            that.dismissed = true;\n                            that = realControl;\n                        }\n                        return loadResult;\n                    });\n                    var renderCalled = load.then(function Pages_init(loadResult) {\n                        return Promise.join({\n                            loadResult: loadResult,\n                            initResult: that.init(element, options)\n                        });\n                    }).then(function Pages_render(result) {\n                        return that.pageLifeCycle.steps.init.resolve().then(function () {\n                            return result;\n                        });\n                    }).then(function Pages_render(result) {\n                        return that.render(element, options, result.loadResult);\n                    }).then(function Pages_render(result) {\n                        return that.rendered(element, options);\n                    }).then(function (result) {\n                        return that.pageLifeCycle.steps.render.resolve();\n                    }).then(function Pages_processed() {\n                        if (WinJSContrib.UI.WebComponents) {\n                            //add delay to enable webcomponent processing\n                            return WinJS.Promise.timeout();\n                        }\n                    });\n                    that.elementReady = renderCalled.then(function () {\n                        return element;\n                    });\n                    that.renderComplete = renderCalled.then(function Pages_process() {\n                        return that.process(element, options);\n                    }).then(function (result) {\n                        return that.pageLifeCycle.steps.process.resolve();\n                    }).then(function Pages_processed() {\n                        WinJSContrib.UI.bindMembers(element, that);\n                        return that.processed(element, options);\n                    }).then(function () {\n                        return that;\n                    });\n                    var callComplete = function () {\n                        complete && complete(that);\n                        _WriteProfilerMark(\"WinJS.UI.Pages:createPage\" + profilerMarkIdentifier + \",StopTM\");\n                    };\n                    // promises guarantee order, so this will be called prior to ready path below\n                    //\n                    that.renderComplete.then(callComplete, callComplete);\n                    that.layoutComplete = that.renderComplete.then(function () {\n                        return parentedPromise;\n                    }).then(function () {\n                        element.style.display = that.pageLifeCycle.initialDisplay || '';\n                        var r = element.getBoundingClientRect(); //force element layout\n                        return broadcast(that, element, 'pageLayout', [element, options], null, that.pageLayout);\n                    }).then(function () {\n                        WinJSContrib.UI.bindActions(element, that);\n                    }).then(function (result) {\n                        return that.pageLifeCycle.steps.layout.resolve();\n                    }).then(function () {\n                        return that;\n                    });\n                    that.readyComplete = that.layoutComplete.then(function Pages_ready() {\n                        that.ready(element, options);\n                        that.pageLifeCycle.ended = new Date();\n                        that.pageLifeCycle.delta = that.pageLifeCycle.ended - that.pageLifeCycle.created;\n                        console.log('navigation to ' + uri + ' took ' + that.pageLifeCycle.delta + 'ms');\n                        //broadcast(that, element, 'pageReady', [element, options]);\n                    }).then(function (result) {\n                        return that.pageLifeCycle.steps.ready.resolve();\n                    }).then(function () {\n                        return that;\n                    }).then(null, function Pages_error(err) {\n                        if (that.error)\n                            return that.error(err);\n                        if (err && err._value && err._value.name === \"Canceled\")\n                            return;\n                        return WinJS.Promise.wrapError(err);\n                    });\n                    that.__checkLayout = function () {\n                        var page = this;\n                        var updateLayoutArgs = arguments;\n                        var p = null;\n                        if (page.updateLayout) {\n                            p = WinJS.Promise.as(page.updateLayout.apply(page, updateLayoutArgs));\n                        }\n                        else {\n                            p = WinJS.Promise.wrap();\n                        }\n                        return p.then(function () {\n                            return broadcast(page, page.element, 'updateLayout', updateLayoutArgs);\n                        });\n                    };\n                }\n                function getPageConstructor(uri, members) {\n                    /// <signature helpKeyword=\"WinJS.UI.Pages.define\">\n                    /// <summary locid=\"WinJS.UI.Pages.define\">\n                    /// Creates a new page control from the specified URI that contains the specified members.\n                    /// Multiple calls to this method for the same URI are allowed, and all members will be\n                    /// merged.\n                    /// </summary>\n                    /// <param name=\"uri\" locid=\"WinJS.UI.Pages.define_p:uri\">\n                    /// The URI for the content that defines the page.\n                    /// </param>\n                    /// <param name=\"members\" locid=\"WinJS.UI.Pages.define_p:members\">\n                    /// Additional members that the control will have.\n                    /// </param>\n                    /// <returns type=\"Function\" locid=\"WinJS.UI.Pages.define_returnValue\">\n                    /// A constructor function that creates the page.\n                    /// </returns>\n                    /// </signature>\n                    var refUri = abs(uri).toLowerCase();\n                    var base = viewMap[refUri];\n                    uri = abs(uri);\n                    if (!base) {\n                        base = _Base.Class.define(\n                        // This needs to follow the WinJS.UI.processAll \"async constructor\"\n                        // pattern to interop nicely in the \"Views.Control\" use case.\n                        //\n                        // This needs to follow the WinJS.UI.processAll \"async constructor\"\n                        // pattern to interop nicely in the \"Views.Control\" use case.\n                        //\n                        function PageControl_ctor(element, options, complete, parentedPromise) {\n                            var that = this;\n                            var parent = WinJSContrib.Utils.getScopeControl(element);\n                            _ElementUtilities.addClass(element, \"win-disposable\");\n                            _ElementUtilities.addClass(element, \"pagecontrol\");\n                            _ElementUtilities.addClass(element, \"mcn-layout-ctrl\");\n                            that.pageLifeCycle = {\n                                created: new Date(),\n                                location: uri,\n                                stop: function () {\n                                    that.readyComplete.cancel();\n                                    that.cancelPromises();\n                                    if (this.observer) {\n                                        this.observer.disconnect();\n                                        this.observer = null;\n                                    }\n                                },\n                                steps: {\n                                    init: new PageLifeCycleStep(that, 'init', null),\n                                    render: new PageLifeCycleStep(that, 'render', null),\n                                    process: new PageLifeCycleStep(that, 'process', parent),\n                                    layout: new PageLifeCycleStep(that, 'layout', parent),\n                                    ready: new PageLifeCycleStep(that, 'ready', parent)\n                                },\n                                initialDisplay: null\n                            };\n                            this._disposed = false;\n                            this.element = element = element || _Global.document.createElement(\"div\");\n                            element.msSourceLocation = uri;\n                            this.uri = uri;\n                            this.selfhost = selfhost(uri);\n                            element.winControl = this;\n                            that.parentedComplete = parentedPromise;\n                            pageLifeCycle(this, uri, element, options, complete, parentedPromise);\n                        }, _mixinBase);\n                        base = _Base.Class.mix(base, WinJS.UI.DOMEventMixin);\n                        //inject default behaviors to page constructor\n                        WinJSContrib.UI.Pages.defaultFragmentMixins.forEach(function (mixin) {\n                            injectMixin(base, mixin);\n                        });\n                        //WinJSContrib.UI.Pages.fragmentMixin(base);\n                        viewMap[refUri] = base;\n                    }\n                    base = addMembers(base, members);\n                    base.selfhost = selfhost(uri);\n                    return base;\n                }\n                function Pages_define(uri, members) {\n                    /// <signature helpKeyword=\"WinJS.UI.Pages.define\">\n                    /// <summary locid=\"WinJS.UI.Pages.define\">\n                    /// Creates a new page control from the specified URI that contains the specified members.\n                    /// Multiple calls to this method for the same URI are allowed, and all members will be\n                    /// merged.\n                    /// </summary>\n                    /// <param name=\"uri\" locid=\"WinJS.UI.Pages.define_p:uri\">\n                    /// The URI for the content that defines the page.\n                    /// </param>\n                    /// <param name=\"members\" locid=\"WinJS.UI.Pages.define_p:members\">\n                    /// Additional members that the control will have.\n                    /// </param>\n                    /// <returns type=\"Function\" locid=\"WinJS.UI.Pages.define_returnValue\">\n                    /// A constructor function that creates the page.\n                    /// </returns>\n                    /// </signature>\n                    var ctor = viewMap[uri];\n                    if (!ctor) {\n                        ctor = getPageConstructor(uri);\n                    }\n                    if (members) {\n                        ctor = addMembers(ctor, members);\n                    }\n                    if (ctor.selfhost) {\n                        WinJS.Utilities.ready(function () {\n                            render(abs(uri), _Global.document.body);\n                        }, true);\n                    }\n                    //in case we are on WinJS<4 we reference members on WinJS Core Pages\n                    if (!_CorePages.viewMap && !_CorePages._viewMap && typeof members !== 'function')\n                        _Pages._corePages.define(uri, members);\n                    return ctor;\n                }\n                function render(uri, element, options, parentedPromise) {\n                    var Ctor = _CorePages.get(uri);\n                    var control = new Ctor(element, options, null, parentedPromise);\n                    return control.renderComplete.then(null, function (err) {\n                        return Promise.wrapError({\n                            error: err,\n                            page: control\n                        });\n                    });\n                }\n                function get(uri) {\n                    var ctor = viewMap[uri];\n                    if (!ctor) {\n                        ctor = Pages_define(uri);\n                    }\n                    return ctor;\n                }\n                function remove(uri) {\n                    Fragments.clearCache(abs(uri));\n                    delete viewMap[uri.toLowerCase()];\n                }\n                _Pages._corePages = {\n                    get: _CorePages.get,\n                    render: _CorePages.render,\n                    define: _CorePages.define,\n                    _remove: _CorePages._remove,\n                    _viewMap: viewMap,\n                };\n                var pageOverride = {\n                    define: Pages_define,\n                    get: get,\n                    render: render,\n                    _remove: remove,\n                    _viewMap: viewMap\n                };\n                var source = WinJS.UI.Pages;\n                WinJS.Namespace._moduleDefine(_Pages, null, pageOverride);\n                source.get = pageOverride.get;\n                source.define = pageOverride.define;\n                source.render = pageOverride.render;\n                source._remove = pageOverride._remove;\n                //replaces HtmlControl, otherwise it does not use proper Page constructor\n                WinJS.UI.HtmlControl = WinJS.Class.define(function HtmlControl_ctor(element, options, complete) {\n                    /// <signature helpKeyword=\"WinJS.UI.HtmlControl.HtmlControl\">\n                    /// <summary locid=\"WinJS.UI.HtmlControl.constructor\">\n                    /// Initializes a new instance of HtmlControl to define a new page control.\n                    /// </summary>\n                    /// <param name=\"element\" locid=\"WinJS.UI.HtmlControl.constructor_p:element\">\n                    /// The element that hosts the HtmlControl.\n                    /// </param>\n                    /// <param name=\"options\" locid=\"WinJS.UI.HtmlControl.constructor_p:options\">\n                    /// The options for configuring the page. The uri option is required in order to specify the source\n                    /// document for the content of the page.\n                    /// </param>\n                    /// </signature>\n                    WinJS.UI.Pages.render(options.uri, element, options).\n                        then(complete, function () { complete(); });\n                });\n            })(WinJSContrib.UI.Pages, __global, WinJS, WinJS.UI.Pages, WinJS.Utilities, WinJS.Utilities, profiler, WinJS.Promise, WinJS.UI.Fragments, WinJS.UI);\n        })(Pages = UI.Pages || (UI.Pages = {}));\n    })(UI = WinJSContrib.UI || (WinJSContrib.UI = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\n//# sourceMappingURL=winjscontrib.core.js.map","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/*\r\nWARNING: this feature is experimental\r\nYou must add winjscontrib.core.js before this file\r\n*/\r\n\r\n/// <reference path=\"winjscontrib.core.js\" />\r\nvar WinJSContrib = WinJSContrib || {};\r\nWinJSContrib.UI = WinJSContrib.UI || {};\r\n\r\n/**\r\n * @namespace\r\n */\r\nWinJSContrib.UI.WebComponents = WinJSContrib.UI.WebComponents || {};\r\n\r\n(function (global) {\r\n\t'use strict';\r\n\tvar registered = {};\r\n\tWinJSContrib.UI.WebComponents.registered = registered;\r\n\tWinJSContrib.UI.WebComponents.polyfill = false;\r\n\r\n\tif (!global.document.registerElement && global.MutationObserver) {\r\n\t\tWinJSContrib.UI.WebComponents.polyfill = true;\r\n\t}\r\n\r\n\tfunction inspect(node) {\r\n\t\tvar customElement = null;\r\n\t\tvar ctrlName = node.nodeName;\r\n\t\tvar promises = [];\r\n\r\n\t\tif (node.nodeName !== '#text') {\r\n\t\t\tif (node.attributes) {\r\n\t\t\t\tvar ctrlName = node.getAttribute(\"is\");\r\n\t\t\t\tif (ctrlName) {\r\n\t\t\t\t\t//we uppercase because node names are uppercase\r\n\t\t\t\t\tcustomElement = registered[ctrlName.toUpperCase()];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!customElement && node.nodeName !== 'DIV' && node.nodeName !== 'SPAN') {\r\n\t\t\t\tcustomElement = registered[node.nodeName];\r\n\t\t\t}\r\n\r\n\t\t\tif (customElement && !node.mcnComponent) {\r\n\t\t\t\t//createElement(node, customElement);\r\n\t\t\t\tpromises.push(createElement(node, customElement));\r\n\t\t\t}\r\n\r\n\t\t\tif (node.msParentSelectorScope && node.winControl && node.winControl.pageLifeCycle && node.winControl.pageLifeCycle.observer) {\r\n\t\t\t\t//element is a fragment with its own mutation observer, no need to inspect childs\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t//if (node.nodeName === 'WIN-TEMPLATE') {\r\n\t\t\t//    return;\r\n\t\t\t//}\r\n\r\n\t\t\tfor (var i = 0, l = node.childNodes.length; i < l; i++) {\r\n\t\t\t\tpromises.push(inspect(node.childNodes[i]));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn WinJS.Promise.join(promises);\r\n\t}\r\n\r\n\t/**\r\n\t * inspect current DOM element and create webcomponents found on that element and on its child.\r\n\t * @function\r\n\t * @param {HTMLElement} element DOM element to inspect\r\n\t */\r\n\tWinJSContrib.UI.WebComponents.processAll = function (element) { };\r\n\tif (WinJSContrib.UI.WebComponents.polyfill) {\r\n\t\tWinJSContrib.UI.WebComponents.processAll = inspect;\r\n\t}\r\n\r\n\tfunction observeMutations(element) {\r\n\t\tvar observer = null;\r\n\t\tif (WinJSContrib.UI.WebComponents.polyfill) {\r\n\t\t\tobserver = new MutationObserver(function (mutations) {\r\n\t\t\t\t//console.time('check mutation');\r\n\t\t\t\tmutations.forEach(function (mutation) {\r\n\t\t\t\t\tif (mutation.addedNodes.length) {\r\n\t\t\t\t\t\tfor (var i = 0, l = mutation.addedNodes.length; i < l ; i++) {\r\n\t\t\t\t\t\t\tinspect(mutation.addedNodes[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t//console.timeEnd('check mutation');\r\n\t\t\t});\r\n\r\n\t\t\tobserver.observe(element, { childList: true, subtree: true });\r\n\t\t}\r\n\r\n\t\treturn observer;\r\n\t}\r\n\tWinJSContrib.UI.WebComponents.watch = observeMutations;\r\n\r\n\tfunction createElement(element, definition) {\r\n\t\tvar ctrl = element.winControl;\r\n\t\telement.mcnComponent = true;\r\n\t\tvar scope = WinJSContrib.Utils.getScopeControl(element);\r\n\t\tvar p = WinJS.Promise.wrap();\r\n\t\tvar process = function () {\r\n\t\t\tgetControlInstance(definition.ctor, element);\r\n\t\t}\r\n\r\n\t\tif (scope && scope.pageLifeCycle) {\r\n\t\t\t//if the component is owned by a page/fragment, we process the control according to page lifecycle\r\n\t\t\tp = scope.pageLifeCycle.steps.render.attach(process);\r\n\t\t} else {\r\n\t\t\tprocess();\r\n\t\t}\r\n\r\n\t\t//put a proxy on setAttribute to detect changes in attributes\r\n\t\tvar setAttribute = element.setAttribute;\r\n\t\telement.setAttribute = function (name, val) {\r\n\t\t\tif (element.winControl) {\r\n\t\t\t\tsetAttribute.call(this, name, val);\r\n\t\t\t\tvar definition = element.winControl.constructor.mcnWebComponent;\r\n\t\t\t\tif (definition) {\r\n\t\t\t\t\tvar map = definition[name.toUpperCase()];\r\n\t\t\t\t\tif (map) {\r\n\t\t\t\t\t\tvar ctx = { control: element.winControl, name: map.property, data: {} }\r\n\t\t\t\t\t\tdefinition.applyAttribute(name, this, ctx);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn p;\r\n\t}\r\n\r\n\tfunction getControlInstance(ctor, element) {\r\n\t\telement.mcnComponent = true;\r\n\t\tvar definition = ctor.mcnWebComponent;\r\n\t\t//console.time('building ' + definition.name);\r\n\t\tvar options = {};\r\n\t\tif (element.dataset.winOptions) {\r\n\t\t\toptions = getWinJSOptions(element);\r\n\t\t}\r\n\r\n\t\tif (definition && definition.optionsCallback) {\r\n\t\t\toptions = definition.optionsCallback(element, options, scope);\r\n\t\t}\r\n\r\n\t\tvar ctrl = new ctor(element, options);\r\n\t\telement.winControl = ctrl;\r\n\t\tif (definition) {\r\n\t\t\tdefinition.applyAll(element);\r\n\t\t}\r\n\t\t//console.timeEnd('building ' + definition.name);\t\t\r\n\t}\r\n\r\n\tfunction applyMapping(tagname, ctor, mapping) {\r\n\t\tif (typeof mapping == 'function')\r\n\t\t\treturn;\r\n\t\tmapping = mapping || {};\r\n\r\n\t\tctor.mcnWebComponent = {\r\n\t\t\tname: tagname,\r\n\t\t\tmap: mapping.map || {},\r\n\t\t\toptionsCallback: mapping.optionsCallback,\r\n\t\t\tapplyAll: function (element) {\r\n\t\t\t\tvar contextData = {};\r\n\t\t\t\tfor (var item in this.map) {\r\n\t\t\t\t\tvar attrcontext = { control: element.winControl, name: this.map[item].property, data: contextData };\r\n\t\t\t\t\tthis.applyAttribute(item, element, null, attrcontext);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tapplyAttribute: function (name, element, attrvalue, context) {\r\n\t\t\t\tvar map = this.map[name.toUpperCase()];\r\n\t\t\t\tif (map) {\r\n\t\t\t\t\tvar val = attrvalue || element.getAttribute(map.attribute);\r\n\t\t\t\t\tvar ctrl = element.winControl;\r\n\t\t\t\t\tif (val && ctrl) {\r\n\t\t\t\t\t\tif (!map.type || map.type === 'property') {\r\n\t\t\t\t\t\t\tif (map.resolve) {\r\n\t\t\t\t\t\t\t\tWinJSContrib.Utils.applyValue(element, val, ctrl, map.property, context);\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tWinJSContrib.Utils.writeProperty(ctrl, map.property, val);\r\n\t\t\t\t\t\t} else if (map.type === 'event') {\r\n\t\t\t\t\t\t\tWinJSContrib.Utils.resolveValue(element, val, context);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (mapping.properties) {\r\n\t\t\tmapping.properties.forEach(function (p) {\r\n\t\t\t\tif (p) {\r\n\t\t\t\t\tctor.mcnWebComponent.map[p.toUpperCase()] = { attribute: p, property: p, resolve: true, type: 'property' };\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (mapping.events) {\r\n\t\t\tmapping.events.forEach(function (p) {\r\n\t\t\t\tif (p) {\r\n\t\t\t\t\tctor.mcnWebComponent.map[p.toUpperCase()] = { attribute: p, property: p, resolve: true, type: 'event' };\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (mapping.controls) {\r\n\t\t\tfor (var ctKey in mapping.controls) {\r\n\t\t\t\tvar control = mapping.controls[ctKey];\r\n\t\t\t\tvar controlDefinition = control.mcnWebComponent;\r\n\t\t\t\tfor (var mapKey in controlDefinition.map) {\r\n\t\t\t\t\tvar key = ctKey + '.' + mapKey;\r\n\t\t\t\t\tvar controlmap = controlDefinition.map[mapKey];\r\n\t\t\t\t\tctor.mcnWebComponent.map[key.toUpperCase()] = {\r\n\t\t\t\t\t\tattribute: ctKey + '.' + controlmap.attribute,\r\n\t\t\t\t\t\tproperty: ctKey + '.' + controlmap.property,\r\n\t\t\t\t\t\tresolve: controlmap.resolve\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t* Register a control to be used as a webcomponent. If a tagname has already been registered, \r\n\t* the function will throw an error unless you specify the override flag\r\n\t* @function\r\n\t* @param {string} tagname name for DOM element for the component\r\n\t* @param {function} ctor constructor for the WinJS control\r\n\t* @param {Object} mapping definition for mapping between control and DOM element\r\n\t* @param {boolean} override indicate that you want to override an existing component definition\r\n\t* @example\r\n\t* WinJSContrib.UI.WebComponents.register('mcn-semanticlistviews', WinJSContrib.UI.SemanticListViews, {\r\n\t*\tproperties: ['nameOfProperty'],\r\n\t*   events : ['nameOfEvent'],\r\n\t*\tcontrols: {\r\n\t*\t\t\"listview\": WinJS.UI.ListView,\r\n\t*\t\t\"zoomedOutListview\": WinJS.UI.ListView,\r\n\t*\t\t\"semanticZoom\": WinJS.UI.SemanticZoom\r\n\t*\t},\r\n\t*\tmap: {\r\n\t*\t\t\"DEFAULTGROUPLIMIT\": { attribute: 'defaultGroupLimit', property: '_dataManager.defaultGroupLimit', resolve: true },\r\n\t*\t\t\"GROUPKIND\": { attribute: 'groupKind', property: '_dataManager.groupKind', resolve: true },\r\n\t*\t\t\"FIELD\": { attribute: 'field', property: '_dataManager.field', resolve: true },\r\n\t*\t\t\"ITEMS\": { attribute: 'items', property: '_dataManager.items', resolve: true },\r\n\t*\t}\r\n\t*});\r\n\t*/\r\n\tWinJSContrib.UI.WebComponents.register = function register(tagname, ctor, mapping, override) {\r\n\t\tvar existing = registered[tagname.toUpperCase()];\r\n\t\tif (existing && !override) {\r\n\t\t\tthrow 'component ' + tagname + ' already exists';\r\n\t\t}\r\n\r\n\t\tapplyMapping(tagname, ctor, mapping);\r\n\r\n\t\tif (WinJSContrib.UI.WebComponents.polyfill) {\r\n\t\t\tglobal.document.createElement(tagname);\r\n\t\t\t//we uppercase because node names are uppercase\r\n\t\t\tregistered[tagname.toUpperCase()] = { ctor: ctor };\r\n\t\t} else if (global.document.registerElement) {\r\n\t\t\t//register component with \"real\" webcomponent\r\n\t\t\tvar proto = Object.create(HTMLElement.prototype);\r\n\t\t\tproto.createdCallback = function () {\r\n\t\t\t}\r\n\r\n\t\t\tproto.attachedCallback = function () {\r\n\t\t\t\tvar element = this;\r\n\t\t\t\tvar scope = WinJSContrib.Utils.getScopeControl(element);\r\n\t\t\t\tvar process = function () {\r\n\t\t\t\t\tgetControlInstance(ctor, element);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (scope && scope.pageLifeCycle) {\r\n\t\t\t\t\t//if the component is owned by a page/fragment, we process the control according to page lifecycle\r\n\t\t\t\t    scope.pageLifeCycle.steps.render.attach(process);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tprocess();\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t};\r\n\r\n\t\t\tproto.attributeChangedCallback = function (attrName, oldValue, newValue) {\r\n\t\t\t\tvar element = this;\r\n\t\t\t\tif (element.winControl) {\r\n\t\t\t\t\tvar definition = element.winControl.constructor.mcnWebComponent;\r\n\t\t\t\t\tif (definition) {\r\n\t\t\t\t\t\tvar map = definition.map[attrName.toUpperCase()];\r\n\t\t\t\t\t\tif (map) {\r\n\t\t\t\t\t\t\tdefinition.applyAttribute(attrName, element, newValue, { control: element.winControl, name: map.property, data: {} });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t};\r\n\r\n\t\t\tglobal.document.registerElement(tagname, { prototype: proto });\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getWinJSOptions(elt) {\r\n\t\treturn WinJS.UI.optionsParser(elt.dataset.winOptions, window, {\r\n\t\t\tselect: WinJS.Utilities.markSupportedForProcessing(function (text) {\r\n\t\t\t\tvar parent = WinJSContrib.Utils.getScopeControl(elt);\r\n\t\t\t\tif (parent) {\r\n\t\t\t\t\treturn parent.element.querySelector(text);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn document.querySelector(text);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n\tif (WinJS.Binding && WinJS.Binding.Template) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-template', WinJS.Binding.Template, {\r\n\t\t\tproperties: ['extractChild']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.AppBar) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-appbar', WinJS.UI.AppBar, {\r\n\t\t\tproperties: ['closedDisplayMode', 'disabled', 'hidden', 'layout', 'placement', 'sticky', 'commands', \r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.AutoSuggestBox) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-autosuggestbox', WinJS.UI.AutoSuggestBox, {\r\n\t\t\tproperties: ['chooseSuggestionOnEnter', 'disabled', 'onquerychanged', 'onquerysubmitted', \r\n\t\t\t\t'onresultsuggestionchosen', 'onsuggestionsrequested', 'placeholderText', 'queryText', \r\n\t\t\t\t'searchHistoryContext', 'searchHistoryDisabled'],\r\n\t\t\tevents: ['querychanged', 'querysubmitted', 'resultsuggestionchosen', 'suggestionsrequested']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.BackButton) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-backbutton', WinJS.UI.BackButton);\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ContentDialog) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-contentdialog', WinJS.UI.ContentDialog, {\r\n\t\t\tproperties: ['hidden', 'primaryCommandDisabled', 'primaryCommandText', 'secondaryCommandDisabled',\r\n\t\t\t\t'secondaryCommandText', 'title', 'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.DatePicker) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-datepicker', WinJS.UI.DatePicker, {\r\n\t\t\tproperties: ['calendar', 'datePattern', 'disabled', 'maxYear', 'minYear', \r\n\t\t\t\t'monthPattern', 'yearPattern', 'onchange', 'current'],\r\n\t\t\tevents: ['change']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.FlipView) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-flipview', WinJS.UI.FlipView, {\r\n\t\t\tproperties: ['currentPage', 'orientation', 'itemTemplate', 'itemDataSource', 'itemSpacing', 'ondatasourcecountchanged', 'onpagevisibilitychanged', 'onpageselected', 'onpagecompleted'],\r\n\t\t\tevents: ['datasourcecountchanged', 'pagevisibilitychanged', 'pageselected', 'pagecompleted']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Flyout) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-flyout', WinJS.UI.Flyout, {\r\n\t\t\tproperties: ['alignment', 'anchor', 'disabled', 'hidden', 'placement', \r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Hub) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-hub', WinJS.UI.Hub, {\r\n\t\t\tproperties: ['headerTemplate', 'indexOfFirstVisible', 'indexOfLastVisible', 'loadingState', \r\n\t\t\t\t'oncontentanimating', 'onheaderinvoked', 'onloadingstatechanged', \r\n\t\t\t\t'orientation', 'scrollPosition', 'sectionOnScreen', 'sections', 'zoomableView'],\r\n\t\t\tevents: ['contentanimating', 'headerinvoked', 'loadingstatechanged']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.HubSection) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-hubsection', WinJS.UI.HubSection, {\r\n\t\t\tproperties: ['contentElement', 'header', 'isHeaderStatic']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ItemContainer) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-itemcontainer', WinJS.UI.ItemContainer, {\r\n\t\t\tproperties: ['draggable', 'oninvoked', 'onselectionchanged', 'onselectionchanging', 'selected', 'selectionDisabled', \r\n\t\t\t\t'swipeBehavior', 'swipeOrientation', 'tapBehavior'],\r\n\t\t\tevents: ['invoked', 'selectionchanged', 'selectionchanging']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ListView) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-listview', WinJS.UI.ListView, {\r\n\t\t\tproperties: [\r\n\t\t\t\t'itemTemplate', 'itemDataSource', 'itemsDraggable', 'itemsReorderable',\r\n\t\t\t\t'oniteminvoked', 'groupHeaderTemplate', 'groupDataSource', 'swipeBehavior',\r\n\t\t\t\t'selectBehavior', 'tapBehavior', 'header', 'footer'\r\n\t\t\t],\r\n\t\t\tevents: ['iteminvoked']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Menu) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-menu', WinJS.UI.Menu, {\r\n\t\t\tproperties: ['alignment', 'anchor', 'commands', 'disabled', 'hidden', 'placement', \r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Pivot) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-pivot', WinJS.UI.Pivot, {\r\n\t\t\tproperties: ['items', 'locked', 'onitemanimationend', 'onitemanimationstart', 'onselectionchanged', \r\n\t\t\t\t'selectedIndex', 'selectedItem', 'title'],\r\n\t\t\tevents: ['itemanimationend', 'itemanimationstart', 'selectionchanged']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.PivotItem) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-pivotitem', WinJS.UI.PivotItem, {\r\n\t\t\tproperties: ['contentElement', 'header']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Rating) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-rating', WinJS.UI.Rating, {\r\n\t\t\tproperties: ['averageRating', 'disabled', 'enableClear', 'maxRating', \r\n\t\t\t\t'oncancel', 'onchange', 'onpreviewchange', 'tooltipStrings', 'userRating'],\r\n\t\t\tevents: ['cancel', 'change', 'previewchange']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Repeater) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-repeater', WinJS.UI.Repeater, {\r\n\t\t\tproperties: ['data', 'length', 'onitemchanged', 'onitemchanging', 'oniteminserted', 'oniteminserting', \r\n\t\t\t\t'onitemmoved', 'onitemmoving', 'onitemremoved', 'onitemremoving', 'onitemsloaded', \r\n\t\t\t\t'onitemsreloaded', 'onitemsreloading', 'template'],\r\n\t\t\tevents: ['itemchanged', 'itemchanging', 'iteminserted', 'iteminserting',\r\n\t\t\t\t'itemmoved', 'itemmoving', 'itemremoved', 'itemremoving', 'itemsloaded',\r\n\t\t\t\t'itemsreloaded', 'itemsreloading']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.SearchBox) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-searchbox', WinJS.UI.SearchBox, {\r\n\t\t\tproperties: ['chooseSuggestionOnEnter', 'disabled', 'focusOnKeyboardInput', 'onquerychanged', 'onquerysubmitted', \r\n\t\t\t\t'onresultsuggestionchosen', 'onsuggestionsrequested', 'placeholderText', 'queryText', \r\n\t\t\t\t'searchHistoryContext', 'searchHistoryDisabled'],\r\n\t\t\tevents: ['querychanged', 'querysubmitted', 'resultsuggestionchosen', 'suggestionsrequested']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.SemanticZoom) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-semanticzoom', WinJS.UI.SemanticZoom, {\r\n\t\t\tproperties: ['enableButton', 'locked', 'onzoomchanged', 'zoomedInItem', 'zoomedOut', 'zoomedOutItem', 'zoomFactor'],\r\n\t\t\tevents: ['zoomchanged']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.SplitView) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-splitview', WinJS.UI.SplitView, {\r\n\t\t\tproperties: ['contentElement', 'hiddenDisplayMode', 'paneElement', 'paneHidden', 'panePlacement', 'shownDisplayMode',\r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.TimePicker) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-timepicker', WinJS.UI.TimePicker, {\r\n\t\t\tproperties: ['onchange', 'clock', 'current', 'disabled', 'hourPattern',\r\n\t\t\t\t'minuteIncrement', 'minutePattern', 'periodPattern'],\r\n\t\t\tevents: ['onchange']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ToggleSwitch) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-toggleswitch', WinJS.UI.ToggleSwitch, {\r\n\t\t\tproperties: ['onchange', 'checked', 'disabled', 'labelOff', 'labelOn', 'title'],\r\n\t\t\tevents: ['onchange']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ToolBar) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-toolbar', WinJS.UI.ToolBar);\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Tooltip) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-tooltip', WinJS.UI.Tooltip, {\r\n\t\t\tproperties: ['contentElement', 'extraClass', 'infotip', 'innerHTML', 'onbeforeclose', \r\n\t\t\t\t'onbeforeopen', 'onclosed', 'onopened', 'placement'],\r\n\t\t\tevents: ['beforeclose', 'beforeopen', 'closed', 'opened']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ViewBox) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-viewbox', WinJS.UI.ViewBox);\r\n\t}\r\n\r\n\r\n\t/*\r\n\t\t\t\tWinJS.UI.MenuCommand\r\n\t\t\t\tWinJS.UI.NavBar\r\n\t\t\t\tWinJS.UI.NavBarCommand\r\n\t\t\t\tWinJS.UI.NavBarContainer\r\n\t\t\t\tToolbar\r\n\t*/\r\n})(this);","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var WinRT;\n    (function (WinRT) {\n        /**\n         * read protocol arguments from application activation event arguments\n         * @function WinJSContrib.WinRT.readProtocol\n         * @param {Object} args WinJS application activation argument\n         * @returns {Object} protocol arguments\n         */\n        function readProtocol(args) {\n            if (args.detail.kind === Windows.ApplicationModel.Activation.ActivationKind.protocol && args.detail.uri) {\n                var navArgs = { action: undefined };\n                var protocolArgs = {};\n                var queryargs = args.detail.uri.query;\n                if (queryargs[0] == '?') {\n                    queryargs = queryargs.substr(1);\n                }\n                if (queryargs) {\n                    queryargs.split('&').forEach(function (item) {\n                        var arg = item.split('=');\n                        protocolArgs[arg[0]] = decodeURIComponent(arg[1]);\n                    });\n                }\n                navArgs.protocol = {\n                    action: args.detail.uri.host,\n                    args: protocolArgs\n                };\n                return navArgs;\n            }\n        }\n        WinRT.readProtocol = readProtocol;\n        ;\n        /**\n         * Indicate if a valid internet connection is available, even with constrained access\n         * @function WinJSContrib.WinRT.isConnected\n         * @returns {boolean}\n         */\n        function isConnected() {\n            var nlvl = Windows.Networking.Connectivity.NetworkConnectivityLevel;\n            var profile = Windows.Networking.Connectivity.NetworkInformation.getInternetConnectionProfile();\n            if (profile !== null) {\n                var level = profile.getNetworkConnectivityLevel();\n                return level === nlvl.constrainedInternetAccess || level === nlvl.internetAccess;\n            }\n            return false;\n        }\n        WinRT.isConnected = isConnected;\n        ;\n        /**\n         * Indicate if a valid internet connection is available\n         * @function WinJSContrib.WinRT.hasInternetAccess\n         * @returns {boolean}\n         */\n        function hasInternetAccess() {\n            var nlvl = Windows.Networking.Connectivity.NetworkConnectivityLevel;\n            var profile = Windows.Networking.Connectivity.NetworkInformation.getInternetConnectionProfile();\n            if (profile !== null) {\n                var level = profile.getNetworkConnectivityLevel();\n                return level === nlvl.internetAccess;\n            }\n            return false;\n        }\n        WinRT.hasInternetAccess = hasInternetAccess;\n        ;\n        /**\n         * trigger callback when internet connection status is changing\n         * @function WinJSContrib.WinRT.onInternetStatusChanged\n         * @param {function} callback callback for internet status change notification\n         * @returns {function} function to call for unregistering the callback\n         */\n        function onInternetStatusChanged(callback) {\n            var handler = function (arg) {\n                var e = arg;\n                callback(WinJSContrib.WinRT.hasInternetAccess());\n            };\n            var network = Windows.Networking.Connectivity.NetworkInformation;\n            network.addEventListener('networkstatuschanged', handler);\n            return function () {\n                network.removeEventListener('networkstatuschanged', handler);\n            };\n        }\n        WinRT.onInternetStatusChanged = onInternetStatusChanged;\n    })(WinRT = WinJSContrib.WinRT || (WinJSContrib.WinRT = {}));\n})(WinJSContrib || (WinJSContrib = {}));\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Alerts;\n    (function (Alerts) {\n        /**\n         * show system alert box\n         * @function WinJSContrib.Alerts.messageBox\n         * @param {Object} opt message options\n         * @returns {WinJS.Promise}\n         */\n        function messageBox(opt) {\n            var _global = window;\n            if (opt) {\n                if (_global.Windows) {\n                    var md = new Windows.UI.Popups.MessageDialog(opt.content);\n                    if (opt.title) {\n                        md.title = opt.title;\n                    }\n                    if (opt.commands && opt.commands.forEach) {\n                        opt.commands.forEach(function (command, index) {\n                            var cmd = new Windows.UI.Popups.UICommand();\n                            if (command.id)\n                                cmd.id = command.id;\n                            cmd.label = command.label;\n                            if (command.callback) {\n                                cmd.invoked = command.callback;\n                            }\n                            ((md.commands)).append(cmd);\n                            if (command.isDefault) {\n                                md.defaultCommandIndex = index;\n                            }\n                        });\n                    }\n                    return (md.showAsync());\n                }\n                else {\n                    return new WinJS.Promise(function (complete, error) {\n                        var title = \"\";\n                        if (opt.title) {\n                            title = opt.title;\n                        }\n                        var commands = [];\n                        if (opt.commands && opt.commands.forEach) {\n                            //if (opt.commands.length > 2) {\n                            //    return WinJS.Promise.wrapError(\"you must specify maximum 2 commands on Cordova platforms\");\n                            //}\n                            opt.commands.forEach(function (command, index) {\n                                commands.push(command.label);\n                            });\n                        }\n                        else\n                            commands = ['Ok'];\n                        if (_global.navigator && _global.navigator.notification && _global.navigator.notification.confirm) {\n                            _global.navigator.notification.confirm(opt.content, function (res) {\n                                if (opt.commands && opt.commands[res - 1] && opt.commands[res - 1].callback) {\n                                    var c = opt.commands[res - 1].callback();\n                                    if (c && c.then) {\n                                        c.then(function () {\n                                            complete(true);\n                                        });\n                                    }\n                                    else {\n                                        complete(true);\n                                    }\n                                }\n                                else if (res != 0)\n                                    complete(true);\n                                else\n                                    complete(false);\n                            }, title, commands // buttonLabels\n                            );\n                        }\n                        else {\n                            if (window.confirm(title))\n                                complete(true);\n                            else\n                                complete(false);\n                        }\n                    });\n                }\n            }\n            return WinJS.Promise.wrapError(\"you must specify commands as an array of objects with properties text and callback such as {text: '', callback: function(c){}}\");\n        }\n        Alerts.messageBox = messageBox;\n        ;\n        /**\n         * show system alert box\n         * @function WinJSContrib.Alerts.message\n         * @param {string} title title of the alert\n         * @param {string} content text for the alert\n         * @returns {WinJS.Promise}\n         */\n        function message(title, content) {\n            return WinJSContrib.Alerts.messageBox({ title: title, content: content });\n        }\n        Alerts.message = message;\n        /**\n         * show system alert box\n         * @function WinJSContrib.Alerts.confirm\n         * @param {string} title title of the alert\n         * @param {string} content text for the alert\n         * @param {string} yes text for yes\n         * @param {string} no text for no\n         * @returns {WinJS.Promise}\n         */\n        function confirm(title, content, yes, no) {\n            return new WinJS.Promise(function (complete, error) {\n                WinJSContrib.Alerts.messageBox({\n                    title: title,\n                    content: content,\n                    commands: [\n                        {\n                            label: yes,\n                            callback: function (e) {\n                                complete(true);\n                            },\n                            isDefault: true\n                        },\n                        {\n                            label: no,\n                            callback: function (e) {\n                                complete(false);\n                            }\n                        }\n                    ]\n                });\n            });\n        }\n        Alerts.confirm = confirm;\n        /**\n         * show system toast notification\n         * @function WinJSContrib.Alerts.toastNotification\n         * @param {Object} data toast options\n         */\n        function toastNotification(data) {\n            if (Windows) {\n                var notifications = Windows.UI.Notifications;\n                var template = data.template || (data.picture ? notifications.ToastTemplateType.toastImageAndText01 : notifications.ToastTemplateType.toastText01);\n                //var template = notifications.ToastTemplateType[data.template]; //toastImageAndText01;\n                var toastXml = notifications.ToastNotificationManager.getTemplateContent(template);\n                var toastTextElements = toastXml.getElementsByTagName(\"text\");\n                var toastImageElements = toastXml.getElementsByTagName(\"image\");\n                if (data.launch) {\n                    var toastElements = toastXml.getElementsByTagName(\"toast\");\n                    toastElements[0].setAttribute(\"launch\", JSON.stringify(data.launch));\n                }\n                toastTextElements[0].appendChild(toastXml.createTextNode(data.text));\n                if (data.text2 && toastTextElements.length > 1) {\n                    toastTextElements[1].appendChild(toastXml.createTextNode(data.text2));\n                }\n                if (data.text3 && toastTextElements.length > 1) {\n                    toastTextElements[2].appendChild(toastXml.createTextNode(data.text3));\n                }\n                if (data.picture) {\n                    toastImageElements[0].setAttribute(\"src\", data.picture); //\"ms-appx:///images/logo.png\"\n                }\n                var toast = new notifications.ToastNotification(toastXml);\n                var toastNotifier = notifications.ToastNotificationManager.createToastNotifier();\n                toastNotifier.show(toast);\n            }\n            else {\n                throw \"No notification plugin found\";\n            }\n        }\n        Alerts.toastNotification = toastNotification;\n        /**\n         * show system toast notification\n         * @function WinJSContrib.Alerts.toast\n         * @param {string} text text displayed in the toast\n         * @param {string} picture path to a picture to display in the toast\n         */\n        function toast(text, picture) {\n            WinJSContrib.Alerts.toastNotification({ text: text, picture: picture });\n        }\n        Alerts.toast = toast;\n    })(Alerts = WinJSContrib.Alerts || (WinJSContrib.Alerts = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\n//# sourceMappingURL=../../Sources/WinRT/winjscontrib.winrt.core.js.map","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib = WinJSContrib || {};\r\nWinJSContrib.UPnP = WinJSContrib.UPnP || {};\r\n\r\n(function (global) {\r\n\r\n    WinJSContrib.UPnP.deviceTypes = {\r\n        ContentDirectory1: 'urn:schemas-upnp-org:service:ContentDirectory:1',\r\n        ContentDirectory2: 'urn:schemas-upnp-org:service:ContentDirectory:2',\r\n        ContentDirectory3: 'urn:schemas-upnp-org:service:ContentDirectory:3',\r\n        ContentDirectory4: 'urn:schemas-upnp-org:service:ContentDirectory:4',\r\n        MediaRenderer1: 'urn:schemas-upnp-org:device:MediaRenderer:1',\r\n        MediaRenderer2: 'urn:schemas-upnp-org:device:MediaRenderer:2',\r\n        MediaRenderer3: 'urn:schemas-upnp-org:device:MediaRenderer:3',\r\n        MediaRenderer4: 'urn:schemas-upnp-org:device:MediaRenderer:4',\r\n        MediaServer1: 'urn:schemas-upnp-org:device:MediaServer:1',\r\n        MediaServer2: 'urn:schemas-upnp-org:device:MediaServer:2',\r\n        MediaServer3: 'urn:schemas-upnp-org:device:MediaServer:3',\r\n        MediaServer4: 'urn:schemas-upnp-org:device:MediaServer:4',\r\n        AVTransport1:'urn:schemas-upnp-org:service:AVTransport:1',\r\n        AVTransport2: 'urn:schemas-upnp-org:service:AVTransport:2',\r\n        ConnectionManager1: 'urn:schemas-upnp-org:service:ConnectionManager:1',\r\n        ConnectionManager2: 'urn:schemas-upnp-org:service:ConnectionManager:2',\r\n        ConnectionManager3: 'urn:schemas-upnp-org:service:ConnectionManager:3'\r\n    };\r\n\r\n    WinJSContrib.UPnP.devicesDiscovery = function devicesDiscovery(filter, callback, timeout) {\r\n        var hostName;\r\n        try {\r\n            hostName = new Windows.Networking.HostName(\"239.255.255.250\");\r\n        } catch (ex) {\r\n            error({ message: \"Invalid host name.\" });\r\n            return;\r\n        }\r\n\r\n        var devices = new WinJS.Binding.List();\r\n\r\n        var discovery = {\r\n            devices: devices,\r\n            hasError: null,\r\n            promise: null,\r\n        };\r\n\r\n        function exists(url) {\r\n            var matches = devices.filter(function (d) {\r\n                return (url == d.deviceDescriptionUrl);\r\n            });\r\n            return matches.length > 0;\r\n        }\r\n\r\n        function discover(filter) {\r\n            return new WinJS.Promise(function (complete, error) {\r\n                var clientSocket = new Windows.Networking.Sockets.DatagramSocket();\r\n\r\n                function onsuccess(err) {\r\n                    try {\r\n                        if (clientSocket)\r\n                            clientSocket.close();\r\n                    } catch (ex) {\r\n                    }\r\n                    complete(devices);\r\n                }\r\n\r\n                function onerror(err) {\r\n                    try {\r\n                        if (clientSocket)\r\n                            clientSocket.close();\r\n                    } catch (ex) {\r\n                    }\r\n                    error(err);\r\n                }\r\n\r\n                clientSocket.onmessagereceived = function (args) {\r\n                    var e = args;\r\n                    var reader = args.getDataReader();\r\n                    var count = reader.unconsumedBufferLength;\r\n                    var data = reader.readString(count);\r\n                    var completed = false;\r\n\r\n                    if (data) {\r\n                        var items = data.split('\\n');\r\n                        items.forEach(function (item) {\r\n                            if (!completed && item.toLowerCase().indexOf('location:') == 0) {\r\n                                var url = item.substr(9, item.length - 9);\r\n                                completed = true;\r\n                                if (!exists(url)) {\r\n                                    WinJS.xhr({ url: url }).then(function (r) {\r\n\r\n                                        var rawdevice = xmlToJson(r.responseXML);\r\n                                        var device = rawdevice.root.device;\r\n\r\n                                        device.deviceDescriptionUrl = url;\r\n                                        device.rootUrl = url.substr(0, url.indexOf('/', 8));\r\n                                        if (!exists(url)) {\r\n                                            devices.push(new WinJSContrib.UPnP.UPnPDevice(device));\r\n                                        }\r\n\r\n                                        if (callback)\r\n                                            callback(device, url);\r\n                                    }, function (err) {\r\n                                        console.error('calling device failed');\r\n                                        console.error(err);\r\n                                    });\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n\r\n                }\r\n\r\n                clientSocket.getOutputStreamAsync(hostName, \"1900\").then(function (outputStream) {\r\n                    var message = \"M-SEARCH * HTTP/1.1\\r\\n\" +\r\n                                        \"HOST: 239.255.255.250:1900\\r\\n\" +\r\n                                          \"ST:\" + (filter || \"upnp:rootdevice\") + \"\\r\\n\" +\r\n                                          \"MAN:\\\"ssdp:discover\\\"\\r\\n\" +\r\n                                          \"MX:3\\r\\n\\r\\n\";\r\n\r\n\r\n                    var writer = new Windows.Storage.Streams.DataWriter(outputStream);\r\n                    writer.unicodeEncoding = Windows.Storage.Streams.UnicodeEncoding.Utf8;\r\n                    writer.writeString(message);\r\n                    return writer.storeAsync();\r\n                }).then(function () {\r\n                    return WinJS.Promise.timeout(timeout || 20000);\r\n                }).then(onsuccess, onerror);\r\n            }).then(function (res) {\r\n                discovery.hasError = false;\r\n            }, function (err) {\r\n                discovery.hasError = true;\r\n                discovery.error = err;\r\n            });\r\n        }\r\n\r\n        var promises = [];\r\n\r\n        if (!filter || (typeof filter == 'string')) {\r\n            promises.push(discover(filter));\r\n        }\r\n        else if (filter && typeof filter != 'string' && filter.length) {\r\n            for (var i = 0 ; i < filter.length; i++) {\r\n                promises.push(discover(filter[i]));\r\n            }\r\n        }\r\n\r\n        discovery.promise = WinJS.Promise.join(promises);\r\n\r\n        return discovery;\r\n    }\r\n\r\n    function endsWith(text, search) {\r\n        return text.indexOf(search) == text.length - search.length;\r\n    }\r\n\r\n    WinJSContrib.UPnP.getContentType = function (url, extension) {\r\n        var lowerUrl = url.toLowerCase();\r\n\r\n        if (extension == \"mp3\" || endsWith(lowerUrl, \".mp3\"))\r\n            return \"audio/mp3\";\r\n\r\n        if (extension == \"mp4\" || endsWith(lowerUrl, \".mp4\"))\r\n            return \"video/mp4\";\r\n\r\n        if (extension == \"avi\" || endsWith(lowerUrl, \".avi\"))\r\n            return \"video/avi\";\r\n\r\n        if (extension == \"mkv\" || endsWith(lowerUrl, \".mkv\"))\r\n            return \"video/x-matroska\";\r\n    }\r\n\r\n    function xmlToJson(xml) {\r\n\r\n        // Create the return object\r\n        var obj = {};\r\n\r\n        if (xml.nodeType == 1) { // element\r\n            // do attributes\r\n            if (xml.attributes.length > 0) {\r\n                obj[\"@attributes\"] = {};\r\n                for (var j = 0; j < xml.attributes.length; j++) {\r\n                    var attribute = xml.attributes.item(j);\r\n\r\n                    obj[\"@attributes\"][attribute.nodeName] = attribute.nodeValue;\r\n                }\r\n            }\r\n        } else if (xml.nodeType == 3) { // text\r\n            obj = xml.nodeValue;\r\n        }\r\n\r\n        // do children\r\n        if (xml.hasChildNodes()) {\r\n            var properties = 0;\r\n            for (var i = 0; i < xml.childNodes.length; i++) {\r\n                var item = xml.childNodes.item(i);\r\n                var nodeName = item.nodeName;\r\n                if (typeof (obj[nodeName]) == \"undefined\") {\r\n                    var tmp = xmlToJson(item);\r\n                    var colonIdx = nodeName.indexOf(':');\r\n                    if (colonIdx > 0) {\r\n                        var clearNode = nodeName.substr(colonIdx + 1, nodeName.length - colonIdx - 1);\r\n\r\n                    }\r\n\r\n                    if (clearNode && !obj[clearNode]) {\r\n                        obj[clearNode] = tmp;\r\n                    } else {\r\n                        obj[nodeName] = tmp;\r\n                    }\r\n\r\n                    properties++;\r\n                } else {\r\n                    if (typeof (obj[nodeName].push) == \"undefined\") {\r\n                        var old = obj[nodeName];\r\n                        obj[nodeName] = [];\r\n                        obj[nodeName].push(old);\r\n                    }\r\n                    obj[nodeName].push(xmlToJson(item));\r\n                    properties++;\r\n                }\r\n            }\r\n\r\n            if (obj['#text'] && typeof obj['#text'] == 'string') {\r\n                obj['#text'] = obj['#text'].trim();\r\n            }\r\n            if (properties == 1 && obj['#text'] && typeof obj['#text'] == 'string') {\r\n                obj = obj['#text'];\r\n            }\r\n        }\r\n\r\n        for (var e in obj[\"@attributes\"]) {\r\n            if (!obj[e])\r\n                obj[e] = obj[\"@attributes\"][e];\r\n        }\r\n\r\n        return obj;\r\n    };\r\n\r\n    /**\r\n     * UPnP device\r\n     * @class\r\n     */\r\n    WinJSContrib.UPnP.UPnPDevice = function (deviceObj) {\r\n        for (var p in deviceObj) {\r\n            this[p] = deviceObj[p];\r\n        }\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getService = function (serviceType) {\r\n        var device = this;\r\n        var service = null;\r\n\r\n        if (typeof serviceType == 'string')\r\n            serviceType = [serviceType];\r\n\r\n        if (device.serviceList && device.serviceList.service) {\r\n            service = device.serviceList.service.filter(function (s) {\r\n                return serviceType.indexOf(s.serviceType) >= 0;\r\n            })[0];\r\n\r\n            if (!service && device.deviceList) {\r\n                device.deviceList.device.forEach(function (childdevice) {\r\n                    var childService = childdevice.serviceList.service.filter(function (s) {\r\n                        return serviceType.indexOf(s.serviceType) >= 0;\r\n                    })[0];\r\n\r\n                    if (childService)\r\n                        service = childService;\r\n                });\r\n            }\r\n        }\r\n\r\n        if (service) {\r\n            service.rootUrl = device.rootUrl;\r\n            service.url = device.rootUrl + service.controlURL;\r\n        }\r\n\r\n        return service;\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getAVTransport = function () {\r\n        var service = this.getService([WinJSContrib.UPnP.deviceTypes.AVTransport1, WinJSContrib.UPnP.deviceTypes.AVTransport2]);\r\n        if (service) {\r\n            return new WinJSContrib.UPnP.UPnPAVTransport(service);\r\n        }\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getContentDirectory = function () {\r\n        var service = this.getService([WinJSContrib.UPnP.deviceTypes.ContentDirectory1, WinJSContrib.UPnP.deviceTypes.ContentDirectory2, WinJSContrib.UPnP.deviceTypes.ContentDirectory3, WinJSContrib.UPnP.deviceTypes.ContentDirectory4]);\r\n        if (service) {\r\n            return new WinJSContrib.UPnP.UPnPContentDirectory(service);\r\n        }\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getConnectionManager = function () {\r\n        var service = this.getService([WinJSContrib.UPnP.deviceTypes.ConnectionManager1, WinJSContrib.UPnP.deviceTypes.ConnectionManager2, WinJSContrib.UPnP.deviceTypes.ConnectionManager3]);\r\n        if (service) {\r\n            return new WinJSContrib.UPnP.UPnPConnectionManager(service);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Code largely from https://github.com/richtr/plug.play.js\r\n     */\r\n\r\n    WinJSContrib.UPnP.UPnPService = function (serviceObj, opts) {\r\n\r\n        this.options = opts || { debug: false };\r\n        this.svc = serviceObj;\r\n\r\n        // API stub\r\n        this.action = function () { };\r\n\r\n        //if (!this.svc || !(this.svc instanceof NetworkService)) {\r\n\r\n        //    this.debugLog('First argument provided in constructor MUST be a valid NetworkService object');\r\n\r\n        //    return this;\r\n        //}\r\n\r\n        //if (!this.svc.type || this.svc.type.indexOf('upnp:') !== 0) {\r\n\r\n        //    this.debugLog('First argument provided in constructor MUST be a _UPnP_ NetworkService object');\r\n\r\n        //    return this;\r\n\r\n        //}\r\n\r\n        //this.svcType = this.svc.type.replace('upnp:', '');\r\n        this.svcType = this.svc.serviceType;\r\n        this.svcUrl = this.svc.url;\r\n\r\n        var self = this;\r\n\r\n        // Full API\r\n        this.action = function (upnpAction, upnpParameters, callback) {\r\n\r\n            return new WinJS.Promise(function (promiseComplete, promiseError) {\r\n\r\n                // Handle .action( name, callback )\r\n                if (!callback && Object.prototype.toString.call(upnpParameters) == '[object Function]') {\r\n                    callback = upnpParameters;\r\n                    upnpParameters = {};\r\n                }\r\n\r\n                // Generate a callback stub if a Function has not been provided\r\n                if (!callback || Object.prototype.toString.call(callback) !== '[object Function]') {\r\n                    callback = function (e, response) { };\r\n                }\r\n\r\n                // Create a UPnP XML Request message\r\n                var svcMsg = self.createRequest(self.svcType, upnpAction, upnpParameters);\r\n\r\n                // Send the UPnP XML Request message to the current service\r\n                self.sendRequest(self.svcType, upnpAction, self.svcUrl, svcMsg, function (e, xmlResponse) {\r\n\r\n                    if (e !== null) {\r\n                        callback.apply(self, [e, null]);\r\n                        promiseError(e);\r\n                        return;\r\n                    }\r\n\r\n                    // Parse UPnP XML Response message\r\n                    self.handleResponse(upnpAction, xmlResponse.responseXML || \"\", upnpParameters, function (e, upnpResponse) {\r\n\r\n                        // Fire callback\r\n                        callback.apply(self, [e, upnpResponse]);\r\n\r\n                        // Fire promise\r\n                        if (e !== null) {\r\n                            promiseError(e);\r\n                        } else {\r\n                            promiseComplete(upnpResponse);\r\n                        }\r\n\r\n                    });\r\n\r\n                });\r\n            });\r\n        }\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.constructor = WinJSContrib.UPnP.UPnPService;\r\n\r\n    // UPnP XML MESSAGING TEMPLATES\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.requestTemplate = \"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?>\\n\" +\r\n     \"<s:Envelope s:encodingStyle=\\\"http://schemas.xmlsoap.org/soap/encoding/\\\" \" +\r\n       \"xmlns:s=\\\"http://schemas.xmlsoap.org/soap/envelope/\\\">\\n\" +\r\n       \"\\t<s:Body>\\n\" +\r\n         \"\\t\\t<u:{ACTION_NAME} xmlns:u=\\\"{ACTION_TYPE}\\\">\\n\" +\r\n           \"{ACTION_VARS}\" +\r\n         \"\\t\\t</u:{ACTION_NAME}>\\n\" +\r\n       \"\\t</s:Body>\\n\" +\r\n     \"</s:Envelope>\\n\";\r\n\r\n    // UPNP PRIMITIVE VARIABLE TYPE CHECKERS\r\n    // from http://upnp.org/specs/arch/UPnP-arch-DeviceArchitecture-v1.0.pdf\r\n    WinJSContrib.UPnP.UPnPService.prototype.types = {\r\n\r\n        \"i1\": function (val, allowedValues, toNative) {\r\n            var i8 = new Int8Array(1);\r\n            i8[0] = val;\r\n\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(i8[0], allowedValues);\r\n\r\n        },\r\n\r\n        \"i2\": function (val, allowedValues, toNative) {\r\n            var i16 = new Int16Array(1);\r\n            i16[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(i16[0], allowedValues);\r\n        },\r\n\r\n        \"i4\": function (val, allowedValues, toNative) {\r\n            var i32 = new Int32Array(1);\r\n            i32[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(i32[0], allowedValues);\r\n        },\r\n\r\n        \"ui1\": function (val, allowedValues, toNative) {\r\n            var ui8 = new Uint8Array(1);\r\n            ui8[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(ui8[0], allowedValues);\r\n        },\r\n\r\n        \"ui2\": function (val, allowedValues, toNative) {\r\n            var ui16 = new Uint16Array(1);\r\n            ui16[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(ui16[0], allowedValues);\r\n        },\r\n\r\n        \"ui4\": function (val, allowedValues, toNative) {\r\n            var ui32 = new Uint32Array(1);\r\n            ui32[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(ui32[0], allowedValues);\r\n        },\r\n\r\n        \"int\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || isNaN(val)) {\r\n                val = 0;\r\n            } else if (typeof val !== 'number') {\r\n                if (val === true) {\r\n                    val = 1;\r\n                } else {\r\n                    val = parseInt(val + \"\", 10);\r\n                }\r\n            }\r\n            if (!toNative) {\r\n                val = expandExponential(val + \"\");\r\n            }\r\n            if (isNaN(val)) val = 0;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n        },\r\n\r\n        \"r4\": function (val, allowedValues, toNative) {\r\n            var f32 = new Float32Array(1);\r\n            f32[0] = val;\r\n            if (!toNative) {\r\n                return f32[0] ? expandExponential(f32[0] + \"\") : \"0\";\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(f32[0], allowedValues);\r\n        },\r\n\r\n        \"r8\": function (val, allowedValues, toNative) {\r\n            var f64 = new Float64Array(1);\r\n            f64[0] = val;\r\n            if (!toNative) {\r\n                return f64[0] ? expandExponential(f64[0] + \"\") : \"0\";\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(f64[0], allowedValues);\r\n        },\r\n\r\n        \"number\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['r8'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"fixed_14_4\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['float'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"float\": function (val, allowedValues, toNative) {\r\n            var _float = parseFloat(val);\r\n            if (!toNative) {\r\n                return _float ? expandExponential(_float + \"\") : \"0\";\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(_float, allowedValues);\r\n        },\r\n\r\n        \"char\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            } else if (val === false || val === true || val == \"true\" || val == \"yes\" || val == \"false\" || val == \"no\") {\r\n                val = (val === true || val == \"true\" || val == \"yes\") ? \"1\" : \"0\";\r\n            } else {\r\n                val = val.toString();\r\n            }\r\n            if (val.length > 0) {\r\n                val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n                return val.charAt(0);\r\n            }\r\n            return val;\r\n        },\r\n\r\n        \"string\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            val = val + \"\";\r\n\r\n            val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n            return val;\r\n        },\r\n\r\n        \"xmlObj\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            val = val + \"\";\r\n\r\n            val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n            try {\r\n                var s = '';\r\n\r\n                var currentPos = val.indexOf('&');\r\n                while (currentPos > 0) {\r\n                    var idx = val.indexOf(';', currentPos);\r\n                    if (idx < 0 || (idx - currentPos) > 5) {\r\n                        val = val.substr(0, currentPos) + \"&amp;\" + val.substr(currentPos + 1, val.length - (currentPos + 1));\r\n                    }\r\n                    currentPos = val.indexOf('&', currentPos + 1);\r\n                }\r\n\r\n                var xml = parseXML(val);\r\n                return xmlToJson(xml);\r\n            } catch (exception) {\r\n                console.error(exception);\r\n                return val;\r\n            }\r\n        },\r\n\r\n        \"date\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"dateTime\": function (val, allowedValues, toNative) {\r\n            if (toNative) { // Parse to ECMA Date object\r\n                if (Object.prototype.toString.call(val) == '[object String]') {\r\n                    val = new Date(parseDate(val));\r\n                    if (isNaN(val)) val = \"\";\r\n                } else if (Object.prototype.toString.call(val) == '[object Date]') {\r\n                    val = val;\r\n                }\r\n            } else { // Parse to ISO-8601 string\r\n                if (Object.prototype.toString.call(val) == '[object String]') {\r\n                    val = val + \"\";\r\n                } else if (Object.prototype.toString.call(val) == '[object Date]') {\r\n                    if (val.toString() == \"Invalid Date\") { // opera specific functionality\r\n                        val = \"\";\r\n                    } else {\r\n                        val = val.toISOString();\r\n                    }\r\n                }\r\n            }\r\n            val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n            return val;\r\n        },\r\n\r\n        \"dateTime_tz\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"time\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"time_tz\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"boolean\": function (val, allowedValues, toNative) {\r\n            if (val == 'false' || val == 'f' || val == 'no' || val == 'n' || val instanceof RegExp || val <= 0 || !val) {\r\n                if (toNative) {\r\n                    val = false;\r\n                } else {\r\n                    val = \"0\";\r\n                }\r\n            } else {\r\n                if (toNative) {\r\n                    val = true;\r\n                } else {\r\n                    val = \"1\";\r\n                }\r\n            }\r\n            return val;\r\n        },\r\n\r\n        \"bin_base64\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            if (val === true || val === false) {\r\n                val = val === true ? \"1\" : \"0\";\r\n            }\r\n            if (toNative) { // convert to string\r\n                val = atob(val + \"\");\r\n            } else { // convert to base64\r\n                val = btoa(val + \"\");\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n        },\r\n\r\n        \"bin_hex\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            if (val === true || val === false) {\r\n                val = val === true ? \"1\" : \"0\";\r\n            }\r\n            if (toNative) { // convert to string\r\n                val = htoa(val + \"\");\r\n            } else { // convert to hex\r\n                val = atoh(val + \"\");\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n        },\r\n\r\n        \"uri\": function (val, allowedValues, toNative) {\r\n            if (toNative) {\r\n                val = decodeURI(val + \"\");\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['string'](val, allowedValues); // No URI syntax checking\r\n        },\r\n\r\n        \"uuid\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['string'](val, allowedValues); // No UUID syntax checking\r\n        }\r\n\r\n    };\r\n\r\n    // Override .types toString function\r\n    for (var type in WinJSContrib.UPnP.UPnPService.prototype.types) {\r\n        WinJSContrib.UPnP.UPnPService.prototype.types[type]._name = type;\r\n        WinJSContrib.UPnP.UPnPService.prototype.types[type][\"toString\"] = function () { return this._name; };\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.createRequest = function (upnpServiceType, upnpActionName, parameters) {\r\n\r\n        parameters = this.formatParameters(parameters);\r\n\r\n        this.debugLog('Creating UPnP XML Control Message for [' + upnpActionName + '] with parameters:');\r\n        this.debugLog(JSON ? JSON.stringify(parameters) : null);\r\n\r\n        // Build basic part of XML request\r\n        var svcMsg = this.requestTemplate.replace(/\\{ACTION_TYPE\\}/g, encodeXML(trim(upnpServiceType)));\r\n\r\n        svcMsg = svcMsg.replace(/\\{ACTION_NAME\\}/g, encodeXML(trim(upnpActionName)));\r\n\r\n        var svcInParams = parameters['request'],\r\n            svcInParams_xml = \"\";\r\n\r\n        if (svcInParams) {\r\n\r\n            // Generate XML parameters syntax\r\n            for (var svcParam in svcInParams) {\r\n\r\n                // Perform type checking sanitization\r\n                if (svcInParams[svcParam]['type'] !== undefined && svcInParams[svcParam]['type'] !== null) {\r\n\r\n                    // get the primitive sanitization function\r\n                    var typeCheck = this.types[svcInParams[svcParam]['type']];\r\n\r\n                    if (typeCheck) {\r\n                        svcInParams[svcParam]['value'] = typeCheck(svcInParams[svcParam]['value'], svcInParams[svcParam]['allowedValueList'], false);\r\n                    }\r\n\r\n                }\r\n\r\n                if (svcInParams[svcParam]['value'] === null || svcInParams[svcParam]['value'] === undefined) {\r\n\r\n                    svcInParams[svcParam]['value'] = \"\"; // pass through empty value\r\n\r\n                }\r\n\r\n                svcInParams_xml += \"\\t\\t\\t<\" + svcParam + \">\" + encodeXML(trim(svcInParams[svcParam]['value'] + \"\")) + \"</\" + svcParam + \">\\n\";\r\n\r\n            }\r\n\r\n        }\r\n\r\n        // Add ACTION_VARS, if any\r\n        svcMsg = svcMsg.replace(/\\{ACTION_VARS\\}/g, svcInParams_xml);\r\n\r\n        // DEBUG\r\n        this.debugLog('[REQUEST] (SOAPAction: ' + upnpServiceType + '#' + upnpActionName + ') ' + svcMsg);\r\n\r\n        return svcMsg;\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.sendRequest = function (upnpServiceType, upnpActionName, upnpEndpointURL, upnpRequestXML, onUPnPResponse) {\r\n\r\n        var soapaction = '\\\"' + upnpServiceType.replace(/[\\\"\\#]/g, '') + '#' + upnpActionName.replace(/[\\\"\\#]/g, '') + '\\\"'\r\n        var httpClient = new Windows.Web.Http.HttpClient();\r\n        var uri = new Windows.Foundation.Uri(upnpEndpointURL);\r\n        var request = new Windows.Web.Http.HttpRequestMessage(Windows.Web.Http.HttpMethod.post, uri);\r\n        request.headers.append('SOAPACTION', soapaction);\r\n        //request.headers.append('Content-Type', 'text/xml; charset=\"utf-8\";');        \r\n\r\n        request.content = new Windows.Web.Http.HttpStringContent(upnpRequestXML, Windows.Storage.Streams.UnicodeEncoding.utf8, \"text/xml\");\r\n\r\n        httpClient.sendRequestAsync(request).then(function (r) {\r\n            var content = r.content.readAsStringAsync().then(function (text) {\r\n                var xml = parseXML(text);\r\n                var r = {\r\n                    status: 200,\r\n                    responseText: text,\r\n                    responseXML: xml\r\n                };\r\n                onUPnPResponse.apply(this, [null, r]);\r\n            });\r\n\r\n        }, function (err) {\r\n            onUPnPResponse.apply(undefined, [new UPnPError('XmlHttpRequest failed'), null]);\r\n        });\r\n\r\n        return this;\r\n\r\n        try {\r\n\r\n            var xhr = new XMLHttpRequest();\r\n\r\n            xhr.open('POST', upnpEndpointURL);\r\n            xhr.setRequestHeader('Content-Type', 'text/xml; charset=\"utf-8\";');\r\n            xhr.setRequestHeader('action', soapaction);\r\n            xhr.setRequestHeader('zurgl', soapaction);\r\n            xhr.setRequestHeader('SOAPAction', soapaction);\r\n\r\n            xhr.onabort = xhr.onerror = function () {\r\n\r\n                onUPnPResponse.apply(undefined, [new UPnPError('XmlHttpRequest failed'), null]);\r\n\r\n                //xhrManager.release(xhr);\r\n\r\n            };\r\n\r\n            var self = this;\r\n\r\n            xhr.onreadystatechange = function () {\r\n\r\n                if (this.readyState < 4) return;\r\n\r\n                if (this.status !== 200) {\r\n\r\n                    onUPnPResponse.apply(undefined, [new UPnPError('XmlHttpRequest expected 200 OK. Received ' + this.status + ' response.'), null]);\r\n\r\n                    self.debugLog(\"[ERROR-RESPONSE] \" + this.responseText);\r\n\r\n                    //xhrManager.release(xhr);\r\n\r\n                    return;\r\n\r\n                }\r\n\r\n                self.debugLog(\"[SUCCESS-RESPONSE] \" + this.responseText);\r\n\r\n                onUPnPResponse.apply(this, [null, this]);\r\n\r\n                //xhrManager.release(xhr);\r\n\r\n            };\r\n\r\n            xhr.send(upnpRequestXML);\r\n\r\n        } catch (e) {\r\n\r\n            onUPnPResponse.apply(undefined, [new UPnPError(e), null]);\r\n\r\n        }\r\n\r\n        return this; // allow method chaining\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.handleResponse = function (upnpActionName, upnpResponseXML, parameters, onUPnPResolved) {\r\n\r\n        parameters = this.formatParameters(parameters);\r\n\r\n        var svcOutParams = parameters['response'];\r\n\r\n        var responseJSON = {};\r\n\r\n        // Process all XML response variables\r\n        var responseContainer = upnpResponseXML.getElementsByTagName ?\r\n                                  upnpResponseXML.getElementsByTagName(upnpActionName + \"Response\") : null;\r\n\r\n        // If we don't have any response variables, try again with the namespace attached (required for lib to work in Firefox)\r\n        if (responseContainer === null || responseContainer.length <= 0) {\r\n            responseContainer = upnpResponseXML.getElementsByTagName ?\r\n                                      upnpResponseXML.getElementsByTagName(\"u:\" + upnpActionName + \"Response\") : null;\r\n        }\r\n\r\n        if (responseContainer !== null && responseContainer.length > 0) {\r\n\r\n            var responseVars = responseContainer[0].childNodes;\r\n\r\n            if (responseVars && responseVars.length > 0) {\r\n\r\n                for (var i = 0, l = responseVars.length; i < l; i++) {\r\n\r\n                    var varName = responseVars[i].nodeName;\r\n                    var varVal = responseVars[i].firstChild ? trim(decodeXML(responseVars[i].firstChild.nodeValue + \"\")) : null;\r\n\r\n                    // Perform type checking sanitization if requested\r\n                    if (svcOutParams[varName] && svcOutParams[varName]['type'] !== undefined && svcOutParams[varName]['type'] !== null) {\r\n\r\n                        // get the primitive sanitization function\r\n                        var typeCheck = this.types[svcOutParams[varName]['type']];\r\n\r\n                        if (typeCheck) {\r\n                            varVal = typeCheck(varVal, svcOutParams[varName]['allowedValueList'] || null, true);\r\n                        }\r\n\r\n                    }\r\n\r\n                    responseJSON[varName] = (varVal !== undefined && varVal !== null) ? varVal : \"\";\r\n\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n\r\n        // Fire callback with the parsed action response data\r\n        onUPnPResolved.apply(undefined, [null, { data: responseJSON }]);\r\n\r\n        return this; // allow method chaining\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.formatParameter = function (parameter) {\r\n\r\n        var param = {};\r\n\r\n        if (parameter['type'] !== undefined || parameter['value'] !== undefined || parameter['allowedValueList'] !== undefined) {\r\n\r\n            param = parameter;\r\n\r\n            if (parameter['allowedValueList'] !== undefined && typeof parameter['allowedValueList'] !== 'array') {\r\n                parameter['allowedValueList'] = [];\r\n            }\r\n\r\n        } else {\r\n\r\n            param = { value: parameter };\r\n\r\n        }\r\n\r\n        // check type is valid, otherwise discard requested type\r\n        if (param['type'] !== undefined && param['type'] !== null) {\r\n\r\n            if (!this.types[(param['type'] + \"\")]) {\r\n\r\n                delete param['type'];\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return param;\r\n\r\n    };\r\n\r\n    // Normalize the input parameters argument\r\n    WinJSContrib.UPnP.UPnPService.prototype.formatParameters = function (parameters) {\r\n\r\n        if (parameters === undefined || parameters === null) {\r\n            parameters = {};\r\n        }\r\n\r\n        if (!parameters['request']) {\r\n            parameters['request'] = {};\r\n        }\r\n\r\n        if (!parameters['response']) {\r\n            parameters['response'] = {};\r\n        }\r\n\r\n        for (var param in parameters) {\r\n\r\n            if (param === 'request' || param === 'response') {\r\n\r\n                for (var processParam in parameters[param]) {\r\n\r\n                    parameters[param][processParam] = this.formatParameter(parameters[param][processParam]);\r\n\r\n                }\r\n\r\n            } else { // append as 'request' parameter and remove from root object\r\n\r\n                parameters['request'][param] = this.formatParameter(parameters[param]);\r\n\r\n                delete parameters[param];\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return parameters;\r\n\r\n    };\r\n\r\n    // ALLOWED VALUE LIST CHECKER\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues = function (val, allowedValueList) {\r\n\r\n        // Check against allowedValues if provided\r\n        if (val && allowedValueList && Object.prototype.toString.call(allowedValueList) == '[object Array]') {\r\n\r\n            var matchFound = false;\r\n\r\n            for (var i = 0, l = allowedValueList.length; i < l; i++) {\r\n\r\n                if (val == allowedValueList[i]) {\r\n\r\n                    matchFound = true;\r\n                    break;\r\n\r\n                }\r\n            }\r\n\r\n            if (!matchFound) {\r\n                return \"\";\r\n            }\r\n        }\r\n\r\n        return val;\r\n\r\n    };\r\n\r\n    // UPnP DEBUGGER\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.debugLog = function (msg, level) {\r\n        if ((this.options && this.options.debug)) {\r\n            console[level || 'log'](\"Plug.UPnP: \" + msg);\r\n        }\r\n    };\r\n\r\n    // UPnP ERROR OBJECT\r\n\r\n    var UPnPError = function (description) {\r\n        return {\r\n            'description': description\r\n        };\r\n    };\r\n\r\n    function parseXML(text) {\r\n        return (new DOMParser()).parseFromString(text, \"text/xml\");\r\n    }\r\n\r\n    // *** CUSTOM TYPE FUNCTIONS ***\r\n\r\n    // BASE64 FUNCTIONS\r\n    // (forked from https://github.com/dankogai/js-base64/blob/master/base64.js)\r\n\r\n    var b64chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\r\n\r\n    var b64tab = (function (bin) {\r\n        var t = {};\r\n        for (var i = 0, l = bin.length; i < l; i++) t[bin.charAt(i)] = i;\r\n        return t;\r\n    })(b64chars);\r\n\r\n    var cb_encode = function (ccc) {\r\n        var padlen = [0, 2, 1][ccc.length % 3],\r\n            ord = ccc.charCodeAt(0) << 16\r\n                | ((ccc.length > 1 ? ccc.charCodeAt(1) : 0) << 8)\r\n                | ((ccc.length > 2 ? ccc.charCodeAt(2) : 0)),\r\n            chars = [\r\n                b64chars.charAt(ord >>> 18),\r\n                b64chars.charAt((ord >>> 12) & 63),\r\n                padlen >= 2 ? '=' : b64chars.charAt((ord >>> 6) & 63),\r\n                padlen >= 1 ? '=' : b64chars.charAt(ord & 63)\r\n            ];\r\n        return chars.join('');\r\n    };\r\n\r\n    var cb_decode = function (cccc) {\r\n        var len = cccc.length,\r\n            padlen = len % 4,\r\n            n = (len > 0 ? b64tab[cccc.charAt(0)] << 18 : 0)\r\n              | (len > 1 ? b64tab[cccc.charAt(1)] << 12 : 0)\r\n              | (len > 2 ? b64tab[cccc.charAt(2)] << 6 : 0)\r\n              | (len > 3 ? b64tab[cccc.charAt(3)] : 0),\r\n            chars = [\r\n                String.fromCharCode(n >>> 16),\r\n                String.fromCharCode((n >>> 8) & 0xff),\r\n                String.fromCharCode(n & 0xff)\r\n            ];\r\n        chars.length -= [0, 0, 2, 1][padlen];\r\n        return chars.join('');\r\n    };\r\n\r\n    var btoa = global.btoa || function (b) {\r\n        return b.replace(/[\\s\\S]{1,3}/g, cb_encode);\r\n    };\r\n\r\n    var atob = global.atob || function (a) {\r\n        return a.replace(/[\\s\\S]{1,4}/g, cb_decode);\r\n    };\r\n\r\n    // HEX FUNCTIONS\r\n\r\n    var hexChars = '0123456789abcdef';\r\n\r\n    var hextab = (function (bin) {\r\n        var t = {};\r\n        for (var i = 0, l = bin.length; i < l; i++) t[i] = bin.charAt(i);\r\n        return t;\r\n    })(hexChars);\r\n\r\n    function toHex(n) {\r\n        var result = ''\r\n        var start = true;\r\n        for (var i = 32; i > 0;) {\r\n            i -= 4;\r\n            var digit = (n >> i) & 0xf;\r\n            if (!start || digit != 0) {\r\n                start = false;\r\n                result += hextab[digit];\r\n            }\r\n        }\r\n        return (result == '' ? '0' : result);\r\n    }\r\n\r\n    function pad(str, len, pad) {\r\n        var result = str;\r\n        for (var i = str.length; i < len; i++) {\r\n            result = pad + result;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function ntos(n) {\r\n        n = n.toString(16);\r\n        if (n.length == 1) n = \"0\" + n;\r\n        n = \"%\" + n;\r\n        return unescape(n);\r\n    }\r\n\r\n    function htoa(str) {\r\n        str = str.toUpperCase().replace(new RegExp(\"s/[^0-9A-Z]//g\"));\r\n        var result = \"\";\r\n        var nextchar = \"\";\r\n        for (var i = 0; i < str.length; i++) {\r\n            nextchar += str.charAt(i);\r\n            if (nextchar.length == 2) {\r\n                result += ntos(parseInt(nextchar, 16));\r\n                nextchar = \"\";\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function atoh(str) {\r\n        var result = \"\";\r\n        for (var i = 0; i < str.length; i++) {\r\n            result += pad(toHex(str.charCodeAt(i) & 0xff), 2, '0');\r\n        }\r\n        return result;\r\n    }\r\n\r\n    // NUMBER FUNCTIONS\r\n\r\n    function expandExponential(str) {\r\n        return str.replace(/^([+-])?(\\d+).?(\\d*)[eE]([-+]?\\d+)$/, function (x, s, n, f, c) {\r\n            var l = +c < 0, i = n.length + +c, x = (l ? n : f).length,\r\n            c = ((c = Math.abs(c)) >= x ? c - x + l : 0),\r\n            z = (new Array(c + 1)).join(\"0\"), r = n + f;\r\n            return (s || \"\") + (l ? r = z + r : r += z).substr(0, i += l ? z.length : 0) + (i < r.length ? \".\" + r.substr(i) : \"\");\r\n        });\r\n    };\r\n\r\n    // STRING FUNCTIONS\r\n\r\n    var trim = function (str) {\r\n        if (String.prototype.trim) {\r\n            return str.trim();\r\n        } else {\r\n            return str.replace(/^\\s+|\\s+$/g, \"\");\r\n        }\r\n    };\r\n\r\n    var encodeXML = function (str) {\r\n        return str.replace(/\\&/g, '&amp;')\r\n                   .replace(/</g, '&lt;')\r\n                   .replace(/>/g, '&gt;')\r\n                   .replace(/'/g, '&#39;')\r\n                   .replace(/\"/g, '&quot;');\r\n    };\r\n\r\n    var decodeXML = function (str) {\r\n        return str.replace(/\\&quot;/g, '\"')\r\n                   .replace(/\\&\\#39;/g, '\\'')\r\n                   .replace(/\\&gt;/g, '>')\r\n                   .replace(/\\&lt;/g, '<')\r\n                   .replace(/\\&amp;/g, '&');\r\n    };\r\n\r\n    /**\r\n     * Date.parse with progressive enhancement for ISO 8601 <https://github.com/csnover/js-iso8601>\r\n     * © 2011 Colin Snover <http://zetafleet.com>\r\n     * Released under MIT license.\r\n     *\r\n     * 2012 - Modifications to accept times without dates - by Rich Tibbett\r\n     */\r\n\r\n    var parseDate = function (date) {\r\n        var timestamp, struct, minutesOffset = 0, numericKeys = [1, 4, 5, 6, 7, 10, 11];\r\n\r\n        if (typeof date !== 'string') date += \"\";\r\n\r\n        if ((struct = /^((\\d{4}|[+\\-]\\d{6})(?:-(\\d{2})(?:-(\\d{2}))?)?)?(?:[T\\s]?(\\d{2}):(\\d{2})(?::(\\d{2})(?:\\.(\\d{3}))?)?(?:(Z)|([+\\-])(\\d{4}))?)?$/.exec(date))) {\r\n\r\n            struct = struct.slice(1, struct.length);\r\n\r\n            // avoid NaN timestamps caused by “undefined” values being passed to Date.UTC\r\n            for (var i = 0, k; (k = numericKeys[i]) ; ++i) {\r\n                struct[k] = +struct[k] || 0;\r\n            }\r\n\r\n            // allow undefined days and months\r\n            struct[2] = (+struct[2] || 1) - 1;\r\n            struct[3] = +struct[3] || 1;\r\n\r\n            if (struct[8] !== 'Z' && struct[9] !== undefined) {\r\n                minutesOffset = ((struct[10] / 100) - ((struct[10] / 100) % 1)) * 60 + (struct[10] % 100);\r\n\r\n                if (struct[9] === '+') {\r\n                    minutesOffset = 0 - minutesOffset;\r\n                }\r\n            }\r\n\r\n            timestamp = Date.UTC(struct[1], struct[2], struct[3], struct[4], struct[5] + minutesOffset, struct[6], struct[7]);\r\n        }\r\n        else {\r\n            timestamp = Date.parse ? Date.parse(date) : NaN;\r\n        }\r\n\r\n        return timestamp;\r\n    };\r\n\r\n    var allowedContentDirectoryTypes = {\r\n        'urn:schemas-upnp-org:service:ContentDirectory:1': true,\r\n        'urn:schemas-upnp-org:service:ContentDirectory:2': true,\r\n        'urn:schemas-upnp-org:service:ContentDirectory:3': true,\r\n        'urn:schemas-upnp-org:service:ContentDirectory:4': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPContentDirectory = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedContentDirectoryTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Media Server Service\");\r\n            return;\r\n        }\r\n\r\n        // *** ContentDirectory:1 methods\r\n\r\n        this.getSystemUpdateId = function (callback) {\r\n\r\n            return this.action('GetSystemUpdateID', {\r\n                request: {},\r\n                response: {\r\n                    Id: {\r\n                        type: this.types.ui4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getSearchCapabilities = function (callback) {\r\n\r\n            return this.action('GetSearchCapabilities', {\r\n                request: {},\r\n                response: {\r\n                    SearchCaps: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getSortCapabilities = function (callback) {\r\n\r\n            return this.action('GetSortCapabilities', {\r\n                request: {},\r\n                response: {\r\n                    SortCaps: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.browse = function (objectId, browseFlag, filter, startingIndex, requestedCount, sortCriteria, callback) {\r\n\r\n            return this.action('Browse', {\r\n                request: {\r\n                    ObjectID: {\r\n                        value: objectId || '0',\r\n                        type: this.types.string\r\n                    },\r\n                    BrowseFlag: {\r\n                        value: browseFlag || 'BrowseDirectChildren',\r\n                        type: this.types.string\r\n                    },\r\n                    Filter: {\r\n                        value: filter || '*',\r\n                        type: this.types.string\r\n                    },\r\n                    StartingIndex: {\r\n                        value: startingIndex || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    RequestedCount: {\r\n                        value: requestedCount || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    SortCriteria: {\r\n                        value: sortCriteria,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    Result: {\r\n                        type: this.types.xmlObj\r\n                    },\r\n                    NumberReturned: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    TotalMatches: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    UpdateID: {\r\n                        type: this.types.ui4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.search = function (objectId, browseFlag, filter, startingIndex, requestedCount, sortCriteria, callback) {\r\n\r\n            return this.action('Search', {\r\n                request: {\r\n                    ObjectID: {\r\n                        value: objectId || '0',\r\n                        type: this.types.string\r\n                    },\r\n                    BrowseFlag: {\r\n                        value: browseFlag || 'BrowseDirectChildren',\r\n                        type: this.types.string\r\n                    },\r\n                    Filter: {\r\n                        value: filter || '*',\r\n                        type: this.types.string\r\n                    },\r\n                    StartingIndex: {\r\n                        value: startingIndex || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    RequestedCount: {\r\n                        value: requestedCount || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    SortCriteria: {\r\n                        value: sortCriteria,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    Result: {\r\n                        type: this.types.xmlObj\r\n                    },\r\n                    NumberReturned: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    TotalMatches: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    UpdateID: {\r\n                        type: this.types.ui4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n\r\n        // *** ContentDirectory:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ContentDirectory:2') {\r\n\r\n            // TODO: GetFeatureList, GetSortExtensionCapabilities, MoveObject\r\n\r\n        }\r\n\r\n\r\n        // *** ContentDirectory:3 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ContentDirectory:3') {\r\n\r\n            // TODO\r\n\r\n        }\r\n\r\n        // *** ContentDirectory:4 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ContentDirectory:4') {\r\n            // TODO\r\n        }\r\n    };\r\n    WinJSContrib.UPnP.UPnPContentDirectory.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n    var allowedConnectionManagerTypes = {\r\n        'urn:schemas-upnp-org:service:ConnectionManager:1': true,\r\n        'urn:schemas-upnp-org:service:ConnectionManager:2': true,\r\n        'urn:schemas-upnp-org:service:ConnectionManager:3': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPConnectionManager = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedConnectionManagerTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Service\");\r\n            return;\r\n        }\r\n\r\n        // *** ConnectionManager:1 methods\r\n\r\n        this.getCurrentConnectionIDs = function (callback) {\r\n\r\n            return this.action('GetCurrentConnectionIDs', {\r\n                request: {},\r\n                response: {\r\n                    ConnectionIDs: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getCurrentConnectionInfo = function (connectionId, callback) {\r\n\r\n            return this.action('GetCurrentConnectionInfo', {\r\n                request: {\r\n                    ConnectionID: {\r\n                        value: connectionId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    RcsID: {\r\n                        type: this.types.i4\r\n                    },\r\n                    AVTransportID: {\r\n                        type: this.types.i4\r\n                    },\r\n                    ProtocolInfo: {\r\n                        type: this.types.string\r\n                    },\r\n                    PeerConnectionManager: {\r\n                        type: this.types.string\r\n                    },\r\n                    PeerConnectionID: {\r\n                        type: this.types.i4\r\n                    },\r\n                    Direction: {\r\n                        type: this.types.string\r\n                    },\r\n                    Status: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getProtocolInfo = function (callback) {\r\n\r\n            return this.action('GetProtocolInfo', {\r\n                request: {},\r\n                response: {\r\n                    Source: {\r\n                        type: this.types.string\r\n                    },\r\n                    Sink: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        // *** ConnectionManager:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ConnectionManager:2') {\r\n            // TODO\r\n        }\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPConnectionManager.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n    var allowedAVTransportTypes = {\r\n        'urn:schemas-upnp-org:service:AVTransport:1': true,\r\n        'urn:schemas-upnp-org:service:AVTransport:2': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPAVTransport = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedAVTransportTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Media Renderer Service\");\r\n            return;\r\n        }\r\n\r\n        // *** AVTransport:1 methods\r\n\r\n        this.getDeviceCapabilities = function (instanceId, callback) {\r\n\r\n            return this.action('GetDeviceCapabilities', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    PlayMedia: {\r\n                        type: this.types.string\r\n                    },\r\n                    RecMedia: {\r\n                        type: this.types.string\r\n                    },\r\n                    RecQualityModes: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getMediaInfo = function (instanceId, callback) {\r\n\r\n            return this.action('GetMediaInfo', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    NrTracks: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    MediaDuration: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentURI: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentURIMetaData: {\r\n                        type: this.types.string\r\n                    },\r\n                    NextURI: {\r\n                        type: this.types.string\r\n                    },\r\n                    NextURIMetaData: {\r\n                        type: this.types.string\r\n                    },\r\n                    PlayMedium: {\r\n                        type: this.types.string\r\n                    },\r\n                    RecordMedium: {\r\n                        type: this.types.string\r\n                    },\r\n                    WriteStatus: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getPositionInfo = function (instanceId, callback) {\r\n\r\n            return this.action('GetPositionInfo', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    Track: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    TrackDuration: {\r\n                        type: this.types.string\r\n                    },\r\n                    TrackMetaData: {\r\n                        type: this.types.xmlObj\r\n                    },\r\n                    TrackURI: {\r\n                        type: this.types.string\r\n                    },\r\n                    RelTime: {\r\n                        type: this.types.string\r\n                    },\r\n                    AbsTime: {\r\n                        type: this.types.string\r\n                    },\r\n                    RelCount: {\r\n                        type: this.types.i4\r\n                    },\r\n                    AbsCount: {\r\n                        type: this.types.i4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getTransportInfo = function (instanceId, callback) {\r\n\r\n            return this.action('GetTransportInfo', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentTransportState: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentTransportStatus: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentSpeed: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getTransportSettings = function (instanceId, callback) {\r\n\r\n            return this.action('GetTransportSettings', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    PlayMode: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    RecQualityMode: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setAVTransportURI = function (instanceId, currentURI, currentURIMetaData, callback) {\r\n\r\n            return this.action('SetAVTransportURI', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    CurrentURI: {\r\n                        value: currentURI,\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentURIMetaData: {\r\n                        value: currentURIMetaData,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.play = function (instanceId, speed, callback) {\r\n\r\n            return this.action('Play', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Speed: {\r\n                        value: speed || '1',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.pause = function (instanceId, callback) {\r\n\r\n            return this.action('Pause', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.stop = function (instanceId, callback) {\r\n\r\n            return this.action('Stop', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.next = function (instanceId, callback) {\r\n\r\n            return this.action('Next', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.previous = function (instanceId, callback) {\r\n\r\n            return this.action('Previous', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.seek = function (instanceId, unit, target, callback) {\r\n\r\n            return this.action('Seek', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Unit: {\r\n                        value: unit,\r\n                        type: this.types.string\r\n                    },\r\n                    Target: {\r\n                        value: target,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        // *** AVTransport:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:AVTransport:2') {\r\n\r\n            // TODO\r\n\r\n        }\r\n    };\r\n    WinJSContrib.UPnP.UPnPAVTransport.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n    var allowedRenderingControlTypes = {\r\n        'urn:schemas-upnp-org:service:RenderingControl:1': true,\r\n        'urn:schemas-upnp-org:service:RenderingControl:2': true,\r\n        'urn:schemas-upnp-org:service:RenderingControl:3': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPRenderingControl = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedRenderingControlTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Media Renderer Service\");\r\n            return;\r\n        }\r\n\r\n        // *** RenderingControl:1 methods\r\n\r\n        this.listPresets = function (instanceId, callback) {\r\n\r\n            return this.action('ListPresets', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentPresetNameList: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.selectPreset = function (instanceId, presetName, callback) {\r\n\r\n            return this.action('SelectPreset', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    PresetName: {\r\n                        value: presetName || \"FactoryDefaults\",\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBrightness = function (instanceId, callback) {\r\n\r\n            return this.action('GetBrightness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBrightness: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setBrightness = function (instanceId, desiredBrightness, callback) {\r\n\r\n            return this.action('SetBrightness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredBrightness: {\r\n                        value: desiredBrightness,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getContrast = function (instanceId, callback) {\r\n\r\n            return this.action('GetContrast', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentContrast: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setContrast = function (instanceId, desiredContrast, callback) {\r\n\r\n            return this.action('SetContrast', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredContrast: {\r\n                        value: desiredContrast,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getSharpness = function (instanceId, callback) {\r\n\r\n            return this.action('GetSharpness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentSharpness: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setSharpness = function (instanceId, desiredSharpness, callback) {\r\n\r\n            return this.action('SetSharpness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredSharpness: {\r\n                        value: desiredSharpness,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getRedVideoGain = function (instanceId, callback) {\r\n\r\n            return this.action('GetRedVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentRedVideoGain: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setRedVideoGain = function (instanceId, desiredRedVideoGain, callback) {\r\n\r\n            return this.action('SetRedVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredRedVideoGain: {\r\n                        value: desiredRedVideoGain,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getGreenVideoGain = function (instanceId, callback) {\r\n\r\n            return this.action('GetGreenVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentGreenVideoGain: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setGreenVideoGain = function (instanceId, desiredGreenVideoGain, callback) {\r\n\r\n            return this.action('SetGreenVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredGreenVideoGain: {\r\n                        value: desiredGreenVideoGain,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBlueVideoGain = function (instanceId, callback) {\r\n\r\n            return this.action('GetBlueVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBlueVideoGain: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setBlueVideoGain = function (instanceId, desiredBlueVideoGain, callback) {\r\n\r\n            return this.action('SetBlueVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredBlueVideoGain: {\r\n                        value: desiredBlueVideoGain,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getRedVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetRedVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentRedVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setRedVideoBlackLevel = function (instanceId, desiredRedVideoBlackLevel, callback) {\r\n\r\n            return this.action('SetRedVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredRedVideoBlackLevel: {\r\n                        value: desiredRedVideoBlackLevel,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getGreenVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetGreenVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentGreenVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setGreenVideoBlackLevel = function (instanceId, desiredGreenVideoBlackLevel, callback) {\r\n\r\n            return this.action('SetGreenVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredGreenVideoBlackLevel: {\r\n                        value: desiredGreenVideoBlackLevel,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBlueVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetBlueVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBlueVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setBlueVideoBlackLevel = function (instanceId, desiredBlueVideoBlackLevel, callback) {\r\n\r\n            return this.action('SetBlueVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredBlueVideoBlackLevel: {\r\n                        value: desiredBlueVideoBlackLevel,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBlueVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetBlueVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBlueVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getColorTemperature = function (instanceId, callback) {\r\n\r\n            return this.action('GetColorTemperature', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentColorTemperature: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setColorTemperature = function (instanceId, desiredColorTemperature, callback) {\r\n\r\n            return this.action('SetColorTemperature', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredColorTemperature: {\r\n                        value: desiredColorTemperature,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getHorizontalKeystone = function (instanceId, callback) {\r\n\r\n            return this.action('GetHorizontalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentHorizontalKeystone: {\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setHorizontalKeystone = function (instanceId, desiredHorizontalKeystone, callback) {\r\n\r\n            return this.action('SetHorizontalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredHorizontalKeystone: {\r\n                        value: desiredHorizontalKeystone,\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVerticalKeystone = function (instanceId, callback) {\r\n\r\n            return this.action('GetVerticalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentVerticalKeystone: {\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setVerticalKeystone = function (instanceId, desiredVerticalKeystone, callback) {\r\n\r\n            return this.action('SetVerticalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredVerticalKeystone: {\r\n                        value: desiredVerticalKeystone,\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getMute = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetMute', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentMute: {\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setMute = function (instanceId, channel, desiredMute, callback) {\r\n\r\n            return this.action('SetMute', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredMute: {\r\n                        value: desiredMute,\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVolume = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetVolume', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentVolume: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setVolume = function (instanceId, channel, desiredVolume, callback) {\r\n\r\n            return this.action('SetVolume', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredVolume: {\r\n                        value: desiredVolume,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVolumeDB = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetVolumeDB', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentVolume: {\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setVolumeDB = function (instanceId, channel, desiredVolume, callback) {\r\n\r\n            return this.action('SetVolumeDB', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredVolume: {\r\n                        value: desiredVolume,\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVolumeDBRange = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetVolumeDBRange', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    MinValue: {\r\n                        type: this.types.i2\r\n                    },\r\n                    MaxValue: {\r\n                        type: this.types.i2\r\n                    },\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getLoudness = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetLoudness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentLoudness: {\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setLoudness = function (instanceId, channel, desiredLoudness, callback) {\r\n\r\n            return this.action('SetLoudness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredLoudness: {\r\n                        value: desiredLoudness,\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        // *** RenderingControl:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:RenderingControl:2' ||\r\n              this.upnpType === 'urn:schemas-upnp-org:service:RenderingControl:3') {\r\n\r\n            this.getStateVariables = function (instanceId, stateVariableList, callback) {\r\n\r\n                return this.action('GetStateVariables', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        },\r\n                        StateVariableList: {\r\n                            value: stateVariableList,\r\n                            type: this.types.string\r\n                        }\r\n                    },\r\n                    response: {\r\n                        StateVariableValuePairs: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.setStateVariables = function (instanceId, renderingControlUDN, serviceType, serviceId, stateVariableValuePairs, callback) {\r\n\r\n                return this.action('SetStateVariables', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        },\r\n                        RenderingControlUDN: {\r\n                            value: renderingControlUDN,\r\n                            type: this.types.string\r\n                        },\r\n                        ServiceType: {\r\n                            value: serviceType,\r\n                            type: this.types.string\r\n                        },\r\n                        ServiceId: {\r\n                            value: serviceId,\r\n                            type: this.types.string\r\n                        },\r\n                        StateVariableValuePairs: {\r\n                            value: stateVariableValuePairs,\r\n                            type: this.types.string\r\n                        }\r\n                    },\r\n                    response: {\r\n                        StateVariableList: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n        }\r\n\r\n        // *** RenderingControl:3 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:RenderingControl:3') {\r\n\r\n            this.getAllowedTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetAllowedTransforms', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        }\r\n                    },\r\n                    response: {\r\n                        CurrentAllowedTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetTransforms', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        }\r\n                    },\r\n                    response: {\r\n                        CurrentTransformValues: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.setTransforms = function (instanceId, desiredTransformValues, callback) {\r\n\r\n                return this.action('SetTransforms', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        },\r\n                        DesiredTransformValues: {\r\n                            value: desiredTransformValues,\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getAllAvailableTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetAllAvailableTransforms', {\r\n                    response: {\r\n                        AllAllowedTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getAllowedDefaultTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetAllowedDefaultTransforms', {\r\n                    response: {\r\n                        AllowedDefaultTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getDefaultTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetDefaultTransforms', {\r\n                    response: {\r\n                        CurrentDefaultTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.setDefaultTransforms = function (instanceId, desiredDefaultTransformSettings, callback) {\r\n\r\n                return this.action('SetDefaultTransforms', {\r\n                    request: {\r\n                        DesiredDefaultTransformSettings: {\r\n                            value: desiredDefaultTransformSettings,\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n        }\r\n\r\n    };\r\n    WinJSContrib.UPnP.UPnPRenderingControl.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n})(window);","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib;\r\n(function (WinJSContrib) {\r\n    'use strict';\r\n\r\n    /**\r\n     * Custom WinJS Bindings\r\n     * @namespace WinJSContrib.Bindings\r\n     */\r\n    (function (Bindings) {\r\n\r\n        /**\r\n         * path for default picture\r\n         */\r\n        WinJSContrib.Bindings.pictureUnavailable = '/images/unavailable.png';\r\n\r\n        /**\r\n         * Helper for reading arguments for an element\r\n         * @param {HTMLElement} element\r\n         * @param {string} argument name\r\n         */\r\n        WinJSContrib.Bindings.bindingArguments = function bindingArguments(elt, argname) {\r\n            var data;\r\n            if (WinJS.UI._optionsParser) {\r\n                var text = elt.getAttribute(\"data-win-bind-args\");\r\n                if (text) {\r\n                    data = WinJS.UI.optionsParser(text, window);\r\n                }\r\n            } else {\r\n                data = elt.dataset.winBindArgs;\r\n            }\r\n\r\n            if (data) {\r\n                if (argname) {\r\n                    return data[argname];\r\n                } else {\r\n                    return data;\r\n                }\r\n            }\r\n        };\r\n        var bindingArguments = WinJSContrib.Bindings.bindingArguments;\r\n\r\n        /**\r\n         * Binding function to remove HTML from data and add it to destination\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.removeHTML = WinJS.Binding.initializer(function (source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            var elt = document.createElement('DIV');\r\n            elt.innerHTML = data;\r\n            WinJS.Binding.oneTime({ value: elt.innerText }, ['value'], dest, [destProperty]);\r\n        });\r\n\r\n        /**\r\n         * Binding function to remove HTML from data and add it to destination with an ellipse after X characters. The number of characters is specified with \"ellipsisize\" argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.removeHTMLAndEllipsisize = WinJS.Binding.initializer(function (source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            var elt = document.createElement('DIV');\r\n            elt.innerHTML = data;\r\n            var textRes = elt.innerText;\r\n            var size = bindingArguments(dest, 'ellipsisize');\r\n\r\n            if (size)\r\n                textRes = toStaticHTML(WinJSContrib.Utils.ellipsisizeString(elt.innerText, size, true));\r\n            WinJS.Binding.oneTime({ value: textRes }, ['value'], dest, [destProperty]);\r\n        });\r\n\r\n        /**\r\n         * Binding function to remove HTML from data and add it to destination with an ellipse after X characters. The number of characters is specified with \"ellipsisize\" argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.staticHTML = WinJS.Binding.initializer(function (source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            dest[destProperty] = toStaticHTML(data);\r\n        });\r\n\r\n        /**\r\n         * Binding function to add a data-* attribute to the element. Use the destination name to specifiy attribute name\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         * @example\r\n         * //assuming object is { myproperty: 42 }\r\n         * <div data-win-bind=\"foo : myproperty WinJSContrib.Bindings.dataAttr\"></div>\r\n         * //will result to\r\n         * <div data-foo=\"42\" data-win-bind=\"foo : myproperty WinJSContrib.Bindings.dataAttr\"></div>\r\n         */\r\n        WinJSContrib.Bindings.dataAttr = WinJS.Binding.initializer(function dataAttrBinding(source, sourceProperty, dest, destProperty) {\r\n        \tvar data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n        \tdest.setAttribute('data-' + destProperty, data)\r\n        });\r\n\r\n        /**\r\n         * Binding function to add css class named after object property. You could format class by using a \"format\" argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.addClass = WinJS.Binding.initializer(function addClassBinding(source, sourceProperty, dest, destProperty) {\r\n            function setClass(newval, oldval) {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                var formatParameter = bindingArguments(dest, 'format');\r\n                if (formatParameter) {\r\n                    dest.classList.remove(formatParameter.format(oldval));\r\n                    dest.classList.add(formatParameter.format(data));\r\n                }\r\n                else {\r\n                    dest.classList.remove(oldval);\r\n                    dest.classList.add(data);\r\n                }\r\n            }\r\n\r\n            var bindingDesc = {};\r\n            bindingDesc[sourceProperty] = setClass;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * add css class based on a prefix defined with destProperty and the value from the source object\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.asClass = WinJS.Binding.initializer(function asClassBinding(source, sourceProperty, dest, destProperty) {\r\n            function setClass(newval, oldval) {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                dest.classList.remove(destProperty + '-' + oldval);\r\n                dest.classList.add(destProperty + '-' + data);\r\n            }\r\n            var bindingDesc = {};\r\n            bindingDesc[sourceProperty] = setClass;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * convert a url string for use as a background image url\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.toBgImage = WinJS.Binding.initializer(function toBgImageBinding(source, sourceProperty, dest, destProperty) {\r\n            function setImage() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data || !data.length) {\r\n                    dest.style.backgroundImage = '';\r\n                    return;\r\n                }\r\n                dest.style.backgroundImage = 'url(\"' + data + '\")';\r\n            }\r\n\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setImage;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n\r\n        WinJSContrib.Bindings.ToRealDate = WinJS.Binding.initializer(function ToRealDateBinding(source, sourceProperty, dest, destProperty) {\r\n            var date = new Date(source.date * 1000);\r\n            dest.innerHTML = date.toLocaleDateString();\r\n        });\r\n\r\n        function _setPic(dest, url) {\r\n            if (dest.nodeName.toLowerCase() == 'img') {\r\n                dest.src = url;\r\n            }\r\n            else {\r\n                dest.style.backgroundImage = 'url(\"' + url + '\")';\r\n            }\r\n            dest.classList.add('imageLoaded');\r\n        }\r\n\r\n        /**\r\n         * Asynchronously load a picture (using src for image tag and background-image for other elements) from url path, and add 'imageLoaded' css class once picture is ready. \r\n         * You could rely on '.imageLoaded' to add transitions for image loading\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.picture = WinJS.Binding.initializer(function toSmartBgImageBinding(source, sourceProperty, dest, destProperty) {\r\n            function setImage() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data || !data.length) {\r\n                    data = Bindings.pictureUnavailable;\r\n                }\r\n\r\n                dest.classList.remove('imageLoaded');\r\n                setTimeout(function () {\r\n                    WinJSContrib.UI.loadImage(data).done(function () {\r\n                        _setPic(dest, data);\r\n                    }, function () {\r\n                        _setPic(dest, Bindings.pictureUnavailable);\r\n                        WinJS.Utilities.addClass(dest, 'imageLoaded');\r\n                    });\r\n                }, 200);\r\n            }\r\n\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setImage;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n        WinJSContrib.Bindings.toSmartBgImage = WinJSContrib.Bindings.picture; //deprecated method name\r\n\r\n        /**\r\n         * show element if property is filled or true. The dest property can be used to choose what to use for showing/hiding object (opacity, visibility, or display)\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.showIf = WinJS.Binding.initializer(function hideUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.classList.remove('mcn-show');\r\n                    dest.classList.add('mcn-hide');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '0';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = 'hidden';\r\n                    } else {\r\n                        dest.style.display = 'none';\r\n                    }\r\n                } else {\r\n                    dest.classList.remove('mcn-hide');\r\n                    dest.classList.add('mcn-show');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = '';\r\n                    } else {\r\n                        dest.style.display = '';\r\n                    }\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * Alias for {@link WinJSContrib.Bindings.showIf}, just for semantic purpose\r\n         * @function\r\n         * @see WinJSContrib.Bindings.showIf\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.hideIfNot = WinJSContrib.Bindings.showIf;\r\n        WinJSContrib.Bindings.hideIfNotDefined = WinJSContrib.Bindings.showIf;//warning, deprecated\r\n\r\n        /**\r\n         * hide element if property is filled or true. The dest property can be used to choose what to use for showing/hiding object (opacity, visibility, or display)\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.hideIf = WinJS.Binding.initializer(function showUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.classList.remove('mcn-hide');\r\n                    dest.classList.add('mcn-show');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = '';\r\n                    } else {\r\n                        dest.style.display = '';\r\n                    }\r\n                } else {\r\n                    dest.classList.remove('mcn-show');\r\n                    dest.classList.add('mcn-hide');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '0';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = 'hidden';\r\n                    } else {\r\n                        dest.style.display = 'none';\r\n                    }\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * Alias for {@link WinJSContrib.Bindings.hideIf}, just for semantic purpose\r\n         * @function\r\n         * @see WinJSContrib.Bindings.hideIf\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.showIfNot = WinJSContrib.Bindings.hideIf; //warning, deprecated\r\n\r\n        WinJSContrib.Bindings.showIfNotDefined = WinJSContrib.Bindings.hideIf; //warning, deprecated\r\n\r\n        /**\r\n         * enable element if property is filled or true\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.enableIf = WinJS.Binding.initializer(function disableUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.disabled = true;\r\n                } else {\r\n                    dest.disabled = false;\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n        WinJSContrib.Bindings.disableIfNot = WinJSContrib.Bindings.enableIf;\r\n\r\n        /**\r\n         * disable element if property is filled or true\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.disableIf = WinJS.Binding.initializer(function enableUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.disabled = false;\r\n                } else {\r\n                    dest.disabled = true;\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n        WinJSContrib.Bindings.enableIfNot = WinJSContrib.Bindings.disableIf;\r\n\r\n        /**\r\n         * apply a percent number as width (in percent) on the element\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.toWidth = WinJS.Binding.initializer(function progressToWidth(source, sourceProperty, dest, destProperty) {\r\n            function setWidth() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.style.width = '';\r\n                } else {\r\n                    dest.style.width = data + '%';\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setWidth;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * truncate a string and add ellipse to the text if string is longer than a limit. The max size of text is determined by a 'ellipsisize' argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         * @example {@lang xml}\r\n         * <p data-win-bind=\"innerText : someLongText WinJSContrib.Bindings.ellipsisize\" data-win-bind-args='{ \"ellipsisize\" : 50}'></p>\r\n         */\r\n        WinJSContrib.Bindings.ellipsisize = WinJS.Binding.initializer(function toEllipsisizedBinding(source, sourceProperty, dest, destProperty) {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            var size = bindingArguments(dest, 'ellipsisize');\r\n            dest[destProperty] = toStaticHTML(WinJSContrib.Utils.ellipsisizeString(sourcedata, size, true));\r\n        });\r\n        WinJSContrib.Bindings.toEllipsisized = WinJSContrib.Bindings.ellipsisize; //deprecated name\r\n\r\n        WinJSContrib.Bindings.emptyIfNull = WinJS.Binding.initializer(function emptyIfNull(source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (typeof data === \"undefined\" || data === null) {\r\n                dest[destProperty] = \"\";\r\n            } else {\r\n                dest[destProperty] = data;\r\n            }\r\n        });\r\n\r\n\r\n        /**\r\n         * Two way binding triggered by \"change\" event on inputs\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.twoWayOnChange = WinJS.Binding.initializer(function twoWayOnChangeBinding(source, sourceProperty, dest, destProperty) {\r\n            function setVal() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                WinJSContrib.Utils.writeProperty(dest, destProperty, data || '');\r\n            }\r\n\r\n            function getVal() {\r\n                var val = WinJSContrib.Utils.getProperty(dest, destProperty);\r\n                WinJSContrib.Utils.writeProperty(source, sourceProperty, val.propValue);\r\n            }\r\n\r\n            dest.addEventListener('change', getVal, false);\r\n            if (!dest.winControl) {\r\n                dest.classList.add('win-disposable');\r\n                dest.winControl = {\r\n                    dispose: function () {\r\n                        dest.removeEventListener('change', getVal);\r\n                    }\r\n                };\r\n            }\r\n\r\n            var bindingDesc = {\r\n            };\r\n\r\n            bindingDesc[sourceProperty] = setVal;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /** \r\n         * cleans up a binding list by returning its items as non-observable \r\n         * @function \r\n         * @param {Object[]} bindingList binding list to clean up \r\n         * @returns {Object[]} array containing the cleaned up items \r\n         */\r\n        Bindings.cleanUpBindingList = function (bindingList) {\r\n            var result = [];\r\n\r\n            bindingList.forEach(function (item) {\r\n                var unwrappedItem = WinJS.Binding.unwrap(item);\r\n                result.push(unwrappedItem);\r\n            });\r\n\r\n            return result;\r\n        };\r\n\r\n\r\n    })(WinJSContrib.Bindings || (WinJSContrib.Bindings = {}));\r\n    var Bindings = WinJSContrib.Bindings;\r\n})(WinJSContrib || (WinJSContrib = {}));\r\n","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/// <reference path=\"WinJSContrib.binding.utils.js\" />\r\n/// <reference path=\"moment.min.js\" />\r\n\r\nvar WinJSContrib;\r\nWinJSContrib.Utils = WinJSContrib.Utils || {};\r\nWinJSContrib.Bindings = WinJSContrib.Bindings || {};\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    /** \r\n     * format date using binding argument 'formatDate'\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.formatDate = WinJS.Utilities.markSupportedForProcessing(function formatDateBinding(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                var arg = WinJSContrib.Bindings.bindingArguments(dest, 'formatDate') || 'L';\r\n                dest.innerText = moment(sourcedata).format(arg);\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n    /** \r\n     * format date using calendar function\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.calendar = WinJS.Utilities.markSupportedForProcessing(function formatDateBinding(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                dest.innerText = moment(sourcedata).calendar();\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n    function daysSince(m, d, y) {\r\n        if (d == '' || m == '' || y == '') {\r\n            //alert(\"All fields must be entered\");\r\n            return;\r\n        }\r\n\r\n        if (isNaN(m) || isNaN(y) || isNaN(d)) {\r\n            //alert(\"Only numbers .\");\r\n            return;\r\n        }\r\n\r\n        var myDate = new Date();\r\n        var yourDate = new Date(y, m - 1, d);\r\n\r\n        var secondsInADay = 1000 * 60 * 60 * 24;\r\n        var diff = Math.floor((myDate.getTime() - yourDate.getTime()) / secondsInADay);\r\n        return diff;\r\n    }\r\n\r\n\r\n    /**\r\n     * display number of days since a date\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.daysSinceDate = WinJS.Utilities.markSupportedForProcessing(function daysSinceDateBinding(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                sourcedata = new Date(sourcedata);\r\n                var m = sourcedata.getMonth() + 1, d = sourcedata.getDate(), y = sourcedata.getFullYear();\r\n                var fromdate = daysSince(m, d, y);\r\n                dest.innerText = fromdate;\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n    /**\r\n     * apply moment.js humanize formatting on a date. Use 'humanizeFormat' and 'addSuffix' arguments to configure binding\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.humanizeDate = WinJS.Utilities.markSupportedForProcessing(function humanizeDate(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                var arg = WinJSContrib.Bindings.bindingArguments(dest, \"humanizeFormat\"),\r\n                    addSuffix = WinJSContrib.Bindings.bindingArguments(dest, \"addSuffix\");\r\n                dest.innerText = moment.duration(sourcedata, arg).humanize(addSuffix);\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n\r\n})();","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/**\n * @namespace WinJSContrib.UI.Animation\n */\n/**\n */\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var UI;\n    (function (UI) {\n        var Animation;\n        (function (Animation) {\n            /**\n             * @enum\n             * @memberof WinJSContrib.UI.Animation\n             */\n            Animation.Easings = {\n                /**\n                 * Quad ease in\n                 */\n                easeInQuad: 'cubic-bezier(0.550, 0.085, 0.680, 0.530)',\n                /**\n                 * Cubic ease in\n                 */\n                easeInCubic: 'cubic-bezier(0.550, 0.055, 0.675, 0.190)',\n                /**\n                 * Quart ease in\n                 */\n                easeInQuart: 'cubic-bezier(0.895, 0.030, 0.685, 0.220)',\n                /**\n                 * Quint ease in\n                 */\n                easeInQuint: 'cubic-bezier(0.755, 0.050, 0.855, 0.060)',\n                /**\n                 * Sine ease in\n                 */\n                easeInSine: 'cubic-bezier(0.470, 0.000, 0.745, 0.715)',\n                /**\n                 * Expo ease in\n                 */\n                easeInExpo: 'cubic-bezier(0.950, 0.050, 0.795, 0.035)',\n                /**\n                 * Circ ease in\n                 */\n                easeInCirc: 'cubic-bezier(0.600, 0.040, 0.980, 0.335)',\n                /**\n                 * Back ease in\n                 */\n                easeInBack: 'cubic-bezier(0.600, -0.280, 0.735, 0.045)',\n                /**\n                 * Quad ease out\n                 */\n                easeOutQuad: 'cubic-bezier(0.250, 0.460, 0.450, 0.940)',\n                /**\n                 * Cubic ease out\n                 */\n                easeOutCubic: 'cubic-bezier(0.215, 0.610, 0.355, 1.000)',\n                /**\n                 * Quart ease out\n                 */\n                easeOutQuart: 'cubic-bezier(0.165, 0.840, 0.440, 1.000)',\n                /**\n                 * Quint ease out\n                 */\n                easeOutQuint: 'cubic-bezier(0.230, 1.000, 0.320, 1.000)',\n                /**\n                 * Sine ease out\n                 */\n                easeOutSine: 'cubic-bezier(0.390, 0.575, 0.565, 1.000)',\n                /**\n                 * Expo ease out\n                 */\n                easeOutExpo: 'cubic-bezier(0.190, 1.000, 0.220, 1.000)',\n                /**\n                 * Circ ease out\n                 */\n                easeOutCirc: 'cubic-bezier(0.075, 0.820, 0.165, 1.000)',\n                /**\n                 * Back ease out\n                 */\n                easeOutBack: 'cubic-bezier(0.175, 0.885, 0.320, 1.275)',\n                /**\n                 * Quad ease in-out\n                 */\n                easeInOutQuad: 'cubic-bezier(0.455, 0.030, 0.515, 0.955)',\n                /**\n                 * Cubic ease in-out\n                 */\n                easeInOutCubic: 'cubic-bezier(0.645, 0.045, 0.355, 1.000)',\n                /**\n                 * Quart ease in-out\n                 */\n                easeInOutQuart: 'cubic-bezier(0.770, 0.000, 0.175, 1.000)',\n                /**\n                 * Quint ease in-out\n                 */\n                easeInOutQuint: 'cubic-bezier(0.860, 0.000, 0.070, 1.000)',\n                /**\n                 * Sine ease in-out\n                 */\n                easeInOutSine: 'cubic-bezier(0.445, 0.050, 0.550, 0.950)',\n                /**\n                 * Expo ease in-out\n                 */\n                easeInOutExpo: 'cubic-bezier(1.000, 0.000, 0.000, 1.000)',\n                /**\n                 * Circ ease in-out\n                 */\n                easeInOutCirc: 'cubic-bezier(0.785, 0.135, 0.150, 0.860)',\n                /**\n                 * Back ease in-out\n                 */\n                easeInOutBack: 'cubic-bezier(0.680, -0.550, 0.265, 1.550)',\n            };\n            var equivalents = WinJS.Utilities._browserStyleEquivalents || { transform: { cssName: 'transform' } };\n            function getOpt(options) {\n                if (options && typeof options == 'number')\n                    return { duration: options };\n                else\n                    return options || {};\n            }\n            /**\n             * configurable fade out\n             * @function WinJSContrib.UI.Animation.fadeOut\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function fadeOut(elements, options) {\n                options = getOpt(options);\n                var args = {\n                    property: \"opacity\",\n                    delay: staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333),\n                    duration: options.duration || 167,\n                    timing: options.easing || \"ease-in-out\",\n                    to: 0\n                };\n                return WinJS.UI.executeTransition(elements, args);\n            }\n            Animation.fadeOut = fadeOut;\n            /**\n             * configurable fade in\n             * @function WinJSContrib.UI.Animation.fadeIn\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function fadeIn(elements, options) {\n                options = getOpt(options);\n                return WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333),\n                    duration: options.duration || 167,\n                    timing: options.easing || \"ease-in-out\",\n                    to: 1\n                });\n            }\n            Animation.fadeIn = fadeIn;\n            function staggerDelay(initialDelay, extraDelay, delayFactor, delayCap) {\n                return function (i) {\n                    var ret = initialDelay;\n                    for (var j = 0; j < i; j++) {\n                        extraDelay *= delayFactor;\n                        ret += extraDelay;\n                    }\n                    if (delayCap) {\n                        ret = Math.min(ret, delayCap);\n                    }\n                    return ret;\n                };\n            }\n            /**\n             * configurable page exit effect\n             * @function WinJSContrib.UI.Animation.pageExit\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function pageExit(elements, options) {\n                options = getOpt(options);\n                var args = {\n                    property: \"opacity\",\n                    delay: staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333),\n                    duration: options.duration || 160,\n                    timing: options.easing || \"ease-in\",\n                    to: 0\n                };\n                return WinJS.UI.executeTransition(elements, args);\n            }\n            Animation.pageExit = pageExit;\n            /**\n             * configurable page enter effect\n             * @function WinJSContrib.UI.Animation.enterPage\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function enterPage(elements, options) {\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 120, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var animationParams = {\n                    keyframe: 'WinJSContrib-EnterPage',\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: options.duration || 600,\n                    timing: options.easing || \"cubic-bezier(0.1, 0.9, 0.2, 1)\"\n                };\n                var promise1 = WinJS.UI.executeAnimation(elements, animationParams);\n                var args = {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: options.duration || 600,\n                    timing: options.easing || \"ease-out\",\n                    to: 1\n                };\n                var promise2 = WinJS.UI.executeTransition(elements, args);\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.enterPage = enterPage;\n            function slideAnim(element, keyframeName, isIn, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var duration = options.duration || isIn ? 250 : 150;\n                var delay = options.delay || 5;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var easing = WinJSContrib.UI.Animation.Easings.easeInQuad;\n                if (isIn)\n                    easing = WinJSContrib.UI.Animation.Easings.easeOutQuad;\n                var animationParams = {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: duration,\n                    timing: options.easing || easing\n                };\n                var promise1 = WinJS.UI.executeAnimation(element, animationParams);\n                var transitionParams = {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: duration / 2,\n                    timing: easing,\n                    from: 0,\n                    to: 1\n                };\n                if (!isIn) {\n                    transitionParams.from = 1;\n                    transitionParams.to = 0;\n                    if (transitionParams.delay < duration / 2)\n                        transitionParams.delay = duration / 2;\n                }\n                var promise2 = WinJS.UI.executeTransition(element, transitionParams);\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromBottom\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromBottom(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromBottom', true, options);\n            }\n            Animation.slideFromBottom = slideFromBottom;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromTop\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromTop(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromTop', true, options);\n            }\n            Animation.slideFromTop = slideFromTop;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromLeft\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromLeft(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromLeft', true, options);\n            }\n            Animation.slideFromLeft = slideFromLeft;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromRight\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromRight(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromRight', true, options);\n            }\n            Animation.slideFromRight = slideFromRight;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToBottom\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToBottom(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToBottom', false, options);\n            }\n            Animation.slideToBottom = slideToBottom;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToTop\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToTop(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToTop', false, options);\n            }\n            Animation.slideToTop = slideToTop;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToLeft\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToLeft(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToLeft', false, options);\n            }\n            Animation.slideToLeft = slideToLeft;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToRight\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToRight(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToRight', false, options);\n            }\n            Animation.slideToRight = slideToRight;\n            /**\n             * animation for tab exit\n             * @function WinJSContrib.UI.Animation.tabExitPage\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function tabExitPage(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var animationParams = {\n                    keyframe: \"WinJSContrib-tabExitPage\",\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: options.duration || 160,\n                    timing: \"ease-in\"\n                };\n                var promise1 = WinJS.UI.executeAnimation(elements, animationParams);\n                var transitionParams = {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: options.duration || 160,\n                    timing: \"linear\",\n                    from: 1,\n                    to: 0\n                };\n                var promise2 = WinJS.UI.executeTransition(elements, transitionParams);\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.tabExitPage = tabExitPage;\n            /**\n             * animation for tab exit\n             * @function WinJSContrib.UI.Animation.tabEnterPage\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function tabEnterPage(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: \"WinJSContrib-tabEnterPage\",\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: options.duration || 250,\n                    timing: WinJSContrib.UI.Animation.Easings.easeOutQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: options.duration || 250,\n                    timing: \"ease-out\",\n                    from: 0,\n                    to: 1\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.tabEnterPage = tabEnterPage;\n            /**\n             * exit and grow animation\n             * @function WinJSContrib.UI.Animation.exitGrow\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function exitGrow(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-exitGrow\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var dur = options.duration || 250;\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeInQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeInQuint,\n                    from: 1,\n                    to: 0\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.exitGrow = exitGrow;\n            /**\n             * exit and shrink animation\n             * @function WinJSContrib.UI.Animation.exitShrink\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function exitShrink(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-exitShrink\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var dur = options.duration || 250;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 10, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeInQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: WinJSContrib.UI.Animation.Easings.easeInQuint,\n                    from: 1,\n                    to: 0\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.exitShrink = exitShrink;\n            /**\n             * shrink and fall animation\n             * @function WinJSContrib.UI.Animation.shrinkAndFall\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function shrinkAndFall(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var dur = options.duration || 250;\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: \"WinJSContrib-shrinkAndFall\",\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || \"ease-in\"\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: \"ease-in\",\n                    from: 1,\n                    to: 0\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.shrinkAndFall = shrinkAndFall;\n            /**\n             * enter and shrink animation\n             * @function WinJSContrib.UI.Animation.enterShrink\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function enterShrink(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-enterShrink\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var dur = options.duration || 350;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeOutQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeOutQuint,\n                    from: 0,\n                    to: 1\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.enterShrink = enterShrink;\n            /**\n             * enter and shrink animation\n             * @function WinJSContrib.UI.Animation.enterGrow\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function enterGrow(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-enterGrow\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var dur = options.duration || 350;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeOutQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: WinJSContrib.UI.Animation.Easings.easeOutQuint,\n                    from: 0,\n                    to: 1\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.enterGrow = enterGrow;\n        })(Animation = UI.Animation || (UI.Animation = {}));\n    })(UI = WinJSContrib.UI || (WinJSContrib.UI = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\n//# sourceMappingURL=../../Sources/Common/winjscontrib.ui.animation.js.map","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n//this control requires snap.svg\r\n\r\n(function () {\r\n    'use strict';\r\n    var elasticbuttonkinds = {\r\n        rectangle: {\r\n            morphpath: 'M286,113c0,0-68.8,6-136,6c-78.2,0-137-6-137-6S6,97.198,6,62.5C6,33.999,13,12,13,12s59-7,137-7c85,0,136,7,136,7s8,17.598,8,52C294,96.398,286,113,286,113z',\r\n            svg: '<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 300 125\" preserveAspectRatio=\"none\"><path d=\"M286.5,113c0,0-104,0-136.5,0c-35.75,0-136.5,0-136.5,0s0-39.417,0-52.5c0-12.167,0-48.5,0-48.5s101.833,0,136.5,0c33.583,0,136.5,0,136.5,0s0,35.917,0,48.5C286.5,73.167,286.5,113,286.5,113z\"/></svg>'\r\n        },\r\n        roundedrectangle: {\r\n            morphpath: 'M287,95.25c0,11.046-5.954,19.75-17,19.75c0,0-90-4-120-4s-120,4-120,4c-11.046,0-17.25-9.5-17.25-20.5c0-8.715,0.25-10.75,0.25-34s-0.681-26.257-1-33.75C11.5,15,18.954,10,30,10c0,0,90,3,120,3s120-3,120-3c11.046,0,17.75,6.5,17,20c-0.402,7.239,0,6.75,0,30.5C287,83.5,287,84.75,287,95.25z',\r\n            svg: '<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 300 125\" preserveAspectRatio=\"none\"><path d=\"M290,95c0,11.046-8.954,20-20,20c0,0-90,0-120,0s-120,0-120,0c-11.046,0-20-9-20-20c0-8.715,0-25.875,0-34.5c0-7.625,0-22.774,0-30.5c0-11.625,8.954-20,20-20c0,0,90,0,120,0s120,0,120,0c11.046,0,20,8.954,20,20c0,7.25,0,22.875,0,30.5C290,69.125,290,84.5,290,95z\"/></svg>'\r\n        },\r\n        round: {\r\n            morphpath: 'M251,150c0,93.5-29.203,143-101,143S49,243.5,49,150C49,52.5,78.203,7,150,7S251,51.5,251,150z',\r\n            svg: '<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 300 300\" preserveAspectRatio=\"none\"><path d=\"M281,150c0,71.797-59.203,131-131,131S19,221.797,19,150S78.203,19,150,19S281,78.203,281,150z\"/></svg>'\r\n        },\r\n    };\r\n\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        ElasticButton: WinJS.Class.mix(WinJS.Class.define(function ctor(element, options) {\r\n            this.element = element || document.createElement('DIV');\r\n            options = options || {};\r\n            this.element.winControl = this;\r\n            this.behavior = {\r\n                speed: { reset: 800, active: 150 },\r\n                easing: { reset: mina.elastic, active: mina.easein }\r\n            };\r\n\r\n            this.element.classList.add('mcn-elasticbutton');\r\n            this.element.classList.add('win-disposable');\r\n            WinJS.UI.setOptions(this, options);\r\n        }, {\r\n            kind: {\r\n                get: function () {\r\n                    return this._kind;\r\n                },\r\n                set: function (val) {\r\n                    this._kind = val;\r\n                    this.render();\r\n                }\r\n            },\r\n\r\n            render: function () {\r\n                var ctrl = this;\r\n                this.element.classList.add('mcn-elasticbutton-' + ctrl.kind);\r\n                var contentCreated = false;\r\n                if (!ctrl.contentElement) {\r\n                    ctrl.contentElement = document.createElement('DIV');\r\n                    ctrl.contentElement.className = 'mcn-elasticbutton-content';\r\n                    WinJSContrib.Utils.moveChilds(ctrl.element, ctrl.contentElement);\r\n                    contentCreated = true;\r\n                }\r\n\r\n                if (!ctrl.bgElement) {\r\n                    ctrl.bgElement = document.createElement('DIV');\r\n                    ctrl.bgElement.className = 'mcn-elasticbutton-bg';\r\n                    ctrl.element.appendChild(ctrl.bgElement);\r\n                }\r\n\r\n                if (contentCreated) {\r\n                    ctrl.element.appendChild(ctrl.contentElement);\r\n                }\r\n\r\n                if (!ctrl.contentElement) {\r\n                    ctrl.contentElement = document.createElement('DIV');\r\n                    ctrl.contentElement.className = 'mcn-elasticbutton-content';\r\n                    while (ctrl.element.children.length > 0) {\r\n                        ctrl.contentElement.appendChild(ctrl.element.children[0]);\r\n                    }\r\n                    ctrl.element.appendChild(ctrl.contentElement);\r\n                }\r\n\r\n                ctrl.currentKind = elasticbuttonkinds[this.kind];\r\n                if (ctrl.currentKind) {\r\n                    ctrl.bgElement.innerHTML = ctrl.currentKind.svg;\r\n                    ctrl.snap = Snap(ctrl.bgElement.querySelector('svg'));\r\n                    ctrl.pathEl = ctrl.snap.select('path');\r\n                    ctrl.paths = {\r\n                        reset: ctrl.pathEl.attr('d'),\r\n                        active: ctrl.currentKind.morphpath\r\n                    };\r\n                    if (ctrl.eventTracker)\r\n                        ctrl.eventTracker.dispose();\r\n                    ctrl.eventTracker = new WinJSContrib.UI.EventTracker();\r\n                    ctrl.eventTracker.addEvent(ctrl.element, 'pointerdown', function (arg) { ctrl._ptdown(arg); });\r\n                    ctrl.eventTracker.addEvent(ctrl.element, 'pointerup', function (arg) { ctrl._ptup(arg); });\r\n                    ctrl.eventTracker.addEvent(ctrl.element, 'pointerleave', function (arg) { ctrl._ptup(arg); })\r\n                }\r\n            },\r\n\r\n            _ptdown: function (arg) {\r\n                this.element.classList.add(\"pressed\");\r\n                this.pathEl.stop().animate({ 'path': this.paths.active }, this.behavior.speed.active, this.behavior.easing.active);\r\n            },\r\n\r\n            _ptup: function (arg) {\r\n                this.element.classList.remove(\"pressed\");\r\n                this.pathEl.stop().animate({ 'path': this.paths.reset }, this.behavior.speed.reset, this.behavior.easing.reset);\r\n            },\r\n\r\n            dispose: function () {\r\n                if (this.eventTracker) this.eventTracker.dispose();\r\n                WinJS.Utilities.disposeSubTree(this.element);\r\n                this.element = null;\r\n            }\r\n        }),\r\n\t\tWinJS.Utilities.eventMixin,\r\n\t\tWinJS.Utilities.createEventProperties(\"myevent\"))\r\n    });\r\n})();","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/// <reference path=\"winjscontrib.core.js\" />\r\n\r\n//this controls requires snap.svg\r\n\r\n(function () {\r\n    'use strict';\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        FOWrapper: WinJS.Class.mix(WinJS.Class.define(function ctor(element, options) {\r\n            this.element = element || document.createElement('DIV');\r\n            options = options || {};\r\n            this.element.winControl = this;\r\n            this.element.classList.add('mcn-fowrapper');\r\n            this.element.classList.add('mcn-layout-ctrl');\r\n            this.element.classList.add('win-disposable');\r\n            WinJS.UI.setOptions(this, options);\r\n            this.render();\r\n        }, {\r\n            someProperty: {\r\n                get: function () {\r\n                    return this._someProperty;\r\n                },\r\n                set: function (val) {\r\n                    this._someProperty = val;\r\n                }\r\n            },\r\n\r\n            render: function () {\r\n                var ctrl = this;\r\n                ctrl.wrapperId = WinJSContrib.Utils.guid();\r\n                var body = document.createElement(\"BODY\");\r\n                body.className = \"mcn-fowrapper-content\";\r\n                body.style.width = '100%';\r\n                body.style.height = '100%';\r\n                WinJSContrib.Utils.moveChilds(ctrl.element, body);\r\n                ctrl.element.innerHTML = '<svg id=\"' + ctrl.wrapperId + '\" class=\"mcn-fowrapper-svg\" xmlns=\"http://www.w3.org/2000/svg\" style=\"width:100%; height: 100%\">' +\r\n                    '<defs>' +\r\n                        '<filter id=\"blur-' + ctrl.wrapperId + '\" x=\"0\" y=\"0\"><feGaussianBlur class=\"gblur\" in=\"SourceGraphic\" stdDeviation=\"0\" /></filter>' +\r\n                    '</defs>' +\r\n                    '<foreignObject class=\"fowrapper\" width=\"100%\" height=\"100%\" requiredExtensions=\"http://www.w3.org/1999/xhtml\" filter=\"url(#blur-' + ctrl.wrapperId + ')\">' +\r\n                    '</foreignObject>' +\r\n                '</svg>';\r\n                var container = ctrl.element.querySelector(\".fowrapper\");\r\n                ctrl.svg = ctrl.element.querySelector(\"svg\");\r\n                ctrl.container = container;\r\n                ctrl.content = body;\r\n                ctrl.blurFilter = ctrl.element.querySelector(\".gblur\");\r\n                ctrl.sblurFilter = Snap(ctrl.blurFilter);\r\n                container.appendChild(body);\r\n            },\r\n\r\n            blurTo: function (blur, duration, easing) {\r\n                var ctrl = this;\r\n\r\n                ctrl.sblurFilter.stop();\r\n                if (!duration) {\r\n                    ctrl.blurFilter.setAttribute(\"stdDeviation\", blur);                    \r\n                    return;\r\n                }\r\n\r\n                ctrl.sblurFilter.animate({ stdDeviation: blur }, duration, easing || mina.easeout);\r\n                ctrl.dispatchEvent('blur');\r\n            },\r\n\r\n            updateLayout: function () {\r\n                if (this.container) {\r\n                    this.container.setAttribute(\"width\", \"100%\");\r\n                    this.container.setAttribute(\"height\", \"100%\");\r\n                }\r\n            },\r\n\r\n            dispose: function () {\r\n                WinJS.Utilities.disposeSubTree(this.element);                \r\n                this.element = null;\r\n            }\r\n        }),\r\n        WinJS.Utilities.eventMixin,\r\n        WinJS.Utilities.createEventProperties(\"blur\"))\r\n    });\r\n})();","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib = WinJSContrib || {};\r\nWinJSContrib.UI = WinJSContrib.UI || {};\r\n\r\n(function () {\r\n    \"use strict\";\r\n\r\n    WinJSContrib.UI.MultiPassRenderer = WinJS.Class.define(\r\n    /**\r\n     * This control manage multi-pass rendering for improving performances when showing a list of items.\r\n     * The renderer will render \"shells\" for the items to enable page layout, and render items content on demand, or when items scrolls to view.  \r\n     * @class WinJSContrib.UI.MultiPassRenderer\r\n     */\r\n    function (element, options) {\r\n        options = options || {};\r\n        this.items = [];\r\n        this.element = element;\r\n        this._scrollProcessor = null;\r\n        this._tolerance = 1;\r\n        this._virtualize = false;\r\n        this._scrollContainer = options.scrollContainer || null;\r\n        this._multipass = options.multipass || false;\r\n        this._orientation = options.orientation || '';\r\n        this.itemClassName = options.itemClass || options.className || options.itemClassName;\r\n        this.itemTemplate = WinJSContrib.Utils.getTemplate(options.template || options.itemTemplate);\r\n        this.itemInvoked = options.invoked || options.itemInvoked;\r\n        this.onitemContent = options.onitemContent;\r\n        this._onScrollBinded = this._onScroll.bind(this);\r\n\r\n        if (element) {\r\n            element.className = element.className + ' mcn-items-ctrl mcn-layout-ctrl win-disposable';\r\n        }\r\n\r\n        //element.mcnRenderer = this;\r\n        //WinJS.UI.setOptions(this, options);\r\n    },\r\n    /**\r\n      * @lends WinJSContrib.UI.MultiPassRenderer.prototype\r\n      */\r\n    {\r\n        dispose : function(){\r\n            var ctrl = this;\r\n            WinJSContrib.UI.untapAll(ctrl.element);\r\n            WinJS.Utilities.disposeSubTree(ctrl.element);\r\n            ctrl._unregisterScrollEvents();\r\n            ctrl._scrollContainer = null;\r\n            ctrl.element = null;\r\n            ctrl._scrollProcessor = null;\r\n            ctrl.rect = null;           \r\n            ctrl.items = [];\r\n        },\r\n\r\n        clear: function () {\r\n            var ctrl = this;\r\n            WinJS.Utilities.disposeSubTree(ctrl.element);\r\n            ctrl.element.innerHTML = '';\r\n        },\r\n\r\n        /**\r\n         * kind of multipass, can be 'section', or 'item'\r\n         * @type {String}\r\n         * @field\r\n         */\r\n        multipass: {\r\n            get: function () {\r\n                return this._multipass;\r\n            },\r\n            set: function (val) {\r\n                this._multipass = val;\r\n                this.refreshScrollEvents();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * tolerance for determining if the rendering should apply. Tolerance is expressed in scroll container proportion. For example, 1 means that tolerance is equal to scroll container size\r\n         * @type {number}\r\n         * @field\r\n         */\r\n        tolerance: {\r\n            get: function () {\r\n                return this._tolerance;\r\n            },\r\n            set: function (val) {\r\n                this._tolerance = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * indicate if renderer empty items out of sight\r\n         * @type {boolean}\r\n         * @field\r\n         */\r\n        virtualize: {\r\n            get: function () {\r\n                return this._virtualize;\r\n            },\r\n            set: function (val) {\r\n                this._virtualize = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * could be 'vertical' or 'horizontal'\r\n         * @type {String}\r\n         * @field\r\n         */\r\n        orientation: {\r\n            get: function () {\r\n                return this._orientation;\r\n            },\r\n            set: function (val) {\r\n                this._orientation = val;\r\n                this.refreshScrollEvents();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Element containing scroll. If scrollContainer is filled, items content will get rendered when coming into view\r\n         * @type {HTMLElement}\r\n         * @field\r\n         */\r\n        scrollContainer: {\r\n            get: function () {\r\n                return this._scrollContainer;\r\n            },\r\n            set: function (val) {\r\n                this._unregisterScrollEvents();\r\n                this._scrollContainer = val;\r\n                this._registerScrollEvents();\r\n                //this.checkRendering();\r\n            }\r\n        },\r\n\r\n        _onScroll: function () {\r\n            var ctrl = this;\r\n            if (ctrl.scrollContainer && ctrl._scrollProcessor) {\r\n                if (ctrl._scrollRequest) {\r\n                    cancelAnimationFrame(ctrl._scrollRequest);\r\n                }\r\n\r\n                ctrl._scrollRequest = requestAnimationFrame(function () {\r\n                    ctrl.checkRendering();\r\n                });\r\n            }\r\n        },\r\n\r\n        _unregisterScrollEvents: function () {\r\n            this._scrollProcessor = null;\r\n            this.clearOffsets();\r\n            if (this.scrollContainer) {\r\n                this.scrollContainer.removeEventListener('scroll', this._onScrollBinded);\r\n            }\r\n        },\r\n\r\n        _registerScrollEvents: function () {\r\n            var ctrl = this;\r\n            if (ctrl.scrollContainer) {\r\n                this.scrollContainer.addEventListener('scroll', this._onScrollBinded);\r\n\r\n                if (ctrl.orientation == 'vertical') {\r\n                    if (ctrl.multipass == 'section') {\r\n                        ctrl._scrollProcessor = function () { ctrl._checkSection(ctrl._vIsInView); }\r\n                    } else if (ctrl.multipass == 'item') {\r\n                        ctrl._scrollProcessor = function () { ctrl._checkItem(ctrl._vIsInView); }\r\n                    }\r\n                } else {\r\n                    if (ctrl.multipass == 'section') {\r\n                        ctrl._scrollProcessor = function () { ctrl._checkSection(ctrl._hIsInView); }\r\n                    } else if (ctrl.multipass == 'item') {\r\n                        ctrl._scrollProcessor = function () { ctrl._checkItem(ctrl._hIsInView); }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * refresh scroll events associated to multi pass renderer\r\n         */\r\n        refreshScrollEvents: function () {\r\n            this._unregisterScrollEvents();\r\n            this._registerScrollEvents();\r\n            this.clearOffsets();\r\n        },\r\n\r\n        _vIsInView: function (rect, scrollContainer, tolerance) {\r\n            var pxTolerance = scrollContainer.clientHeight * tolerance;\r\n            if (rect.y >= scrollContainer.scrollTop - pxTolerance && rect.y <= scrollContainer.scrollTop + scrollContainer.clientHeight + pxTolerance)\r\n                return true;\r\n\r\n            if (rect.y + rect.height >= scrollContainer.scrollTop - pxTolerance && rect.y + rect.height <= scrollContainer.scrollTop + scrollContainer.clientHeight + pxTolerance)\r\n                return true;\r\n\r\n            if (rect.y <= scrollContainer.scrollTop - pxTolerance && rect.y + rect.height >= scrollContainer.scrollTop + scrollContainer.clientHeight + pxTolerance)\r\n                return true;\r\n\r\n            return false;\r\n        },\r\n\r\n        _hIsInView: function (rect, scrollContainer, tolerance) {\r\n            var pxTolerance = scrollContainer.clientWidth * (tolerance || 0);\r\n            if (rect.x >= scrollContainer.scrollLeft - pxTolerance && rect.x <= scrollContainer.scrollLeft + scrollContainer.clientWidth + pxTolerance)\r\n                return true;\r\n\r\n            if (rect.x + rect.width >= scrollContainer.scrollLeft - pxTolerance && rect.x + rect.width <= scrollContainer.scrollLeft + scrollContainer.clientWidth + pxTolerance)\r\n                return true;\r\n\r\n            if (rect.x <= scrollContainer.scrollLeft - pxTolerance && rect.x + rect.width >= scrollContainer.scrollLeft + scrollContainer.clientWidth + pxTolerance)\r\n                return true;\r\n\r\n            return false;\r\n        },\r\n\r\n        /**\r\n         * Clear cached offsets for bloc and for items\r\n         */\r\n        clearOffsets: function () {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n            \r\n            ctrl.rect = null;\r\n            ctrl.items.forEach(function (item) {\r\n                item.rect = null;\r\n            });\r\n        },\r\n\r\n        /**\r\n         * update ui related properties like cached offsets, scroll events, ...\r\n         */\r\n        updateLayout: function () {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n            ctrl.refreshScrollEvents();\r\n        },\r\n\r\n        _checkSection: function (check, tolerance, noRender) {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n            tolerance = tolerance || 0;\r\n\r\n            if (!ctrl.rect && ctrl.items && ctrl.items.length) {\r\n                ctrl.rect = WinJSContrib.UI.offsetFrom(ctrl.element, ctrl.scrollContainer);\r\n            } else {\r\n                ctrl.rect = ctrl.rect || { x: 0, y: 0, width: 0, height: 0 };\r\n                ctrl.rect.width = ctrl.element.clientWidth;\r\n                ctrl.rect.height = ctrl.element.clientHeight;\r\n            }\r\n\r\n            if (check(ctrl.rect, ctrl.scrollContainer, tolerance)) {\r\n                if (noRender)\r\n                    return true;\r\n\r\n                ctrl.renderItemsContent();\r\n                if (ctrl.onrendersection) {\r\n                    ctrl.onrendersection();\r\n                }\r\n            } else if (ctrl.virtualize && tolerance > 0 && ctrl.items && ctrl.items.length && ctrl.items[0].rendered) {\r\n                ctrl.items.forEach(function (item) {\r\n                    item.empty();\r\n                });\r\n            }\r\n\r\n            if (tolerance == 0 && ctrl.tolerance > 0) {\r\n                setImmediate(function () {\r\n                    ctrl._checkSection(check, ctrl.tolerance);\r\n                });\r\n            }\r\n        },\r\n\r\n        _checkItem: function (check, tolerance) {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n            tolerance = tolerance || 0;\r\n            var allRendered = true;\r\n\r\n            var countR = function () {\r\n                var countRendered = 0;\r\n                ctrl.items.forEach(function (item) {\r\n                    if (item.rendered) {\r\n                        countRendered++;\r\n                    }\r\n                });\r\n                console.log('rendered ' + countRendered);\r\n            }\r\n\r\n            if (ctrl._checkSection(check, tolerance, true)) {\r\n                ctrl.items.forEach(function (item) {\r\n                    if (!item.rect) {\r\n                        item.rect = WinJSContrib.UI.offsetFrom(item.element, ctrl.scrollContainer);\r\n                    }\r\n                    allRendered = allRendered & item.rendered;\r\n\r\n                    if (!item.rendered && check(item.rect, ctrl.scrollContainer, tolerance)) {\r\n                        item.render();\r\n                    } else if (item.rendered && ctrl.virtualize && tolerance > 0 && !check(item.rect, ctrl.scrollContainer, tolerance)) {\r\n                        item.empty();\r\n                    }\r\n                });\r\n                ctrl.allRendered = allRendered;\r\n                //countR();\r\n            } else if (tolerance > 0 && ctrl.items.length && (ctrl.items[0].rendered || ctrl.items[ctrl.items.length - 1].rendered)) {\r\n                ctrl.items.forEach(function (item) {\r\n                    if (!item.rect) {\r\n                        item.rect = WinJSContrib.UI.offsetFrom(item.element, ctrl.scrollContainer);\r\n                    }\r\n                    if (ctrl.virtualize && !check(item.rect, ctrl.scrollContainer, tolerance)) {\r\n                        item.empty();\r\n                    }\r\n                });\r\n                //countR();\r\n            }\r\n\r\n            if (tolerance == 0 && ctrl.tolerance > 0) {\r\n                setImmediate(function () {\r\n                    ctrl._checkItem(check, ctrl.tolerance);\r\n                });\r\n            }\r\n\r\n\r\n        },\r\n\r\n        /**\r\n         * render items shells to the page\r\n         * @param {Array} items array of items to render\r\n         * @param {Object} renderOptions options for rendering items, can override control options like item template\r\n         */\r\n        prepareItems: function (items, renderOptions) {\r\n            var ctrl = this;\r\n            items = items || [];\r\n            renderOptions = renderOptions || {};\r\n            var numItems = items.length;\r\n\r\n            var itemInvoked = renderOptions.itemInvoked || ctrl.itemInvoked;\r\n            if (typeof itemInvoked == 'string')\r\n                itemInvoked = WinJSContrib.Utils.resolveMethod(ctrl.element, itemInvoked);\r\n            var template = WinJSContrib.Utils.getTemplate(renderOptions.template) || ctrl.itemTemplate;\r\n            var className = renderOptions.itemClassName || ctrl.itemClassName;\r\n            var onitemInit = renderOptions.onitemInit || ctrl.onitemInit;\r\n            var onitemContent = renderOptions.onitemContent || ctrl.onitemContent;\r\n            var container = ctrl.element;\r\n            var registereditems = ctrl.items;\r\n\r\n            items.forEach(function (itemdata) {\r\n                var item = new WinJSContrib.UI.MultiPassItem(ctrl, null, {\r\n                    data: itemdata,\r\n                    template: template,\r\n                    className: className,\r\n                    itemInvoked: itemInvoked,\r\n                    onitemInit: onitemInit,\r\n                    onitemContent: onitemContent\r\n                });\r\n                registereditems.push(item);\r\n                container.appendChild(item.element);\r\n            });\r\n            //for (var i = 0 ; i < numItems; i++) {\r\n            //    var itemdata = items[i];\r\n            //    var item = new WinJSContrib.UI.MultiPassItem(ctrl, null, {\r\n            //        data: itemdata,\r\n            //        template: template,\r\n            //        className: className,\r\n            //        itemInvoked: itemInvoked,\r\n            //        onitemInit: onitemInit,\r\n            //        onitemContent: onitemContent\r\n            //    });\r\n            //    registereditems.push(item);\r\n            //    container.appendChild(item.element);\r\n            //}\r\n\r\n            if (renderOptions.renderItems || !this.multipass) {\r\n                ctrl.renderItemsContent();\r\n            }\r\n            //ctrl.element.style.display = '';\r\n        },\r\n\r\n        /**\r\n         * check rendering of items, based on multipass configuration (force items on screen to render)\r\n         */\r\n        checkRendering: function () {\r\n            var ctrl = this;\r\n            if (ctrl.element && ctrl._scrollProcessor)\r\n                ctrl._scrollProcessor();\r\n        },\r\n\r\n        /**\r\n         * force rendering of all unrendered items\r\n         */\r\n        renderItemsContent: function () {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n\r\n            ctrl.items.forEach(function (item) {\r\n                if (!item.rendered) {\r\n                    //setImmediate(function () {\r\n                    item.render();\r\n                    //});\r\n                }\r\n            });\r\n            ctrl.allRendered = true;\r\n        }\r\n    });\r\n\r\n    WinJSContrib.UI.MultiPassItem = WinJS.Class.define(\r\n        /**\r\n         * Item for multipass rendering\r\n         * @class WinJSContrib.UI.MultiPassItem\r\n         */\r\n    function (renderer, element, options) {\r\n        options = options || {};\r\n        var item = this;\r\n        item.renderer = renderer;\r\n        item.element = element || document.createElement('DIV');\r\n        item.element.className = item.element.className + ' ' + options.className + ' mcn-multipass-item unloaded win-disposable';\r\n        item.element.winControl = item;\r\n\r\n        item.itemInvoked = options.itemInvoked;\r\n        item.itemDataPromise = WinJS.Promise.as(options.data);\r\n\r\n        item.itemTemplate = options.template;\r\n        item.rendered = false;\r\n        item.onitemContent = options.onitemContent;\r\n        if (options.onitemInit) {\r\n            options.onitemInit(this);\r\n        }\r\n    },\r\n    /**\r\n     * @lends WinJSContrib.UI.MultiPassItem\r\n     */\r\n    {\r\n        dispose: function () {\r\n            var item = this;\r\n            item.renderer = null;\r\n            item.element = null;\r\n            item.itemInvoked = null;\r\n            item.itemData = null;\r\n            item.itemDataPromise = null;\r\n            item.itemTemplate = null;\r\n            item.onitemContent = null;\r\n        },\r\n\r\n        /**\r\n         * render item content\r\n         */\r\n        render: function (delayed) {\r\n            var ctrl = this;\r\n\r\n            if (ctrl.element && ctrl.itemTemplate && !ctrl.rendered) {\r\n\r\n                ctrl.rendered = true;\r\n                return ctrl._renderContent();\r\n            }\r\n\r\n            return WinJS.Promise.wrap(ctrl.contentElement);\r\n        },\r\n\r\n        /**\r\n         * empty item and mark it as unrendered\r\n         */\r\n        empty: function () {\r\n            var ctrl = this;\r\n            if (ctrl.element && ctrl.rendered) {\r\n                WinJSContrib.UI.untapAll(ctrl.element);\r\n                ctrl.element.classList.remove('loaded');\r\n                ctrl.element.innerHTML = '';\r\n                ctrl.rendered = false;\r\n            }\r\n        },\r\n\r\n        _renderItemContent: function (rendered) {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n\r\n            ctrl.element.appendChild(rendered);\r\n\r\n            if (ctrl.itemInvoked) {\r\n                if (typeof ctrl.itemInvoked == 'string')\r\n                    ctrl.itemInvoked = WinJSContrib.Utils.resolveMethod(ctrl.element, ctrl.itemInvoked);\r\n\r\n                if (ctrl.itemInvoked) {\r\n                    WinJSContrib.UI.tap(ctrl.element, function (arg) {\r\n                        ctrl.itemInvoked(ctrl);\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (ctrl.onitemContent) {\r\n                ctrl.onitemContent(ctrl.itemData, rendered);\r\n            }\r\n            else if (ctrl.renderer.onitemContent) {\r\n                ctrl.renderer.onitemContent(ctrl.itemData, rendered);\r\n            }\r\n\r\n            setImmediate(function () {\r\n                if (ctrl.element) {\r\n                    ctrl.element.classList.remove('unloaded');\r\n                    ctrl.element.classList.add('loaded');\r\n                }\r\n            });\r\n\r\n            ctrl.rendered = true;\r\n            ctrl.contentElement = rendered;\r\n            return rendered;\r\n        },\r\n\r\n        _renderContent: function () {\r\n            var ctrl = this;\r\n\r\n            if (ctrl.element && ctrl.itemTemplate) {\r\n                return ctrl.itemDataPromise.then(function (data) {\r\n                    ctrl.itemData = data;\r\n                    return ctrl.itemTemplate.render(data).then(function (rendered) {\r\n                        ctrl._renderItemContent(rendered);\r\n                    });\r\n                });\r\n            }\r\n\r\n            return WinJS.Promise.wrap();\r\n        }\r\n    });\r\n})();","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n(function () {\r\n\r\n\t\"use strict\";\r\n\r\n\t/**\r\n     * Object representing a layout configuration for the grid control\r\n     * @typedef {Object} WinJSContrib.UI.GridControlLayout\r\n     * @property {string} layout layout algorythm to apply (horizontal | vertical | flexhorizontal | flexvertical | hbloc\r\n     * @property {number} cellSpace space between grid cells\r\n     * @property {number} cellWidth width of grid cells\r\n     * @property {number} cellHeight height of grid cells\r\n     * @property {number} itemsPerColumn number of cells per column if using a layout with a fixed number of cells\r\n     * @property {number} itemsPerRow number of cells per row if using a layout with a fixed number of cells\r\n     * @example\r\n     * {\r\n     *     layout: 'horizontal',\r\n     *     itemsPerColumn: (options.itemsPerColumn) ? options.itemsPerColumn : undefined,\r\n     *     itemsPerRow: (options.itemsPerRow) ? options.itemsPerRow : undefined,\r\n     *     cellSpace: 10,\r\n     *     cellWidth: (options.cellWidth) ? options.cellWidth : undefined,\r\n     *     cellHeight: (options.cellHeight) ? options.cellHeight : undefined,\r\n     * }\r\n     */\r\n\r\n\tWinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n\t\tGridControl: WinJS.Class.define(\r\n            /**\r\n             * @classdesc\r\n             * Control that layout it's children with different algorythms. Used with {@link WinJSContrib.UI.Hub}, The Grid could rely on multipass rendering to optimize large hub pages load.\r\n             * @class WinJSContrib.UI.GridControl\r\n             * @param {HTMLElement} element DOM element containing the control\r\n             * @param {Object} options\r\n             */\r\n            function GridControl(element, options) {\r\n            \tvar grid = this;\r\n            \toptions = options || {};\r\n            \tgrid.element = element;\r\n\r\n            \tgrid.element.className = grid.element.className + ' mcn-grid-ctrl mcn-layout-ctrl win-disposable';\r\n            \tgrid.element.winControl = grid;\r\n\r\n\r\n            \t/**\r\n                 * multipass renderer for the grid\r\n                 * @field\r\n                 * @type WinJSContrib.UI.MultiPassRenderer\r\n                 */\r\n            \tgrid.renderer = new WinJSContrib.UI.MultiPassRenderer(grid.element, {\r\n            \t\tmultipass: options.multipass,\r\n            \t\titemClassName: options.itemClassName,\r\n            \t\titemTemplate: options.itemTemplate,\r\n            \t\titemInvoked: options.itemInvoked,\r\n            \t});\r\n\r\n\r\n            \tgrid.layouts = options.layouts;\r\n\r\n            \t/**\r\n                 * default layout definitions for the grid\r\n                 * @field\r\n                 * @type WinJSContrib.UI.GridControlLayout\r\n                 */\r\n            \tgrid.defaultLayout = {\r\n            \t\tlayout: options.layout || 'none',\r\n            \t\titemsPerColumn: (options.itemsPerColumn) ? options.itemsPerColumn : undefined,\r\n            \t\titemsPerRow: (options.itemsPerRow) ? options.itemsPerRow : undefined,\r\n            \t\tcellSpace: (options.cellSpace) ? options.cellSpace : 10,\r\n            \t\tcellWidth: (options.cellWidth) ? options.cellWidth : undefined,\r\n            \t\tcellHeight: (options.cellHeight) ? options.cellHeight : undefined,\r\n            \t};\r\n\r\n            \t/**\r\n                 * indicate if grid accept layout event from the page (if you use WinJS Contrib page events)\r\n                 * @field\r\n                 * @type boolean\r\n                 */\r\n            \tgrid.autolayout = options.autolayout || true;\r\n\r\n            \tvar parent = WinJSContrib.Utils.getScopeControl(grid.element);\r\n            \tif (parent && parent.pageLifeCycle) {\r\n            \t\tparent.pageLifeCycle.steps.layout.attach(function () {\r\n            \t\t\tif (grid.autolayout) {\r\n            \t\t\t\tgrid.layout();\r\n            \t\t\t}\r\n            \t\t});\r\n            \t}\r\n            \telse if (parent && parent.elementReady) {\r\n            \t\tparent.elementReady.then(function () {\r\n            \t\t\tparent.readyComplete.then(function () {\r\n            \t\t\t\tif (grid.autolayout) {\r\n            \t\t\t\t\tgrid.layout();\r\n            \t\t\t\t}\r\n            \t\t\t});\r\n            \t\t});\r\n            \t}\r\n            },\r\n            /**\r\n             * @lends WinJSContrib.UI.GridControl.prototype\r\n             */\r\n            {\r\n            \t/**\r\n                 * scroll element containing the grid. Required for multi pass rendering\r\n                 * @field\r\n                 * @type HTMLElement\r\n                 */\r\n            \tscrollContainer: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.scrollContainer;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.scrollContainer = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * indicate if grid layout itself according to the page lifecycle (default to true)\r\n                 * @field\r\n                 * @type boolean\r\n                 */\r\n            \tautolayout: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this._autolayout;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis._autolayout = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * layout definitions for the grid. It's an object containing several grid layout options. See {@link WinJSContrib.UI.GridControlLayout}\r\n                 * @field\r\n                 * @type Object\r\n                 */\r\n            \tlayouts: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.gridLayouts;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.gridLayouts = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * indicate the kind of multipass treatment\r\n                 * @field\r\n                 * @type string\r\n                 */\r\n            \tmultipass: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.multipass;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.multipass = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * callback triggered when clicking on an item\r\n                 * @field\r\n                 * @type HTMLElement\r\n                 */\r\n            \titemInvoked: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.itemInvoked;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.itemInvoked = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * item template (WinJS Template or template function)\r\n                 * @field\r\n                 * @type Object\r\n                 */\r\n            \titemTemplate: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.itemTemplate;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.itemTemplate = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * css class added on item's placeholder\r\n                 * @field\r\n                 * @type Object\r\n                 */\r\n            \titemClassName: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.itemClassName;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.itemClassName = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * items to render\r\n                 * @field\r\n                 * @type Object\r\n                 */\r\n            \titems: {\r\n            \t\tget: function () {\r\n            \t\t\treturn;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n\t\t\t\t\t\tif (val && val.length)\r\n            \t\t\t\tthis.prepareItems(val);\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * render HTML for items\r\n                 * @param {Array} items array of items to render\r\n                 * @param {Object} renderOptions\r\n                 */\r\n            \tprepareItems: function (items, renderOptions) {\r\n                    if (!this.element)\r\n                        return;\r\n                    \r\n            \t\tvar parent = WinJSContrib.Utils.getParentControlByClass('mcn-layout-ctrl', this.element);\r\n            \t\tvar parentMultipass = undefined;\r\n            \t\tif (!this.renderer.multipass && parent && parent.multipass) {\r\n            \t\t\tthis.renderer.multipass = parent.multipass;\r\n            \t\t}\r\n\r\n            \t\tthis.renderer.prepareItems(items, renderOptions);\r\n            \t},\r\n\r\n            \t/**\r\n                 * force items content to render\r\n                 */\r\n            \trenderItemsContent: function () {\r\n            \t\tif (!this.renderer)\r\n                        return;\r\n                    this.renderer.renderItemsContent();\r\n            \t},\r\n\r\n            \tresetElement: function (elt, isItem) {\r\n            \t\tvar style = elt.style;\r\n            \t\tif (isItem && style.position) style.position = '';\r\n            \t\tif (!isItem && style.display) style.display = '';\r\n            \t\tif (style.width) style.width = '';\r\n            \t\tif (style.height) style.height = '';\r\n            \t\tif (style.minWidth) style.minWidth = '';\r\n            \t\tif (style.minHeight) style.minHeight = '';\r\n            \t\tif (style.left) style.left = '';\r\n            \t\tif (style.top) style.top = '';\r\n            \t},\r\n\r\n            \tclearContent: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\tctrl.renderer.clear();\r\n            \t},\r\n\r\n            \t/**\r\n                 * Clear all layout and position styles on items\r\n                 */\r\n            \tclearLayout: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\t\r\n            \t\tctrl.resetElement(ctrl.element, false);\r\n            \t\tif (ctrl.element.children.length) {\r\n            \t\t\tfor (var i = 0, l = ctrl.element.children.length; i < l; i++) {\r\n            \t\t\t\tctrl.resetElement(ctrl.element.children[i], true);\r\n            \t\t\t}\r\n            \t\t}\r\n            \t},\r\n\r\n            \tfill: function (matrix, x, y, w, h) {\r\n            \t\tif (matrix.length < x + w) {\r\n            \t\t\tfor (var i = matrix.length ; i < x + w ; i++) {\r\n            \t\t\t\tmatrix.push([]);\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\tfor (var i = x ; i < x + w ; i++) {\r\n            \t\t\tvar col = matrix[i];\r\n            \t\t\tif (col.length < y + h) {\r\n            \t\t\t\tfor (var j = col.length ; j < y + h ; j++) {\r\n            \t\t\t\t\tcol.push(false);\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n\r\n            \t\t\tfor (var j = y ; j < y + h ; j++) {\r\n            \t\t\t\tcol[j] = true;\r\n            \t\t\t}\r\n            \t\t}\r\n            \t},\r\n\r\n            \tfit: function (matrix, x, y, w, h, maxW, maxH) {\r\n            \t\t//items to big\r\n            \t\tif (maxH && h > maxH && y === 0)\r\n            \t\t\treturn true;\r\n            \t\tif (maxW && w > maxW && x === 0)\r\n            \t\t\treturn true;\r\n\r\n            \t\t//overflow grid capacity\r\n            \t\tif (maxW && (x + w) > maxW)\r\n            \t\t\treturn false;\r\n            \t\tif (maxH && (y + h) > maxH)\r\n            \t\t\treturn false;\r\n\r\n            \t\tfor (var i = x ; i < x + w ; i++) {\r\n            \t\t\tvar col = matrix[i];\r\n            \t\t\tif (col) {\r\n            \t\t\t\tfor (var j = y ; j < y + h ; j++) {\r\n            \t\t\t\t\tif (col[j] === true)\r\n            \t\t\t\t\t\treturn false;\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\treturn true;\r\n            \t},\r\n\r\n            \tfirstFit: function (matrix, w, h, maxH, numItems) {\r\n            \t\tvar ctrl = this;\r\n            \t\tfor (var i = 0 ; i < numItems * maxH * 2 ; i++) {\r\n            \t\t\tvar col = matrix[i];\r\n            \t\t\tif (col) {\r\n            \t\t\t\tfor (var j = 0 ; j < maxH ; j++) {\r\n            \t\t\t\t\tif (col[j] !== true && ctrl.fit(matrix, i, j, w, h, undefined, maxH)) {\r\n            \t\t\t\t\t\treturn { x: i, y: j };\r\n            \t\t\t\t\t}\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n            \t\t\telse {\r\n            \t\t\t\treturn { x: i, y: 0 };\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\treturn undefined;\r\n            \t},\r\n\r\n            \tvisibleChilds: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\tvar res = [];\r\n\r\n            \t\tfor (var i = 0, l = ctrl.element.children.length; i < l ; i++) {\r\n            \t\t\tvar item = ctrl.element.children[i];\r\n            \t\t\tvar st = window.getComputedStyle(item);\r\n            \t\t\tif (st.display != 'none' && st.visibility != 'hidden') {\r\n            \t\t\t\tres.push(item);\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\treturn res;\r\n            \t},\r\n\r\n            \t/**\r\n                 * Layouts algorythm implementations\r\n                 */\r\n            \tGridLayoutsImpl: {\r\n            \t\tnone: function () {\r\n            \t\t},\r\n\r\n            \t\tflexhorizontal: function () {\r\n            \t\t\tvar ctrl = this;\r\n            \t\t\tctrl.renderer.orientation = 'horizontal';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\tctrl.element.style.display = 'flex';\r\n            \t\t\tctrl.element.style.flexFlow = 'column wrap';\r\n            \t\t\tctrl.element.style.alignContent = 'flex-start';\r\n            \t\t\t//ctrl.element.style.alignContent = 'flex-start';\r\n\r\n            \t\t\tif (ctrl.element.style.width)\r\n            \t\t\t\tctrl.element.style.width = '';\r\n\r\n            \t\t\tctrl.element.style.height = '';\r\n\r\n            \t\t\tif (ctrl.element.clientHeight)\r\n            \t\t\t\tctrl.element.style.height = ctrl.element.clientHeight + 'px';\r\n            \t\t\telse\r\n            \t\t\t\tctrl.element.style.height = '';\r\n\r\n            \t\t\tvar _itemsPerColumn = Math.floor(ctrl.element.clientHeight / (ctrl.data.cellHeight + ctrl.data.cellSpace));\r\n            \t\t\tif (_itemsPerColumn) {\r\n            \t\t\t\tvar visibleitems = ctrl.visibleChilds();\r\n            \t\t\t\tvar columns = Math.ceil(visibleitems.length / _itemsPerColumn);\r\n            \t\t\t\tctrl.element.style.minWidth = ((ctrl.data.cellWidth + ctrl.data.cellSpace) * columns) + 'px';\r\n            \t\t\t}\r\n            \t\t},\r\n\r\n            \t\tflexvertical: function () {\r\n            \t\t    var ctrl = this;\r\n                        ctrl.renderer.orientation = 'vertical';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\tctrl.element.style.display = 'flex';\r\n            \t\t\tctrl.element.style.flexFlow = 'row wrap';\r\n            \t\t\tctrl.element.style.alignContent = 'flex-start';\r\n\r\n            \t\t\tctrl.element.style.width = '';\r\n            \t\t\tif (ctrl.element.clientWidth)\r\n            \t\t\t\tctrl.element.style.width = ctrl.element.clientWidth + 'px';\r\n            \t\t\telse\r\n            \t\t\t\tctrl.element.style.width = '';\r\n\r\n            \t\t\tif (ctrl.element.style.height)\r\n            \t\t\t\tctrl.element.style.height = '';\r\n            \t\t},\r\n\r\n            \t\thbloc: function () {\r\n            \t\t\tvar ctrl = this;\r\n            \t\t\tctrl.renderer.orientation = 'horizontal';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\tctrl.element.style.height = '';\r\n            \t\t\tvar _containerH = ctrl.element.clientHeight;\r\n            \t\t\tif (!_containerH)\r\n            \t\t\t\treturn;\r\n\r\n            \t\t\tvar cellW = ctrl.data.cellWidth;\r\n            \t\t\tvar space = ctrl.data.cellSpace;\r\n            \t\t\tvar colCount = 1;\r\n            \t\t\tvar colOffset = 0;\r\n            \t\t\tvar topOffset = 0;\r\n\r\n            \t\t\tvar childs = ctrl.visibleChilds();\r\n            \t\t\tchilds.forEach(function (elt) {\r\n            \t\t\t\tif (elt.style.position != 'absolute')\r\n            \t\t\t\t\telt.style.position = 'absolute';\r\n            \t\t\t\tvar eltH = elt.clientHeight;\r\n            \t\t\t\tif (topOffset + eltH > _containerH) {\r\n            \t\t\t\t\tcolCount++;\r\n            \t\t\t\t\tcolOffset = colOffset + space + cellW;\r\n            \t\t\t\t\ttopOffset = 0;\r\n            \t\t\t\t}\r\n\r\n            \t\t\t\tif (elt.style.left != colOffset + 'px')\r\n            \t\t\t\t\telt.style.left = colOffset + 'px';\r\n            \t\t\t\tif (elt.style.top != topOffset + 'px')\r\n            \t\t\t\t\telt.style.top = topOffset + 'px';\r\n\r\n            \t\t\t\ttopOffset += eltH;\r\n            \t\t\t});\r\n\r\n            \t\t\tcolOffset = colOffset + cellW;\r\n            \t\t\tif (ctrl.element.style.width != colOffset + 'px')\r\n            \t\t\t\tctrl.element.style.width = colOffset + 'px';\r\n            \t\t},\r\n\r\n            \t\thorizontal: function () {\r\n            \t\t\tvar ctrl = this;\r\n            \t\t\tctrl.renderer.orientation = 'horizontal';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\tctrl.element.style.height = '';\r\n            \t\t\tvar _containerH = ctrl.element.clientHeight;\r\n            \t\t\tif (!_containerH)\r\n            \t\t\t\treturn;\r\n\r\n            \t\t\tvar _itemsPerColumn = Math.floor(_containerH / (ctrl.data.cellHeight + ctrl.data.cellSpace));\r\n            \t\t\tif (_itemsPerColumn <= 0)\r\n            \t\t\t\t_itemsPerColumn = 1;\r\n\r\n            \t\t\tvar cellW = ctrl.data.cellWidth;\r\n            \t\t\tvar cellH = ctrl.data.cellHeight;\r\n            \t\t\tvar space = ctrl.data.cellSpace;\r\n            \t\t\tvar aspectRatio = cellW / cellH;\r\n            \t\t\tvar ratioW = 1;\r\n            \t\t\tvar ratioH = 1;\r\n\r\n            \t\t\tif (ctrl.data.itemsPerColumn) {\r\n            \t\t\t\t_itemsPerColumn = ctrl.data.itemsPerColumn;\r\n            \t\t\t\tcellH = ((_containerH - ((_itemsPerColumn - 1) * space)) / _itemsPerColumn) >> 0;\r\n            \t\t\t\tcellW = (ctrl.data.cellWidth * cellH / ctrl.data.cellHeight) >> 0;\r\n            \t\t\t\tratioW = cellW / ctrl.data.cellWidth;\r\n            \t\t\t\tratioH = cellH / ctrl.data.cellHeight;\r\n            \t\t\t}\r\n\r\n            \t\t\tvar gridCellsMatrix = [[]];\r\n            \t\t\tvar childs = ctrl.visibleChilds();\r\n            \t\t\tchilds.forEach(function (elt) {\r\n            \t\t\t\telt.style.position = 'absolute';\r\n            \t\t\t\tvar eltW = elt.offsetWidth * ratioW;\r\n            \t\t\t\tvar eltH = elt.offsetHeight * ratioH;\r\n            \t\t\t\tvar eltColumns = (eltW / cellW) >> 0;\r\n            \t\t\t\tvar eltRows = (eltH / cellH) >> 0;\r\n\r\n            \t\t\t\tvar pos = ctrl.firstFit(gridCellsMatrix, eltColumns, eltRows, _itemsPerColumn, ctrl.element.children.length);\r\n            \t\t\t\tif (!pos)\r\n            \t\t\t\t\tpos = { x: 0, y: 0 };\r\n            \t\t\t\tctrl.fill(gridCellsMatrix, pos.x, pos.y, eltColumns, eltRows);\r\n\r\n            \t\t\t\tvar left = pos.x * (cellW + space);\r\n            \t\t\t\tvar top = pos.y * (cellH + space);\r\n            \t\t\t\tvar w = (eltColumns * cellW + ((eltColumns - 1) * space));\r\n            \t\t\t\tvar h = (eltRows * cellH + ((eltRows - 1) * space));\r\n            \t\t\t\telt.style.left = left + 'px';\r\n            \t\t\t\telt.style.top = top + 'px';\r\n            \t\t\t\telt.style.width = w + 'px';\r\n            \t\t\t\telt.style.height = h + 'px';\r\n            \t\t\t});\r\n\r\n            \t\t\tvar elementWidth = gridCellsMatrix.length * (cellW + space);\r\n            \t\t\tctrl.element.style.width = elementWidth + 'px';\r\n            \t\t},\r\n\r\n            \t\tvertical: function (plugin) {\r\n            \t\t\tvar ctrl = this;\r\n            \t\t\tctrl.renderer.orientation = 'vertical';\r\n            \t\t\tctrl.element.style.width = '';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\t//Be aware that in this case, we invert the matrix to crawl data in lines\r\n            \t\t\tvar _containerW = ctrl.element.clientWidth;\r\n            \t\t\tif (!_containerW)\r\n            \t\t\t\treturn;\r\n\r\n            \t\t\tvar _itemsPerLine = Math.floor(_containerW / (ctrl.data.cellWidth + ctrl.data.cellSpace));\r\n            \t\t\tif (_itemsPerLine <= 0)\r\n            \t\t\t\t_itemsPerLine = 1;\r\n\r\n            \t\t\tvar cellW = ctrl.data.cellWidth;\r\n            \t\t\tvar cellH = ctrl.data.cellHeight;\r\n            \t\t\tvar space = ctrl.data.cellSpace;\r\n            \t\t\tvar aspectRatio = cellW / cellH;\r\n            \t\t\tvar ratioW = 1;\r\n            \t\t\tvar ratioH = 1;\r\n\r\n            \t\t\tif (ctrl.data.itemsPerRow) {\r\n            \t\t\t\t_itemsPerLine = ctrl.data.itemsPerRow;\r\n            \t\t\t\tcellW = ((_containerW - ((_itemsPerLine - 1) * space)) / _itemsPerLine) >> 0;\r\n            \t\t\t\tcellH = (ctrl.data.cellHeight * cellW / ctrl.data.cellWidth) >> 0;\r\n            \t\t\t\tratioW = cellW / ctrl.data.cellWidth;\r\n            \t\t\t\tratioH = cellH / ctrl.data.cellHeight;\r\n            \t\t\t}\r\n\r\n            \t\t\tvar gridCellsMatrix = [[]];\r\n            \t\t\tvar childs = ctrl.visibleChilds();\r\n            \t\t\tchilds.forEach(function (elt) {\r\n            \t\t\t\telt.style.position = 'absolute';\r\n\r\n            \t\t\t\tvar eltW = elt.offsetWidth * ratioW;\r\n            \t\t\t\tvar eltH = elt.offsetHeight * ratioH;\r\n            \t\t\t\tvar eltColumns = (eltW / cellW) >> 0;\r\n            \t\t\t\tvar eltRows = (eltH / cellH) >> 0;\r\n\r\n            \t\t\t\tvar pos = ctrl.firstFit(gridCellsMatrix, eltRows, eltColumns, _itemsPerLine, ctrl.element.children.length);\r\n            \t\t\t\t//if (!pos)\r\n            \t\t\t\t//    return;\r\n\r\n            \t\t\t\tctrl.fill(gridCellsMatrix, pos.x, pos.y, eltRows, eltColumns);\r\n\r\n            \t\t\t\tvar left = pos.y * (cellW + space);\r\n            \t\t\t\tvar top = pos.x * (cellH + space);\r\n            \t\t\t\telt.style.left = left + 'px';\r\n            \t\t\t\telt.style.top = top + 'px';\r\n            \t\t\t\telt.style.width = (eltColumns * cellW + ((eltColumns - 1) * space)) + 'px';\r\n            \t\t\t\telt.style.height = (eltRows * cellH + ((eltRows - 1) * space)) + 'px';\r\n\r\n            \t\t\t});\r\n\r\n            \t\t\tvar elementHeight = gridCellsMatrix.length * (cellH + space);\r\n            \t\t\tctrl.element.style.height = elementHeight + 'px';\r\n            \t\t},\r\n            \t},\r\n\r\n            \t/**\r\n                 * layout content items\r\n                 */\r\n            \tlayout: function () {\r\n            \t    var ctrl = this;\r\n            \t    if (!ctrl.element)\r\n            \t        return;\r\n            \t\tvar oldlayout = ctrl.data;\r\n            \t\tctrl.data = ctrl.getLayout();\r\n\r\n            \t\tif (ctrl.data) {\r\n            \t\t\t//if (ctrl.data == oldlayout && ctrl.data.applyed)\r\n            \t\t\t//    return;\r\n\r\n            \t\t\tctrl.data.cellSpace = (ctrl.data.cellSpace != undefined ? ctrl.data.cellSpace : (ctrl.defaultLayout.cellSpace != undefined ? ctrl.defaultLayout.cellSpace : 10));\r\n            \t\t\tctrl.data.cellWidth = ctrl.data.cellWidth || ctrl.defaultLayout.cellWidth || 0;\r\n            \t\t\tctrl.data.cellHeight = ctrl.data.cellHeight || ctrl.defaultLayout.cellHeight || 0;\r\n\r\n            \t\t\t//if cell dimensions are not defined, take it from last child\r\n            \t\t\tif (!ctrl.data.cellWidth || !ctrl.data.cellHeight) {\r\n            \t\t\t    if (ctrl.element && ctrl.element.childNodes && ctrl.element.children.length > 0) {\r\n            \t\t\t\t\tvar childs = ctrl.visibleChilds();\r\n            \t\t\t\t\tif (childs && childs.length) {\r\n            \t\t\t\t\t\tvar firstChild = childs[0];\r\n            \t\t\t\t\t\tvar w = firstChild.clientWidth;\r\n            \t\t\t\t\t\tvar h = firstChild.clientHeight;\r\n            \t\t\t\t\t\tvar l = childs.length;\r\n            \t\t\t\t\t\tif (l > 10) l = 10;\r\n            \t\t\t\t\t\tfor (var i = 0, l = childs.length; i < l ; i++) {\r\n            \t\t\t\t\t\t\tvar item = childs[i];\r\n            \t\t\t\t\t\t\tif (w == 0 || item.clientWidth < w) {\r\n            \t\t\t\t\t\t\t\tw = item.clientWidth;\r\n            \t\t\t\t\t\t\t}\r\n            \t\t\t\t\t\t\tif (h == 0 || item.clientHeight < h) {\r\n            \t\t\t\t\t\t\t\th = item.clientHeight;\r\n            \t\t\t\t\t\t\t}\r\n            \t\t\t\t\t\t}\r\n            \t\t\t\t\t\tctrl.data.cellWidth = w;\r\n            \t\t\t\t\t\tctrl.data.cellHeight = h;\r\n            \t\t\t\t\t}\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n\r\n            \t\t\tvar layoutChanged = !oldlayout || ctrl.data.layout !== oldlayout.layout;\r\n            \t\t\tif (ctrl.data.layout) {\r\n            \t\t\t\tvar layoutfunc = ctrl.GridLayoutsImpl[ctrl.data.layout.toLowerCase()];\r\n            \t\t\t\tif (layoutfunc) {\r\n            \t\t\t\t\tif (layoutChanged)\r\n            \t\t\t\t\t\tctrl.changeLayout();\r\n\r\n            \t\t\t\t\tlayoutfunc.bind(ctrl)(layoutChanged);\r\n            \t\t\t\t\tctrl.data.applyed = true;\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n            \t\t\tctrl.renderer.checkRendering();\r\n            \t\t}\r\n            \t},\r\n\r\n            \tchangeLayout: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\tctrl.clearLayout();\r\n            \t\tctrl.renderer.updateLayout();\r\n            \t},\r\n\r\n            \t/**\r\n                 * update grid layout\r\n                 */\r\n            \tupdateLayout: function (element, viewState, lastViewState) {\r\n            \t    var ctrl = this;\r\n            \t    if (!ctrl.element)\r\n            \t        return;\r\n            \t\tctrl.layout();\r\n            \t},\r\n\r\n            \t/**\r\n                 * get layout applicable to the current context\r\n                 */\r\n            \tgetLayout: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\tvar matchingLayout = undefined;\r\n            \t\tif (ctrl.gridLayouts) {\r\n            \t\t\tfor (var name in ctrl.gridLayouts) {\r\n            \t\t\t\tvar layout = ctrl.gridLayouts[name];\r\n            \t\t\t\tif (ctrl.gridLayouts.hasOwnProperty(name)) {\r\n            \t\t\t\t\tif (layout.query) {\r\n            \t\t\t\t\t\tvar mq = window.matchMedia(layout.query);\r\n            \t\t\t\t\t\tif (mq.matches) {\r\n            \t\t\t\t\t\t\tmatchingLayout = layout;\r\n            \t\t\t\t\t\t}\r\n            \t\t\t\t\t} else if (!matchingLayout) {\r\n            \t\t\t\t\t\tmatchingLayout = layout;\r\n            \t\t\t\t\t}\r\n            \t\t\t\t}\r\n            \t\t\t\telse if (!matchingLayout) {\r\n            \t\t\t\t\tmatchingLayout = layout;\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\tif (!matchingLayout) {\r\n            \t\t\tmatchingLayout = ctrl.defaultLayout;\r\n            \t\t}\r\n\r\n            \t\treturn JSON.parse(JSON.stringify(matchingLayout));\r\n            \t},\r\n\r\n            \t/**\r\n                 * Release grid resources\r\n                 */\r\n            \tdispose: function () {\r\n            \t\tthis.element = null;\r\n            \t\tthis.renderer.dispose();\r\n            \t\tif (WinJS.Utilities.disposeSubTree)\r\n            \t\t\tWinJS.Utilities.disposeSubTree(this.element);\r\n            \t}\r\n            })\r\n\t});\r\n\r\n\tif (WinJSContrib.UI.WebComponents) {\r\n\t\tWinJSContrib.UI.WebComponents.register('mcn-grid', WinJSContrib.UI.GridControl, {\r\n\t\t\tproperties: ['multipass', 'autolayout', 'layouts', 'itemInvoked', 'itemTemplate', 'itemClassName', 'items']\r\n\t\t});\r\n\t}\r\n})();","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        /*\n         look at http://burakkanber.com/blog/machine-learning-full-text-search-in-javascript-relevance-scoring/\n         */\n        /**\n         * definition for a field\n         * @typedef {Object} WinJSContrib.Search.FieldDefinition\n         * @property {number} weight weight of the item to rank search results\n         * @example\n         * { weight : 2}\n         */\n        /**\n         * Definition of an index content\n         * @typedef {Object} WinJSContrib.Search.IndexDefinition\n         * @property {string} key name of the property considered as a key for the items\n         * @property {Object} fields object containing item's property path as name, and {@link WinJSContrib.Search.FieldDefinition} as value\n         * @example\n         * { key: 'id', fields: { \"title\": { weight : 5}, \"description.detail\": { weight : 2}}}\n         */\n        /**\n         * Small text search features based on objet indexing and text stemming. It's inspired by tools like Lucene.\n         * For now indexes are stored with WinRT files, but it will soon be extended to support an extensible storage mecanism\n         * @namespace WinJSContrib.Search\n         */\n        /**\n         * path for search worker script file\n         * @field WinJSContrib.Search.workerPath\n         * @type {string}\n         */\n        Search.workerPath = './scripts/winjscontrib/winjscontrib.search.worker.js';\n        function writeFile(folder, fileName, CreationCollisionOption, objectGraph) {\n            return new WinJS.Promise(function (complete, error) {\n                folder.createFileAsync(fileName, CreationCollisionOption).done(function (docfile) {\n                    Windows.Storage.FileIO.writeTextAsync(docfile, JSON.stringify(objectGraph)).done(function () {\n                        if (WinJS && WinJS.log)\n                            WinJS.log(\"File written \" + docfile.path);\n                        complete();\n                    }, error);\n                }, error);\n            });\n        }\n        Search.writeFile = writeFile;\n        function openFile(folder, fileName) {\n            return new WinJS.Promise(function (complete, error) {\n                folder.createFileAsync(fileName, Windows.Storage.CreationCollisionOption.openIfExists).then(function (file) {\n                    Windows.Storage.FileIO.readTextAsync(file).done(function (text) {\n                        if (text)\n                            complete(JSON.parse(text));\n                        else\n                            complete();\n                    }, error);\n                }, error);\n            });\n        }\n        Search.openFile = openFile;\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var Index = (function () {\n            /**\n             * Search index\n             * @class WinJSContrib.Search.Index\n             * @classdesc\n             * This class is the heart of the search engine. operations performed by this object are synchronous but exposes as promises.\n             * This way Index is almost interchangeable with {@link WinJSContrib.Search.IndexWorkerProxy}\n             * @param {string} name index name\n             * @param {WinJSContrib.Search.IndexDefinition} definition index definition\n             */\n            function Index(name, definition) {\n                this.items = [];\n                this.storeData = true;\n                var index = this;\n                index.name = name || 'defaultIndex';\n                index.definition = definition || {};\n                index.items = [];\n                index.storeData = true;\n                index.onprogress = undefined;\n                index.stopWords = WinJSContrib.Search.Stemming.StopWords.common;\n                index.pipeline = new WinJSContrib.Search.Stemming.Pipeline(definition);\n                //index.pipeline.registerDefault();\n                index.folderPromise = Windows.Storage.ApplicationData.current.localFolder.createFolderAsync(\"WinJSContrib\\\\Search\", Windows.Storage.CreationCollisionOption.openIfExists).then(function (folder) {\n                    return folder;\n                }, function (err) {\n                    if (WinJS && WinJS.log)\n                        WinJS.log(\"Folder init error \" + err.message);\n                    return null;\n                });\n            }\n            /**\n             * get number of items in index\n             * @function WinJSContrib.Search.Index.prototype.count\n             * @returns {WinJS.Promise}\n             */\n            Index.prototype.count = function () {\n                return WinJS.Promise.wrap(this.items.length);\n            };\n            /**\n             * clear index\n             * @function WinJSContrib.Search.Index.prototype.clear\n             * @returns {WinJS.Promise}\n             */\n            Index.prototype.clear = function () {\n                this.items = [];\n                return WinJS.Promise.wrap();\n            };\n            /**\n             * release index\n             * @function WinJSContrib.Search.Index.prototype.dispose\n             */\n            Index.prototype.dispose = function () {\n                this.items = [];\n                this.definition = undefined;\n                this.stopWords = undefined;\n                this.pipeline.clear();\n                this.pipeline = undefined;\n                this.onprogress = undefined;\n                this.folderPromise = undefined;\n            };\n            /**\n             * export index\n             * @function WinJSContrib.Search.Index.prototype.export\n             */\n            Index.prototype.export = function () {\n                return { definition: this.definition, items: this.items };\n            };\n            /**\n             * serialize index to string\n             * @function WinJSContrib.Search.Index.prototype.toString\n             */\n            Index.prototype.toString = function () {\n                return JSON.stringify(this.export());\n            };\n            /**\n             * load index from serialized string\n             * @function WinJSContrib.Search.Index.prototype.loadData\n             */\n            Index.prototype.loadData = function (indexString) {\n                var tmp = indexString;\n                if (typeof tmp == 'String')\n                    tmp = JSON.parse(indexString);\n                if (tmp) {\n                    if (tmp.definition && tmp.definition.fields && tmp.items && tmp.items.length) {\n                        this.definition = tmp.definition;\n                        this.pipeline.reload(this.definition);\n                    }\n                    this.items = tmp.items || [];\n                }\n            };\n            /**\n             * save index to storage\n             * @function WinJSContrib.Search.Index.prototype.save\n             * @returns {WinJS.Promise}\n             */\n            Index.prototype.save = function () {\n                var idx = this;\n                var exp = idx.export();\n                return idx.folderPromise.then(function (folder) {\n                    return Search.writeFile(folder, idx.name, Windows.Storage.CreationCollisionOption.replaceExisting, exp).then(function (filename) {\n                        return { index: idx };\n                    });\n                });\n            };\n            /**\n             * load index from storage\n             * @function WinJSContrib.Search.Index.prototype.load\n             * @returns {WinJS.Promise}\n             */\n            Index.prototype.load = function () {\n                var idx = this;\n                return idx.folderPromise.then(function (folder) {\n                    return Search.openFile(folder, idx.name).then(function (savedidx) {\n                        idx.loadData(savedidx);\n                    });\n                });\n            };\n            Index.prototype._runSearch = function (querytext, options) {\n                var index = this;\n                var preparedTokens = index.processText(querytext);\n                var searchResult = [];\n                var size = index.items.length;\n                var lastprogress = -1;\n                for (var i = 0; i < size; i++) {\n                    var itemResult = index._searchItem(preparedTokens, index.items[i]);\n                    if (itemResult)\n                        searchResult.push(itemResult);\n                    var p = (100 * i / size) << 0;\n                    if (index.onprogress && p != lastprogress)\n                        index.onprogress({ progressPercent: p, items: size, current: i });\n                    lastprogress = p;\n                }\n                searchResult = searchResult.sort(function (a, b) {\n                    return b.rank - a.rank;\n                });\n                if (options && options.limit) {\n                    searchResult = searchResult.slice(0, options.limit);\n                }\n                return searchResult;\n            };\n            /**\n             * search index\n             * @function WinJSContrib.Search.Index.prototype.search\n             * @param {string} querytext\n             * @returns {WinJS.Promise} search result\n             */\n            Index.prototype.search = function (querytext, options) {\n                return WinJS.Promise.wrap(this._runSearch(querytext, options));\n            };\n            Index.prototype._searchItem = function (searchtokens, indexitem) {\n                var index = this;\n                var size = indexitem.items.length;\n                var points = 0;\n                for (var i = 0; i < size; i++) {\n                    var tokenitem = indexitem.items[i];\n                    if (searchtokens.untokenized && tokenitem.tokens.untokenized == searchtokens.untokenized) {\n                        points += 4 * tokenitem.weight;\n                    }\n                    if (searchtokens.untokenized && tokenitem.tokens.untokenized && tokenitem.tokens.untokenized.indexOf(searchtokens.untokenized) >= 0) {\n                        points += 2 * tokenitem.weight;\n                    }\n                    for (var t = 0; t < tokenitem.tokens.items.length; t++) {\n                        var token = tokenitem.tokens.items[t];\n                        for (var s = 0; s < searchtokens.items.length; s++) {\n                            var stoken = searchtokens.items[s];\n                            if (stoken.length > 1 && token == stoken) {\n                                points += tokenitem.weight;\n                            }\n                            if (stoken.length > 2 && token.indexOf(stoken) >= 0) {\n                                points += tokenitem.weight * 0.2;\n                            }\n                        }\n                    }\n                }\n                if (points) {\n                    return { rank: points, key: indexitem.key, item: indexitem.rawdata };\n                }\n            };\n            /**\n             * set index definition\n             * @function WinJSContrib.Search.Index.prototype.define\n             */\n            Index.prototype.define = function (obj) {\n                this.definition = obj;\n            };\n            Index.prototype._add = function (obj) {\n                var index = this;\n                var key = undefined;\n                var def = index.definition;\n                var res = {\n                    items: [],\n                    rawdata: undefined,\n                    key: undefined\n                };\n                if (!def || !def.fields)\n                    return;\n                if (index.storeData)\n                    res.rawdata = obj;\n                if (def.key)\n                    res.key = WinJSContrib.Utils.readProperty(obj, def.key);\n                for (var elt in def.fields) {\n                    if (def.fields.hasOwnProperty(elt)) {\n                        var weight = def.fields[elt].weight || 1;\n                        var value = WinJSContrib.Utils.readProperty(obj, elt.split('.'));\n                        if (value)\n                            res.items.push({ tokens: index.processText(value), weight: weight });\n                    }\n                }\n                index.items.push(res);\n                return WinJS.Promise.wrap(res);\n            };\n            /**\n             * add an object to index\n             * @function WinJSContrib.Search.Index.prototype.add\n             * @param {Object} obj object to index\n             * @param {WinJSContrib.Search.IndexDefinition} definition index definition (optional), use index's definition if not defined\n             * @returns {WinJS.Promise}\n             */\n            Index.prototype.add = function (obj) {\n                return WinJS.Promise.wrap(this._add(obj));\n            };\n            /**\n             * add an array of objects to index\n             * @function WinJSContrib.Search.Index.prototype.addRange\n             * @param {Array} items items array\n             * @returns {WinJS.Promise}\n             */\n            Index.prototype.addRange = function (arr, progress) {\n                var index = this;\n                var size = arr.length;\n                var indexed = [];\n                var lastprogress = -1;\n                for (var i = 0; i < size; i++) {\n                    var item = index._add(arr[i]);\n                    if (item)\n                        indexed.push(item);\n                    var p = (100 * i / size) << 0;\n                    if (progress && p != lastprogress)\n                        progress({ progressPercent: p, items: size, current: i });\n                    lastprogress = p;\n                }\n                return WinJS.Promise.wrap({ indexed: indexed.length });\n            };\n            Index.prototype.refresh = function () {\n                var index = this;\n                var old = index.items;\n                var size = old.length;\n                index.items = [];\n                for (var i = 0; i < size; i++) {\n                    var item = index.items[i];\n                    index.add(item.rawdata);\n                }\n            };\n            /**\n             * prepare a text for search by applying stemming and tokenizing text\n             * @function WinJSContrib.Search.Index.prototype.processText\n             * @param {string} text\n             */\n            Index.prototype.processText = function (text) {\n                if (typeof text == \"number\")\n                    text = text.toString();\n                var tokens = this.tokenize(text);\n                var res = [];\n                var size = tokens.length;\n                for (var i = 0; i < size; i++) {\n                    var txt = this.pipeline.run(tokens[i]);\n                    if (txt.length > 1)\n                        res.push(txt);\n                }\n                return { items: res, untokenized: this.pipeline.run(text) };\n            };\n            /**\n             * Check if a word is a stopword\n             * @function WinJSContrib.Search.Index.prototype.checkWord\n             * @param {string} word\n             */\n            Index.prototype.checkWord = function (token) {\n                var size = this.stopWords.length;\n                for (var i = 0; i < size; i++) {\n                    if (token == this.stopWords[i])\n                        return '';\n                }\n                return token;\n            };\n            /**\n             * split a string into words\n             * @function WinJSContrib.Search.Index.prototype.tokenize\n             * @param {string} text\n             */\n            Index.prototype.tokenize = function (token) {\n                var index = this;\n                var tokens = [];\n                if (!token || !token.split)\n                    return tokens;\n                var words = token.split(/\\W+/);\n                for (var i = 0; i < words.length; i++) {\n                    if (words[i].length > 0) {\n                        tokens.push(words[i]);\n                    }\n                }\n                return tokens;\n            };\n            return Index;\n        })();\n        Search.Index = Index;\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var IndexGroup = (function () {\n            /**\n             * group of indexes\n             * @class WinJSContrib.Search.IndexGroup\n             * @param {Object} definitions object containing definitions\n             * @example\n             * var idxgroup = new WinJSContrib.Search.IndexGroup({ peoples: { \"firstname\": { weight: 42 }} });\n             */\n            function IndexGroup(definitions) {\n                /**\n                 * object containing indexes, stored by name\n                 * @field\n                 * @type Object\n                 */\n                this.indexes = {};\n                if (definitions) {\n                    for (var n in definitions) {\n                        var elt = definitions[n];\n                        if (!elt.useworker)\n                            this.indexes[n] = new WinJSContrib.Search.Index(n, elt.definition);\n                        else\n                            this.indexes[n] = new WinJSContrib.Search.IndexWorkerProxy(n, elt.definition);\n                    }\n                }\n            }\n            /**\n             * add an index to group\n             * @function WinJSContrib.Search.IndexGroup.prototype.addIndex\n             * @param {string} name index name\n             * @param {WinJSContrib.Search.IndexDefinition} definition index definition\n             * @params {boolean} async true if index must operate on a web worker\n             * @params {Array} items array of items to index\n             * @returns {WinJS.Promise}\n             */\n            IndexGroup.prototype.addIndex = function (name, definition, async, items) {\n                if (async)\n                    var idx = new WinJSContrib.Search.IndexWorkerProxy(name, definition);\n                else\n                    var idx = new WinJSContrib.Search.Index(name, definition);\n                this.indexes[name] = idx;\n                if (items && items.length) {\n                    return idx.addRange(items).then(function () {\n                        return idx;\n                    });\n                }\n                return WinJS.Promise.wrap(idx);\n            };\n            /**\n             * add items to an index\n             * @function WinJSContrib.Search.IndexGroup.prototype.addRange\n             * @param {string} name index name\n             * @params {Array} items array of items to index\n             * @returns {WinJS.Promise}\n             */\n            IndexGroup.prototype.addRangefunction = function (name, items) {\n                var idx = this.indexes[name];\n                if (idx && items && items.length) {\n                    return idx.addRange(items);\n                }\n                return WinJS.Promise.wrapError({ message: 'search index ' + name + ' not found' });\n            };\n            /**\n             * search group's indexes\n             * @function WinJSContrib.Search.IndexGroup.prototype.search\n             * @param {string} querytext search query\n             */\n            IndexGroup.prototype.search = function (querytext) {\n                var group = this;\n                var searchresult = { hasResult: false, allResults: [] };\n                function searchindex(name, index) {\n                    return index.search(querytext).then(function (res) {\n                        if (res && res.length) {\n                            res.forEach(function (item) {\n                                item.searchItemType = name;\n                                searchresult.allResults.push(item);\n                            });\n                        }\n                        searchresult[name] = res;\n                    });\n                }\n                var promises = [];\n                for (var n in this.indexes) {\n                    promises.push(searchindex(n, this.indexes[n]));\n                }\n                return WinJS.Promise.join(promises).then(function () {\n                    searchresult.allResults.sort(function (a, b) {\n                        return b.rank - a.rank;\n                    });\n                    searchresult.hasResult = searchresult.allResults.length > 0;\n                    return searchresult;\n                });\n            };\n            /**\n             * save group indexes\n             * @function WinJSContrib.Search.IndexGroup.prototype.save\n             * @returns {WinJS.Promise}\n             */\n            IndexGroup.prototype.save = function () {\n                var promises = [];\n                for (var n in this.indexes) {\n                    promises.push(this.indexes[n].save());\n                }\n                return WinJS.Promise.join(promises);\n            };\n            /**\n             * load group indexes\n             * @function WinJSContrib.Search.IndexGroup.prototype.load\n             * @returns {WinJS.Promise}\n             */\n            IndexGroup.prototype.load = function () {\n                var promises = [];\n                for (var n in this.indexes) {\n                    promises.push(this.indexes[n].load());\n                }\n                return WinJS.Promise.join(promises);\n            };\n            /**\n             * release all indexes\n             * @function WinJSContrib.Search.IndexGroup.prototype.dispose\n             */\n            IndexGroup.prototype.dispose = function () {\n                for (var n in this.indexes) {\n                    this.indexes[n].dispose();\n                }\n                this.indexes = {};\n            };\n            return IndexGroup;\n        })();\n        Search.IndexGroup = IndexGroup;\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var IndexWorkerProxy = (function () {\n            /**\n             * @classdesc\n             * Proxy for a {@link WinJSContrib.Search.Index} running in a web worker\n             * @class\n             * @param {string} name index name\n             * @param {WinJSContrib.Search.IndexDefinition} definition index definition\n             * @param {string} workerpath path for web worker script file (optional)\n             */\n            function IndexWorkerProxy(name, definition, workerpath) {\n                var wrapper = this;\n                wrapper.worker = new WinJSContrib.Messenger.SmartWorker(workerpath || WinJSContrib.Search.workerPath);\n                wrapper.init(name, definition);\n            }\n            /**\n             * initialize worker\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.init\n             * @param {string} name\n             * @param {WinJSContrib.Search.IndexDefinition} definition index definition (optional), use index's definition if not defined\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.init = function (name, definition, load) {\n                return this.worker.start('init', { name: name, load: load, definition: definition });\n            };\n            /**\n             * start search\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.search\n             * @param {string} searchTerm search query\n             * @param {Object} options\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.search = function (searchTerm, options) {\n                return this.worker.start('search', { searchTerm: searchTerm, options: options });\n            };\n            /**\n             * get the number of items in index\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.count\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.count = function () {\n                return this.worker.start('count');\n            };\n            /**\n             * add an object to index\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.add\n             * @param {Object} obj object to index\n             * @param {Object} options\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.add = function (data, options) {\n                return this.worker.start('index', { items: [data], options: options });\n            };\n            /**\n             * add an array of objects to index\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.addRange\n             * @param {Array} items items array\n             * @param {Object} options\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.addRange = function (data, options) {\n                return this.worker.start('index', { items: data, options: options });\n            };\n            /**\n             * release proxy\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.dispose\n             */\n            IndexWorkerProxy.prototype.dispose = function () {\n                this.worker.dispose();\n            };\n            /**\n             * clear index\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.clear\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.clear = function () {\n                return this.worker.start('clear');\n            };\n            /**\n             * load index from storage\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.load\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.load = function () {\n                return this.worker.start('load');\n            };\n            /**\n             * save index to storage\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.save\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.save = function () {\n                return this.worker.start('save');\n            };\n            return IndexWorkerProxy;\n        })();\n        Search.IndexWorkerProxy = IndexWorkerProxy;\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var Stemming;\n        (function (Stemming) {\n            /**\n             * @namespace\n             */\n            var Pipeline = (function () {\n                /**\n                 * stemming pipeline\n                 * @class WinJSContrib.Search.Stemming.Pipeline\n                 */\n                function Pipeline(definition) {\n                    this.reload = function (definition) {\n                        var pipe = this;\n                        var sets = WinJSContrib.Search.Stemming.Presets;\n                        var ops = WinJSContrib.Search.Stemming.Op;\n                        pipe._processors = [];\n                        var processorNames = null;\n                        if (definition) {\n                            var type = typeof definition.stemming;\n                            if (type === 'string') {\n                                processorNames = sets[definition.stemming];\n                            }\n                            else if (definition.stemming && definition.stemming.length) {\n                                processorNames = definition.stemming;\n                            }\n                        }\n                        if (!processorNames) {\n                            processorNames = WinJSContrib.Search.Stemming.Presets.standard;\n                        }\n                        processorNames.forEach(function (name) {\n                            var processor = ops[name];\n                            if (processor) {\n                                pipe._processors.push(processor);\n                            }\n                        });\n                    };\n                    this.reload(definition);\n                }\n                /**\n                 * add a stemming function to pipeline\n                 * @function WinJSContrib.Search.Stemming.Pipeline.prototype.add\n                 * @param {function} callback stemming function\n                 */\n                Pipeline.prototype.add = function (callback) {\n                    this._processors.push(callback);\n                };\n                /**\n                 * @function WinJSContrib.Search.Stemming.Pipeline.prototype.clear\n                 * remove all stemming functions from pipeline\n                 */\n                Pipeline.prototype.clear = function () {\n                    this._processors = [];\n                };\n                /**\n                 * apply stemming pipeline to text\n                 * @function WinJSContrib.Search.Stemming.Pipeline.prototype.run\n                 * @param {string} text\n                 */\n                Pipeline.prototype.run = function (text) {\n                    var size = this._processors.length;\n                    var res = text;\n                    for (var i = 0; i < size; i++) {\n                        res = this._processors[i](res);\n                    }\n                    return res;\n                };\n                return Pipeline;\n            })();\n            Stemming.Pipeline = Pipeline;\n        })(Stemming = Search.Stemming || (Search.Stemming = {}));\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var Stemming;\n        (function (Stemming) {\n            var Presets;\n            (function (Presets) {\n                Presets.standard = [\n                    \"lowerCase\",\n                    \"removeDiacritics\"\n                ];\n                Presets.full = [\n                    \"lowerCase\",\n                    \"removeDiacritics\",\n                    \"dedup\",\n                    \"dropInitialLetters\",\n                    \"dropBafterMAtEnd\",\n                    \"transformCK\",\n                    \"cTransform\",\n                    \"dTransform\",\n                    \"dropG\",\n                    \"transformG\",\n                    \"dropH\",\n                    \"transformPH\",\n                    \"transformQ\",\n                    \"transformS\",\n                    \"transformX\",\n                    \"transformT\",\n                    \"dropT\",\n                    \"transformV\",\n                    \"transformWH\",\n                    \"dropW\",\n                    \"dropY\",\n                    \"transformZ\"\n                ];\n            })(Presets = Stemming.Presets || (Stemming.Presets = {}));\n        })(Stemming = Search.Stemming || (Search.Stemming = {}));\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var Stemming;\n        (function (Stemming) {\n            var StopWords;\n            (function (StopWords) {\n                /**\n                * common stop words\n                * @field WinJSContrib.Search.Stemming.StopWords.common\n                */\n                StopWords.common = [\n                    //french\n                    \"de\",\n                    \"du\",\n                    \"des\",\n                    \"le\",\n                    \"la\",\n                    \"les\",\n                    \"te\",\n                    \"ta\",\n                    \"ton\",\n                    \"tes\",\n                    \"un\",\n                    \"une\",\n                    \"et\",\n                    \"ou\",\n                    \"mais\",\n                    \"pour\",\n                    \"par\",\n                    \"avec\",\n                    \"si\",\n                    //english\n                    \"a\",\n                    \"able\",\n                    \"about\",\n                    \"across\",\n                    \"after\",\n                    \"all\",\n                    \"almost\",\n                    \"also\",\n                    \"am\",\n                    \"among\",\n                    \"an\",\n                    \"and\",\n                    \"any\",\n                    \"are\",\n                    \"as\",\n                    \"at\",\n                    \"be\",\n                    \"because\",\n                    \"been\",\n                    \"but\",\n                    \"by\",\n                    \"can\",\n                    \"cannot\",\n                    \"could\",\n                    \"dear\",\n                    \"did\",\n                    \"do\",\n                    \"does\",\n                    \"either\",\n                    \"else\",\n                    \"ever\",\n                    \"every\",\n                    \"for\",\n                    \"from\",\n                    \"get\",\n                    \"got\",\n                    \"had\",\n                    \"has\",\n                    \"have\",\n                    \"he\",\n                    \"her\",\n                    \"hers\",\n                    \"him\",\n                    \"his\",\n                    \"how\",\n                    \"however\",\n                    \"i\",\n                    \"if\",\n                    \"in\",\n                    \"into\",\n                    \"is\",\n                    \"it\",\n                    \"its\",\n                    \"just\",\n                    \"least\",\n                    \"let\",\n                    \"like\",\n                    \"likely\",\n                    \"may\",\n                    \"me\",\n                    \"might\",\n                    \"most\",\n                    \"must\",\n                    \"my\",\n                    \"neither\",\n                    \"no\",\n                    \"nor\",\n                    \"not\",\n                    \"of\",\n                    \"off\",\n                    \"often\",\n                    \"on\",\n                    \"only\",\n                    \"or\",\n                    \"other\",\n                    \"our\",\n                    \"own\",\n                    \"rather\",\n                    \"said\",\n                    \"say\",\n                    \"says\",\n                    \"she\",\n                    \"should\",\n                    \"since\",\n                    \"so\",\n                    \"some\",\n                    \"than\",\n                    \"that\",\n                    \"the\",\n                    \"their\",\n                    \"them\",\n                    \"then\",\n                    \"there\",\n                    \"these\",\n                    \"they\",\n                    \"this\",\n                    \"tis\",\n                    \"to\",\n                    \"too\",\n                    \"twas\",\n                    \"us\",\n                    \"wants\",\n                    \"was\",\n                    \"we\",\n                    \"were\",\n                    \"what\",\n                    \"when\",\n                    \"where\",\n                    \"which\",\n                    \"while\",\n                    \"who\",\n                    \"whom\",\n                    \"why\",\n                    \"will\",\n                    \"with\",\n                    \"would\",\n                    \"yet\",\n                    \"you\",\n                    \"your\"\n                ];\n            })(StopWords = Stemming.StopWords || (Stemming.StopWords = {}));\n        })(Stemming = Search.Stemming || (Search.Stemming = {}));\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var Stemming;\n        (function (Stemming) {\n            var Op;\n            (function (Op) {\n                /**\n                 * built-in stemmings\n                 * @namespace\n                 */\n                /**\n                 *\n                 */\n                function lowerCase(token) {\n                    if (!token)\n                        return;\n                    return token.toLowerCase();\n                }\n                Op.lowerCase = lowerCase;\n                /**\n                 *\n                 */\n                function dedup(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/([^c])\\1/g, '$1');\n                }\n                Op.dedup = dedup;\n                /**\n                 *\n                 */\n                function dropInitialLetters(token) {\n                    if (!token)\n                        return;\n                    if (token.match(/^(kn|gn|pn|ae|wr)/))\n                        return token.substr(1, token.length - 1);\n                    return token;\n                }\n                Op.dropInitialLetters = dropInitialLetters;\n                /**\n                 *\n                 */\n                function dropBafterMAtEnd(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/mb$/, 'm');\n                }\n                Op.dropBafterMAtEnd = dropBafterMAtEnd;\n                /**\n                 *\n                 */\n                function cTransform(token) {\n                    if (!token)\n                        return;\n                    token = token.replace(/([^s]|^)(c)(h)/g, '$1x$3').trim();\n                    token = token.replace(/cia/g, 'xia');\n                    token = token.replace(/c(i|e|y)/g, 's$1');\n                    token = token.replace(/c/g, 'k');\n                    return token;\n                }\n                Op.cTransform = cTransform;\n                /**\n                 *\n                 */\n                function dTransform(token) {\n                    if (!token)\n                        return;\n                    token = token.replace(/d(ge|gy|gi)/g, 'j$1');\n                    token = token.replace(/d/g, 't');\n                    return token;\n                }\n                Op.dTransform = dTransform;\n                /**\n                 *\n                 */\n                function dropG(token) {\n                    if (!token)\n                        return;\n                    token = token.replace(/gh(^$|[^aeiou])/g, 'h$1');\n                    token = token.replace(/g(n|ned)$/g, '$1');\n                    return token;\n                }\n                Op.dropG = dropG;\n                /**\n                 *\n                 */\n                function transformG(token) {\n                    if (!token)\n                        return;\n                    token = token.replace(/([^g]|^)(g)(i|e|y)/g, '$1j$3');\n                    token = token.replace(/gg/g, 'g');\n                    token = token.replace(/g/g, 'k');\n                    return token;\n                }\n                Op.transformG = transformG;\n                /**\n                 *\n                 */\n                function dropH(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/([aeiou])h([^aeiou])/g, '$1$2');\n                }\n                Op.dropH = dropH;\n                /**\n                 *\n                 */\n                function transformCK(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/ck/g, 'k');\n                }\n                Op.transformCK = transformCK;\n                /**\n                 *\n                 */\n                function transformPH(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/ph/g, 'f');\n                }\n                Op.transformPH = transformPH;\n                /**\n                 *\n                 */\n                function transformQ(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/q/g, 'k');\n                }\n                Op.transformQ = transformQ;\n                /**\n                 *\n                 */\n                function transformS(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/s(h|io|ia)/g, 'x$1');\n                }\n                Op.transformS = transformS;\n                /**\n                 *\n                 */\n                function transformT(token) {\n                    if (!token)\n                        return;\n                    token = token.replace(/t(ia|io)/g, 'x$1');\n                    token = token.replace(/th/, '0');\n                    return token;\n                }\n                Op.transformT = transformT;\n                /**\n                 *\n                 */\n                function dropT(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/tch/g, 'ch');\n                }\n                Op.dropT = dropT;\n                /**\n                 *\n                 */\n                function transformV(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/v/g, 'f');\n                }\n                Op.transformV = transformV;\n                /**\n                 *\n                 */\n                function transformWH(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/^wh/, 'w');\n                }\n                Op.transformWH = transformWH;\n                /**\n                 *\n                 */\n                function dropW(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/w([^aeiou]|$)/g, '$1');\n                }\n                Op.dropW = dropW;\n                /**\n                 *\n                 */\n                function transformX(token) {\n                    if (!token)\n                        return;\n                    token = token.replace(/^x/, 's');\n                    token = token.replace(/x/g, 'ks');\n                    return token;\n                }\n                Op.transformX = transformX;\n                /**\n                 *\n                 */\n                function dropY(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/y([^aeiou]|$)/g, '$1');\n                }\n                Op.dropY = dropY;\n                /**\n                 *\n                 */\n                function transformZ(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/z/, 's');\n                }\n                Op.transformZ = transformZ;\n                /**\n                 *\n                 */\n                function dropVowels(token) {\n                    if (!token)\n                        return;\n                    return token.charAt(0) + token.substr(1, token.length).replace(/[aeiou]/g, '');\n                }\n                Op.dropVowels = dropVowels;\n                /**\n                 *\n                 */\n                function removeDiacritics(s) {\n                    if (!s)\n                        return;\n                    var r = s.toLowerCase();\n                    r = r.replace(new RegExp(\"/.../g\", 'g'), \" \");\n                    r = r.replace(new RegExp(\"[àáâãäå]\", 'g'), \"a\");\n                    r = r.replace(new RegExp(\"æ\", 'g'), \"ae\");\n                    r = r.replace(new RegExp(\"ç\", 'g'), \"c\");\n                    r = r.replace(new RegExp(\"[èéêë]\", 'g'), \"e\");\n                    r = r.replace(new RegExp(\"[ìíîï]\", 'g'), \"i\");\n                    r = r.replace(new RegExp(\"ñ\", 'g'), \"n\");\n                    r = r.replace(new RegExp(\"[òóôõö]\", 'g'), \"o\");\n                    r = r.replace(new RegExp(\"œ\", 'g'), \"oe\");\n                    r = r.replace(new RegExp(\"[ùúûü]\", 'g'), \"u\");\n                    r = r.replace(new RegExp(\"[ýÿ]\", 'g'), \"y\");\n                    r = r.replace(new RegExp(\"['\\\"]\", 'g'), \" \");\n                    return r;\n                }\n                Op.removeDiacritics = removeDiacritics;\n            })(Op = Stemming.Op || (Stemming.Op = {}));\n        })(Stemming = Search.Stemming || (Search.Stemming = {}));\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\n//# sourceMappingURL=winjscontrib.search.js.map","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib = WinJSContrib || {};\r\nWinJSContrib.UI = WinJSContrib.UI || {};\r\n\r\n/** @namespace */\r\nWinJSContrib.UI.DataSources = WinJSContrib.UI.DataSources || {};\r\n\r\n\r\n(function (ds, gr) {\r\n    \"use strict\";\r\n\r\n    ds.DataSourceManager = WinJS.Class.mix(WinJS.Class.define(\r\n    /** \r\n     * \r\n     * @class WinJSContrib.UI.DataSources.DataSourceManager\r\n     * @classdesc helper class to manage an array with filter and grouping facilities and plug it into listview with or without semantic zoom. \r\n     * This is a low level helper object, it's likely that relying on {@link WinJSContrib.UI.SemanticListViews} will be easier.\r\n     * @param {Object} options\r\n     * @example\r\n     * {@lang javascript}\r\n     * var datamgr = new WinJSContrib.UI.DataSources.DataSourceManager({\r\n     *    defaultGroupLimit: 12,\r\n     *    groupKind: WinJSContrib.UI.DataSources.Grouping.byField,\r\n     *    field: 'metadata.genre',\r\n     *    listview: page.zoomedInList,\r\n     *    zoomedOutListView: page.zoomedOutList\r\n     * });\r\n     * \r\n     */\r\n    function (options) {\r\n        this.groupedList = null;\r\n        this.list = null;\r\n        this.defaultGroupLimit = 0;\r\n        this.filters = new WinJS.Binding.List();\r\n        this.filters.onitemchanged = this.init.bind(this);\r\n        this.filters.oniteminserted = this.init.bind(this);\r\n        this.filters.onitemremoved = this.init.bind(this);\r\n        this.apply(options);\r\n    },\r\n    /**\r\n     * @lends WinJSContrib.UI.DataSources.DataSourceManager.prototype\r\n     */\r\n    {\r\n        apply: function (options) {\r\n            options = options || {};\r\n\r\n            if (options.field)\r\n                this.field = options.field;\r\n\r\n            if (options.defaultGroupLimit) this.defaultGroupLimit = options.defaultGroupLimit;\r\n            if (options.filter) this.filter = options.filter;\r\n            if (options.groupKind) {\r\n                if (options.groupKind != this.groupKind) {\r\n                    this.groupKind = options.groupKind;\r\n                }\r\n                options = options.groupKind(options);\r\n            }\r\n            if (options.defaultGroupName) this.defaultGroupName = options.defaultGroupName;\r\n            if (options.compareGroups) this.compareGroups = options.compareGroups;\r\n            if (options.getGroupKey) this.getGroupKey = options.getGroupKey;\r\n            if (options.getGroupData) this.getGroupData = options.getGroupData;\r\n            if (options.listview) this.listview = options.listview;\r\n            if (options.zoomedOutListView) this.zoomedOutListView = options.zoomedOutListView;\r\n            if (options.items) this.items = options.items;\r\n\r\n        },\r\n\r\n        /**\r\n         * path to the field to use for groupings\r\n         * @field\r\n         * @type string\r\n         */\r\n        field: {\r\n            get: function () {\r\n                return this._field;\r\n            },\r\n            set: function (val) {\r\n                this._field = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * no grouping if items.length < defaultGroupLimit\r\n         * @field\r\n         * @type number\r\n         */\r\n        defaultGroupLimit: {\r\n            get: function () {\r\n                return this._defaultGroupLimit;\r\n            },\r\n            set: function (val) {\r\n                this._defaultGroupLimit = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * groupKind grouping manager function\r\n         * @field\r\n         * @type function\r\n         */\r\n        groupKind: {\r\n            get: function () {\r\n                return this._groupKind;\r\n            },\r\n            set: function (val) {\r\n                if (val != this._groupKind) {\r\n                    this._groupKind = val;\r\n                    this.apply({ groupKind: val });\r\n                    this.init();\r\n                }\r\n                if (!val) {\r\n                    this.compareGroups = null;\r\n                    this.getGroupData = null;\r\n                    this.getGroupKey = null;\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * items listview\r\n         * @field\r\n         * @type WinJS.UI.ListView\r\n         */\r\n        listview: {\r\n            get: function () {\r\n                return this._listview;\r\n            },\r\n            set: function (val) {\r\n                if (this._listview) {\r\n                    this.detach();\r\n                }\r\n\r\n                this._listview = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * listview for grouped items\r\n         * @field\r\n         * @type WinJS.UI.ListView\r\n         */\r\n        groupedList: {\r\n            get: function () {\r\n                return this._groupedList;\r\n            },\r\n            set: function (val) {\r\n                this._groupedList = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * item filter callback\r\n         * @field\r\n         * @type function\r\n         */\r\n        filter: {\r\n            get: function () {\r\n                return this._filter;\r\n            },\r\n            set: function (val) {\r\n                if (this._filter) {\r\n                    this.detach();\r\n                }\r\n\r\n                this._filter = val;\r\n                if (val) {\r\n                    this.init();\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * data items\r\n         * @field\r\n         * @type Array\r\n         */\r\n        items: {\r\n            get: function () {\r\n                return this._items;\r\n            },\r\n            set: function (val) {\r\n                if (this._items) {\r\n                    this.detach();\r\n                }\r\n                this._items = val;\r\n                if (val) {\r\n                    this.init();\r\n                }\r\n                else {\r\n                    this.list = null;\r\n                    this.groupedList = null;\r\n                    this.filteredlist = null;\r\n                    this.detach();\r\n                }\r\n            }\r\n        },\r\n\r\n        _filterItems: function (item) {\r\n            var ctrl = this;\r\n            var res = function (item) { return true; };\r\n\r\n            if (this.filter)\r\n                res = function (item) { return ctrl.filter(item) };\r\n\r\n            if (this.filters.length) {\r\n                var addFilter = function (f, newFilter) {\r\n                    return function (item) {\r\n                        var tmp = f(item);\r\n                        if (!tmp)\r\n                            return false;\r\n\r\n                        return newFilter(item);\r\n                    }\r\n                }\r\n\r\n                for (var i = 0 ; i < this.filters.length ; i++) {\r\n                    var filter = this.filters.getAt(i);\r\n                    res = addFilter(res, filter);\r\n                }\r\n            }\r\n\r\n            return res;\r\n        },\r\n\r\n        refresh: function () {\r\n            this.init();\r\n        },\r\n\r\n        /**\r\n         * initialise data\r\n         */\r\n        init: function (dontAttach) {\r\n            var ctrl = this;\r\n            this.detach();\r\n            if (this.items) {\r\n                this.list = new WinJS.Binding.List(this.items);\r\n\r\n                if (this.filter || this.filters.length) {\r\n                    var filterCallback = this._filterItems();\r\n                    this.filteredlist = this.list.createFiltered(filterCallback);\r\n                }\r\n                else {\r\n                    this.filteredlist = this.list;\r\n                }\r\n\r\n                if (this.getGroupKey && this.getGroupData && this.compareGroups) {\r\n                    this.groupedList = this.filteredlist.createGrouped(this.getGroupKey.bind(this), this.getGroupData.bind(this), this.compareGroups.bind(this));\r\n\r\n                    var g = ctrl.groupedList.groups;\r\n                    for (var n in g._groupItems) {\r\n                        console.log(n);\r\n                        var grp = ctrl.groupedList._groupsProjection._groupItems[n];\r\n                        if (grp && grp.groupSize !== undefined)\r\n                            grp.data.groupCount = grp.groupSize;\r\n                    }\r\n                } else {\r\n                    this.groupedList = null;\r\n                }\r\n\r\n                if (!dontAttach)\r\n                    this.attach();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * clean-up, initialise data and bind listviews to data\r\n         * @param {Array} items\r\n         */\r\n        prepareItems: function (items) {\r\n            this.detach();\r\n            this._items = items;\r\n            this.init(true);\r\n        },\r\n\r\n        /**\r\n         * attach listviews to data\r\n         */\r\n        attach: function () {\r\n            if ((this.groupedList || this.filteredlist) && this.listview) {\r\n                if (this.groupedList && this.groupedList.length >= this.defaultGroupLimit) {\r\n                    this.listview.itemDataSource = this.groupedList.dataSource;\r\n                    this.listview.groupDataSource = this.groupedList.groups.dataSource;\r\n\r\n                    if (this.zoomedOutListView)\r\n                        this.zoomedOutListView.itemDataSource = this.groupedList.groups.dataSource;\r\n\r\n                    var semzoom = this.parentSemanticZoom();\r\n                    if (semzoom) {\r\n                        semzoom.locked = false;\r\n                    }\r\n                }\r\n                else if (this.filteredlist && this.filteredlist.length >= this.defaultGroupLimit) {\r\n                    this.listview.itemDataSource = this.filteredlist.dataSource;\r\n                    this.listview.groupDataSource = null;\r\n                    var semzoom = this.parentSemanticZoom();\r\n                    if (semzoom) {\r\n                        semzoom.locked = true;\r\n                    }\r\n                }\r\n                else if (this.filteredlist && this.filteredlist.length) {\r\n                    this.listview.itemDataSource = this.filteredlist.dataSource;\r\n                    this.listview.groupDataSource = null;\r\n                }\r\n                else {\r\n                    if (this.groupedList)\r\n                        this.listview.itemDataSource = this.groupedList.dataSource;\r\n                    this.listview.groupDataSource = null;\r\n                    if (this.zoomedOutListView)\r\n                        this.zoomedOutListView.itemDataSource = null;\r\n\r\n                    var semzoom = this.parentSemanticZoom();\r\n                    if (semzoom) {\r\n                        semzoom.locked = true;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * get parent semantic zoom control\r\n         * @returns {WinJS.UI.SemanticZoom}\r\n         */\r\n        parentSemanticZoom: function () {\r\n            var parent = this.listview.element.parentElement;\r\n            while (parent) {\r\n                if (parent.classList.contains('win-semanticzoom'))\r\n                    return parent.winControl;\r\n                parent = parent.parentElement;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * detach listviews from data\r\n         */\r\n        detach: function () {\r\n            if (this.listview) {\r\n                this.listview.itemDataSource = null;\r\n                this.listview.groupDataSource = null;\r\n                if (this.zoomedOutListView)\r\n                    this.zoomedOutListView.itemDataSource = null;\r\n            }\r\n        }\r\n    }), WinJS.UI.DOMEventMixin);\r\n\r\n    WinJSContrib.UI.SemanticListViews = WinJS.Class.mix(WinJS.Class.define(\r\n    /** \r\n     * \r\n     * @class WinJSContrib.UI.SemanticListViews\r\n     * @classdesc Control wrapping semantic zoom and listviews with a {@link WinJSContrib.UI.DataSources.DataSourceManager}\r\n     * @param {HTMLElement} element DOM element containing the control\r\n     * @param {Object} options\r\n     * \r\n     * @example {@lang xml}\r\n     * <div id=\"semanticzoom\" data-win-control=\"WinJSContrib.UI.SemanticListViews\" data-win-options=\"{\r\n     *      listview: { itemTemplate: select('#listItemTemplate'), groupHeaderTemplate : select('#groupItemTemplate')},\r\n     *      zoomedOutListview: { itemTemplate: select('#semanticItemTemplate')},\r\n     *      data: {\r\n     *          defaultGroupLimit: 12,\r\n     *          groupKind: WinJSContrib.UI.DataSources.Grouping.byField,\r\n     *          field: 'metadata.genre',\r\n     *          items: moviesSample\r\n     *      }}\">\r\n     * </div>\r\n     */\r\n    function ctor(element, options) {\r\n        this.element = element || document.createElement('DIV');\r\n        options = options || {};\r\n        this.element.winControl = this;\r\n        this.element.classList.add('win-disposable');\r\n        WinJS.UI.setOptions(this, options);\r\n        this._initControl(options);\r\n    },\r\n    /**\r\n     * @lends WinJSContrib.UI.SemanticListViews.prototype\r\n     */\r\n    {\r\n        /**\r\n         * semantic zoom control\r\n         * @field\r\n         * @type {WinJS.UI.SemanticZoom}\r\n         */\r\n        semanticZoom: {\r\n            get: function () {\r\n                return this._semanticZoom;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * items listview\r\n         * @field\r\n         * @type WinJS.UI.ListView \r\n         */\r\n        listview: {\r\n            get: function () {\r\n                return this._listview;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * listview for zoomed out items (usually groups)\r\n         * @field\r\n         * @type WinJS.UI.ListView \r\n         */\r\n        zoomedOutListview: {\r\n            get: function () {\r\n                return this._zoomedOutListview;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * dataManager datasource manager\r\n         * @field\r\n         * @type WinJSContrib.UI.DataSources.DataSourceManager \r\n         */\r\n        dataManager: {\r\n            get: function () {\r\n                return this._dataManager;\r\n            }\r\n        },\r\n\r\n        _initControl: function (options) {\r\n            var semanticPlaceholder = document.createElement('DIV')\r\n            semanticPlaceholder.style.width = '100%';\r\n            semanticPlaceholder.style.height = '100%';\r\n\r\n            var listviewPlaceholder = document.createElement('DIV');\r\n            listviewPlaceholder.style.width = '100%';\r\n            listviewPlaceholder.style.height = '100%';\r\n            listviewPlaceholder.className = 'zoomedinlist';\r\n\r\n            var zoomedOutListviewPlaceholder = document.createElement('DIV');\r\n            zoomedOutListviewPlaceholder.style.width = '100%';\r\n            zoomedOutListviewPlaceholder.style.height = '100%';\r\n            zoomedOutListviewPlaceholder.className = 'zoomedoutlist';\r\n\r\n            semanticPlaceholder.appendChild(listviewPlaceholder);\r\n            semanticPlaceholder.appendChild(zoomedOutListviewPlaceholder);\r\n            this.element.appendChild(semanticPlaceholder);\r\n\r\n            this._listview = new WinJS.UI.ListView(listviewPlaceholder, options.listview);\r\n            this._zoomedOutListview = new WinJS.UI.ListView(zoomedOutListviewPlaceholder, options.zoomedOutListview);\r\n\r\n            this._semanticZoom = new WinJS.UI.SemanticZoom(semanticPlaceholder, options.semanticzoom);\r\n\r\n            var dataOptions = options.data || {};\r\n            dataOptions.listview = this._listview;\r\n            dataOptions.zoomedOutListView = this._zoomedOutListview;\r\n            this._dataManager = new ds.DataSourceManager(dataOptions);\r\n        },\r\n\r\n        /**\r\n         * release control\r\n         */\r\n        dispose: function () {\r\n            WinJS.Utilities.disposeSubTree(this.element);\r\n        }\r\n    }), WinJS.UI.DOMEventMixin, WinJS.Utilities.createEventProperties(\"myevent\"));\r\n})(WinJSContrib.UI.DataSources, WinJSContrib.UI.DataSources.Grouping);\r\n\r\nif (WinJSContrib.UI.WebComponents) {\r\n    WinJSContrib.UI.WebComponents.register('mcn-semanticlistviews', WinJSContrib.UI.SemanticListViews, {\r\n        properties: [],\r\n        controls: {\r\n            \"listview\": WinJS.UI.ListView,\r\n            \"zoomedOutListview\": WinJS.UI.ListView,\r\n            \"semanticZoom\": WinJS.UI.SemanticZoom\r\n        },\r\n        map: {\r\n            \"DEFAULTGROUPLIMIT\": { attribute: 'defaultGroupLimit', property: '_dataManager.defaultGroupLimit', resolve: true },\r\n            \"GROUPKIND\": { attribute: 'groupKind', property: '_dataManager.groupKind', resolve: true },\r\n            \"FIELD\": { attribute: 'field', property: '_dataManager.field', resolve: true },\r\n            \"ITEMS\": { attribute: 'items', property: '_dataManager.items', resolve: true },\r\n        }\r\n    });\r\n}\r\n\r\n/** \r\n * Custom grouping settings for {@link WinJSContrib.UI.DataSources.DataSourceManager}\r\n * @namespace \r\n * @example\r\n * var datamgr = new WinJSContrib.UI.DataSources.DataSourceManager({\r\n *    defaultGroupLimit: 12,\r\n *    groupKind: WinJSContrib.UI.DataSources.Grouping.byField,\r\n *    field: 'metadata.genre',\r\n *    listview: page.zoomedInList,\r\n *    zoomedOutListView: page.zoomedOutList\r\n * });\r\n */\r\nWinJSContrib.UI.DataSources.Grouping = WinJSContrib.UI.DataSources.Grouping || {};\r\n\r\n(function (ds, gr) {\r\n    \"use strict\";\r\n\r\n    /**\r\n     * alphabetic grouping, use \"options.field\" to define the property used for grouping\r\n     * @param {Object} options grouping options\r\n     * @returns {Object} group manager\r\n     */\r\n    WinJSContrib.UI.DataSources.Grouping.alphabetic = WinJS.Utilities.markSupportedForProcessing(function (options) {\r\n        options = options || {};\r\n        options.defaultGroupName = options.defaultGroupName || '#';\r\n\r\n        options.compareGroups = options.compareGroups || function (left, right) {\r\n            return left.toUpperCase().charCodeAt(0) - right.toUpperCase().charCodeAt(0);\r\n        }\r\n\r\n        options.getGroupKey = options.getGroupKey || function (dataItem) {\r\n            if (!dataItem)\r\n                return this.defaultGroupName;\r\n\r\n            var val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                return this.defaultGroupName;\r\n\r\n            var key = val[0].toUpperCase();\r\n            return key;\r\n        }\r\n\r\n        options.getGroupData = options.getGroupData || function (dataItem) {\r\n            var val = '#';\r\n            if (dataItem)\r\n                val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                val = this.defaultGroupName;\r\n\r\n            var key = val[0].toUpperCase();\r\n            return {\r\n                title: key\r\n            };\r\n        }\r\n        return options;\r\n    });\r\n\r\n    /**\r\n     * grouping by a string field on items, use \"options.field\" to define the property used for grouping\r\n     * @param {Object} options grouping options\r\n     * @returns {Object} group manager\r\n     */\r\n    WinJSContrib.UI.DataSources.Grouping.byField = WinJS.Utilities.markSupportedForProcessing(function (options) {\r\n        options.defaultGroupName = options.defaultGroupName || '#';\r\n\r\n        options.compareGroups = options.compareGroups || function (a, b) {\r\n            if (a > b)\r\n                return 1;\r\n            if (a < b)\r\n                return -1;\r\n\r\n            return 0;\r\n        }\r\n\r\n        options.getGroupKey = options.getGroupKey || function (dataItem) {\r\n            if (!dataItem)\r\n                return this.defaultGroupName;\r\n\r\n            var val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                return this.defaultGroupName;\r\n\r\n            var key = val.toString().toUpperCase();\r\n            return key;\r\n        }\r\n\r\n        options.getGroupData = options.getGroupData || function (dataItem) {\r\n            var val = '#';\r\n            if (dataItem)\r\n                val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                val = this.defaultGroupName;\r\n\r\n            var key = val;\r\n            return {\r\n                title: key\r\n            };\r\n        }\r\n\r\n        return options;\r\n    });\r\n\r\n    /**\r\n     * grouping by year from a date field, use \"options.field\" to define the property used for grouping\r\n     * @param {Object} options grouping options\r\n     * @returns {Object} group manager\r\n     */\r\n    WinJSContrib.UI.DataSources.Grouping.byYear = WinJS.Utilities.markSupportedForProcessing(function (options) {\r\n        options.defaultGroupName = options.defaultGroupName || '#';\r\n\r\n        options.compareGroups = options.compareGroups || function (a, b) {\r\n            if (a > b)\r\n                return 1;\r\n            if (a < b)\r\n                return -1;\r\n\r\n            return 0;\r\n        }\r\n\r\n        options.getGroupKey = options.getGroupKey || function (dataItem) {\r\n            if (!dataItem)\r\n                return this.defaultGroupName;\r\n\r\n            var val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                return this.defaultGroupName;\r\n\r\n            var key = new Date(new Date(new Date(val).setMonth(0, 1)).setHours(0, 0, 0, 0));\r\n            return key.toISOString();\r\n        }\r\n\r\n        options.getGroupData = options.getGroupData || function (dataItem) {\r\n            var val = '#';\r\n            if (dataItem)\r\n                val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                val = this.defaultGroupName;\r\n\r\n            var key = new Date(new Date(new Date(val).setMonth(0, 1)).setHours(0, 0, 0, 0));\r\n            return {\r\n                title: key.getFullYear().toString(),\r\n                date: key\r\n            };\r\n        }\r\n\r\n        return options;\r\n    });\r\n\r\n    /**\r\n     * grouping by month from a date field, use \"options.field\" to define the property used for grouping\r\n     * @param {Object} options grouping options\r\n     * @returns {Object} group manager\r\n     */\r\n    WinJSContrib.UI.DataSources.Grouping.byMonth = WinJS.Utilities.markSupportedForProcessing(function (options) {\r\n        options.defaultGroupName = options.defaultGroupName || '#';\r\n\r\n        options.compareGroups = options.compareGroups || function (a, b) {\r\n            if (a > b)\r\n                return 1;\r\n            if (a < b)\r\n                return -1;\r\n\r\n            return 0;\r\n        }\r\n\r\n        options.getGroupKey = options.getGroupKey || function (dataItem) {\r\n            if (!dataItem)\r\n                return this.defaultGroupName;\r\n\r\n            var val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                return this.defaultGroupName;\r\n\r\n            var key = new Date(new Date(new Date(val).setDate(1)).setHours(0, 0, 0, 0));\r\n            return key.toISOString();\r\n        }\r\n\r\n        options.getGroupData = options.getGroupData || function (dataItem) {\r\n            var val = '#';\r\n            if (dataItem)\r\n                val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                val = this.defaultGroupName;\r\n\r\n            var key = new Date(new Date(new Date(val).setDate(1)).setHours(0, 0, 0, 0));\r\n            return {\r\n                title: WinJSContrib.Utils.pad2(key.getMonth() + 1) + '-' + key.getFullYear().toString(),\r\n                date: key\r\n            };\r\n        }\r\n\r\n        return options;\r\n    });\r\n\r\n    /**\r\n     * grouping by day from a date field, use \"options.field\" to define the property used for grouping\r\n     * @param {Object} options grouping options\r\n     * @returns {Object} group manager\r\n     */\r\n    WinJSContrib.UI.DataSources.Grouping.byDay = WinJS.Utilities.markSupportedForProcessing(function (options) {\r\n        options.defaultGroupName = options.defaultGroupName || '#';\r\n\r\n        options.compareGroups = options.compareGroups || function (a, b) {\r\n            if (a > b)\r\n                return 1;\r\n            if (a < b)\r\n                return -1;\r\n\r\n            return 0;\r\n        }\r\n\r\n        options.getGroupKey = options.getGroupKey || function (dataItem) {\r\n            if (!dataItem)\r\n                return this.defaultGroupName;\r\n\r\n            var val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                return this.defaultGroupName;\r\n\r\n            var key = new Date(new Date(val).setHours(0, 0, 0, 0));\r\n            return key.toISOString();\r\n        }\r\n\r\n        options.getGroupData = options.getGroupData || function (dataItem) {\r\n            var val = '#';\r\n            if (dataItem)\r\n                val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                val = this.defaultGroupName;\r\n\r\n            var key = new Date(new Date(val).setHours(0, 0, 0, 0));\r\n            return {\r\n                title: WinJSContrib.Utils.pad2(key.getMonth() + 1) + '-' + WinJSContrib.Utils.pad2(key.getDate()) + '-' + key.getFullYear().toString(),\r\n                date: key\r\n            };\r\n        }\r\n\r\n        return options;\r\n    });\r\n\r\n})(WinJSContrib.UI.DataSources, WinJSContrib.UI.DataSources.Grouping);\r\n"],"sourceRoot":" "}