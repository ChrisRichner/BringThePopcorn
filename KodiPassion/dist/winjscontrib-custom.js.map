{"version":3,"sources":["../scripts/winjscontrib/js/winjscontrib.ui.webcomponents.js","../scripts/winjscontrib/js/winjscontrib.winrt.core.js","../scripts/winjscontrib/js/winjscontrib.winrt.upnp.js","../scripts/winjscontrib/js/winjscontrib.bindings.js","../scripts/winjscontrib/js/winjscontrib.date.utils.js","../scripts/winjscontrib/js/winjscontrib.search.js","../scripts/winjscontrib/js/winjscontrib.ui.animation.js","../scripts/winjscontrib/js/winjscontrib.ui.elasticbutton.js","../scripts/winjscontrib/js/winjscontrib.ui.fowrapper.js","../scripts/winjscontrib/js/winjscontrib.ui.multipass-renderer.js","../scripts/winjscontrib/js/winjscontrib.ui.grid.js","../scripts/winjscontrib/js/winjscontrib.ui.datasourcemanager.js"],"names":["WinJSContrib","UI","WebComponents","global","inspect","node","customElement","ctrlName","nodeName","promises","attributes","getAttribute","registered","toUpperCase","mcnComponent","push","createElement","msParentSelectorScope","winControl","pageLifeCycle","observer","i","l","childNodes","length","WinJS","Promise","join","observeMutations","element","polyfill","MutationObserver","mutations","forEach","mutation","addedNodes","observe","childList","subtree","definition","scope","Utils","getScopeControl","p","wrap","process","getControlInstance","ctor","steps","render","attach","setAttribute","name","val","call","this","constructor","mcnWebComponent","map","ctx","control","property","data","applyAttribute","options","dataset","winOptions","getWinJSOptions","optionsCallback","ctrl","applyAll","applyMapping","tagname","mapping","contextData","item","attrcontext","attrvalue","context","attribute","type","resolveValue","resolve","applyValue","writeProperty","properties","events","controls","ctKey","controlDefinition","mapKey","key","controlmap","elt","optionsParser","window","select","Utilities","markSupportedForProcessing","text","parent","querySelector","document","registerElement","processAll","watch","register","override","existing","proto","Object","create","HTMLElement","prototype","createdCallback","attachedCallback","attributeChangedCallback","attrName","oldValue","newValue","Binding","Template","AppBar","AutoSuggestBox","BackButton","ContentDialog","DatePicker","FlipView","Flyout","Hub","HubSection","ItemContainer","ListView","Menu","Pivot","PivotItem","Rating","Repeater","SearchBox","SemanticZoom","SplitView","TimePicker","ToggleSwitch","ToolBar","Tooltip","ViewBox","WinRT","readProtocol","args","detail","kind","Windows","ApplicationModel","Activation","ActivationKind","protocol","uri","navArgs","action","undefined","protocolArgs","queryargs","query","substr","split","arg","decodeURIComponent","host","isConnected","nlvl","Networking","Connectivity","NetworkConnectivityLevel","profile","NetworkInformation","getInternetConnectionProfile","level","getNetworkConnectivityLevel","constrainedInternetAccess","internetAccess","hasInternetAccess","onInternetStatusChanged","callback","handler","network","addEventListener","removeEventListener","Alerts","messageBox","opt","_global","md","Popups","MessageDialog","content","title","commands","command","index","cmd","UICommand","id","label","invoked","append","isDefault","defaultCommandIndex","showAsync","complete","error","navigator","notification","confirm","res","c","then","wrapError","message","yes","no","e","toastNotification","notifications","Notifications","template","picture","ToastTemplateType","toastImageAndText01","toastText01","toastXml","ToastNotificationManager","getTemplateContent","toastTextElements","getElementsByTagName","toastImageElements","launch","toastElements","JSON","stringify","appendChild","createTextNode","text2","text3","toast","ToastNotification","toastNotifier","createToastNotifier","show","UPnP","endsWith","search","indexOf","xmlToJson","xml","obj","nodeType","j","nodeValue","hasChildNodes","tmp","colonIdx","clearNode","old","trim","parseXML","DOMParser","parseFromString","toHex","n","result","start","digit","hextab","pad","str","len","ntos","toString","unescape","htoa","replace","RegExp","nextchar","charAt","parseInt","atoh","charCodeAt","expandExponential","x","s","f","Math","abs","z","Array","r","deviceTypes","ContentDirectory1","ContentDirectory2","ContentDirectory3","ContentDirectory4","MediaRenderer1","MediaRenderer2","MediaRenderer3","MediaRenderer4","MediaServer1","MediaServer2","MediaServer3","MediaServer4","AVTransport1","AVTransport2","ConnectionManager1","ConnectionManager2","ConnectionManager3","devicesDiscovery","filter","timeout","exists","url","matches","devices","d","deviceDescriptionUrl","discover","onsuccess","err","clientSocket","close","ex","onerror","Sockets","DatagramSocket","onmessagereceived","reader","getDataReader","count","unconsumedBufferLength","readString","completed","items","toLowerCase","xhr","rawdevice","responseXML","device","root","rootUrl","UPnPDevice","console","getOutputStreamAsync","hostName","outputStream","writer","Storage","Streams","DataWriter","unicodeEncoding","UnicodeEncoding","Utf8","writeString","storeAsync","discovery","hasError","HostName","List","promise","getContentType","extension","lowerUrl","deviceObj","getService","serviceType","service","serviceList","deviceList","childdevice","childService","controlURL","getAVTransport","UPnPAVTransport","getContentDirectory","UPnPContentDirectory","getConnectionManager","UPnPConnectionManager","UPnPService","serviceObj","opts","debug","svc","svcType","svcUrl","self","upnpAction","upnpParameters","promiseComplete","promiseError","response","svcMsg","createRequest","sendRequest","xmlResponse","apply","handleResponse","upnpResponse","requestTemplate","types","i1","allowedValues","toNative","i8","Int8Array","checkAllowedValues","i2","i16","Int16Array","i4","i32","Int32Array","ui1","ui8","Uint8Array","ui2","ui16","Uint16Array","ui4","ui32","Uint32Array","int","isNaN","r4","f32","Float32Array","r8","f64","Float64Array","number","fixed_14_4","float","_float","parseFloat","char","string","xmlObj","currentPos","idx","exception","date","dateTime","Date","parseDate","toISOString","dateTime_tz","time","time_tz","boolean","bin_base64","atob","btoa","bin_hex","decodeURI","uuid","_name","upnpServiceType","upnpActionName","parameters","formatParameters","debugLog","encodeXML","svcInParams","svcInParams_xml","svcParam","typeCheck","upnpEndpointURL","upnpRequestXML","onUPnPResponse","soapaction","httpClient","Web","Http","HttpClient","Foundation","Uri","request","HttpRequestMessage","HttpMethod","post","headers","HttpStringContent","utf8","sendRequestAsync","readAsStringAsync","status","responseText","UPnPError","upnpResponseXML","onUPnPResolved","svcOutParams","responseJSON","responseContainer","responseVars","varName","varVal","firstChild","decodeXML","formatParameter","parameter","param","value","processParam","allowedValueList","matchFound","msg","description","b64chars","b64tab","bin","t","cb_encode","ccc","padlen","ord","chars","cb_decode","cccc","String","fromCharCode","b","a","hexChars","timestamp","struct","minutesOffset","numericKeys","exec","slice","k","UTC","parse","NaN","allowedContentDirectoryTypes","urn:schemas-upnp-org:service:ContentDirectory:1","urn:schemas-upnp-org:service:ContentDirectory:2","urn:schemas-upnp-org:service:ContentDirectory:3","urn:schemas-upnp-org:service:ContentDirectory:4","upnpType","getSystemUpdateId","Id","getSearchCapabilities","SearchCaps","getSortCapabilities","SortCaps","browse","objectId","browseFlag","startingIndex","requestedCount","sortCriteria","ObjectID","BrowseFlag","Filter","StartingIndex","RequestedCount","SortCriteria","Result","NumberReturned","TotalMatches","UpdateID","allowedConnectionManagerTypes","urn:schemas-upnp-org:service:ConnectionManager:1","urn:schemas-upnp-org:service:ConnectionManager:2","urn:schemas-upnp-org:service:ConnectionManager:3","getCurrentConnectionIDs","ConnectionIDs","getCurrentConnectionInfo","connectionId","ConnectionID","RcsID","AVTransportID","ProtocolInfo","PeerConnectionManager","PeerConnectionID","Direction","Status","getProtocolInfo","Source","Sink","allowedAVTransportTypes","urn:schemas-upnp-org:service:AVTransport:1","urn:schemas-upnp-org:service:AVTransport:2","getDeviceCapabilities","instanceId","InstanceID","PlayMedia","RecMedia","RecQualityModes","getMediaInfo","NrTracks","MediaDuration","CurrentURI","CurrentURIMetaData","NextURI","NextURIMetaData","PlayMedium","RecordMedium","WriteStatus","getPositionInfo","Track","TrackDuration","TrackMetaData","TrackURI","RelTime","AbsTime","RelCount","AbsCount","getTransportInfo","CurrentTransportState","CurrentTransportStatus","CurrentSpeed","getTransportSettings","PlayMode","RecQualityMode","setAVTransportURI","currentURI","currentURIMetaData","play","speed","Speed","pause","stop","next","previous","seek","unit","target","Unit","Target","allowedRenderingControlTypes","urn:schemas-upnp-org:service:RenderingControl:1","urn:schemas-upnp-org:service:RenderingControl:2","urn:schemas-upnp-org:service:RenderingControl:3","UPnPRenderingControl","listPresets","InstanceId","CurrentPresetNameList","selectPreset","presetName","PresetName","getBrightness","CurrentBrightness","setBrightness","desiredBrightness","DesiredBrightness","getContrast","CurrentContrast","setContrast","desiredContrast","DesiredContrast","getSharpness","CurrentSharpness","setSharpness","desiredSharpness","DesiredSharpness","getRedVideoGain","CurrentRedVideoGain","setRedVideoGain","desiredRedVideoGain","DesiredRedVideoGain","getGreenVideoGain","CurrentGreenVideoGain","setGreenVideoGain","desiredGreenVideoGain","DesiredGreenVideoGain","getBlueVideoGain","CurrentBlueVideoGain","setBlueVideoGain","desiredBlueVideoGain","DesiredBlueVideoGain","getRedVideoBlackLevel","CurrentRedVideoBlackLevel","setRedVideoBlackLevel","desiredRedVideoBlackLevel","DesiredRedVideoBlackLevel","getGreenVideoBlackLevel","CurrentGreenVideoBlackLevel","setGreenVideoBlackLevel","desiredGreenVideoBlackLevel","DesiredGreenVideoBlackLevel","getBlueVideoBlackLevel","CurrentBlueVideoBlackLevel","setBlueVideoBlackLevel","desiredBlueVideoBlackLevel","DesiredBlueVideoBlackLevel","getColorTemperature","CurrentColorTemperature","setColorTemperature","desiredColorTemperature","DesiredColorTemperature","getHorizontalKeystone","CurrentHorizontalKeystone","setHorizontalKeystone","desiredHorizontalKeystone","DesiredHorizontalKeystone","getVerticalKeystone","CurrentVerticalKeystone","setVerticalKeystone","desiredVerticalKeystone","DesiredVerticalKeystone","getMute","channel","Channel","CurrentMute","setMute","desiredMute","DesiredMute","getVolume","CurrentVolume","setVolume","desiredVolume","DesiredVolume","getVolumeDB","setVolumeDB","getVolumeDBRange","MinValue","MaxValue","getLoudness","CurrentLoudness","setLoudness","desiredLoudness","DesiredLoudness","getStateVariables","stateVariableList","StateVariableList","StateVariableValuePairs","setStateVariables","renderingControlUDN","serviceId","stateVariableValuePairs","RenderingControlUDN","ServiceType","ServiceId","getAllowedTransforms","CurrentAllowedTransformSettings","getTransforms","CurrentTransformValues","setTransforms","desiredTransformValues","DesiredTransformValues","getAllAvailableTransforms","AllAllowedTransformSettings","getAllowedDefaultTransforms","AllowedDefaultTransformSettings","getDefaultTransforms","CurrentDefaultTransformSettings","setDefaultTransforms","desiredDefaultTransformSettings","DesiredDefaultTransformSettings","Bindings","_setPic","dest","src","style","backgroundImage","classList","add","pictureUnavailable","bindingArguments","argname","_optionsParser","winBindArgs","removeHTML","initializer","source","sourceProperty","destProperty","readProperty","innerHTML","oneTime","innerText","removeHTMLAndEllipsisize","textRes","size","toStaticHTML","ellipsisizeString","staticHTML","dataAttr","addClass","setClass","newval","oldval","remove","format","bindingDesc","bind","asClass","toBgImage","setImage","ToRealDate","toLocaleDateString","setTimeout","loadImage","done","toSmartBgImage","showIf","setVisibility","opacity","visibility","display","hideIfNot","hideIfNotDefined","hideIf","showIfNot","showIfNotDefined","enableIf","disabled","disableIfNot","disableIf","enableIfNot","toWidth","setWidth","width","ellipsisize","sourcedata","toEllipsisized","emptyIfNull","twoWayOnChange","setVal","getVal","getProperty","propValue","dispose","cleanUpBindingList","bindingList","unwrappedItem","unwrap","daysSince","m","y","myDate","yourDate","secondsInADay","diff","floor","getTime","formatDate","setDate","moment","calendar","daysSinceDate","getMonth","getDate","getFullYear","fromdate","humanizeDate","addSuffix","duration","humanize","Search","writeFile","folder","fileName","CreationCollisionOption","objectGraph","createFileAsync","docfile","FileIO","writeTextAsync","log","path","openFile","openIfExists","file","readTextAsync","workerPath","Index","storeData","onprogress","stopWords","Stemming","StopWords","common","pipeline","Pipeline","folderPromise","ApplicationData","current","localFolder","createFolderAsync","clear","loadData","indexString","fields","reload","save","exp","replaceExisting","filename","load","savedidx","_runSearch","querytext","preparedTokens","processText","searchResult","lastprogress","itemResult","_searchItem","progressPercent","sort","rank","limit","searchtokens","indexitem","points","tokenitem","untokenized","tokens","weight","token","stoken","rawdata","define","_add","def","hasOwnProperty","addRange","arr","progress","indexed","refresh","tokenize","txt","run","checkWord","words","IndexGroup","definitions","indexes","useworker","IndexWorkerProxy","addIndex","async","addRangefunction","searchindex","searchItemType","searchresult","allResults","hasResult","workerpath","wrapper","worker","Messenger","SmartWorker","init","searchTerm","pipe","sets","Presets","ops","Op","_processors","processorNames","stemming","standard","processor","full","lowerCase","dedup","dropInitialLetters","match","dropBafterMAtEnd","cTransform","dTransform","dropG","transformG","dropH","transformCK","transformPH","transformQ","transformS","transformT","dropT","transformV","transformWH","dropW","transformX","dropY","transformZ","dropVowels","removeDiacritics","Animation","getOpt","fadeOut","elements","delay","staggerDelay","itemdelay","maxdelay","timing","easing","to","executeTransition","fadeIn","initialDelay","extraDelay","delayFactor","delayCap","ret","min","pageExit","enterPage","stagger","animationParams","keyframe","equivalents","transform","cssName","promise1","executeAnimation","promise2","slideAnim","keyframeName","isIn","Easings","easeInQuad","easeOutQuad","transitionParams","from","slideFromBottom","slideFromTop","slideFromLeft","slideFromRight","slideToBottom","slideToTop","slideToLeft","slideToRight","tabExitPage","tabEnterPage","exitGrow","exagerated","dur","easeInQuint","exitShrink","shrinkAndFall","enterShrink","easeOutQuint","enterGrow","easeInCubic","easeInQuart","easeInSine","easeInExpo","easeInCirc","easeInBack","easeOutCubic","easeOutQuart","easeOutSine","easeOutExpo","easeOutCirc","easeOutBack","easeInOutQuad","easeInOutCubic","easeInOutQuart","easeInOutQuint","easeInOutSine","easeInOutExpo","easeInOutCirc","easeInOutBack","_browserStyleEquivalents","elasticbuttonkinds","rectangle","morphpath","svg","roundedrectangle","round","Namespace","ElasticButton","Class","mix","behavior","reset","active","mina","elastic","easein","setOptions","get","_kind","set","contentCreated","contentElement","className","moveChilds","bgElement","children","currentKind","snap","Snap","pathEl","paths","attr","eventTracker","EventTracker","addEvent","_ptdown","_ptup","animate","disposeSubTree","eventMixin","createEventProperties","FOWrapper","someProperty","_someProperty","wrapperId","guid","body","height","container","blurFilter","sblurFilter","blurTo","blur","stdDeviation","easeout","dispatchEvent","updateLayout","MultiPassRenderer","_scrollProcessor","_tolerance","_virtualize","_scrollContainer","scrollContainer","_multipass","multipass","_orientation","orientation","itemClassName","itemClass","itemTemplate","getTemplate","itemInvoked","onitemContent","_onScrollBinded","_onScroll","untapAll","_unregisterScrollEvents","rect","refreshScrollEvents","tolerance","virtualize","_registerScrollEvents","_scrollRequest","cancelAnimationFrame","requestAnimationFrame","checkRendering","clearOffsets","_checkSection","_vIsInView","_checkItem","_hIsInView","pxTolerance","clientHeight","scrollTop","clientWidth","scrollLeft","check","noRender","offsetFrom","renderItemsContent","onrendersection","rendered","empty","setImmediate","allRendered","prepareItems","renderOptions","resolveMethod","onitemInit","registereditems","itemdata","MultiPassItem","renderItems","renderer","itemDataPromise","as","itemData","delayed","_renderContent","_renderItemContent","tap","GridControl","grid","layouts","defaultLayout","layout","itemsPerColumn","itemsPerRow","cellSpace","cellWidth","cellHeight","autolayout","elementReady","readyComplete","_autolayout","gridLayouts","getParentControlByClass","resetElement","isItem","position","minWidth","minHeight","left","top","clearContent","clearLayout","fill","matrix","w","h","col","fit","maxW","maxH","firstFit","numItems","visibleChilds","st","getComputedStyle","GridLayoutsImpl","none","flexhorizontal","flexFlow","alignContent","_itemsPerColumn","visibleitems","columns","ceil","flexvertical","hbloc","_containerH","cellW","space","colCount","colOffset","topOffset","childs","eltH","horizontal","cellH","ratioW","ratioH","gridCellsMatrix","eltW","offsetWidth","offsetHeight","eltColumns","eltRows","pos","elementWidth","vertical","plugin","_containerW","_itemsPerLine","elementHeight","oldlayout","getLayout","layoutChanged","layoutfunc","changeLayout","applyed","viewState","lastViewState","matchingLayout","mq","matchMedia","DataSources","ds","gr","DataSourceManager","groupedList","list","defaultGroupLimit","filters","onitemchanged","oniteminserted","onitemremoved","field","groupKind","defaultGroupName","compareGroups","getGroupKey","getGroupData","listview","zoomedOutListView","_field","_defaultGroupLimit","_groupKind","_listview","detach","_groupedList","_filter","_items","filteredlist","_filterItems","addFilter","newFilter","getAt","dontAttach","filterCallback","createFiltered","createGrouped","g","groups","_groupItems","grp","_groupsProjection","groupSize","groupCount","itemDataSource","dataSource","groupDataSource","semzoom","parentSemanticZoom","locked","parentElement","contains","DOMEventMixin","SemanticListViews","_initControl","semanticZoom","_semanticZoom","zoomedOutListview","_zoomedOutListview","dataManager","_dataManager","semanticPlaceholder","listviewPlaceholder","zoomedOutListviewPlaceholder","semanticzoom","dataOptions","Grouping","DEFAULTGROUPLIMIT","GROUPKIND","FIELD","ITEMS","alphabetic","right","dataItem","byField","byYear","setMonth","setHours","byMonth","pad2","byDay"],"mappings":"AAYA,GAAIA,cAAeA,gBACnBA,cAAaC,GAAKD,aAAaC,OAK/BD,aAAaC,GAAGC,cAAgBF,aAAaC,GAAGC,kBAEhD,SAAWC,GACV,YASA,SAASC,GAAQC,GAChB,GAAIC,GAAgB,KAChBC,EAAWF,EAAKG,SAChBC,IAEJ,IAAsB,UAAlBJ,EAAKG,SAAsB,CAC9B,GAAIH,EAAKK,WAAY,CACpB,GAAIH,GAAWF,EAAKM,aAAa,KAC7BJ,KAEHD,EAAgBM,EAAWL,EAASM,gBAatC,GATKP,GAAmC,QAAlBD,EAAKG,UAAwC,SAAlBH,EAAKG,WACrDF,EAAgBM,EAAWP,EAAKG,WAG7BF,IAAkBD,EAAKS,cAE1BL,EAASM,KAAKC,EAAcX,EAAMC,IAG/BD,EAAKY,uBAAyBZ,EAAKa,YAAcb,EAAKa,WAAWC,eAAiBd,EAAKa,WAAWC,cAAcC,SAEnH,MAOD,KAAK,GAAIC,GAAI,EAAGC,EAAIjB,EAAKkB,WAAWC,OAAYF,EAAJD,EAAOA,IAClDZ,EAASM,KAAKX,EAAQC,EAAKkB,WAAWF,KAIxC,MAAOI,OAAMC,QAAQC,KAAKlB,GAa3B,QAASmB,GAAiBC,GACzB,GAAIT,GAAW,IAiBf,OAhBIpB,cAAaC,GAAGC,cAAc4B,WACjCV,EAAW,GAAIW,kBAAiB,SAAUC,GAEzCA,EAAUC,QAAQ,SAAUC,GAC3B,GAAIA,EAASC,WAAWX,OACvB,IAAK,GAAIH,GAAI,EAAGC,EAAIY,EAASC,WAAWX,OAAYF,EAAJD,EAAQA,IACvDjB,EAAQ8B,EAASC,WAAWd,QAOhCD,EAASgB,QAAQP,GAAWQ,WAAW,EAAMC,SAAS,KAGhDlB,EAIR,QAASJ,GAAca,EAASU,GACpBV,EAAQX,UACnBW,GAAQf,cAAe,CACvB,IAAI0B,GAAQxC,aAAayC,MAAMC,gBAAgBb,GAC3Cc,EAAIlB,MAAMC,QAAQkB,OAClBC,EAAU,WACbC,EAAmBP,EAAWQ,KAAMlB,GAGjCW,IAASA,EAAMrB,cAElBwB,EAAIH,EAAMrB,cAAc6B,MAAMC,OAAOC,OAAOL,GAE5CA,GAID,IAAIM,GAAetB,EAAQsB,YAe3B,OAdAtB,GAAQsB,aAAe,SAAUC,EAAMC,GACtC,GAAIxB,EAAQX,WAAY,CACvBiC,EAAaG,KAAKC,KAAMH,EAAMC,EAC9B,IAAId,GAAaV,EAAQX,WAAWsC,YAAYC,eAChD,IAAIlB,EAAY,CACf,GAAImB,GAAMnB,EAAWa,EAAKvC,cAC1B,IAAI6C,EAAK,CACR,GAAIC,IAAQC,QAAS/B,EAAQX,WAAYkC,KAAMM,EAAIG,SAAUC,QAC7DvB,GAAWwB,eAAeX,EAAMG,KAAMI,OAMnChB,EAGR,QAASG,GAAmBC,EAAMlB,GACjCA,EAAQf,cAAe,CACvB,IAAIyB,GAAaQ,EAAKU,gBAElBO,IACAnC,GAAQoC,QAAQC,aACnBF,EAAUG,EAAgBtC,IAGvBU,GAAcA,EAAW6B,kBAC5BJ,EAAUzB,EAAW6B,gBAAgBvC,EAASmC,EAASxB,OAGxD,IAAI6B,GAAO,GAAItB,GAAKlB,EAASmC,EAC7BnC,GAAQX,WAAamD,EACjB9B,GACHA,EAAW+B,SAASzC,GAKtB,QAAS0C,GAAaC,EAASzB,EAAM0B,GACpC,GAAsB,kBAAXA,KAEXA,EAAUA,MAEV1B,EAAKU,iBACJL,KAAMoB,EACNd,IAAKe,EAAQf,QACbU,gBAAiBK,EAAQL,gBACzBE,SAAU,SAAUzC,GACnB,GAAI6C,KACJ,KAAK,GAAIC,KAAQpB,MAAKG,IAAK,CAC1B,GAAIkB,IAAgBhB,QAAS/B,EAAQX,WAAYkC,KAAMG,KAAKG,IAAIiB,GAAMd,SAAUC,KAAMY,EACtFnB,MAAKQ,eAAeY,EAAM9C,EAAS,KAAM+C,KAG3Cb,eAAgB,SAAUX,EAAMvB,EAASgD,EAAWC,GACnD,GAAIpB,GAAMH,KAAKG,IAAIN,EAAKvC,cACxB,IAAI6C,EAAK,CACR,GAAIL,GAAMwB,GAAahD,EAAQlB,aAAa+C,EAAIqB,WAC5CV,EAAOxC,EAAQX,UACnB,IAAImC,GAAOgB,EACV,GAAKX,EAAIsB,MAAqB,aAAbtB,EAAIsB,KAOG,UAAbtB,EAAIsB,MACdhF,aAAayC,MAAMwC,aAAapD,EAASwB,EAAKyB,OARL,CACzC,GAAIpB,EAAIwB,QAEP,WADAlF,cAAayC,MAAM0C,WAAWtD,EAASwB,EAAKgB,EAAMX,EAAIG,SAAUiB,EAIjE9E,cAAayC,MAAM2C,cAAcf,EAAMX,EAAIG,SAAUR,OAStDoB,EAAQY,YACXZ,EAAQY,WAAWpD,QAAQ,SAAUU,GAChCA,IACHI,EAAKU,gBAAgBC,IAAIf,EAAE9B,gBAAmBkE,UAAWpC,EAAGkB,SAAUlB,EAAGuC,SAAS,EAAMF,KAAM,eAK7FP,EAAQa,QACXb,EAAQa,OAAOrD,QAAQ,SAAUU,GAC5BA,IACHI,EAAKU,gBAAgBC,IAAIf,EAAE9B,gBAAmBkE,UAAWpC,EAAGkB,SAAUlB,EAAGuC,SAAS,EAAMF,KAAM,YAK7FP,EAAQc,UACX,IAAK,GAAIC,KAASf,GAAQc,SAAU,CACnC,GAAI3B,GAAUa,EAAQc,SAASC,GAC3BC,EAAoB7B,EAAQH,eAChC,KAAK,GAAIiC,KAAUD,GAAkB/B,IAAK,CACzC,GAAIiC,GAAMH,EAAQ,IAAME,EACpBE,EAAaH,EAAkB/B,IAAIgC,EACvC3C,GAAKU,gBAAgBC,IAAIiC,EAAI9E,gBAC5BkE,UAAWS,EAAQ,IAAMI,EAAWb,UACpClB,SAAU2B,EAAQ,IAAMI,EAAW/B,SACnCqB,QAASU,EAAWV,WAkFzB,QAASf,GAAgB0B,GACxB,MAAOpE,OAAMxB,GAAG6F,cAAcD,EAAI5B,QAAQC,WAAY6B,QACrDC,OAAQvE,MAAMwE,UAAUC,2BAA2B,SAAUC,GAC5D,GAAIC,GAASpG,aAAayC,MAAMC,gBAAgBmD,EAChD,OAAIO,GACIA,EAAOvE,QAAQwE,cAAcF,GAG7BG,SAASD,cAAcF,OAjSlC,GAAIvF,KACJZ,cAAaC,GAAGC,cAAcU,WAAaA,EAC3CZ,aAAaC,GAAGC,cAAc4B,UAAW,GAEpC3B,EAAOmG,SAASC,iBAAmBpG,EAAO4B,mBAC9C/B,aAAaC,GAAGC,cAAc4B,UAAW,GAgD1C9B,aAAaC,GAAGC,cAAcsG,WAAa,SAAU3E,KACjD7B,aAAaC,GAAGC,cAAc4B,WACjC9B,aAAaC,GAAGC,cAAcsG,WAAapG,GAuB5CJ,aAAaC,GAAGC,cAAcuG,MAAQ7E,EAyJtC5B,aAAaC,GAAGC,cAAcwG,SAAW,SAAkBlC,EAASzB,EAAM0B,EAASkC,GAClF,GAAIC,GAAWhG,EAAW4D,EAAQ3D,cAClC,IAAI+F,IAAaD,EAChB,KAAM,aAAenC,EAAU,iBAKhC,IAFAD,EAAaC,EAASzB,EAAM0B,GAExBzE,aAAaC,GAAGC,cAAc4B,SACjC3B,EAAOmG,SAAStF,cAAcwD,GAE9B5D,EAAW4D,EAAQ3D,gBAAmBkC,KAAMA,OACtC,IAAI5C,EAAOmG,SAASC,gBAAiB,CAE3C,GAAIM,GAAQC,OAAOC,OAAOC,YAAYC,UACtCJ,GAAMK,gBAAkB,aAGxBL,EAAMM,iBAAmB,WACxB,GAAItF,GAAU0B,KACVf,EAAQxC,aAAayC,MAAMC,gBAAgBb,GAC3CgB,EAAU,WACbC,EAAmBC,EAAMlB,GAGtBW,IAASA,EAAMrB,cAEfqB,EAAMrB,cAAc6B,MAAMC,OAAOC,OAAOL,GAE3CA,KAIFgE,EAAMO,yBAA2B,SAAUC,EAAUC,EAAUC,GAC9D,GAAI1F,GAAU0B,IACd,IAAI1B,EAAQX,WAAY,CACvB,GAAIqB,GAAaV,EAAQX,WAAWsC,YAAYC,eAChD,IAAIlB,EAAY,CACf,GAAImB,GAAMnB,EAAWmB,IAAI2D,EAASxG,cAC9B6C,IACHnB,EAAWwB,eAAesD,EAAUxF,EAAS0F,GAAY3D,QAAS/B,EAAQX,WAAYkC,KAAMM,EAAIG,SAAUC,aAM9G3D,EAAOmG,SAASC,gBAAgB/B,GAAWyC,UAAWJ,MAoBpDpF,MAAM+F,SAAW/F,MAAM+F,QAAQC,UAClCzH,aAAaC,GAAGC,cAAcwG,SAAS,eAAgBjF,MAAM+F,QAAQC,UACpEpC,YAAa,kBAIX5D,MAAMxB,IAAMwB,MAAMxB,GAAGyH,QACxB1H,aAAaC,GAAGC,cAAcwG,SAAS,aAAcjF,MAAMxB,GAAGyH,QAC7DrC,YAAa,oBAAqB,WAAY,SAAU,SAAU,YAAa,SAAU,WACxF,cAAe,cAAe,eAAgB,gBAC/CC,QAAS,YAAa,YAAa,aAAc,gBAI/C7D,MAAMxB,IAAMwB,MAAMxB,GAAG0H,gBACxB3H,aAAaC,GAAGC,cAAcwG,SAAS,qBAAsBjF,MAAMxB,GAAG0H,gBACrEtC,YAAa,0BAA2B,WAAY,iBAAkB,mBACrE,2BAA4B,yBAA0B,kBAAmB,YACzE,uBAAwB,yBACzBC,QAAS,eAAgB,iBAAkB,yBAA0B,0BAInE7D,MAAMxB,IAAMwB,MAAMxB,GAAG2H,YACxB5H,aAAaC,GAAGC,cAAcwG,SAAS,iBAAkBjF,MAAMxB,GAAG2H,YAG/DnG,MAAMxB,IAAMwB,MAAMxB,GAAG4H,eACxB7H,aAAaC,GAAGC,cAAcwG,SAAS,oBAAqBjF,MAAMxB,GAAG4H,eACpExC,YAAa,SAAU,yBAA0B,qBAAsB,2BACtE,uBAAwB,QAAS,cAAe,cAAe,eAAgB,gBAChFC,QAAS,YAAa,YAAa,aAAc,gBAI/C7D,MAAMxB,IAAMwB,MAAMxB,GAAG6H,YACxB9H,aAAaC,GAAGC,cAAcwG,SAAS,iBAAkBjF,MAAMxB,GAAG6H,YACjEzC,YAAa,WAAY,cAAe,WAAY,UAAW,UAC9D,eAAgB,cAAe,WAAY,WAC5CC,QAAS,YAIP7D,MAAMxB,IAAMwB,MAAMxB,GAAG8H,UACxB/H,aAAaC,GAAGC,cAAcwG,SAAS,eAAgBjF,MAAMxB,GAAG8H,UAC/D1C,YAAa,cAAe,cAAe,eAAgB,iBAAkB,cAAe,2BAA4B,0BAA2B,iBAAkB,mBACrKC,QAAS,yBAA0B,wBAAyB,eAAgB,mBAI1E7D,MAAMxB,IAAMwB,MAAMxB,GAAG+H,QACxBhI,aAAaC,GAAGC,cAAcwG,SAAS,aAAcjF,MAAMxB,GAAG+H,QAC7D3C,YAAa,YAAa,SAAU,WAAY,SAAU,YACzD,cAAe,cAAe,eAAgB,gBAC/CC,QAAS,YAAa,YAAa,aAAc,gBAI/C7D,MAAMxB,IAAMwB,MAAMxB,GAAGgI,KACxBjI,aAAaC,GAAGC,cAAcwG,SAAS,UAAWjF,MAAMxB,GAAGgI,KAC1D5C,YAAa,iBAAkB,sBAAuB,qBAAsB,eAC3E,qBAAsB,kBAAmB,wBACzC,cAAe,iBAAkB,kBAAmB,WAAY,gBACjEC,QAAS,mBAAoB,gBAAiB,yBAI5C7D,MAAMxB,IAAMwB,MAAMxB,GAAGiI,YACxBlI,aAAaC,GAAGC,cAAcwG,SAAS,iBAAkBjF,MAAMxB,GAAGiI,YACjE7C,YAAa,iBAAkB,SAAU,oBAIvC5D,MAAMxB,IAAMwB,MAAMxB,GAAGkI,eACxBnI,aAAaC,GAAGC,cAAcwG,SAAS,oBAAqBjF,MAAMxB,GAAGkI,eACpE9C,YAAa,YAAa,YAAa,qBAAsB,sBAAuB,WAAY,oBAC/F,gBAAiB,mBAAoB,eACtCC,QAAS,UAAW,mBAAoB,uBAItC7D,MAAMxB,IAAMwB,MAAMxB,GAAGmI,UACxBpI,aAAaC,GAAGC,cAAcwG,SAAS,eAAgBjF,MAAMxB,GAAGmI,UAC/D/C,YACC,eAAgB,iBAAkB,iBAAkB,mBACpD,gBAAiB,sBAAuB,kBAAmB,gBAC3D,iBAAkB,cAAe,SAAU,UAE5CC,QAAS,iBAIP7D,MAAMxB,IAAMwB,MAAMxB,GAAGoI,MACxBrI,aAAaC,GAAGC,cAAcwG,SAAS,WAAYjF,MAAMxB,GAAGoI,MAC3DhD,YAAa,YAAa,SAAU,WAAY,WAAY,SAAU,YACrE,cAAe,cAAe,eAAgB,gBAC/CC,QAAS,YAAa,YAAa,aAAc,gBAI/C7D,MAAMxB,IAAMwB,MAAMxB,GAAGqI,OACxBtI,aAAaC,GAAGC,cAAcwG,SAAS,YAAajF,MAAMxB,GAAGqI,OAC5DjD,YAAa,QAAS,SAAU,qBAAsB,uBAAwB,qBAC7E,gBAAiB,eAAgB,SAClCC,QAAS,mBAAoB,qBAAsB,sBAIjD7D,MAAMxB,IAAMwB,MAAMxB,GAAGsI,WACxBvI,aAAaC,GAAGC,cAAcwG,SAAS,gBAAiBjF,MAAMxB,GAAGsI,WAChElD,YAAa,iBAAkB,YAI7B5D,MAAMxB,IAAMwB,MAAMxB,GAAGuI,QACxBxI,aAAaC,GAAGC,cAAcwG,SAAS,aAAcjF,MAAMxB,GAAGuI,QAC7DnD,YAAa,gBAAiB,WAAY,cAAe,YACxD,WAAY,WAAY,kBAAmB,iBAAkB,cAC9DC,QAAS,SAAU,SAAU,mBAI3B7D,MAAMxB,IAAMwB,MAAMxB,GAAGwI,UACxBzI,aAAaC,GAAGC,cAAcwG,SAAS,eAAgBjF,MAAMxB,GAAGwI,UAC/DpD,YAAa,OAAQ,SAAU,gBAAiB,iBAAkB,iBAAkB,kBACnF,cAAe,eAAgB,gBAAiB,iBAAkB,gBAClE,kBAAmB,mBAAoB,YACxCC,QAAS,cAAe,eAAgB,eAAgB,gBACvD,YAAa,aAAc,cAAe,eAAgB,cAC1D,gBAAiB,oBAIhB7D,MAAMxB,IAAMwB,MAAMxB,GAAGyI,WACxB1I,aAAaC,GAAGC,cAAcwG,SAAS,gBAAiBjF,MAAMxB,GAAGyI,WAChErD,YAAa,0BAA2B,WAAY,uBAAwB,iBAAkB,mBAC7F,2BAA4B,yBAA0B,kBAAmB,YACzE,uBAAwB,yBACzBC,QAAS,eAAgB,iBAAkB,yBAA0B,0BAInE7D,MAAMxB,IAAMwB,MAAMxB,GAAG0I,cACxB3I,aAAaC,GAAGC,cAAcwG,SAAS,mBAAoBjF,MAAMxB,GAAG0I,cACnEtD,YAAa,eAAgB,SAAU,gBAAiB,eAAgB,YAAa,gBAAiB,cACtGC,QAAS,iBAIP7D,MAAMxB,IAAMwB,MAAMxB,GAAG2I,WACxB5I,aAAaC,GAAGC,cAAcwG,SAAS,gBAAiBjF,MAAMxB,GAAG2I,WAChEvD,YAAa,iBAAkB,oBAAqB,cAAe,aAAc,gBAAiB,mBACjG,cAAe,cAAe,eAAgB,gBAC/CC,QAAS,YAAa,YAAa,aAAc,gBAI/C7D,MAAMxB,IAAMwB,MAAMxB,GAAG4I,YACxB7I,aAAaC,GAAGC,cAAcwG,SAAS,iBAAkBjF,MAAMxB,GAAG4I,YACjExD,YAAa,WAAY,QAAS,UAAW,WAAY,cACxD,kBAAmB,gBAAiB,iBACrCC,QAAS,cAIP7D,MAAMxB,IAAMwB,MAAMxB,GAAG6I,cACxB9I,aAAaC,GAAGC,cAAcwG,SAAS,mBAAoBjF,MAAMxB,GAAG6I,cACnEzD,YAAa,WAAY,UAAW,WAAY,WAAY,UAAW,SACvEC,QAAS,cAIP7D,MAAMxB,IAAMwB,MAAMxB,GAAG8I,SACxB/I,aAAaC,GAAGC,cAAcwG,SAAS,cAAejF,MAAMxB,GAAG8I,SAG5DtH,MAAMxB,IAAMwB,MAAMxB,GAAG+I,SACxBhJ,aAAaC,GAAGC,cAAcwG,SAAS,cAAejF,MAAMxB,GAAG+I,SAC9D3D,YAAa,iBAAkB,aAAc,UAAW,YAAa,gBACpE,eAAgB,WAAY,WAAY,aACzCC,QAAS,cAAe,aAAc,SAAU,YAI9C7D,MAAMxB,IAAMwB,MAAMxB,GAAGgJ,SACxBjJ,aAAaC,GAAGC,cAAcwG,SAAS,cAAejF,MAAMxB,GAAGgJ,UAW9D1F;AC7fH,GAAIvD,eACJ,SAAWA,GACP,GAAIkJ,IACJ,SAAWA,GAOP,QAASC,GAAaC,GAClB,GAAIA,EAAKC,OAAOC,OAASC,QAAQC,iBAAiBC,WAAWC,eAAeC,UAAYP,EAAKC,OAAOO,IAAK,CACrG,GAAIC,IAAYC,OAAQC,QACpBC,KACAC,EAAYb,EAAKC,OAAOO,IAAIM,KAchC,OAboB,KAAhBD,EAAU,KACVA,EAAYA,EAAUE,OAAO,IAE7BF,GACAA,EAAUG,MAAM,KAAKnI,QAAQ,SAAU0C,GACnC,GAAI0F,GAAM1F,EAAKyF,MAAM,IACrBJ,GAAaK,EAAI,IAAMC,mBAAmBD,EAAI,MAGtDR,EAAQF,UACJG,OAAQV,EAAKC,OAAOO,IAAIW,KACxBnB,KAAMY,GAEHH,GAUf,QAASW,KACL,GAAIC,GAAOlB,QAAQmB,WAAWC,aAAaC,yBACvCC,EAAUtB,QAAQmB,WAAWC,aAAaG,mBAAmBC,8BACjE,IAAgB,OAAZF,EAAkB,CAClB,GAAIG,GAAQH,EAAQI,6BACpB,OAAOD,KAAUP,EAAKS,2BAA6BF,IAAUP,EAAKU,eAEtE,OAAO,EASX,QAASC,KACL,GAAIX,GAAOlB,QAAQmB,WAAWC,aAAaC,yBACvCC,EAAUtB,QAAQmB,WAAWC,aAAaG,mBAAmBC,8BACjE,IAAgB,OAAZF,EAAkB,CAClB,GAAIG,GAAQH,EAAQI,6BACpB,OAAOD,KAAUP,EAAKU,eAE1B,OAAO,EAUX,QAASE,GAAwBC,GAC7B,GAAIC,GAAU,SAAUlB,GAEpBiB,EAAStL,EAAakJ,MAAMkC,sBAE5BI,EAAUjC,QAAQmB,WAAWC,aAAaG,kBAE9C,OADAU,GAAQC,iBAAiB,uBAAwBF,GAC1C,WACHC,EAAQE,oBAAoB,uBAAwBH,IAhD5DrC,EAAMC,aAAeA,EAgBrBD,EAAMsB,YAAcA,EAgBpBtB,EAAMkC,kBAAoBA,EAmB1BlC,EAAMmC,wBAA0BA,GACjCnC,EAAQlJ,EAAakJ,QAAUlJ,EAAakJ,YAChDlJ,eAAiBA,iBACpB,IAAIA,eACJ,SAAWA,GACP,GAAI2L,IACJ,SAAWA,GAOP,QAASC,GAAWC,GAChB,GAAIC,GAAU/F,MACd,IAAI8F,EAAK,CACL,GAAIC,EAAQvC,QAAS,CACjB,GAAIwC,GAAK,GAAIxC,SAAQtJ,GAAG+L,OAAOC,cAAcJ,EAAIK,QAmBjD,OAlBIL,GAAIM,QACJJ,EAAGI,MAAQN,EAAIM,OAEfN,EAAIO,UAAYP,EAAIO,SAASnK,SAC7B4J,EAAIO,SAASnK,QAAQ,SAAUoK,EAASC,GACpC,GAAIC,GAAM,GAAIhD,SAAQtJ,GAAG+L,OAAOQ,SAC5BH,GAAQI,KACRF,EAAIE,GAAKJ,EAAQI,IACrBF,EAAIG,MAAQL,EAAQK,MAChBL,EAAQf,WACRiB,EAAII,QAAUN,EAAQf,UAExBS,EAAY,SAAEa,OAAOL,GACnBF,EAAQQ,YACRd,EAAGe,oBAAsBR,KAI7BP,EAAGgB,YAGX,MAAO,IAAItL,OAAMC,QAAQ,SAAUsL,EAAUC,GACzC,GAAId,GAAQ,EACRN,GAAIM,QACJA,EAAQN,EAAIM,MAEhB,IAAIC,KACAP,GAAIO,UAAYP,EAAIO,SAASnK,QAI7B4J,EAAIO,SAASnK,QAAQ,SAAUoK,EAASC,GACpCF,EAASrL,KAAKsL,EAAQK,SAI1BN,GAAY,MACZN,EAAQoB,WAAapB,EAAQoB,UAAUC,cAAgBrB,EAAQoB,UAAUC,aAAaC,QACtFtB,EAAQoB,UAAUC,aAAaC,QAAQvB,EAAIK,QAAS,SAAUmB,GAC1D,GAAIxB,EAAIO,UAAYP,EAAIO,SAASiB,EAAM,IAAMxB,EAAIO,SAASiB,EAAM,GAAG/B,SAAU,CACzE,GAAIgC,GAAIzB,EAAIO,SAASiB,EAAM,GAAG/B,UAC1BgC,IAAKA,EAAEC,KACPD,EAAEC,KAAK,WACHP,GAAS,KAIbA,GAAS,OAIbA,GADY,GAAPK,GACI,GAEA,IACdlB,EAAOC,GAKNY,EADAjH,OAAOqH,QAAQjB,IACN,GAEA,KAK7B,MAAO1K,OAAMC,QAAQ8L,UAAU,kIAWnC,QAASC,GAAQtB,EAAOD,GACpB,MAAOlM,GAAa2L,OAAOC,YAAaO,MAAOA,EAAOD,QAASA,IAYnE,QAASkB,GAAQjB,EAAOD,EAASwB,EAAKC,GAClC,MAAO,IAAIlM,OAAMC,QAAQ,SAAUsL,EAAUC,GACzCjN,EAAa2L,OAAOC,YAChBO,MAAOA,EACPD,QAASA,EACTE,WAEQM,MAAOgB,EACPpC,SAAU,SAAUsC,GAChBZ,GAAS,IAEbH,WAAW,IAGXH,MAAOiB,EACPrC,SAAU,SAAUsC,GAChBZ,GAAS,UAajC,QAASa,GAAkB/J,GACvB,IAAIyF,QA0BA,KAAM,8BAzBN,IAAIuE,GAAgBvE,QAAQtJ,GAAG8N,cAC3BC,EAAWlK,EAAKkK,WAAalK,EAAKmK,QAAUH,EAAcI,kBAAkBC,oBAAsBL,EAAcI,kBAAkBE,aAElIC,EAAWP,EAAcQ,yBAAyBC,mBAAmBP,GACrEQ,EAAoBH,EAASI,qBAAqB,QAClDC,EAAqBL,EAASI,qBAAqB,QACvD,IAAI3K,EAAK6K,OAAQ,CACb,GAAIC,GAAgBP,EAASI,qBAAqB,QAClDG,GAAc,GAAGzL,aAAa,SAAU0L,KAAKC,UAAUhL,EAAK6K,SAEhEH,EAAkB,GAAGO,YAAYV,EAASW,eAAelL,EAAKqC,OAC1DrC,EAAKmL,OAAST,EAAkBhN,OAAS,GACzCgN,EAAkB,GAAGO,YAAYV,EAASW,eAAelL,EAAKmL,QAE9DnL,EAAKoL,OAASV,EAAkBhN,OAAS,GACzCgN,EAAkB,GAAGO,YAAYV,EAASW,eAAelL,EAAKoL,QAE9DpL,EAAKmK,SACLS,EAAmB,GAAGvL,aAAa,MAAOW,EAAKmK,QAEnD,IAAIkB,GAAQ,GAAIrB,GAAcsB,kBAAkBf,GAC5CgB,EAAgBvB,EAAcQ,yBAAyBgB,qBAC3DD,GAAcE,KAAKJ,GAa3B,QAASA,GAAMhJ,EAAM8H,GACjBjO,EAAa2L,OAAOkC,mBAAoB1H,KAAMA,EAAM8H,QAASA,IAzFjEtC,EAAOC,WAAaA,EAYpBD,EAAO8B,QAAUA,EAiCjB9B,EAAOyB,QAAUA,EAoCjBzB,EAAOkC,kBAAoBA,EAU3BlC,EAAOwD,MAAQA,GAChBxD,EAAS3L,EAAa2L,SAAW3L,EAAa2L,aAClD3L,eAAiBA;ACrQpB,GAAIA,cAAeA,gBACnBA,cAAawP,KAAOxP,aAAawP,SAEjC,SAAWrP,GAiJP,QAASsP,GAAStJ,EAAMuJ,GACpB,MAAOvJ,GAAKwJ,QAAQD,IAAWvJ,EAAK3E,OAASkO,EAAOlO,OAmBxD,QAASoO,GAAUC,GAGf,GAAIC,KAEJ,IAAoB,GAAhBD,EAAIE,UAEJ,GAAIF,EAAInP,WAAWc,OAAS,EAAG,CAC3BsO,EAAI,iBACJ,KAAK,GAAIE,GAAI,EAAGA,EAAIH,EAAInP,WAAWc,OAAQwO,IAAK,CAC5C,GAAIjL,GAAY8K,EAAInP,WAAWiE,KAAKqL,EAEpCF,GAAI,eAAe/K,EAAUvE,UAAYuE,EAAUkL,gBAGpC,IAAhBJ,EAAIE,WACXD,EAAMD,EAAII,UAId,IAAIJ,EAAIK,gBAAiB,CAErB,IAAK,GADD7K,GAAa,EACRhE,EAAI,EAAGA,EAAIwO,EAAItO,WAAWC,OAAQH,IAAK,CAC5C,GAAIsD,GAAOkL,EAAItO,WAAWoD,KAAKtD,GAC3Bb,EAAWmE,EAAKnE,QACpB,IAA8B,mBAAlBsP,GAAItP,GAA2B,CACvC,GAAI2P,GAAMP,EAAUjL,GAChByL,EAAW5P,EAASmP,QAAQ,IAChC,IAAIS,EAAW,EACX,GAAIC,GAAY7P,EAAS2J,OAAOiG,EAAW,EAAG5P,EAASgB,OAAS4O,EAAW,EAI3EC,KAAcP,EAAIO,GAClBP,EAAIO,GAAaF,EAEjBL,EAAItP,GAAY2P,EAGpB9K,QACG,CACH,GAAmC,mBAAvByK,GAAItP,GAAc,KAAkB,CAC5C,GAAI8P,GAAMR,EAAItP,EACdsP,GAAItP,MACJsP,EAAItP,GAAUO,KAAKuP,GAEvBR,EAAItP,GAAUO,KAAK6O,EAAUjL,IAC7BU,KAIJyK,EAAI,UAAmC,gBAAhBA,GAAI,WAC3BA,EAAI,SAAWA,EAAI,SAASS,QAEd,GAAdlL,GAAmByK,EAAI,UAAmC,gBAAhBA,GAAI,WAC9CA,EAAMA,EAAI,UAIlB,IAAK,GAAIlC,KAAKkC,GAAI,eACTA,EAAIlC,KACLkC,EAAIlC,GAAKkC,EAAI,eAAelC,GAGpC,OAAOkC,GAitBX,QAASU,GAASrK,GACd,OAAO,GAAKsK,YAAaC,gBAAgBvK,EAAM,YAgEnD,QAASwK,GAAMC,GAGX,IAAK,GAFDC,GAAS,GACTC,GAAQ,EACHzP,EAAI,GAAIA,EAAI,GAAI,CACrBA,GAAK,CACL,IAAI0P,GAASH,GAAKvP,EAAK,EAClByP,IAAkB,GAATC,IACVD,GAAQ,EACRD,GAAUG,EAAOD,IAGzB,MAAkB,IAAVF,EAAe,IAAMA,EAGjC,QAASI,GAAIC,EAAKC,EAAKF,GAEnB,IAAK,GADDJ,GAASK,EACJ7P,EAAI6P,EAAI1P,OAAY2P,EAAJ9P,EAASA,IAC9BwP,EAASI,EAAMJ,CAEnB,OAAOA,GAGX,QAASO,GAAKR,GAIV,MAHAA,GAAIA,EAAES,SAAS,IACC,GAAZT,EAAEpP,SAAaoP,EAAI,IAAMA,GAC7BA,EAAI,IAAMA,EACHU,SAASV,GAGpB,QAASW,GAAKL,GACVA,EAAMA,EAAIrQ,cAAc2Q,QAAQ,GAAIC,QAAO,kBAG3C,KAAK,GAFDZ,GAAS,GACTa,EAAW,GACNrQ,EAAI,EAAGA,EAAI6P,EAAI1P,OAAQH,IAC5BqQ,GAAYR,EAAIS,OAAOtQ,GACA,GAAnBqQ,EAASlQ,SACTqP,GAAUO,EAAKQ,SAASF,EAAU,KAClCA,EAAW,GAGnB,OAAOb,GAGX,QAASgB,GAAKX,GAEV,IAAK,GADDL,GAAS,GACJxP,EAAI,EAAGA,EAAI6P,EAAI1P,OAAQH,IAC5BwP,GAAUI,EAAIN,EAA0B,IAApBO,EAAIY,WAAWzQ,IAAY,EAAG,IAEtD,OAAOwP,GAKX,QAASkB,GAAkBb,GACvB,MAAOA,GAAIM,QAAQ,sCAAuC,SAAUQ,EAAGC,EAAGrB,EAAGsB,EAAG5E,GAC5E,GAAIhM,GAAS,GAAJgM,EAAOjM,EAAIuP,EAAEpP,SAAU8L,EAAG0E,GAAK1Q,EAAIsP,EAAIsB,GAAG1Q,OACnD8L,GAAMA,EAAI6E,KAAKC,IAAI9E,KAAO0E,EAAI1E,EAAI0E,EAAI1Q,EAAI,EAC1C+Q,EAAI,GAAKC,OAAMhF,EAAI,GAAI3L,KAAK,KAAM4Q,EAAI3B,EAAIsB,CAC1C,QAAQD,GAAK,KAAO3Q,EAAIiR,EAAIF,EAAIE,EAAIA,GAAKF,GAAGlI,OAAO,EAAG9I,GAAKC,EAAI+Q,EAAE7Q,OAAS,IAAMH,EAAIkR,EAAE/Q,OAAS,IAAM+Q,EAAEpI,OAAO9I,GAAK,MA/iC3HrB,aAAawP,KAAKgD,aACdC,kBAAmB,kDACnBC,kBAAmB,kDACnBC,kBAAmB,kDACnBC,kBAAmB,kDACnBC,eAAgB,8CAChBC,eAAgB,8CAChBC,eAAgB,8CAChBC,eAAgB,8CAChBC,aAAc,4CACdC,aAAc,4CACdC,aAAc,4CACdC,aAAc,4CACdC,aAAa,6CACbC,aAAc,6CACdC,mBAAoB,mDACpBC,mBAAoB,mDACpBC,mBAAoB,oDAGxBzT,aAAawP,KAAKkE,iBAAmB,SAA0BC,EAAQrI,EAAUsI,GAiB7E,QAASC,GAAOC,GACZ,GAAIC,GAAUC,EAAQL,OAAO,SAAUM,GACnC,MAAQH,IAAOG,EAAEC,sBAErB,OAAOH,GAAQvS,OAAS,EAG5B,QAAS2S,GAASR,GACd,MAAO,IAAIlS,OAAMC,QAAQ,SAAUsL,EAAUC,GAGzC,QAASmH,GAAUC,GACf,IACQC,GACAA,EAAaC,QACnB,MAAOC,IAETxH,EAASgH,GAGb,QAASS,GAAQJ,GACb,IACQC,GACAA,EAAaC,QACnB,MAAOC,IAETvH,EAAMoH,GAjBV,GAAIC,GAAe,GAAI/K,SAAQmB,WAAWgK,QAAQC,cAoBlDL,GAAaM,kBAAoB,SAAUxL,GACvC,GACIyL,GAASzL,EAAK0L,gBACdC,EAAQF,EAAOG,uBACflR,EAAO+Q,EAAOI,WAAWF,GACzBG,GAAY,CAEhB,IAAIpR,EAAM,CACN,GAAIqR,GAAQrR,EAAKsG,MAAM,KACvB+K,GAAMlT,QAAQ,SAAU0C,GACpB,IAAKuQ,GAAwD,GAA3CvQ,EAAKyQ,cAAczF,QAAQ,aAAmB,CAC5D,GAAImE,GAAMnP,EAAKwF,OAAO,EAAGxF,EAAKnD,OAAS,EACvC0T,IAAY,EACPrB,EAAOC,IACRrS,MAAM4T,KAAMvB,IAAKA,IAAOvG,KAAK,SAAUgF,GAEnC,GAAI+C,GAAY1F,EAAU2C,EAAEgD,aACxBC,EAASF,EAAUG,KAAKD,MAE5BA,GAAOtB,qBAAuBJ,EAC9B0B,EAAOE,QAAU5B,EAAI3J,OAAO,EAAG2J,EAAInE,QAAQ,IAAK,IAC3CkE,EAAOC,IACRE,EAAQjT,KAAK,GAAIf,cAAawP,KAAKmG,WAAWH,IAG9ClK,GACAA,EAASkK,EAAQ1B,IACtB,SAAUO,GACTuB,QAAQ3I,MAAM,yBACd2I,QAAQ3I,MAAMoH,UAStCC,EAAauB,qBAAqBC,EAAU,QAAQvI,KAAK,SAAUwI,GAC/D,GAAItI,GAAU,4DAEiBkG,GAAU,mBAAqB,0CAK1DqC,EAAS,GAAIzM,SAAQ0M,QAAQC,QAAQC,WAAWJ,EAGpD,OAFAC,GAAOI,gBAAkB7M,QAAQ0M,QAAQC,QAAQG,gBAAgBC,KACjEN,EAAOO,YAAY9I,GACZuI,EAAOQ,eACfjJ,KAAK,WACJ,MAAO9L,OAAMC,QAAQkS,QAAQA,GAAW,OACzCrG,KAAK6G,EAAWK,KACpBlH,KAAK,SAAUF,GACdoJ,EAAUC,UAAW,GACtB,SAAUrC,GACToC,EAAUC,UAAW,EACrBD,EAAUxJ,MAAQoH,IAtG1B,GAAIyB,EACJ,KACIA,EAAW,GAAIvM,SAAQmB,WAAWiM,SAAS,mBAC7C,MAAOnC,GAEL,WADAvH,QAAQQ,QAAS,uBAIrB,GAAIuG,GAAU,GAAIvS,OAAM+F,QAAQoP,KAE5BH,GACAzC,QAASA,EACT0C,SAAU,KACVG,QAAS,MA6FTpW,IAEJ,IAAKkT,GAA4B,gBAAVA,IAGlB,GAAIA,GAA2B,gBAAVA,IAAsBA,EAAOnS,OACnD,IAAK,GAAIH,GAAI,EAAIA,EAAIsS,EAAOnS,OAAQH,IAChCZ,EAASM,KAAKoT,EAASR,EAAOtS,SAJlCZ,GAASM,KAAKoT,EAASR,GAU3B,OAFA8C,GAAUI,QAAUpV,MAAMC,QAAQC,KAAKlB,GAEhCgW,GAOXzW,aAAawP,KAAKsH,eAAiB,SAAUhD,EAAKiD,GAC9C,GAAIC,GAAWlD,EAAIsB,aAEnB,OAAiB,OAAb2B,GAAsBtH,EAASuH,EAAU,QAClC,YAEM,OAAbD,GAAsBtH,EAASuH,EAAU,QAClC,YAEM,OAAbD,GAAsBtH,EAASuH,EAAU,QAClC,YAEM,OAAbD,GAAsBtH,EAASuH,EAAU,QAClC,mBADX,QA2EJhX,aAAawP,KAAKmG,WAAa,SAAUsB,GACrC,IAAK,GAAItU,KAAKsU,GACV1T,KAAKZ,GAAKsU,EAAUtU,IAI5B3C,aAAawP,KAAKmG,WAAW1O,UAAUiQ,WAAa,SAAUC,GAC1D,GAAI3B,GAASjS,KACT6T,EAAU,IA2Bd,OAzB0B,gBAAfD,KACPA,GAAeA,IAEf3B,EAAO6B,aAAe7B,EAAO6B,YAAYD,UACzCA,EAAU5B,EAAO6B,YAAYD,QAAQzD,OAAO,SAAU1B,GAClD,MAAOkF,GAAYxH,QAAQsC,EAAEkF,cAAgB,IAC9C,IAEEC,GAAW5B,EAAO8B,YACnB9B,EAAO8B,WAAW9B,OAAOvT,QAAQ,SAAUsV,GACvC,GAAIC,GAAeD,EAAYF,YAAYD,QAAQzD,OAAO,SAAU1B,GAChE,MAAOkF,GAAYxH,QAAQsC,EAAEkF,cAAgB,IAC9C,EAECK,KACAJ,EAAUI,MAKtBJ,IACAA,EAAQ1B,QAAUF,EAAOE,QACzB0B,EAAQtD,IAAM0B,EAAOE,QAAU0B,EAAQK,YAGpCL,GAGXpX,aAAawP,KAAKmG,WAAW1O,UAAUyQ,eAAiB,WACpD,GAAIN,GAAU7T,KAAK2T,YAAYlX,aAAawP,KAAKgD,YAAYa,aAAcrT,aAAawP,KAAKgD,YAAYc,cACzG,OAAI8D,GACO,GAAIpX,cAAawP,KAAKmI,gBAAgBP,GADjD,QAKJpX,aAAawP,KAAKmG,WAAW1O,UAAU2Q,oBAAsB,WACzD,GAAIR,GAAU7T,KAAK2T,YAAYlX,aAAawP,KAAKgD,YAAYC,kBAAmBzS,aAAawP,KAAKgD,YAAYE,kBAAmB1S,aAAawP,KAAKgD,YAAYG,kBAAmB3S,aAAawP,KAAKgD,YAAYI,mBAChN,OAAIwE,GACO,GAAIpX,cAAawP,KAAKqI,qBAAqBT,GADtD,QAKJpX,aAAawP,KAAKmG,WAAW1O,UAAU6Q,qBAAuB,WAC1D,GAAIV,GAAU7T,KAAK2T,YAAYlX,aAAawP,KAAKgD,YAAYe,mBAAoBvT,aAAawP,KAAKgD,YAAYgB,mBAAoBxT,aAAawP,KAAKgD,YAAYiB,oBACjK,OAAI2D,GACO,GAAIpX,cAAawP,KAAKuI,sBAAsBX,GADvD,QASJpX,aAAawP,KAAKwI,YAAc,SAAUC,EAAYC,GAElD3U,KAAKS,QAAUkU,IAAUC,OAAO,GAChC5U,KAAK6U,IAAMH,EAGX1U,KAAKuG,OAAS,aAkBdvG,KAAK8U,QAAU9U,KAAK6U,IAAIjB,YACxB5T,KAAK+U,OAAS/U,KAAK6U,IAAItE,GAEvB,IAAIyE,GAAOhV,IAGXA,MAAKuG,OAAS,SAAU0O,EAAYC,EAAgBnN,GAEhD,MAAO,IAAI7J,OAAMC,QAAQ,SAAUgX,EAAiBC,GAG3CrN,GAA8D,qBAAlDxE,OAAOG,UAAUoK,SAAS/N,KAAKmV,KAC5CnN,EAAWmN,EACXA,MAICnN,GAAyD,sBAA7CxE,OAAOG,UAAUoK,SAAS/N,KAAKgI,KAC5CA,EAAW,SAAUsC,EAAGgL,KAI5B,IAAIC,GAASN,EAAKO,cAAcP,EAAKF,QAASG,EAAYC,EAG1DF,GAAKQ,YAAYR,EAAKF,QAASG,EAAYD,EAAKD,OAAQO,EAAQ,SAAUjL,EAAGoL,GAEzE,MAAU,QAANpL,GACAtC,EAAS2N,MAAMV,GAAO3K,EAAG,WACzB+K,GAAa/K,QAKjB2K,GAAKW,eAAeV,EAAYQ,EAAYzD,aAAe,GAAIkD,EAAgB,SAAU7K,EAAGuL,GAGxF7N,EAAS2N,MAAMV,GAAO3K,EAAGuL,IAGf,OAANvL,EACA+K,EAAa/K,GAEb8K,EAAgBS,WAUxCnZ,aAAawP,KAAKwI,YAAY/Q,UAAUzD,YAAcxD,aAAawP,KAAKwI,YAIxEhY,aAAawP,KAAKwI,YAAY/Q,UAAUmS,gBAAkB,+RAY1DpZ,aAAawP,KAAKwI,YAAY/Q,UAAUoS,OAEpCC,GAAM,SAAUjW,EAAKkW,EAAeC,GAChC,GAAIC,GAAK,GAAIC,WAAU,EAGvB,OAFAD,GAAG,GAAKpW,EAEDrD,aAAawP,KAAKwI,YAAY/Q,UAAU0S,mBAAmBF,EAAG,GAAIF,IAI7EK,GAAM,SAAUvW,EAAKkW,EAAeC,GAChC,GAAIK,GAAM,GAAIC,YAAW,EAEzB,OADAD,GAAI,GAAKxW,EACFrD,aAAawP,KAAKwI,YAAY/Q,UAAU0S,mBAAmBE,EAAI,GAAIN,IAG9EQ,GAAM,SAAU1W,EAAKkW,EAAeC,GAChC,GAAIQ,GAAM,GAAIC,YAAW,EAEzB,OADAD,GAAI,GAAK3W,EACFrD,aAAawP,KAAKwI,YAAY/Q,UAAU0S,mBAAmBK,EAAI,GAAIT,IAG9EW,IAAO,SAAU7W,EAAKkW,EAAeC,GACjC,GAAIW,GAAM,GAAIC,YAAW,EAEzB,OADAD,GAAI,GAAK9W,EACFrD,aAAawP,KAAKwI,YAAY/Q,UAAU0S,mBAAmBQ,EAAI,GAAIZ,IAG9Ec,IAAO,SAAUhX,EAAKkW,EAAeC,GACjC,GAAIc,GAAO,GAAIC,aAAY,EAE3B,OADAD,GAAK,GAAKjX,EACHrD,aAAawP,KAAKwI,YAAY/Q,UAAU0S,mBAAmBW,EAAK,GAAIf,IAG/EiB,IAAO,SAAUnX,EAAKkW,EAAeC,GACjC,GAAIiB,GAAO,GAAIC,aAAY,EAE3B,OADAD,GAAK,GAAKpX,EACHrD,aAAawP,KAAKwI,YAAY/Q,UAAU0S,mBAAmBc,EAAK,GAAIlB,IAG/EoB,MAAO,SAAUtX,EAAKkW,EAAeC,GAcjC,MAbYzP,UAAR1G,GAA6B,OAARA,GAAgBuX,MAAMvX,GAC3CA,EAAM,EACgB,gBAARA,KAEVA,EADAA,KAAQ,EACF,EAEAuO,SAASvO,EAAM,GAAI,KAG5BmW,IACDnW,EAAM0O,EAAkB1O,EAAM,KAE9BuX,MAAMvX,KAAMA,EAAM,GACfrD,aAAawP,KAAKwI,YAAY/Q,UAAU0S,mBAAmBtW,EAAKkW,IAG3EsB,GAAM,SAAUxX,EAAKkW,EAAeC,GAChC,GAAIsB,GAAM,GAAIC,cAAa,EAE3B,OADAD,GAAI,GAAKzX,EACJmW,EAGExZ,aAAawP,KAAKwI,YAAY/Q,UAAU0S,mBAAmBmB,EAAI,GAAIvB,GAF/DuB,EAAI,GAAK/I,EAAkB+I,EAAI,GAAK,IAAM,KAKzDE,GAAM,SAAU3X,EAAKkW,EAAeC,GAChC,GAAIyB,GAAM,GAAIC,cAAa,EAE3B,OADAD,GAAI,GAAK5X,EACJmW,EAGExZ,aAAawP,KAAKwI,YAAY/Q,UAAU0S,mBAAmBsB,EAAI,GAAI1B,GAF/D0B,EAAI,GAAKlJ,EAAkBkJ,EAAI,GAAK,IAAM,KAKzDE,OAAU,SAAU9X,EAAKkW,EAAeC,GACpC,MAAOxZ,cAAawP,KAAKwI,YAAY/Q,UAAUoS,MAAU,GAAEhW,EAAKkW,EAAeC,IAGnF4B,WAAc,SAAU/X,EAAKkW,EAAeC,GACxC,MAAOxZ,cAAawP,KAAKwI,YAAY/Q,UAAUoS,MAAM,SAAShW,EAAKkW,EAAeC,IAGtF6B,QAAS,SAAUhY,EAAKkW,EAAeC,GACnC,GAAI8B,GAASC,WAAWlY,EACxB,OAAKmW,GAGExZ,aAAawP,KAAKwI,YAAY/Q,UAAU0S,mBAAmB2B,EAAQ/B,GAF/D+B,EAASvJ,EAAkBuJ,EAAS,IAAM,KAKzDE,OAAQ,SAAUnY,EAAKkW,EAAeC,GAQlC,MANInW,GADQ0G,SAAR1G,GAA6B,OAARA,GAAwB,KAARA,GAAeA,EAAM,IAAO,OAASA,YAAeoO,QACnF,GACCpO,KAAQ,GAASA,KAAQ,GAAe,QAAPA,GAAwB,OAAPA,GAAuB,SAAPA,GAAyB,MAAPA,EACpFA,KAAQ,GAAe,QAAPA,GAAwB,OAAPA,EAAgB,IAAM,IAExDA,EAAIgO,WAEVhO,EAAI7B,OAAS,GACb6B,EAAMrD,aAAawP,KAAKwI,YAAY/Q,UAAU0S,mBAAmBtW,EAAKkW,GAC/DlW,EAAIsO,OAAO,IAEftO,GAGXoY,OAAU,SAAUpY,EAAKkW,EAAeC,GAOpC,OANYzP,SAAR1G,GAA6B,OAARA,GAAwB,KAARA,GAAeA,EAAM,IAAO,OAASA,YAAeoO,WACzFpO,EAAM,IAEVA,GAAY,GAEZA,EAAMrD,aAAawP,KAAKwI,YAAY/Q,UAAU0S,mBAAmBtW,EAAKkW,IAI1EmC,OAAU,SAAUrY,EAAKkW,EAAeC,IACxBzP,SAAR1G,GAA6B,OAARA,GAAwB,KAARA,GAAeA,EAAM,IAAO,OAASA,YAAeoO,WACzFpO,EAAM,IAEVA,GAAY,GAEZA,EAAMrD,aAAawP,KAAKwI,YAAY/Q,UAAU0S,mBAAmBtW,EAAKkW,EACtE,KAII,IAHA,GAEIoC,GAAatY,EAAIsM,QAAQ,KACtBgM,EAAa,GAAG,CACnB,GAAIC,GAAMvY,EAAIsM,QAAQ,IAAKgM,IACjB,EAANC,GAAYA,EAAMD,EAAc,KAChCtY,EAAMA,EAAI8G,OAAO,EAAGwR,GAAc,QAAUtY,EAAI8G,OAAOwR,EAAa,EAAGtY,EAAI7B,QAAUma,EAAa,KAEtGA,EAAatY,EAAIsM,QAAQ,IAAKgM,EAAa,GAG/C,GAAI9L,GAAMW,EAASnN,EACnB,OAAOuM,GAAUC,GACnB,MAAOgM,GAEL,MADAjG,SAAQ3I,MAAM4O,GACPxY,IAIfyY,KAAQ,SAAUzY,EAAKkW,EAAeC,GAClC,MAAOxZ,cAAawP,KAAKwI,YAAY/Q,UAAUoS,MAAgB,SAAEhW,EAAKkW,EAAeC,IAGzFuC,SAAY,SAAU1Y,EAAKkW,EAAeC,GAoBtC,MAnBIA,GAC2C,mBAAvC1S,OAAOG,UAAUoK,SAAS/N,KAAKD,IAC/BA,EAAM,GAAI2Y,MAAKC,EAAU5Y,IACrBuX,MAAMvX,KAAMA,EAAM,KACwB,iBAAvCyD,OAAOG,UAAUoK,SAAS/N,KAAKD,KACtCA,EAAMA,GAGiC,mBAAvCyD,OAAOG,UAAUoK,SAAS/N,KAAKD,GAC/BA,GAAY,GACkC,iBAAvCyD,OAAOG,UAAUoK,SAAS/N,KAAKD,KAElCA,EADkB,gBAAlBA,EAAIgO,WACE,GAEAhO,EAAI6Y,eAItB7Y,EAAMrD,aAAawP,KAAKwI,YAAY/Q,UAAU0S,mBAAmBtW,EAAKkW,IAI1E4C,YAAe,SAAU9Y,EAAKkW,EAAeC,GACzC,MAAOxZ,cAAawP,KAAKwI,YAAY/Q,UAAUoS,MAAgB,SAAEhW,EAAKkW,EAAeC,IAGzF4C,KAAQ,SAAU/Y,EAAKkW,EAAeC,GAClC,MAAOxZ,cAAawP,KAAKwI,YAAY/Q,UAAUoS,MAAgB,SAAEhW,EAAKkW,EAAeC,IAGzF6C,QAAW,SAAUhZ,EAAKkW,EAAeC,GACrC,MAAOxZ,cAAawP,KAAKwI,YAAY/Q,UAAUoS,MAAgB,SAAEhW,EAAKkW,EAAeC,IAGzF8C,UAAW,SAAUjZ,EAAKkW,EAAeC,GAcrC,MAXQnW,GAFG,SAAPA,GAAyB,KAAPA,GAAqB,MAAPA,GAAsB,KAAPA,GAAcA,YAAeoO,SAAiB,GAAPpO,IAAaA,EAC/FmW,GACM,EAEA,IAGNA,GACM,EAEA,KAMlB+C,WAAc,SAAUlZ,EAAKkW,EAAeC,GAYxC,OAXYzP,SAAR1G,GAA6B,OAARA,GAAwB,KAARA,GAAeA,EAAM,IAAO,OAASA,YAAeoO,WACzFpO,EAAM,KAENA,KAAQ,GAAQA,KAAQ,KACxBA,EAAMA,KAAQ,EAAO,IAAM,KAG3BA,EADAmW,EACMgD,EAAKnZ,EAAM,IAEXoZ,EAAKpZ,EAAM,IAEdrD,aAAawP,KAAKwI,YAAY/Q,UAAU0S,mBAAmBtW,EAAKkW,IAG3EmD,QAAW,SAAUrZ,EAAKkW,EAAeC,GAYrC,OAXYzP,SAAR1G,GAA6B,OAARA,GAAwB,KAARA,GAAeA,EAAM,IAAO,OAASA,YAAeoO,WACzFpO,EAAM,KAENA,KAAQ,GAAQA,KAAQ,KACxBA,EAAMA,KAAQ,EAAO,IAAM,KAG3BA,EADAmW,EACMjI,EAAKlO,EAAM,IAEXwO,EAAKxO,EAAM,IAEdrD,aAAawP,KAAKwI,YAAY/Q,UAAU0S,mBAAmBtW,EAAKkW,IAG3E3P,IAAO,SAAUvG,EAAKkW,EAAeC,GAIjC,MAHIA,KACAnW,EAAMsZ,UAAUtZ,EAAM,KAEnBrD,aAAawP,KAAKwI,YAAY/Q,UAAUoS,MAAc,OAAEhW,EAAKkW,IAGxEqD,KAAQ,SAAUvZ,EAAKkW,EAAeC,GAClC,MAAOxZ,cAAawP,KAAKwI,YAAY/Q,UAAUoS,MAAc,OAAEhW,EAAKkW,IAM5E,KAAK,GAAIvU,KAAQhF,cAAawP,KAAKwI,YAAY/Q,UAAUoS,MACrDrZ,aAAawP,KAAKwI,YAAY/Q,UAAUoS,MAAMrU,GAAM6X,MAAQ7X,EAC5DhF,aAAawP,KAAKwI,YAAY/Q,UAAUoS,MAAMrU,GAAgB,SAAI,WAAc,MAAOzB,MAAKsZ,MAGhG7c,cAAawP,KAAKwI,YAAY/Q,UAAU6R,cAAgB,SAAUgE,EAAiBC,EAAgBC,GAE/FA,EAAazZ,KAAK0Z,iBAAiBD,GAEnCzZ,KAAK2Z,SAAS,0CAA4CH,EAAiB,sBAC3ExZ,KAAK2Z,SAASrO,KAAOA,KAAKC,UAAUkO,GAAc,KAGlD,IAAInE,GAAStV,KAAK6V,gBAAgB5H,QAAQ,mBAAoB2L,EAAU5M,EAAKuM,IAE7EjE,GAASA,EAAOrH,QAAQ,mBAAoB2L,EAAU5M,EAAKwM,IAE3D,IAAIK,GAAcJ,EAAoB,QAClCK,EAAkB,EAEtB,IAAID,EAGA,IAAK,GAAIE,KAAYF,GAAa,CAG9B,GAAsCrT,SAAlCqT,EAAYE,GAAgB,MAAqD,OAAlCF,EAAYE,GAAgB,KAAY,CAGvF,GAAIC,GAAYha,KAAK8V,MAAM+D,EAAYE,GAAgB,KAEnDC,KACAH,EAAYE,GAAiB,MAAIC,EAAUH,EAAYE,GAAiB,MAAGF,EAAYE,GAA4B,kBAAG,KAKvF,OAAnCF,EAAYE,GAAiB,OAAiDvT,SAAnCqT,EAAYE,GAAiB,SAExEF,EAAYE,GAAiB,MAAI,IAIrCD,GAAmB,OAAYC,EAAW,IAAMH,EAAU5M,EAAK6M,EAAYE,GAAiB,MAAI,KAAO,KAAOA,EAAW,MAYjI,MALAzE,GAASA,EAAOrH,QAAQ,mBAAoB6L,GAG5C9Z,KAAK2Z,SAAS,0BAA4BJ,EAAkB,IAAMC,EAAiB,KAAOlE,GAEnFA,GAIX7Y,aAAawP,KAAKwI,YAAY/Q,UAAU8R,YAAc,SAAU+D,EAAiBC,EAAgBS,EAAiBC,EAAgBC,GAE9H,GAAIC,GAAa,IAAOb,EAAgBtL,QAAQ,UAAW,IAAM,IAAMuL,EAAevL,QAAQ,UAAW,IAAM,IAC3GoM,EAAa,GAAIrU,SAAQsU,IAAIC,KAAKC,WAClCnU,EAAM,GAAIL,SAAQyU,WAAWC,IAAIT,GACjCU,EAAU,GAAI3U,SAAQsU,IAAIC,KAAKK,mBAAmB5U,QAAQsU,IAAIC,KAAKM,WAAWC,KAAMzU,EAqBxF,OApBAsU,GAAQI,QAAQ1R,OAAO,aAAc+Q,GAGrCO,EAAQhS,QAAU,GAAI3C,SAAQsU,IAAIC,KAAKS,kBAAkBd,EAAgBlU,QAAQ0M,QAAQC,QAAQG,gBAAgBmI,KAAM,YAEvHZ,EAAWa,iBAAiBP,GAAS3Q,KAAK,SAAUgF,GAClCA,EAAErG,QAAQwS,oBAAoBnR,KAAK,SAAUpH,GACvD,GAAI0J,GAAMW,EAASrK,GACfoM,GACAoM,OAAQ,IACRC,aAAczY,EACdoP,YAAa1F,EAEjB6N,GAAezE,MAAM1V,MAAO,KAAMgP,OAGvC,SAAU8B,GACTqJ,EAAezE,MAAMlP,QAAY,GAAI8U,GAAU,yBAA0B,SAGtEtb,MA0DXvD,aAAawP,KAAKwI,YAAY/Q,UAAUiS,eAAiB,SAAU6D,EAAgB+B,EAAiB9B,EAAY+B,GAE5G/B,EAAazZ,KAAK0Z,iBAAiBD,EAEnC,IAAIgC,GAAehC,EAAqB,SAEpCiC,KAGAC,EAAoBJ,EAAgBrQ,qBACdqQ,EAAgBrQ,qBAAqBsO,EAAiB,YAAc,IAQ9F,KAL0B,OAAtBmC,GAA8BA,EAAkB1d,QAAU,KAC1D0d,EAAoBJ,EAAgBrQ,qBACVqQ,EAAgBrQ,qBAAqB,KAAOsO,EAAiB,YAAc,MAG/E,OAAtBmC,GAA8BA,EAAkB1d,OAAS,EAAG,CAE5D,GAAI2d,GAAeD,EAAkB,GAAG3d,UAExC,IAAI4d,GAAgBA,EAAa3d,OAAS,EAEtC,IAAK,GAAIH,GAAI,EAAGC,EAAI6d,EAAa3d,OAAYF,EAAJD,EAAOA,IAAK,CAEjD,GAAI+d,GAAUD,EAAa9d,GAAGb,SAC1B6e,EAASF,EAAa9d,GAAGie,WAAa/O,EAAKgP,EAAUJ,EAAa9d,GAAGie,WAAWrP,UAAY,KAAO,IAGvG,IAAI+O,EAAaI,IAA8CrV,SAAlCiV,EAAaI,GAAe,MAAqD,OAAlCJ,EAAaI,GAAe,KAAY,CAGhH,GAAI7B,GAAYha,KAAK8V,MAAM2F,EAAaI,GAAe,KAEnD7B,KACA8B,EAAS9B,EAAU8B,EAAQL,EAAaI,GAA2B,kBAAK,MAAM,IAKtFH,EAAaG,GAAuBrV,SAAXsV,GAAmC,OAAXA,EAAmBA,EAAS,IAWzF,MAFAN,GAAe9F,MAAMlP,QAAY,MAAQjG,KAAMmb,KAExC1b,MAIXvD,aAAawP,KAAKwI,YAAY/Q,UAAUuY,gBAAkB,SAAUC,GAEhE,GAAIC,KA2BJ,OAzB0B3V,UAAtB0V,EAAgB,MAA0C1V,SAAvB0V,EAAiB,OAAqD1V,SAAlC0V,EAA4B,kBAEnGC,EAAQD,EAE8B1V,SAAlC0V,EAA4B,kBAA4D,eAAlCA,GAA4B,mBAClFA,EAA4B,sBAKhCC,GAAUC,MAAOF,GAKC1V,SAAlB2V,EAAY,MAAqC,OAAlBA,EAAY,OAEtCnc,KAAK8V,MAAOqG,EAAY,KAAI,WAEtBA,GAAY,MAMpBA,GAKX1f,aAAawP,KAAKwI,YAAY/Q,UAAUgW,iBAAmB,SAAUD,IAE9CjT,SAAfiT,GAA2C,OAAfA,KAC5BA,MAGCA,EAAoB,UACrBA,EAAoB,YAGnBA,EAAqB,WACtBA,EAAqB,YAGzB,KAAK,GAAI0C,KAAS1C,GAEd,GAAc,YAAV0C,GAAiC,aAAVA,EAEvB,IAAK,GAAIE,KAAgB5C,GAAW0C,GAEhC1C,EAAW0C,GAAOE,GAAgBrc,KAAKic,gBAAgBxC,EAAW0C,GAAOE,QAM7E5C,GAAoB,QAAE0C,GAASnc,KAAKic,gBAAgBxC,EAAW0C,UAExD1C,GAAW0C,EAM1B,OAAO1C,IAMXhd,aAAawP,KAAKwI,YAAY/Q,UAAU0S,mBAAqB,SAAUtW,EAAKwc,GAGxE,GAAIxc,GAAOwc,GAAwE,kBAApD/Y,OAAOG,UAAUoK,SAAS/N,KAAKuc,GAAuC,CAIjG,IAAK,GAFDC,IAAa,EAERze,EAAI,EAAGC,EAAIue,EAAiBre,OAAYF,EAAJD,EAAOA,IAEhD,GAAIgC,GAAOwc,EAAiBxe,GAAI,CAE5Bye,GAAa,CACb,OAKR,IAAKA,EACD,MAAO,GAIf,MAAOzc,IAMXrD,aAAawP,KAAKwI,YAAY/Q,UAAUiW,SAAW,SAAU6C,EAAK/U,GACzDzH,KAAKS,SAAWT,KAAKS,QAAQmU,OAC9BvC,QAAQ5K,GAAS,OAAO,cAAgB+U,GAMhD,IAAIlB,GAAY,SAAUmB,GACtB,OACIA,YAAeA,IAanBC,EAAW,mEAEXC,EAAS,SAAWC,GAEpB,IAAK,GADDC,MACK/e,EAAI,EAAGC,EAAI6e,EAAI3e,OAAYF,EAAJD,EAAOA,IAAK+e,EAAED,EAAIxO,OAAOtQ,IAAMA,CAC/D,OAAO+e,IACRH,GAECI,EAAY,SAAUC,GACtB,GAAIC,IAAU,EAAG,EAAG,GAAGD,EAAI9e,OAAS,GAChCgf,EAAMF,EAAIxO,WAAW,IAAM,IACnBwO,EAAI9e,OAAS,EAAI8e,EAAIxO,WAAW,GAAK,IAAM,GAC3CwO,EAAI9e,OAAS,EAAI8e,EAAIxO,WAAW,GAAK,GAC7C2O,GACIR,EAAStO,OAAO6O,IAAQ,IACxBP,EAAStO,OAAQ6O,IAAQ,GAAM,IAC/BD,GAAU,EAAI,IAAMN,EAAStO,OAAQ6O,IAAQ,EAAK,IAClDD,GAAU,EAAI,IAAMN,EAAStO,OAAa,GAAN6O,GAE5C,OAAOC,GAAM9e,KAAK,KAGlB+e,EAAY,SAAUC,GACtB,GAAIxP,GAAMwP,EAAKnf,OACX+e,EAASpP,EAAM,EACfP,GAAKO,EAAM,EAAI+O,EAAOS,EAAKhP,OAAO,KAAO,GAAK,IACzCR,EAAM,EAAI+O,EAAOS,EAAKhP,OAAO,KAAO,GAAK,IACzCR,EAAM,EAAI+O,EAAOS,EAAKhP,OAAO,KAAO,EAAI,IACxCR,EAAM,EAAI+O,EAAOS,EAAKhP,OAAO,IAAM,GACxC8O,GACIG,OAAOC,aAAajQ,IAAM,IAC1BgQ,OAAOC,aAAcjQ,IAAM,EAAK,KAChCgQ,OAAOC,aAAiB,IAAJjQ,GAG5B,OADA6P,GAAMjf,SAAW,EAAG,EAAG,EAAG,GAAG+e,GACtBE,EAAM9e,KAAK,KAGlB8a,EAAOtc,EAAOsc,MAAQ,SAAUqE,GAChC,MAAOA,GAAEtP,QAAQ,eAAgB6O,IAGjC7D,EAAOrc,EAAOqc,MAAQ,SAAUuE,GAChC,MAAOA,GAAEvP,QAAQ,eAAgBkP,IAKjCM,EAAW,mBAEXhQ,EAAS,SAAWmP,GAEpB,IAAK,GADDC,MACK/e,EAAI,EAAGC,EAAI6e,EAAI3e,OAAYF,EAAJD,EAAOA,IAAK+e,EAAE/e,GAAK8e,EAAIxO,OAAOtQ,EAC9D,OAAO+e,IACRY,GAkECzQ,EAAO,SAAUW,GACjB,MAAI0P,QAAO3Z,UAAUsJ,KACVW,EAAIX,OAEJW,EAAIM,QAAQ,aAAc,KAIrC2L,EAAY,SAAUjM,GACtB,MAAOA,GAAIM,QAAQ,MAAO,SACdA,QAAQ,KAAM,QACdA,QAAQ,KAAM,QACdA,QAAQ,KAAM,SACdA,QAAQ,KAAM,WAG1B+N,EAAY,SAAUrO,GACtB,MAAOA,GAAIM,QAAQ,WAAY,KACnBA,QAAQ,WAAY,KACpBA,QAAQ,SAAU,KAClBA,QAAQ,SAAU,KAClBA,QAAQ,UAAW,MAW/ByK,EAAY,SAAUH,GACtB,GAAImF,GAAWC,EAAQC,EAAgB,EAAGC,GAAe,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,GAI5E,IAFoB,gBAATtF,KAAmBA,GAAQ,IAEjCoF,EAAS,gIAAgIG,KAAKvF,GAAQ,CAEvJoF,EAASA,EAAOI,MAAM,EAAGJ,EAAO1f,OAGhC,KAAK,GAAW+f,GAAPlgB,EAAI,EAAOkgB,EAAIH,EAAY/f,KAAQA,EACxC6f,EAAOK,IAAML,EAAOK,IAAM,CAI9BL,GAAO,KAAOA,EAAO,IAAM,GAAK,EAChCA,EAAO,IAAMA,EAAO,IAAM,EAER,MAAdA,EAAO,IAA4BnX,SAAdmX,EAAO,KAC5BC,EAAkE,IAAhDD,EAAO,IAAM,IAASA,EAAO,IAAM,IAAO,GAAYA,EAAO,IAAM,IAEnE,MAAdA,EAAO,KACPC,EAAgB,EAAIA,IAI5BF,EAAYjF,KAAKwF,IAAIN,EAAO,GAAIA,EAAO,GAAIA,EAAO,GAAIA,EAAO,GAAIA,EAAO,GAAKC,EAAeD,EAAO,GAAIA,EAAO,QAG9GD,GAAYjF,KAAKyF,MAAQzF,KAAKyF,MAAM3F,GAAQ4F,EAAAA,CAGhD,OAAOT,IAGPU,GACAC,mDAAmD,EACnDC,mDAAmD,EACnDC,mDAAmD,EACnDC,mDAAmD,EAGvD/hB,cAAawP,KAAKqI,qBAAuB,SAAUI,EAAYC,GAS3D,MAPAlY,cAAawP,KAAKwI,YAAYiB,MAAM1V,MAAO0U,EAAYC,IAEvD3U,KAAKye,SAAW/J,EAAWd,YAKtBwK,EAA6Bpe,KAAKye,WAOvCze,KAAK0e,kBAAoB,SAAU3W,GAE/B,MAAO/H,MAAKuG,OAAO,qBACfoU,WACAtF,UACIsJ,IACIld,KAAMzB,KAAK8V,MAAMmB,OAG1BlP,IAIP/H,KAAK4e,sBAAwB,SAAU7W,GAEnC,MAAO/H,MAAKuG,OAAO,yBACfoU,WACAtF,UACIwJ,YACIpd,KAAMzB,KAAK8V,MAAMoC,UAG1BnQ,IAIP/H,KAAK8e,oBAAsB,SAAU/W,GAEjC,MAAO/H,MAAKuG,OAAO,uBACfoU,WACAtF,UACI0J,UACItd,KAAMzB,KAAK8V,MAAMoC,UAG1BnQ,IAIP/H,KAAKgf,OAAS,SAAUC,EAAUC,EAAY9O,EAAQ+O,EAAeC,EAAgBC,EAActX,GAE/F,MAAO/H,MAAKuG,OAAO,UACfoU,SACI2E,UACIlD,MAAO6C,GAAY,IACnBxd,KAAMzB,KAAK8V,MAAMoC,QAErBqH,YACInD,MAAO8C,GAAc,uBACrBzd,KAAMzB,KAAK8V,MAAMoC,QAErBsH,QACIpD,MAAOhM,GAAU,IACjB3O,KAAMzB,KAAK8V,MAAMoC,QAErBuH,eACIrD,MAAO+C,GAAiB,IACxB1d,KAAMzB,KAAK8V,MAAMmB,KAErByI,gBACItD,MAAOgD,GAAkB,IACzB3d,KAAMzB,KAAK8V,MAAMmB,KAErB0I,cACIvD,MAAOiD,EACP5d,KAAMzB,KAAK8V,MAAMoC,SAGzB7C,UACIuK,QACIne,KAAMzB,KAAK8V,MAAMqC,QAErB0H,gBACIpe,KAAMzB,KAAK8V,MAAMmB,KAErB6I,cACIre,KAAMzB,KAAK8V,MAAMmB,KAErB8I,UACIte,KAAMzB,KAAK8V,MAAMmB,OAG1BlP,IAIP/H,KAAKmM,OAAS,SAAU8S,EAAUC,EAAY9O,EAAQ+O,EAAeC,EAAgBC,EAActX,GAE/F,MAAO/H,MAAKuG,OAAO,UACfoU,SACI2E,UACIlD,MAAO6C,GAAY,IACnBxd,KAAMzB,KAAK8V,MAAMoC,QAErBqH,YACInD,MAAO8C,GAAc,uBACrBzd,KAAMzB,KAAK8V,MAAMoC,QAErBsH,QACIpD,MAAOhM,GAAU,IACjB3O,KAAMzB,KAAK8V,MAAMoC,QAErBuH,eACIrD,MAAO+C,GAAiB,IACxB1d,KAAMzB,KAAK8V,MAAMmB,KAErByI,gBACItD,MAAOgD,GAAkB,IACzB3d,KAAMzB,KAAK8V,MAAMmB,KAErB0I,cACIvD,MAAOiD,EACP5d,KAAMzB,KAAK8V,MAAMoC,SAGzB7C,UACIuK,QACIne,KAAMzB,KAAK8V,MAAMqC,QAErB0H,gBACIpe,KAAMzB,KAAK8V,MAAMmB,KAErB6I,cACIre,KAAMzB,KAAK8V,MAAMmB,KAErB8I,UACIte,KAAMzB,KAAK8V,MAAMmB,OAG1BlP,IAOe,oDAAlB/H,KAAKye,SASa,oDAAlBze,KAAKye,cAQa,oDAAlBze,KAAKye,eA/JLpM,SAAQ3I,MAAM,wDAmKtBjN,aAAawP,KAAKqI,qBAAqB5Q,UAAYH,OAAOC,OAAO/G,aAAawP,KAAKwI,YAAY/Q,UAE/F,IAAIsc,IACAC,oDAAoD,EACpDC,oDAAoD,EACpDC,oDAAoD,EAGxD1jB,cAAawP,KAAKuI,sBAAwB,SAAUE,EAAYC,GAS5D,MAPAlY,cAAawP,KAAKwI,YAAYiB,MAAM1V,MAAO0U,EAAYC,IAEvD3U,KAAKye,SAAW/J,EAAWd,YAKtBoM,EAA8BhgB,KAAKye,WAOxCze,KAAKogB,wBAA0B,SAAUrY,GAErC,MAAO/H,MAAKuG,OAAO,2BACfoU,WACAtF,UACIgL,eACI5e,KAAMzB,KAAK8V,MAAMoC,UAG1BnQ,IAIP/H,KAAKsgB,yBAA2B,SAAUC,EAAcxY,GAEpD,MAAO/H,MAAKuG,OAAO,4BACfoU,SACI6F,cACIpE,MAAOmE,EACP9e,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACIoL,OACIhf,KAAMzB,KAAK8V,MAAMU,IAErBkK,eACIjf,KAAMzB,KAAK8V,MAAMU,IAErBmK,cACIlf,KAAMzB,KAAK8V,MAAMoC,QAErB0I,uBACInf,KAAMzB,KAAK8V,MAAMoC,QAErB2I,kBACIpf,KAAMzB,KAAK8V,MAAMU,IAErBsK,WACIrf,KAAMzB,KAAK8V,MAAMoC,QAErB6I,QACItf,KAAMzB,KAAK8V,MAAMoC,UAG1BnQ,IAIP/H,KAAKghB,gBAAkB,SAAUjZ,GAE7B,MAAO/H,MAAKuG,OAAO,mBACfoU,WACAtF,UACI4L,QACIxf,KAAMzB,KAAK8V,MAAMoC,QAErBgJ,MACIzf,KAAMzB,KAAK8V,MAAMoC,UAG1BnQ,SAMe,qDAAlB/H,KAAKye,eAzELpM,SAAQ3I,MAAM,2CA+EtBjN,aAAawP,KAAKuI,sBAAsB9Q,UAAYH,OAAOC,OAAO/G,aAAawP,KAAKwI,YAAY/Q,UAEhG,IAAIyd,IACAC,8CAA8C,EAC9CC,8CAA8C,EAGlD5kB,cAAawP,KAAKmI,gBAAkB,SAAUM,EAAYC,GAStD,MAPAlY,cAAawP,KAAKwI,YAAYiB,MAAM1V,MAAO0U,EAAYC,IAEvD3U,KAAKye,SAAW/J,EAAWd,YAKtBuN,EAAwBnhB,KAAKye,WAOlCze,KAAKshB,sBAAwB,SAAUC,EAAYxZ,GAE/C,MAAO/H,MAAKuG,OAAO,yBACfoU,SACI6G,YACIpF,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACIoM,WACIhgB,KAAMzB,KAAK8V,MAAMoC,QAErBwJ,UACIjgB,KAAMzB,KAAK8V,MAAMoC,QAErByJ,iBACIlgB,KAAMzB,KAAK8V,MAAMoC,UAG1BnQ,IAIP/H,KAAK4hB,aAAe,SAAUL,EAAYxZ,GAEtC,MAAO/H,MAAKuG,OAAO,gBACfoU,SACI6G,YACIpF,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACIwM,UACIpgB,KAAMzB,KAAK8V,MAAMmB,KAErB6K,eACIrgB,KAAMzB,KAAK8V,MAAMoC,QAErB6J,YACItgB,KAAMzB,KAAK8V,MAAMoC,QAErB8J,oBACIvgB,KAAMzB,KAAK8V,MAAMoC,QAErB+J,SACIxgB,KAAMzB,KAAK8V,MAAMoC,QAErBgK,iBACIzgB,KAAMzB,KAAK8V,MAAMoC,QAErBiK,YACI1gB,KAAMzB,KAAK8V,MAAMoC,QAErBkK,cACI3gB,KAAMzB,KAAK8V,MAAMoC,QAErBmK,aACI5gB,KAAMzB,KAAK8V,MAAMoC,UAG1BnQ,IAIP/H,KAAKsiB,gBAAkB,SAAUf,EAAYxZ,GAEzC,MAAO/H,MAAKuG,OAAO,mBACfoU,SACI6G,YACIpF,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACIkN,OACI9gB,KAAMzB,KAAK8V,MAAMmB,KAErBuL,eACI/gB,KAAMzB,KAAK8V,MAAMoC,QAErBuK,eACIhhB,KAAMzB,KAAK8V,MAAMqC,QAErBuK,UACIjhB,KAAMzB,KAAK8V,MAAMoC,QAErByK,SACIlhB,KAAMzB,KAAK8V,MAAMoC,QAErB0K,SACInhB,KAAMzB,KAAK8V,MAAMoC,QAErB2K,UACIphB,KAAMzB,KAAK8V,MAAMU,IAErBsM,UACIrhB,KAAMzB,KAAK8V,MAAMU,MAG1BzO,IAIP/H,KAAK+iB,iBAAmB,SAAUxB,EAAYxZ,GAE1C,MAAO/H,MAAKuG,OAAO,oBACfoU,SACI6G,YACIpF,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACI2N,uBACIvhB,KAAMzB,KAAK8V,MAAMoC,QAErB+K,wBACIxhB,KAAMzB,KAAK8V,MAAMoC,QAErBgL,cACIzhB,KAAMzB,KAAK8V,MAAMoC,UAG1BnQ,IAIP/H,KAAKmjB,qBAAuB,SAAU5B,EAAYxZ,GAE9C,MAAO/H,MAAKuG,OAAO,wBACfoU,SACI6G,YACIpF,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACI+N,UACI3hB,KAAMzB,KAAK8V,MAAMmB,KAErBoM,gBACI5hB,KAAMzB,KAAK8V,MAAMoC,UAG1BnQ,IAIP/H,KAAKsjB,kBAAoB,SAAU/B,EAAYgC,EAAYC,EAAoBzb,GAE3E,MAAO/H,MAAKuG,OAAO,qBACfoU,SACI6G,YACIpF,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErB8K,YACI3F,MAAOmH,EACP9hB,KAAMzB,KAAK8V,MAAMoC,QAErB8J,oBACI5F,MAAOoH,EACP/hB,KAAMzB,KAAK8V,MAAMoC,SAGzB7C,aACDtN,IAIP/H,KAAKyjB,KAAO,SAAUlC,EAAYmC,EAAO3b,GAErC,MAAO/H,MAAKuG,OAAO,QACfoU,SACI6G,YACIpF,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErB0M,OACIvH,MAAOsH,GAAS,IAChBjiB,KAAMzB,KAAK8V,MAAMoC,SAGzB7C,aACDtN,IAIP/H,KAAK4jB,MAAQ,SAAUrC,EAAYxZ,GAE/B,MAAO/H,MAAKuG,OAAO,SACfoU,SACI6G,YACIpF,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,aACDtN,IAIP/H,KAAK6jB,KAAO,SAAUtC,EAAYxZ,GAE9B,MAAO/H,MAAKuG,OAAO,QACfoU,SACI6G,YACIpF,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,aACDtN,IAIP/H,KAAK8jB,KAAO,SAAUvC,EAAYxZ,GAE9B,MAAO/H,MAAKuG,OAAO,QACfoU,SACI6G,YACIpF,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,aACDtN,IAIP/H,KAAK+jB,SAAW,SAAUxC,EAAYxZ,GAElC,MAAO/H,MAAKuG,OAAO,YACfoU,SACI6G,YACIpF,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,aACDtN,IAIP/H,KAAKgkB,KAAO,SAAUzC,EAAY0C,EAAMC,EAAQnc,GAE5C,MAAO/H,MAAKuG,OAAO,QACfoU,SACI6G,YACIpF,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErBkN,MACI/H,MAAO6H,EACPxiB,KAAMzB,KAAK8V,MAAMoC,QAErBkM,QACIhI,MAAO8H,EACPziB,KAAMzB,KAAK8V,MAAMoC,SAGzB7C,aACDtN,SAMe,+CAAlB/H,KAAKye,eApRLpM,SAAQ3I,MAAM,0DA0RtBjN,aAAawP,KAAKmI,gBAAgB1Q,UAAYH,OAAOC,OAAO/G,aAAawP,KAAKwI,YAAY/Q,UAE1F,IAAI2gB,IACAC,mDAAmD,EACnDC,mDAAmD,EACnDC,mDAAmD,EAGvD/nB,cAAawP,KAAKwY,qBAAuB,SAAU/P,EAAYC,GAS3D,MAPAlY,cAAawP,KAAKwI,YAAYiB,MAAM1V,MAAO0U,EAAYC,IAEvD3U,KAAKye,SAAW/J,EAAWd,YAKtByQ,EAA6BrkB,KAAKye,WAOvCze,KAAK0kB,YAAc,SAAUnD,EAAYxZ,GAErC,MAAO/H,MAAKuG,OAAO,eACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACIuP,uBACInjB,KAAMzB,KAAK8V,MAAMoC,UAG1BnQ,IAIP/H,KAAK6kB,aAAe,SAAUtD,EAAYuD,EAAY/c,GAElD,MAAO/H,MAAKuG,OAAO,gBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErB8N,YACI3I,MAAO0I,GAAc,kBACrBrjB,KAAMzB,KAAK8V,MAAMoC,UAG1BnQ,IAIP/H,KAAKglB,cAAgB,SAAUzD,EAAYxZ,GAEvC,MAAO/H,MAAKuG,OAAO,iBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACI4P,mBACIxjB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAKklB,cAAgB,SAAU3D,EAAY4D,EAAmBpd,GAE1D,MAAO/H,MAAKuG,OAAO,iBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErBmO,mBACIhJ,MAAO+I,EACP1jB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAKqlB,YAAc,SAAU9D,EAAYxZ,GAErC,MAAO/H,MAAKuG,OAAO,eACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACIiQ,iBACI7jB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAKulB,YAAc,SAAUhE,EAAYiE,EAAiBzd,GAEtD,MAAO/H,MAAKuG,OAAO,eACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErBwO,iBACIrJ,MAAOoJ,EACP/jB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAK0lB,aAAe,SAAUnE,EAAYxZ,GAEtC,MAAO/H,MAAKuG,OAAO,gBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACIsQ,kBACIlkB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAK4lB,aAAe,SAAUrE,EAAYsE,EAAkB9d,GAExD,MAAO/H,MAAKuG,OAAO,gBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErB6O,kBACI1J,MAAOyJ,EACPpkB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAK+lB,gBAAkB,SAAUxE,EAAYxZ,GAEzC,MAAO/H,MAAKuG,OAAO,mBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACI2Q,qBACIvkB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAKimB,gBAAkB,SAAU1E,EAAY2E,EAAqBne,GAE9D,MAAO/H,MAAKuG,OAAO,mBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErBkP,qBACI/J,MAAO8J,EACPzkB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAKomB,kBAAoB,SAAU7E,EAAYxZ,GAE3C,MAAO/H,MAAKuG,OAAO,qBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACIgR,uBACI5kB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAKsmB,kBAAoB,SAAU/E,EAAYgF,EAAuBxe,GAElE,MAAO/H,MAAKuG,OAAO,qBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErBuP,uBACIpK,MAAOmK,EACP9kB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAKymB,iBAAmB,SAAUlF,EAAYxZ,GAE1C,MAAO/H,MAAKuG,OAAO,oBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACIqR,sBACIjlB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAK2mB,iBAAmB,SAAUpF,EAAYqF,EAAsB7e,GAEhE,MAAO/H,MAAKuG,OAAO,oBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErB4P,sBACIzK,MAAOwK,EACPnlB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAK8mB,sBAAwB,SAAUvF,EAAYxZ,GAE/C,MAAO/H,MAAKuG,OAAO,yBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACI0R,2BACItlB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAKgnB,sBAAwB,SAAUzF,EAAY0F,EAA2Blf,GAE1E,MAAO/H,MAAKuG,OAAO,yBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErBiQ,2BACI9K,MAAO6K,EACPxlB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAKmnB,wBAA0B,SAAU5F,EAAYxZ,GAEjD,MAAO/H,MAAKuG,OAAO,2BACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACI+R,6BACI3lB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAKqnB,wBAA0B,SAAU9F,EAAY+F,EAA6Bvf,GAE9E,MAAO/H,MAAKuG,OAAO,2BACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErBsQ,6BACInL,MAAOkL,EACP7lB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAKwnB,uBAAyB,SAAUjG,EAAYxZ,GAEhD,MAAO/H,MAAKuG,OAAO,0BACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACIoS,4BACIhmB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAK0nB,uBAAyB,SAAUnG,EAAYoG,EAA4B5f,GAE5E,MAAO/H,MAAKuG,OAAO,0BACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErB2Q,4BACIxL,MAAOuL,EACPlmB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAKwnB,uBAAyB,SAAUjG,EAAYxZ,GAEhD,MAAO/H,MAAKuG,OAAO,0BACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACIoS,4BACIhmB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAK6nB,oBAAsB,SAAUtG,EAAYxZ,GAE7C,MAAO/H,MAAKuG,OAAO,uBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACIyS,yBACIrmB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAK+nB,oBAAsB,SAAUxG,EAAYyG,EAAyBjgB,GAEtE,MAAO/H,MAAKuG,OAAO,uBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErBgR,yBACI7L,MAAO4L,EACPvmB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAKkoB,sBAAwB,SAAU3G,EAAYxZ,GAE/C,MAAO/H,MAAKuG,OAAO,yBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACI8S,2BACI1mB,KAAMzB,KAAK8V,MAAMO,MAG1BtO,IAIP/H,KAAKooB,sBAAwB,SAAU7G,EAAY8G,EAA2BtgB,GAE1E,MAAO/H,MAAKuG,OAAO,yBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErBqR,2BACIlM,MAAOiM,EACP5mB,KAAMzB,KAAK8V,MAAMO,MAG1BtO,IAIP/H,KAAKuoB,oBAAsB,SAAUhH,EAAYxZ,GAE7C,MAAO/H,MAAKuG,OAAO,uBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACImT,yBACI/mB,KAAMzB,KAAK8V,MAAMO,MAG1BtO,IAIP/H,KAAKyoB,oBAAsB,SAAUlH,EAAYmH,EAAyB3gB,GAEtE,MAAO/H,MAAKuG,OAAO,uBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErB0R,yBACIvM,MAAOsM,EACPjnB,KAAMzB,KAAK8V,MAAMO,MAG1BtO,IAIP/H,KAAK4oB,QAAU,SAAUrH,EAAYsH,EAAS9gB,GAE1C,MAAO/H,MAAKuG,OAAO,WACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErB6R,SACI1M,MAAOyM,GAAW,SAClBpnB,KAAMzB,KAAK8V,MAAMoC,SAGzB7C,UACI0T,aACItnB,KAAMzB,KAAK8V,MAAL9V,cAGf+H,IAIP/H,KAAKgpB,QAAU,SAAUzH,EAAYsH,EAASI,EAAalhB,GAEvD,MAAO/H,MAAKuG,OAAO,WACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErB6R,SACI1M,MAAOyM,GAAW,SAClBpnB,KAAMzB,KAAK8V,MAAMoC,QAErBgR,aACI9M,MAAO6M,EACPxnB,KAAMzB,KAAK8V,MAAL9V,cAGf+H,IAIP/H,KAAKmpB,UAAY,SAAU5H,EAAYsH,EAAS9gB,GAE5C,MAAO/H,MAAKuG,OAAO,aACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErB6R,SACI1M,MAAOyM,GAAW,SAClBpnB,KAAMzB,KAAK8V,MAAMoC,SAGzB7C,UACI+T,eACI3nB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAKqpB,UAAY,SAAU9H,EAAYsH,EAASS,EAAevhB,GAE3D,MAAO/H,MAAKuG,OAAO,aACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErB6R,SACI1M,MAAOyM,GAAW,SAClBpnB,KAAMzB,KAAK8V,MAAMoC,QAErBqR,eACInN,MAAOkN,EACP7nB,KAAMzB,KAAK8V,MAAMgB,OAG1B/O,IAIP/H,KAAKwpB,YAAc,SAAUjI,EAAYsH,EAAS9gB,GAE9C,MAAO/H,MAAKuG,OAAO,eACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErB6R,SACI1M,MAAOyM,GAAW,SAClBpnB,KAAMzB,KAAK8V,MAAMoC,SAGzB7C,UACI+T,eACI3nB,KAAMzB,KAAK8V,MAAMO,MAG1BtO,IAIP/H,KAAKypB,YAAc,SAAUlI,EAAYsH,EAASS,EAAevhB,GAE7D,MAAO/H,MAAKuG,OAAO,eACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErB6R,SACI1M,MAAOyM,GAAW,SAClBpnB,KAAMzB,KAAK8V,MAAMoC,QAErBqR,eACInN,MAAOkN,EACP7nB,KAAMzB,KAAK8V,MAAMO,MAG1BtO,IAIP/H,KAAK0pB,iBAAmB,SAAUnI,EAAYsH,EAAS9gB,GAEnD,MAAO/H,MAAKuG,OAAO,oBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErB6R,SACI1M,MAAOyM,GAAW,SAClBpnB,KAAMzB,KAAK8V,MAAMoC,SAGzB7C,UACIsU,UACIloB,KAAMzB,KAAK8V,MAAMO,IAErBuT,UACInoB,KAAMzB,KAAK8V,MAAMO,MAG1BtO,IAIP/H,KAAK6pB,YAAc,SAAUtI,EAAYsH,EAAS9gB,GAE9C,MAAO/H,MAAKuG,OAAO,eACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErB6R,SACI1M,MAAOyM,GAAW,SAClBpnB,KAAMzB,KAAK8V,MAAMoC,SAGzB7C,UACIyU,iBACIroB,KAAMzB,KAAK8V,MAAL9V,cAGf+H,IAIP/H,KAAK+pB,YAAc,SAAUxI,EAAYsH,EAASmB,EAAiBjiB,GAE/D,MAAO/H,MAAKuG,OAAO,eACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErB6R,SACI1M,MAAOyM,GAAW,SAClBpnB,KAAMzB,KAAK8V,MAAMoC,QAErB+R,iBACI7N,MAAO4N,EACPvoB,KAAMzB,KAAK8V,MAAL9V,cAGf+H,KAMe,oDAAlB/H,KAAKye,UACe,oDAAlBze,KAAKye,YAEPze,KAAKkqB,kBAAoB,SAAU3I,EAAY4I,EAAmBpiB,GAE9D,MAAO/H,MAAKuG,OAAO,qBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErBmT,mBACIhO,MAAO+N,EACP1oB,KAAMzB,KAAK8V,MAAMoC,SAGzB7C,UACIgV,yBACI5oB,KAAMzB,KAAK8V,MAAMoC,UAG1BnQ,IAIP/H,KAAKsqB,kBAAoB,SAAU/I,EAAYgJ,EAAqB3W,EAAa4W,EAAWC,EAAyB1iB,GAEjH,MAAO/H,MAAKuG,OAAO,qBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErByT,qBACItO,MAAOmO,EACP9oB,KAAMzB,KAAK8V,MAAMoC,QAErByS,aACIvO,MAAOxI,EACPnS,KAAMzB,KAAK8V,MAAMoC,QAErB0S,WACIxO,MAAOoO,EACP/oB,KAAMzB,KAAK8V,MAAMoC,QAErBmS,yBACIjO,MAAOqO,EACPhpB,KAAMzB,KAAK8V,MAAMoC,SAGzB7C,UACI+U,mBACI3oB,KAAMzB,KAAK8V,MAAMoC,UAG1BnQ,UAQW,oDAAlB/H,KAAKye,WAELze,KAAK6qB,qBAAuB,SAAUtJ,EAAYxZ,GAE9C,MAAO/H,MAAKuG,OAAO,wBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACIyV,iCACIrpB,KAAMzB,KAAK8V,MAAMoC,UAG1BnQ,IAIP/H,KAAK+qB,cAAgB,SAAUxJ,EAAYxZ,GAEvC,MAAO/H,MAAKuG,OAAO,iBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,MAGzB5B,UACI2V,wBACIvpB,KAAMzB,KAAK8V,MAAMoC,UAG1BnQ,IAIP/H,KAAKirB,cAAgB,SAAU1J,EAAY2J,EAAwBnjB,GAE/D,MAAO/H,MAAKuG,OAAO,iBACfoU,SACIgK,YACIvI,MAAOmF,EACP9f,KAAMzB,KAAK8V,MAAMmB,KAErBkU,wBACI/O,MAAO8O,EACPzpB,KAAMzB,KAAK8V,MAAMoC,UAG1BnQ,IAIP/H,KAAKorB,0BAA4B,SAAU7J,EAAYxZ,GAEnD,MAAO/H,MAAKuG,OAAO,6BACf8O,UACIgW;AACI5pB,KAAMzB,KAAK8V,MAAMoC,UAG1BnQ,IAIP/H,KAAKsrB,4BAA8B,SAAU/J,EAAYxZ,GAErD,MAAO/H,MAAKuG,OAAO,+BACf8O,UACIkW,iCACI9pB,KAAMzB,KAAK8V,MAAMoC,UAG1BnQ,IAIP/H,KAAKwrB,qBAAuB,SAAUjK,EAAYxZ,GAE9C,MAAO/H,MAAKuG,OAAO,wBACf8O,UACIoW,iCACIhqB,KAAMzB,KAAK8V,MAAMoC,UAG1BnQ,IAIP/H,KAAK0rB,qBAAuB,SAAUnK,EAAYoK,EAAiC5jB,GAE/E,MAAO/H,MAAKuG,OAAO,wBACfoU,SACIiR,iCACIxP,MAAOuP,EACPlqB,KAAMzB,KAAK8V,MAAMoC,UAG1BnQ,WAz0BPsK,SAAQ3I,MAAM,0DAg1BtBjN,aAAawP,KAAKwY,qBAAqB/gB,UAAYH,OAAOC,OAAO/G,aAAawP,KAAKwI,YAAY/Q,YAEhGlB;ACjiFH,GAAI/F,eACJ,SAAWA,GACP,cAMA,SAAWovB,GA+KP,QAASC,GAAQC,EAAMxb,GACgB,OAA/Bwb,EAAK9uB,SAAS4U,cACdka,EAAKC,IAAMzb,EAGXwb,EAAKE,MAAMC,gBAAkB,QAAU3b,EAAM,KAEjDwb,EAAKI,UAAUC,IAAI,eAjLvB3vB,EAAaovB,SAASQ,mBAAqB,0BAO3C5vB,EAAaovB,SAASS,iBAAmB,SAA0BhqB,EAAKiqB,GACpE,GAAIhsB,EACJ,IAAIrC,MAAMxB,GAAG8vB,eAAgB,CACzB,GAAI5pB,GAAON,EAAIlF,aAAa,qBACxBwF,KACArC,EAAOrC,MAAMxB,GAAG6F,cAAcK,EAAMJ,aAGxCjC,GAAO+B,EAAI5B,QAAQ+rB,WAGvB,OAAIlsB,GACIgsB,EACOhsB,EAAKgsB,GAELhsB,EAJf,OAQJ,IAAI+rB,GAAmB7vB,EAAaovB,SAASS,gBAU7C7vB,GAAaovB,SAASa,WAAaxuB,MAAM+F,QAAQ0oB,YAAY,SAAUC,EAAQC,EAAgBd,EAAMe,GACjG,GAAIvsB,GAAO9D,EAAayC,MAAM6tB,aAAaH,EAAQC,GAC/CvqB,EAAMS,SAAStF,cAAc,MACjC6E,GAAI0qB,UAAYzsB,EAChBrC,MAAM+F,QAAQgpB,SAAU7Q,MAAO9Z,EAAI4qB,YAAc,SAAUnB,GAAOe,MAWtErwB,EAAaovB,SAASsB,yBAA2BjvB,MAAM+F,QAAQ0oB,YAAY,SAAUC,EAAQC,EAAgBd,EAAMe,GAC/G,GAAIvsB,GAAO9D,EAAayC,MAAM6tB,aAAaH,EAAQC,GAC/CvqB,EAAMS,SAAStF,cAAc,MACjC6E,GAAI0qB,UAAYzsB,CAChB,IAAI6sB,GAAU9qB,EAAI4qB,UACdG,EAAOf,EAAiBP,EAAM,cAE9BsB,KACAD,EAAUE,aAAa7wB,EAAayC,MAAMquB,kBAAkBjrB,EAAI4qB,UAAWG,GAAM,KACrFnvB,MAAM+F,QAAQgpB,SAAU7Q,MAAOgR,IAAY,SAAUrB,GAAOe,MAWhErwB,EAAaovB,SAAS2B,WAAatvB,MAAM+F,QAAQ0oB,YAAY,SAAUC,EAAQC,EAAgBd,EAAMe,GACjG,GAAIvsB,GAAO9D,EAAayC,MAAM6tB,aAAaH,EAAQC,EACnDd,GAAKe,GAAgBQ,aAAa/sB,KAgBtC9D,EAAaovB,SAAS4B,SAAWvvB,MAAM+F,QAAQ0oB,YAAY,SAAyBC,EAAQC,EAAgBd,EAAMe,GACjH,GAAIvsB,GAAO9D,EAAayC,MAAM6tB,aAAaH,EAAQC,EACnDd,GAAKnsB,aAAa,QAAUktB,EAAcvsB,KAW3C9D,EAAaovB,SAAS6B,SAAWxvB,MAAM+F,QAAQ0oB,YAAY,SAAyBC,EAAQC,EAAgBd,EAAMe,GAC9G,QAASa,GAASC,EAAQC,GACtB,GAAIttB,GAAO9D,EAAayC,MAAM6tB,aAAaH,EAAQC,GAC/C5Q,EAAkBqQ,EAAiBP,EAAM,SACzC9P,IACA8P,EAAKI,UAAU2B,OAAO7R,EAAgB8R,OAAOF,IAC7C9B,EAAKI,UAAUC,IAAInQ,EAAgB8R,OAAOxtB,MAG1CwrB,EAAKI,UAAU2B,OAAOD,GACtB9B,EAAKI,UAAUC,IAAI7rB,IAI3B,GAAIytB,KAEJ,OADAA,GAAYnB,GAAkBc,EACvBzvB,MAAM+F,QAAQgqB,KAAKrB,EAAQoB,KAWtCvxB,EAAaovB,SAASqC,QAAUhwB,MAAM+F,QAAQ0oB,YAAY,SAAwBC,EAAQC,EAAgBd,EAAMe,GAC5G,QAASa,GAASC,EAAQC,GACtB,GAAIttB,GAAO9D,EAAayC,MAAM6tB,aAAaH,EAAQC,EACnDd,GAAKI,UAAU2B,OAAOhB,EAAe,IAAMe,GAC3C9B,EAAKI,UAAUC,IAAIU,EAAe,IAAMvsB,GAE5C,GAAIytB,KAEJ,OADAA,GAAYnB,GAAkBc,EACvBzvB,MAAM+F,QAAQgqB,KAAKrB,EAAQoB,KAWtCvxB,EAAaovB,SAASsC,UAAYjwB,MAAM+F,QAAQ0oB,YAAY,SAA0BC,EAAQC,EAAgBd,EAAMe,GAChH,QAASsB,KACL,GAAI7tB,GAAO9D,EAAayC,MAAM6tB,aAAaH,EAAQC,EACnD,OAAKtsB,IAASA,EAAKtC,YAInB8tB,EAAKE,MAAMC,gBAAkB,QAAU3rB,EAAO,WAH1CwrB,EAAKE,MAAMC,gBAAkB,IAMrC,GAAI8B,KAGJ,OADAA,GAAYnB,GAAkBuB,EACvBlwB,MAAM+F,QAAQgqB,KAAKrB,EAAQoB,KAItCvxB,EAAaovB,SAASwC,WAAanwB,MAAM+F,QAAQ0oB,YAAY,SAA2BC,EAAQC,EAAgBd,EAAMe,GAClH,GAAIvU,GAAO,GAAIE,MAAmB,IAAdmU,EAAOrU,KAC3BwT,GAAKiB,UAAYzU,EAAK+V,uBAsB1B7xB,EAAaovB,SAASnhB,QAAUxM,MAAM+F,QAAQ0oB,YAAY,SAA+BC,EAAQC,EAAgBd,EAAMe,GACnH,QAASsB,KACL,GAAI7tB,GAAO9D,EAAayC,MAAM6tB,aAAaH,EAAQC,EAC9CtsB,IAASA,EAAKtC,SACfsC,EAAOsrB,EAASQ,oBAGpBN,EAAKI,UAAU2B,OAAO,eACtBS,WAAW,WACP9xB,EAAaC,GAAG8xB,UAAUjuB,GAAMkuB,KAAK,WACjC3C,EAAQC,EAAMxrB,IACf,WACCurB,EAAQC,EAAMF,EAASQ,oBACvBnuB,MAAMwE,UAAUgrB,SAAS3B,EAAM,kBAEpC,KAGP,GAAIiC,KAGJ,OADAA,GAAYnB,GAAkBuB,EACvBlwB,MAAM+F,QAAQgqB,KAAKrB,EAAQoB,KAEtCvxB,EAAaovB,SAAS6C,eAAiBjyB,EAAaovB,SAASnhB,QAU7DjO,EAAaovB,SAAS8C,OAASzwB,MAAM+F,QAAQ0oB,YAAY,SAAuBC,EAAQC,EAAgBd,EAAMe,GAC1G,QAAS8B,KACL,GAAIruB,GAAO9D,EAAayC,MAAM6tB,aAAaH,EAAQC,EAC9CtsB,IAWDwrB,EAAKI,UAAU2B,OAAO,YACtB/B,EAAKI,UAAUC,IAAI,YACK,YAApBU,EAAa,IAAwC,YAApBA,EAAa,GAC9Cf,EAAKE,MAAM4C,QAAU,GACM,eAApB/B,EAAa,IAA2C,eAApBA,EAAa,GACxDf,EAAKE,MAAM6C,WAAa,GAExB/C,EAAKE,MAAM8C,QAAU,KAjBzBhD,EAAKI,UAAU2B,OAAO,YACtB/B,EAAKI,UAAUC,IAAI,YACK,YAApBU,EAAa,IAAwC,YAApBA,EAAa,GAC9Cf,EAAKE,MAAM4C,QAAU,IACM,eAApB/B,EAAa,IAA2C,eAApBA,EAAa,GACxDf,EAAKE,MAAM6C,WAAa,SAExB/C,EAAKE,MAAM8C,QAAU,QAcjC,GAAIf,KAGJ,OADAA,GAAYnB,GAAkB+B,EACvB1wB,MAAM+F,QAAQgqB,KAAKrB,EAAQoB,KAYtCvxB,EAAaovB,SAASmD,UAAYvyB,EAAaovB,SAAS8C,OACxDlyB,EAAaovB,SAASoD,iBAAmBxyB,EAAaovB,SAAS8C,OAU/DlyB,EAAaovB,SAASqD,OAAShxB,MAAM+F,QAAQ0oB,YAAY,SAAuBC,EAAQC,EAAgBd,EAAMe,GAC1G,QAAS8B,KACL,GAAIruB,GAAO9D,EAAayC,MAAM6tB,aAAaH,EAAQC,EAC9CtsB,IAWDwrB,EAAKI,UAAU2B,OAAO,YACtB/B,EAAKI,UAAUC,IAAI,YACK,YAApBU,EAAa,IAAwC,YAApBA,EAAa,GAC9Cf,EAAKE,MAAM4C,QAAU,IACM,eAApB/B,EAAa,IAA2C,eAApBA,EAAa,GACxDf,EAAKE,MAAM6C,WAAa,SAExB/C,EAAKE,MAAM8C,QAAU,SAjBzBhD,EAAKI,UAAU2B,OAAO,YACtB/B,EAAKI,UAAUC,IAAI,YACK,YAApBU,EAAa,IAAwC,YAApBA,EAAa,GAC9Cf,EAAKE,MAAM4C,QAAU,GACM,eAApB/B,EAAa,IAA2C,eAApBA,EAAa,GACxDf,EAAKE,MAAM6C,WAAa,GAExB/C,EAAKE,MAAM8C,QAAU,IAcjC,GAAIf,KAGJ,OADAA,GAAYnB,GAAkB+B,EACvB1wB,MAAM+F,QAAQgqB,KAAKrB,EAAQoB,KAYtCvxB,EAAaovB,SAASsD,UAAY1yB,EAAaovB,SAASqD,OAExDzyB,EAAaovB,SAASuD,iBAAmB3yB,EAAaovB,SAASqD,OAU/DzyB,EAAaovB,SAASwD,SAAWnxB,MAAM+F,QAAQ0oB,YAAY,SAA0BC,EAAQC,EAAgBd,EAAMe,GAC/G,QAAS8B,KACL,GAAIruB,GAAO9D,EAAayC,MAAM6tB,aAAaH,EAAQC,EAI/Cd,GAAKuD,SAHJ/uB,GAGe,GAFA,EAKxB,GAAIytB,KAGJ,OADAA,GAAYnB,GAAkB+B,EACvB1wB,MAAM+F,QAAQgqB,KAAKrB,EAAQoB,KAEtCvxB,EAAaovB,SAAS0D,aAAe9yB,EAAaovB,SAASwD,SAU3D5yB,EAAaovB,SAAS2D,UAAYtxB,MAAM+F,QAAQ0oB,YAAY,SAAyBC,EAAQC,EAAgBd,EAAMe,GAC/G,QAAS8B,KACL,GAAIruB,GAAO9D,EAAayC,MAAM6tB,aAAaH,EAAQC,EAI/Cd,GAAKuD,SAHJ/uB,GAGe,GAFA,EAKxB,GAAIytB,KAGJ,OADAA,GAAYnB,GAAkB+B,EACvB1wB,MAAM+F,QAAQgqB,KAAKrB,EAAQoB,KAEtCvxB,EAAaovB,SAAS4D,YAAchzB,EAAaovB,SAAS2D,UAU1D/yB,EAAaovB,SAAS6D,QAAUxxB,MAAM+F,QAAQ0oB,YAAY,SAAyBC,EAAQC,EAAgBd,EAAMe,GAC7G,QAAS6C,KACL,GAAIpvB,GAAO9D,EAAayC,MAAM6tB,aAAaH,EAAQC,EAI/Cd,GAAKE,MAAM2D,MAHVrvB,EAGkBA,EAAO,IAFP,GAK3B,GAAIytB,KAGJ,OADAA,GAAYnB,GAAkB8C,EACvBzxB,MAAM+F,QAAQgqB,KAAKrB,EAAQoB,KAatCvxB,EAAaovB,SAASgE,YAAc3xB,MAAM+F,QAAQ0oB,YAAY,SAA+BC,EAAQC,EAAgBd,EAAMe,GACvH,GAAIgD,GAAarzB,EAAayC,MAAM6tB,aAAaH,EAAQC,GACrDQ,EAAOf,EAAiBP,EAAM,cAClCA,GAAKe,GAAgBQ,aAAa7wB,EAAayC,MAAMquB,kBAAkBuC,EAAYzC,GAAM,MAE7F5wB,EAAaovB,SAASkE,eAAiBtzB,EAAaovB,SAASgE,YAE7DpzB,EAAaovB,SAASmE,YAAc9xB,MAAM+F,QAAQ0oB,YAAY,SAAqBC,EAAQC,EAAgBd,EAAMe,GAC7G,GAAIvsB,GAAO9D,EAAayC,MAAM6tB,aAAaH,EAAQC,EAE/Cd,GAAKe,GADW,mBAATvsB,IAAiC,OAATA,EACV,GAEAA,IAa7B9D,EAAaovB,SAASoE,eAAiB/xB,MAAM+F,QAAQ0oB,YAAY,SAA+BC,EAAQC,EAAgBd,EAAMe,GAC1H,QAASoD,KACL,GAAI3vB,GAAO9D,EAAayC,MAAM6tB,aAAaH,EAAQC,EACnDpwB,GAAayC,MAAM2C,cAAckqB,EAAMe,EAAcvsB,GAAQ,IAGjE,QAAS4vB,KACL,GAAIrwB,GAAMrD,EAAayC,MAAMkxB,YAAYrE,EAAMe,EAC/CrwB,GAAayC,MAAM2C,cAAc+qB,EAAQC,EAAgB/sB,EAAIuwB,WAGjEtE,EAAK7jB,iBAAiB,SAAUioB,GAAQ,GACnCpE,EAAKpuB,aACNouB,EAAKI,UAAUC,IAAI,kBACnBL,EAAKpuB,YACD2yB,QAAS,WACLvE,EAAK5jB,oBAAoB,SAAUgoB,KAK/C,IAAInC,KAIJ,OADAA,GAAYnB,GAAkBqD,EACvBhyB,MAAM+F,QAAQgqB,KAAKrB,EAAQoB,KAStCnC,EAAS0E,mBAAqB,SAAUC,GACpC,GAAIljB,KAOJ,OALAkjB,GAAY9xB,QAAQ,SAAU0C,GAC1B,GAAIqvB,GAAgBvyB,MAAM+F,QAAQysB,OAAOtvB,EACzCkM,GAAO9P,KAAKizB,KAGTnjB,IAIZ7Q,EAAaovB,WAAapvB,EAAaovB,aAC3BpvB,GAAaovB,UAC7BpvB,eAAiBA;ACjepB,GAAIA,aACJA,cAAayC,MAAQzC,aAAayC,UAClCzC,aAAaovB,SAAWpvB,aAAaovB,aAErC,WACI,YAmDA,SAAS8E,GAAUC,EAAGlgB,EAAGmgB,GACrB,GAAS,IAALngB,GAAgB,IAALkgB,GAAgB,IAALC,KAKtBxZ,MAAMuZ,IAAMvZ,MAAMwZ,IAAMxZ,MAAM3G,IAAlC,CAKA,GAAIogB,GAAS,GAAIrY,MACbsY,EAAW,GAAItY,MAAKoY,EAAGD,EAAI,EAAGlgB,GAE9BsgB,EAAgB,MAChBC,EAAOriB,KAAKsiB,OAAOJ,EAAOK,UAAYJ,EAASI,WAAaH,EAChE,OAAOC,IAzDXx0B,aAAaovB,SAASuF,WAAalzB,MAAMwE,UAAUC,2BAA2B,SAA2BiqB,EAAQC,EAAgBd,EAAMe,GACnI,QAASuE,KACL,GAAIvB,GAAarzB,aAAayC,MAAM6tB,aAAaH,EAAQC,EACzD,IAAKiD,EAEE,CACH,GAAIhpB,GAAMrK,aAAaovB,SAASS,iBAAiBP,EAAM,eAAiB,GACxEA,GAAKmB,UAAYoE,OAAOxB,GAAY/B,OAAOjnB,OAH3CilB,GAAKmB,UAAY,GAOzB,GAAIc,KAGJ,OADAA,GAAYnB,GAAkBwE,EACvBnzB,MAAM+F,QAAQgqB,KAAKrB,EAAQoB,KAWtCvxB,aAAaovB,SAAS0F,SAAWrzB,MAAMwE,UAAUC,2BAA2B,SAA2BiqB,EAAQC,EAAgBd,EAAMe,GACjI,QAASuE,KACL,GAAIvB,GAAarzB,aAAayC,MAAM6tB,aAAaH,EAAQC,EAIrDd,GAAKmB,UAHJ4C,EAGgBwB,OAAOxB,GAAYyB,WAFnB,GAMzB,GAAIvD,KAGJ,OADAA,GAAYnB,GAAkBwE,EACvBnzB,MAAM+F,QAAQgqB,KAAKrB,EAAQoB,KA+BtCvxB,aAAaovB,SAAS2F,cAAgBtzB,MAAMwE,UAAUC,2BAA2B,SAA8BiqB,EAAQC,EAAgBd,EAAMe,GACzI,QAASuE,KACL,GAAIvB,GAAarzB,aAAayC,MAAM6tB,aAAaH,EAAQC,EACzD,IAAKiD,EAEE,CACHA,EAAa,GAAIrX,MAAKqX,EACtB,IAAIc,GAAId,EAAW2B,WAAa,EAAG/gB,EAAIof,EAAW4B,UAAWb,EAAIf,EAAW6B,cACxEC,EAAWjB,EAAUC,EAAGlgB,EAAGmgB,EAC/B9E,GAAKmB,UAAY0E,MALjB7F,GAAKmB,UAAY,GASzB,GAAIc,KAGJ,OADAA,GAAYnB,GAAkBwE,EACvBnzB,MAAM+F,QAAQgqB,KAAKrB,EAAQoB,KAWtCvxB,aAAaovB,SAASgG,aAAe3zB,MAAMwE,UAAUC,2BAA2B,SAAsBiqB,EAAQC,EAAgBd,EAAMe,GAChI,QAASuE,KACL,GAAIvB,GAAarzB,aAAayC,MAAM6tB,aAAaH,EAAQC,EACzD,IAAKiD,EAEE,CACH,GAAIhpB,GAAMrK,aAAaovB,SAASS,iBAAiBP,EAAM,kBACnD+F,EAAYr1B,aAAaovB,SAASS,iBAAiBP,EAAM,YAC7DA,GAAKmB,UAAYoE,OAAOS,SAASjC,EAAYhpB,GAAKkrB,SAASF,OAJ3D/F,GAAKmB,UAAY,GAQzB,GAAIc,KAGJ,OADAA,GAAYnB,GAAkBwE,EACvBnzB,MAAM+F,QAAQgqB,KAAKrB,EAAQoB;ACjI1C,GAAIvxB,eACJ,SAAWA,GACP,GAAIw1B,IACJ,SAAWA,GA8BP,QAASC,GAAUC,EAAQC,EAAUC,EAAyBC,GAC1D,MAAO,IAAIp0B,OAAMC,QAAQ,SAAUsL,EAAUC,GACzCyoB,EAAOI,gBAAgBH,EAAUC,GAAyB5D,KAAK,SAAU+D,GACrExsB,QAAQ0M,QAAQ+f,OAAOC,eAAeF,EAASlnB,KAAKC,UAAU+mB,IAAc7D,KAAK,WACzEvwB,OAASA,MAAMy0B,KACfz0B,MAAMy0B,IAAI,gBAAkBH,EAAQI,MACxCnpB,KACDC,IACJA,KAIX,QAASmpB,GAASV,EAAQC,GACtB,MAAO,IAAIl0B,OAAMC,QAAQ,SAAUsL,EAAUC,GACzCyoB,EAAOI,gBAAgBH,EAAUpsB,QAAQ0M,QAAQ2f,wBAAwBS,cAAc9oB,KAAK,SAAU+oB,GAClG/sB,QAAQ0M,QAAQ+f,OAAOO,cAAcD,GAAMtE,KAAK,SAAU7rB,GAClDA,EACA6G,EAAS6B,KAAK4S,MAAMtb,IAEpB6G,KACLC,IACJA,KAtBXuoB,EAAOgB,WAAa,uDAYpBhB,EAAOC,UAAYA,EAanBD,EAAOY,SAAWA,GACnBZ,EAASx1B,EAAaw1B,SAAWx1B,EAAaw1B,aAClDx1B,eAAiBA,iBAEpB,IAAIA,eACJ,SAAWA,GACP,GAAIw1B,IACJ,SAAWA,GACP,GAAIiB,GAAQ,WAUR,QAASA,GAAMrzB,EAAMb,GACjBgB,KAAK4R,SACL5R,KAAKmzB,WAAY,CACjB,IAAIpqB,GAAQ/I,IACZ+I,GAAMlJ,KAAOA,GAAQ,eACrBkJ,EAAM/J,WAAaA,MACnB+J,EAAM6I,SACN7I,EAAMoqB,WAAY,EAClBpqB,EAAMqqB,WAAa5sB,OACnBuC,EAAMsqB,UAAY52B,EAAaw1B,OAAOqB,SAASC,UAAUC,OACzDzqB,EAAM0qB,SAAW,GAAIh3B,GAAaw1B,OAAOqB,SAASI,SAAS10B,GAE3D+J,EAAM4qB,cAAgB3tB,QAAQ0M,QAAQkhB,gBAAgBC,QAAQC,YAAYC,kBAAkB,uBAAwB/tB,QAAQ0M,QAAQ2f,wBAAwBS,cAAc9oB,KAAK,SAAUmoB,GACrL,MAAOA,IACR,SAAUrhB,GAGT,MAFI5S,QAASA,MAAMy0B,KACfz0B,MAAMy0B,IAAI,qBAAuB7hB,EAAI5G,SAClC,OAmRf,MA3QAgpB,GAAMxvB,UAAU8N,MAAQ,WACpB,MAAOtT,OAAMC,QAAQkB,KAAKW,KAAK4R,MAAM3T,SAOzCi1B,EAAMxvB,UAAUswB,MAAQ,WAEpB,MADAh0B,MAAK4R,SACE1T,MAAMC,QAAQkB,QAMzB6zB,EAAMxvB,UAAU4sB,QAAU,WACtBtwB,KAAK4R,SACL5R,KAAKhB,WAAawH,OAClBxG,KAAKqzB,UAAY7sB,OACjBxG,KAAKyzB,SAASO,QACdh0B,KAAKyzB,SAAWjtB,OAChBxG,KAAKozB,WAAa5sB,OAClBxG,KAAK2zB,cAAgBntB,QAMzB0sB,EAAMxvB,UAANwvB,UAAyB,WACrB,OAASl0B,WAAYgB,KAAKhB,WAAY4S,MAAO5R,KAAK4R,QAMtDshB,EAAMxvB,UAAUoK,SAAW,WACvB,MAAOxC,MAAKC,UAAUvL,KAAAA,cAM1BkzB,EAAMxvB,UAAUuwB,SAAW,SAAUC,GACjC,GAAItnB,GAAMsnB,CACQ,iBAAPtnB,KACPA,EAAMtB,KAAK4S,MAAMgW,IACjBtnB,IACIA,EAAI5N,YAAc4N,EAAI5N,WAAWm1B,QAAUvnB,EAAIgF,OAAShF,EAAIgF,MAAM3T,SAClE+B,KAAKhB,WAAa4N,EAAI5N,WACtBgB,KAAKyzB,SAASW,OAAOp0B,KAAKhB,aAE9BgB,KAAK4R,MAAQhF,EAAIgF,YAQzBshB,EAAMxvB,UAAU2wB,KAAO,WACnB,GAAIhc,GAAMrY,KACNs0B,EAAMjc,EAAAA,WACV,OAAOA,GAAIsb,cAAc3pB,KAAK,SAAUmoB,GACpC,MAAOF,GAAOC,UAAUC,EAAQ9Z,EAAIxY,KAAMmG,QAAQ0M,QAAQ2f,wBAAwBkC,gBAAiBD,GAAKtqB,KAAK,SAAUwqB,GACnH,OAASzrB,MAAOsP,QAS5B6a,EAAMxvB,UAAU+wB,KAAO,WACnB,GAAIpc,GAAMrY,IACV,OAAOqY,GAAIsb,cAAc3pB,KAAK,SAAUmoB,GACpC,MAAOF,GAAOY,SAASV,EAAQ9Z,EAAIxY,MAAMmK,KAAK,SAAU0qB,GACpDrc,EAAI4b,SAASS,QAIzBxB,EAAMxvB,UAAUixB,WAAa,SAAUC,EAAWn0B,GAM9C,IAAK,GALDsI,GAAQ/I,KACR60B,EAAiB9rB,EAAM+rB,YAAYF,GACnCG,KACA1H,EAAOtkB,EAAM6I,MAAM3T,OACnB+2B,EAAe,GACVl3B,EAAI,EAAOuvB,EAAJvvB,EAAUA,IAAK,CAC3B,GAAIm3B,GAAalsB,EAAMmsB,YAAYL,EAAgB9rB,EAAM6I,MAAM9T,GAC3Dm3B,IACAF,EAAav3B,KAAKy3B,EACtB,IAAI71B,GAAK,IAAMtB,EAAIuvB,GAAS,CACxBtkB,GAAMqqB,YAAch0B,GAAK41B,GACzBjsB,EAAMqqB,YAAa+B,gBAAiB/1B,EAAGwS,MAAOyb,EAAMwG,QAAS/1B,IACjEk3B,EAAe51B,EAQnB,MANA21B,GAAeA,EAAaK,KAAK,SAAU5X,EAAGD,GAC1C,MAAOA,GAAE8X,KAAO7X,EAAE6X,OAElB50B,GAAWA,EAAQ60B,QACnBP,EAAeA,EAAahX,MAAM,EAAGtd,EAAQ60B,QAE1CP,GAQX7B,EAAMxvB,UAAUyI,OAAS,SAAUyoB,EAAWn0B,GAC1C,MAAOvC,OAAMC,QAAQkB,KAAKW,KAAK20B,WAAWC,EAAWn0B,KAEzDyyB,EAAMxvB,UAAUwxB,YAAc,SAAUK,EAAcC,GAIlD,IAAK,GAFDnI,GAAOmI,EAAU5jB,MAAM3T,OACvBw3B,EAAS,EACJ33B,EAAI,EAAOuvB,EAAJvvB,EAAUA,IAAK,CAC3B,GAAI43B,GAAYF,EAAU5jB,MAAM9T,EAC5By3B,GAAaI,aAAeD,EAAUE,OAAOD,aAAeJ,EAAaI,cACzEF,GAAU,EAAIC,EAAUG,QAExBN,EAAaI,aAAeD,EAAUE,OAAOD,aAAeD,EAAUE,OAAOD,YAAYvpB,QAAQmpB,EAAaI,cAAgB,IAC9HF,GAAU,EAAIC,EAAUG,OAE5B,KAAK,GAAIhZ,GAAI,EAAGA,EAAI6Y,EAAUE,OAAOhkB,MAAM3T,OAAQ4e,IAE/C,IAAK,GADDiZ,GAAQJ,EAAUE,OAAOhkB,MAAMiL,GAC1BnO,EAAI,EAAGA,EAAI6mB,EAAa3jB,MAAM3T,OAAQyQ,IAAK,CAChD,GAAIqnB,GAASR,EAAa3jB,MAAMlD,EAC5BqnB,GAAO93B,OAAS,GAAK63B,GAASC,IAC9BN,GAAUC,EAAUG,QAEpBE,EAAO93B,OAAS,GAAK63B,EAAM1pB,QAAQ2pB,IAAW,IAC9CN,GAA6B,GAAnBC,EAAUG,SAKpC,MAAIJ,IACSJ,KAAMI,EAAQrzB,IAAKozB,EAAUpzB,IAAKhB,KAAMo0B,EAAUQ,SAD/D,QAQJ9C,EAAMxvB,UAAUuyB,OAAS,SAAU1pB,GAC/BvM,KAAKhB,WAAauN,GAEtB2mB,EAAMxvB,UAAUwyB,KAAO,SAAU3pB,GAC7B,GAAIxD,GAAQ/I,KAERm2B,EAAMptB,EAAM/J,WACZ8K,GACA8H,SACAokB,QAASxvB,OACTpE,IAAKoE,OAET,IAAK2vB,GAAQA,EAAIhC,OAAjB,CAEIprB,EAAMoqB,YACNrpB,EAAIksB,QAAUzpB,GACd4pB,EAAI/zB,MACJ0H,EAAI1H,IAAM3F,EAAayC,MAAM6tB,aAAaxgB,EAAK4pB,EAAI/zB,KACvD,KAAK,GAAIE,KAAO6zB,GAAIhC,OAChB,GAAIgC,EAAIhC,OAAOiC,eAAe9zB,GAAM,CAChC,GAAIuzB,GAASM,EAAIhC,OAAO7xB,GAAKuzB,QAAU,EACnCzZ,EAAQ3f,EAAayC,MAAM6tB,aAAaxgB,EAAKjK,EAAIuE,MAAM,KACvDuV,IACAtS,EAAI8H,MAAMpU,MAAOo4B,OAAQ7sB,EAAM+rB,YAAY1Y,GAAQyZ,OAAQA,IAIvE,MADA9sB,GAAM6I,MAAMpU,KAAKsM,GACV5L,MAAMC,QAAQkB,KAAKyK,KAS9BopB,EAAMxvB,UAAU0oB,IAAM,SAAU7f,GAC5B,MAAOrO,OAAMC,QAAQkB,KAAKW,KAAKk2B,KAAK3pB,KAQxC2mB,EAAMxvB,UAAU2yB,SAAW,SAAUC,EAAKC,GAKtC,IAAK,GAJDxtB,GAAQ/I,KACRqtB,EAAOiJ,EAAIr4B,OACXu4B,KACAxB,EAAe,GACVl3B,EAAI,EAAOuvB,EAAJvvB,EAAUA,IAAK,CAC3B,GAAIsD,GAAO2H,EAAMmtB,KAAKI,EAAIx4B,GACtBsD,IACAo1B,EAAQh5B,KAAK4D,EACjB,IAAIhC,GAAK,IAAMtB,EAAIuvB,GAAS,CACxBkJ,IAAYn3B,GAAK41B,GACjBuB,GAAWpB,gBAAiB/1B,EAAGwS,MAAOyb,EAAMwG,QAAS/1B,IACzDk3B,EAAe51B,EAEnB,MAAOlB,OAAMC,QAAQkB,MAAOm3B,QAASA,EAAQv4B,UAEjDi1B,EAAMxvB,UAAU+yB,QAAU,WACtB,GAAI1tB,GAAQ/I,KACR+M,EAAMhE,EAAM6I,MACZyb,EAAOtgB,EAAI9O,MACf8K,GAAM6I,QACN,KAAK,GAAI9T,GAAI,EAAOuvB,EAAJvvB,EAAUA,IAAK,CAC3B,GAAIsD,GAAO2H,EAAM6I,MAAM9T,EACvBiL,GAAMqjB,IAAIhrB,EAAK40B,WAQvB9C,EAAMxvB,UAAUoxB,YAAc,SAAUlyB,GACjB,gBAARA,KACPA,EAAOA,EAAKkL,WAIhB,KAAK,GAHD8nB,GAAS51B,KAAK02B,SAAS9zB,GACvBkH,KACAujB,EAAOuI,EAAO33B,OACTH,EAAI,EAAOuvB,EAAJvvB,EAAUA,IAAK,CAC3B,GAAI64B,GAAM32B,KAAKyzB,SAASmD,IAAIhB,EAAO93B,GAC/B64B,GAAI14B,OAAS,GACb6L,EAAItM,KAAKm5B,GAEjB,OAAS/kB,MAAO9H,EAAK6rB,YAAa31B,KAAKyzB,SAASmD,IAAIh0B,KAOxDswB,EAAMxvB,UAAUmzB,UAAY,SAAUf,GAElC,IAAK,GADDzI,GAAOrtB,KAAKqzB,UAAUp1B,OACjBH,EAAI,EAAOuvB,EAAJvvB,EAAUA,IACtB,GAAIg4B,GAAS91B,KAAKqzB,UAAUv1B,GACxB,MAAO,EAEf,OAAOg4B,IAOX5C,EAAMxvB,UAAUgzB,SAAW,SAAUZ,GACjC,GACIF,KACJ,KAAKE,IAAUA,EAAMjvB,MACjB,MAAO+uB,EAEX,KAAK,GADDkB,GAAQhB,EAAMjvB,MAAM,OACf/I,EAAI,EAAGA,EAAIg5B,EAAM74B,OAAQH,IAC1Bg5B,EAAMh5B,GAAGG,OAAS,GAClB23B,EAAOp4B,KAAKs5B,EAAMh5B,GAG1B,OAAO83B,IAEJ1C,IAEXjB,GAAOiB,MAAQA,GAChBjB,EAASx1B,EAAaw1B,SAAWx1B,EAAaw1B,aAClDx1B,eAAiBA,iBAEpB,IAAIA,eACJ,SAAWA,GACP,GAAIw1B,IACJ,SAAWA,GACP,GAAI8E,GAAa,WAQb,QAASA,GAAWC,GAOhB,GADAh3B,KAAKi3B,WACDD,EACA,IAAK,GAAI3pB,KAAK2pB,GAAa,CACvB,GAAI10B,GAAM00B,EAAY3pB,EAIlBrN,MAAKi3B,QAAQ5pB,GAHZ/K,EAAI40B,UAGa,GAAIz6B,GAAaw1B,OAAOkF,iBAAiB9pB,EAAG/K,EAAItD,YAFhD,GAAIvC,GAAaw1B,OAAOiB,MAAM7lB,EAAG/K,EAAItD,aA2GvE,MA5FA+3B,GAAWrzB,UAAU0zB,SAAW,SAAUv3B,EAAMb,EAAYq4B,EAAOzlB,GAC/D,GAAIylB,EACA,GAAIhf,GAAM,GAAI5b,GAAaw1B,OAAOkF,iBAAiBt3B,EAAMb,OAEzD,IAAIqZ,GAAM,GAAI5b,GAAaw1B,OAAOiB,MAAMrzB,EAAMb,EAElD,OADAgB,MAAKi3B,QAAQp3B,GAAQwY,EACjBzG,GAASA,EAAM3T,OACRoa,EAAIge,SAASzkB,GAAO5H,KAAK,WAC5B,MAAOqO,KAGRna,MAAMC,QAAQkB,KAAKgZ,IAS9B0e,EAAWrzB,UAAU4zB,iBAAmB,SAAUz3B,EAAM+R,GACpD,GAAIyG,GAAMrY,KAAKi3B,QAAQp3B,EACvB,OAAIwY,IAAOzG,GAASA,EAAM3T,OACfoa,EAAIge,SAASzkB,GAEjB1T,MAAMC,QAAQ8L,WAAYC,QAAS,gBAAkBrK,EAAO,gBAOvEk3B,EAAWrzB,UAAUyI,OAAS,SAAUyoB,GAGpC,QAAS2C,GAAY13B,EAAMkJ,GACvB,MAAOA,GAAMoD,OAAOyoB,GAAW5qB,KAAK,SAAUF,GACtCA,GAAOA,EAAI7L,QACX6L,EAAIpL,QAAQ,SAAU0C,GAClBA,EAAKo2B,eAAiB33B,EACtB43B,EAAaC,WAAWl6B,KAAK4D,KAGrCq2B,EAAa53B,GAAQiK,IAV7B,GACI2tB,IAAiBE,WAAW,EAAOD,eAYnCx6B,IACJ,KAAK,GAAImQ,KAAKrN,MAAKi3B,QACf/5B,EAASM,KAAK+5B,EAAYlqB,EAAGrN,KAAKi3B,QAAQ5pB,IAE9C,OAAOnP,OAAMC,QAAQC,KAAKlB,GAAU8M,KAAK,WAKrC,MAJAytB,GAAaC,WAAWtC,KAAK,SAAU5X,EAAGD,GACtC,MAAOA,GAAE8X,KAAO7X,EAAE6X,OAEtBoC,EAAaE,UAAYF,EAAaC,WAAWz5B,OAAS,EACnDw5B,KAQfV,EAAWrzB,UAAU2wB,KAAO,WACxB,GAAIn3B,KACJ,KAAK,GAAImQ,KAAKrN,MAAKi3B,QACf/5B,EAASM,KAAKwC,KAAKi3B,QAAQ5pB,GAAGgnB,OAElC,OAAOn2B,OAAMC,QAAQC,KAAKlB,IAO9B65B,EAAWrzB,UAAU+wB,KAAO,WACxB,GAAIv3B,KACJ,KAAK,GAAImQ,KAAKrN,MAAKi3B,QACf/5B,EAASM,KAAKwC,KAAKi3B,QAAQ5pB,GAAGonB,OAElC,OAAOv2B,OAAMC,QAAQC,KAAKlB,IAM9B65B,EAAWrzB,UAAU4sB,QAAU,WAC3B,IAAK,GAAIjjB,KAAKrN,MAAKi3B,QACfj3B,KAAKi3B,QAAQ5pB,GAAGijB,SAEpBtwB,MAAKi3B,YAEFF,IAEX9E,GAAO8E,WAAaA,GACrB9E,EAASx1B,EAAaw1B,SAAWx1B,EAAaw1B,aAClDx1B,eAAiBA,iBAEpB,IAAIA,eACJ,SAAWA,GACP,GAAIw1B,IACJ,SAAWA,GACP,GAAIkF,GAAmB,WASnB,QAASA,GAAiBt3B,EAAMb,EAAY44B,GACxC,GAAIC,GAAU73B,IACd63B,GAAQC,OAAS,GAAIr7B,GAAas7B,UAAUC,YAAYJ,GAAcn7B,EAAaw1B,OAAOgB,YAC1F4E,EAAQI,KAAKp4B,EAAMb,GAiFvB,MAxEAm4B,GAAiBzzB,UAAUu0B,KAAO,SAAUp4B,EAAMb,EAAYy1B,GAC1D,MAAOz0B,MAAK83B,OAAOvqB,MAAM,QAAU1N,KAAMA,EAAM40B,KAAMA,EAAMz1B,WAAYA,KAS3Em4B,EAAiBzzB,UAAUyI,OAAS,SAAU+rB,EAAYz3B,GACtD,MAAOT,MAAK83B,OAAOvqB,MAAM,UAAY2qB,WAAYA,EAAYz3B,QAASA,KAO1E02B,EAAiBzzB,UAAU8N,MAAQ,WAC/B,MAAOxR,MAAK83B,OAAOvqB,MAAM,UAS7B4pB,EAAiBzzB,UAAU0oB,IAAM,SAAU7rB,EAAME,GAC7C,MAAOT,MAAK83B,OAAOvqB,MAAM,SAAWqE,OAAQrR,GAAOE,QAASA,KAShE02B,EAAiBzzB,UAAU2yB,SAAW,SAAU91B,EAAME,GAClD,MAAOT,MAAK83B,OAAOvqB,MAAM,SAAWqE,MAAOrR,EAAME,QAASA,KAM9D02B,EAAiBzzB,UAAU4sB,QAAU,WACjCtwB,KAAK83B,OAAOxH,WAOhB6G,EAAiBzzB,UAAUswB,MAAQ,WAC/B,MAAOh0B,MAAK83B,OAAOvqB,MAAM,UAO7B4pB,EAAiBzzB,UAAU+wB,KAAO,WAC9B,MAAOz0B,MAAK83B,OAAOvqB,MAAM,SAO7B4pB,EAAiBzzB,UAAU2wB,KAAO,WAC9B,MAAOr0B,MAAK83B,OAAOvqB,MAAM,SAEtB4pB,IAEXlF,GAAOkF,iBAAmBA,GAC3BlF,EAASx1B,EAAaw1B,SAAWx1B,EAAaw1B,aAClDx1B,eAAiBA,iBAEpB,IAAIA,eACJ,SAAWA,GACP,GAAIw1B,IACJ,SAAWA,GACP,GAAIqB,IACJ,SAAWA,GAIP,GAAII,GAAW,WAKX,QAASA,GAAS10B,GACdgB,KAAKo0B,OAAS,SAAUp1B,GACpB,GAAIm5B,GAAOn4B,KACPo4B,EAAO37B,EAAaw1B,OAAOqB,SAAS+E,QACpCC,EAAM77B,EAAaw1B,OAAOqB,SAASiF,EACvCJ,GAAKK,cACL,IAAIC,GAAiB,IACrB,IAAIz5B,EAAY,CACZ,GAAIyC,SAAczC,GAAW05B,QAChB,YAATj3B,EACAg3B,EAAiBL,EAAKp5B,EAAW05B,UAE5B15B,EAAW05B,UAAY15B,EAAW05B,SAASz6B,SAChDw6B,EAAiBz5B,EAAW05B,UAG/BD,IACDA,EAAiBh8B,EAAaw1B,OAAOqB,SAAS+E,QAAQM,UAE1DF,EAAe/5B,QAAQ,SAAUmB,GAC7B,GAAI+4B,GAAYN,EAAIz4B,EAChB+4B,IACAT,EAAKK,YAAYh7B,KAAKo7B,MAIlC54B,KAAKo0B,OAAOp1B,GA8BhB,MAvBA00B,GAAShwB,UAAU0oB,IAAM,SAAUrkB,GAC/B/H,KAAKw4B,YAAYh7B,KAAKuK,IAM1B2rB,EAAShwB,UAAUswB,MAAQ,WACvBh0B,KAAKw4B,gBAOT9E,EAAShwB,UAAUkzB,IAAM,SAAUh0B,GAG/B,IAAK,GAFDyqB,GAAOrtB,KAAKw4B,YAAYv6B,OACxB6L,EAAMlH,EACD9E,EAAI,EAAOuvB,EAAJvvB,EAAUA,IACtBgM,EAAM9J,KAAKw4B,YAAY16B,GAAGgM,EAE9B,OAAOA,IAEJ4pB,IAEXJ,GAASI,SAAWA,GACrBJ,EAAWrB,EAAOqB,WAAarB,EAAOqB,eAC1CrB,EAASx1B,EAAaw1B,SAAWx1B,EAAaw1B,aAClDx1B,eAAiBA,iBACpB,IAAIA,eACJ,SAAWA,GACP,GAAIw1B,IACJ,SAAWA,GACP,GAAIqB,IACJ,SAAWA,GACP,GAAI+E,IACJ,SAAWA,GACPA,EAAQM,UACJ,YACA,oBAEJN,EAAQQ,MACJ,YACA,mBACA,QACA,qBACA,mBACA,cACA,aACA,aACA,QACA,aACA,QACA,cACA,aACA,aACA,aACA,aACA,QACA,aACA,cACA,QACA,QACA,eAELR,EAAU/E,EAAS+E,UAAY/E,EAAS+E,cAC5C/E,EAAWrB,EAAOqB,WAAarB,EAAOqB,eAC1CrB,EAASx1B,EAAaw1B,SAAWx1B,EAAaw1B,aAClDx1B,eAAiBA,iBACpB,IAAIA,eACJ,SAAWA,GACP,GAAIw1B,IACJ,SAAWA,GACP,GAAIqB,IACJ,SAAWA,GACP,GAAIC,IACJ,SAAWA,GAKPA,EAAUC,QAEN,KACA,KACA,MACA,KACA,KACA,MACA,KACA,KACA,MACA,MACA,KACA,MACA,KACA,KACA,OACA,OACA,MACA,OACA,KAEA,IACA,OACA,QACA,SACA,QACA,MACA,SACA,OACA,KACA,QACA,KACA,MACA,MACA,MACA,KACA,KACA,KACA,UACA,OACA,MACA,KACA,MACA,SACA,QACA,OACA,MACA,KACA,OACA,SACA,OACA,OACA,QACA,MACA,OACA,MACA,MACA,MACA,MACA,OACA,KACA,MACA,OACA,MACA,MACA,MACA,UACA,IACA,KACA,KACA,OACA,KACA,KACA,MACA,OACA,QACA,MACA,OACA,SACA,MACA,KACA,QACA,OACA,OACA,KACA,UACA,KACA,MACA,MACA,KACA,MACA,QACA,KACA,OACA,KACA,QACA,MACA,MACA,SACA,OACA,MACA,OACA,MACA,SACA,QACA,KACA,OACA,OACA,OACA,MACA,QACA,OACA,OACA,QACA,QACA,OACA,OACA,MACA,KACA,MACA,OACA,KACA,QACA,MACA,KACA,OACA,OACA,OACA,QACA,QACA,QACA,MACA,OACA,MACA,OACA,OACA,QACA,MACA,MACA,SAELD,EAAYD,EAASC,YAAcD,E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","file":"winjscontrib-custom.js","sourcesContent":["/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/*\r\nWARNING: this feature is experimental\r\nYou must add winjscontrib.core.js before this file\r\n*/\r\n\r\n/// <reference path=\"winjscontrib.core.js\" />\r\nvar WinJSContrib = WinJSContrib || {};\r\nWinJSContrib.UI = WinJSContrib.UI || {};\r\n\r\n/**\r\n * @namespace\r\n */\r\nWinJSContrib.UI.WebComponents = WinJSContrib.UI.WebComponents || {};\r\n\r\n(function (global) {\r\n\t'use strict';\r\n\tvar registered = {};\r\n\tWinJSContrib.UI.WebComponents.registered = registered;\r\n\tWinJSContrib.UI.WebComponents.polyfill = false;\r\n\r\n\tif (!global.document.registerElement && global.MutationObserver) {\r\n\t\tWinJSContrib.UI.WebComponents.polyfill = true;\r\n\t}\r\n\r\n\tfunction inspect(node) {\r\n\t\tvar customElement = null;\r\n\t\tvar ctrlName = node.nodeName;\r\n\t\tvar promises = [];\r\n\r\n\t\tif (node.nodeName !== '#text') {\r\n\t\t\tif (node.attributes) {\r\n\t\t\t\tvar ctrlName = node.getAttribute(\"is\");\r\n\t\t\t\tif (ctrlName) {\r\n\t\t\t\t\t//we uppercase because node names are uppercase\r\n\t\t\t\t\tcustomElement = registered[ctrlName.toUpperCase()];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!customElement && node.nodeName !== 'DIV' && node.nodeName !== 'SPAN') {\r\n\t\t\t\tcustomElement = registered[node.nodeName];\r\n\t\t\t}\r\n\r\n\t\t\tif (customElement && !node.mcnComponent) {\r\n\t\t\t\t//createElement(node, customElement);\r\n\t\t\t\tpromises.push(createElement(node, customElement));\r\n\t\t\t}\r\n\r\n\t\t\tif (node.msParentSelectorScope && node.winControl && node.winControl.pageLifeCycle && node.winControl.pageLifeCycle.observer) {\r\n\t\t\t\t//element is a fragment with its own mutation observer, no need to inspect childs\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t//if (node.nodeName === 'WIN-TEMPLATE') {\r\n\t\t\t//    return;\r\n\t\t\t//}\r\n\r\n\t\t\tfor (var i = 0, l = node.childNodes.length; i < l; i++) {\r\n\t\t\t\tpromises.push(inspect(node.childNodes[i]));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn WinJS.Promise.join(promises);\r\n\t}\r\n\r\n\t/**\r\n\t * inspect current DOM element and create webcomponents found on that element and on its child.\r\n\t * @function\r\n\t * @param {HTMLElement} element DOM element to inspect\r\n\t */\r\n\tWinJSContrib.UI.WebComponents.processAll = function (element) { };\r\n\tif (WinJSContrib.UI.WebComponents.polyfill) {\r\n\t\tWinJSContrib.UI.WebComponents.processAll = inspect;\r\n\t}\r\n\r\n\tfunction observeMutations(element) {\r\n\t\tvar observer = null;\r\n\t\tif (WinJSContrib.UI.WebComponents.polyfill) {\r\n\t\t\tobserver = new MutationObserver(function (mutations) {\r\n\t\t\t\t//console.time('check mutation');\r\n\t\t\t\tmutations.forEach(function (mutation) {\r\n\t\t\t\t\tif (mutation.addedNodes.length) {\r\n\t\t\t\t\t\tfor (var i = 0, l = mutation.addedNodes.length; i < l ; i++) {\r\n\t\t\t\t\t\t\tinspect(mutation.addedNodes[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t//console.timeEnd('check mutation');\r\n\t\t\t});\r\n\r\n\t\t\tobserver.observe(element, { childList: true, subtree: true });\r\n\t\t}\r\n\r\n\t\treturn observer;\r\n\t}\r\n\tWinJSContrib.UI.WebComponents.watch = observeMutations;\r\n\r\n\tfunction createElement(element, definition) {\r\n\t\tvar ctrl = element.winControl;\r\n\t\telement.mcnComponent = true;\r\n\t\tvar scope = WinJSContrib.Utils.getScopeControl(element);\r\n\t\tvar p = WinJS.Promise.wrap();\r\n\t\tvar process = function () {\r\n\t\t\tgetControlInstance(definition.ctor, element);\r\n\t\t}\r\n\r\n\t\tif (scope && scope.pageLifeCycle) {\r\n\t\t\t//if the component is owned by a page/fragment, we process the control according to page lifecycle\r\n\t\t\tp = scope.pageLifeCycle.steps.render.attach(process);\r\n\t\t} else {\r\n\t\t\tprocess();\r\n\t\t}\r\n\r\n\t\t//put a proxy on setAttribute to detect changes in attributes\r\n\t\tvar setAttribute = element.setAttribute;\r\n\t\telement.setAttribute = function (name, val) {\r\n\t\t\tif (element.winControl) {\r\n\t\t\t\tsetAttribute.call(this, name, val);\r\n\t\t\t\tvar definition = element.winControl.constructor.mcnWebComponent;\r\n\t\t\t\tif (definition) {\r\n\t\t\t\t\tvar map = definition[name.toUpperCase()];\r\n\t\t\t\t\tif (map) {\r\n\t\t\t\t\t\tvar ctx = { control: element.winControl, name: map.property, data: {} }\r\n\t\t\t\t\t\tdefinition.applyAttribute(name, this, ctx);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn p;\r\n\t}\r\n\r\n\tfunction getControlInstance(ctor, element) {\r\n\t\telement.mcnComponent = true;\r\n\t\tvar definition = ctor.mcnWebComponent;\r\n\t\t//console.time('building ' + definition.name);\r\n\t\tvar options = {};\r\n\t\tif (element.dataset.winOptions) {\r\n\t\t\toptions = getWinJSOptions(element);\r\n\t\t}\r\n\r\n\t\tif (definition && definition.optionsCallback) {\r\n\t\t\toptions = definition.optionsCallback(element, options, scope);\r\n\t\t}\r\n\r\n\t\tvar ctrl = new ctor(element, options);\r\n\t\telement.winControl = ctrl;\r\n\t\tif (definition) {\r\n\t\t\tdefinition.applyAll(element);\r\n\t\t}\r\n\t\t//console.timeEnd('building ' + definition.name);\t\t\r\n\t}\r\n\r\n\tfunction applyMapping(tagname, ctor, mapping) {\r\n\t\tif (typeof mapping == 'function')\r\n\t\t\treturn;\r\n\t\tmapping = mapping || {};\r\n\r\n\t\tctor.mcnWebComponent = {\r\n\t\t\tname: tagname,\r\n\t\t\tmap: mapping.map || {},\r\n\t\t\toptionsCallback: mapping.optionsCallback,\r\n\t\t\tapplyAll: function (element) {\r\n\t\t\t\tvar contextData = {};\r\n\t\t\t\tfor (var item in this.map) {\r\n\t\t\t\t\tvar attrcontext = { control: element.winControl, name: this.map[item].property, data: contextData };\r\n\t\t\t\t\tthis.applyAttribute(item, element, null, attrcontext);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tapplyAttribute: function (name, element, attrvalue, context) {\r\n\t\t\t\tvar map = this.map[name.toUpperCase()];\r\n\t\t\t\tif (map) {\r\n\t\t\t\t\tvar val = attrvalue || element.getAttribute(map.attribute);\r\n\t\t\t\t\tvar ctrl = element.winControl;\r\n\t\t\t\t\tif (val && ctrl) {\r\n\t\t\t\t\t\tif (!map.type || map.type === 'property') {\r\n\t\t\t\t\t\t\tif (map.resolve) {\r\n\t\t\t\t\t\t\t\tWinJSContrib.Utils.applyValue(element, val, ctrl, map.property, context);\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tWinJSContrib.Utils.writeProperty(ctrl, map.property, val);\r\n\t\t\t\t\t\t} else if (map.type === 'event') {\r\n\t\t\t\t\t\t\tWinJSContrib.Utils.resolveValue(element, val, context);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (mapping.properties) {\r\n\t\t\tmapping.properties.forEach(function (p) {\r\n\t\t\t\tif (p) {\r\n\t\t\t\t\tctor.mcnWebComponent.map[p.toUpperCase()] = { attribute: p, property: p, resolve: true, type: 'property' };\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (mapping.events) {\r\n\t\t\tmapping.events.forEach(function (p) {\r\n\t\t\t\tif (p) {\r\n\t\t\t\t\tctor.mcnWebComponent.map[p.toUpperCase()] = { attribute: p, property: p, resolve: true, type: 'event' };\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (mapping.controls) {\r\n\t\t\tfor (var ctKey in mapping.controls) {\r\n\t\t\t\tvar control = mapping.controls[ctKey];\r\n\t\t\t\tvar controlDefinition = control.mcnWebComponent;\r\n\t\t\t\tfor (var mapKey in controlDefinition.map) {\r\n\t\t\t\t\tvar key = ctKey + '.' + mapKey;\r\n\t\t\t\t\tvar controlmap = controlDefinition.map[mapKey];\r\n\t\t\t\t\tctor.mcnWebComponent.map[key.toUpperCase()] = {\r\n\t\t\t\t\t\tattribute: ctKey + '.' + controlmap.attribute,\r\n\t\t\t\t\t\tproperty: ctKey + '.' + controlmap.property,\r\n\t\t\t\t\t\tresolve: controlmap.resolve\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t* Register a control to be used as a webcomponent. If a tagname has already been registered, \r\n\t* the function will throw an error unless you specify the override flag\r\n\t* @function\r\n\t* @param {string} tagname name for DOM element for the component\r\n\t* @param {function} ctor constructor for the WinJS control\r\n\t* @param {Object} mapping definition for mapping between control and DOM element\r\n\t* @param {boolean} override indicate that you want to override an existing component definition\r\n\t* @example\r\n\t* WinJSContrib.UI.WebComponents.register('mcn-semanticlistviews', WinJSContrib.UI.SemanticListViews, {\r\n\t*\tproperties: ['nameOfProperty'],\r\n\t*   events : ['nameOfEvent'],\r\n\t*\tcontrols: {\r\n\t*\t\t\"listview\": WinJS.UI.ListView,\r\n\t*\t\t\"zoomedOutListview\": WinJS.UI.ListView,\r\n\t*\t\t\"semanticZoom\": WinJS.UI.SemanticZoom\r\n\t*\t},\r\n\t*\tmap: {\r\n\t*\t\t\"DEFAULTGROUPLIMIT\": { attribute: 'defaultGroupLimit', property: '_dataManager.defaultGroupLimit', resolve: true },\r\n\t*\t\t\"GROUPKIND\": { attribute: 'groupKind', property: '_dataManager.groupKind', resolve: true },\r\n\t*\t\t\"FIELD\": { attribute: 'field', property: '_dataManager.field', resolve: true },\r\n\t*\t\t\"ITEMS\": { attribute: 'items', property: '_dataManager.items', resolve: true },\r\n\t*\t}\r\n\t*});\r\n\t*/\r\n\tWinJSContrib.UI.WebComponents.register = function register(tagname, ctor, mapping, override) {\r\n\t\tvar existing = registered[tagname.toUpperCase()];\r\n\t\tif (existing && !override) {\r\n\t\t\tthrow 'component ' + tagname + ' already exists';\r\n\t\t}\r\n\r\n\t\tapplyMapping(tagname, ctor, mapping);\r\n\r\n\t\tif (WinJSContrib.UI.WebComponents.polyfill) {\r\n\t\t\tglobal.document.createElement(tagname);\r\n\t\t\t//we uppercase because node names are uppercase\r\n\t\t\tregistered[tagname.toUpperCase()] = { ctor: ctor };\r\n\t\t} else if (global.document.registerElement) {\r\n\t\t\t//register component with \"real\" webcomponent\r\n\t\t\tvar proto = Object.create(HTMLElement.prototype);\r\n\t\t\tproto.createdCallback = function () {\r\n\t\t\t}\r\n\r\n\t\t\tproto.attachedCallback = function () {\r\n\t\t\t\tvar element = this;\r\n\t\t\t\tvar scope = WinJSContrib.Utils.getScopeControl(element);\r\n\t\t\t\tvar process = function () {\r\n\t\t\t\t\tgetControlInstance(ctor, element);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (scope && scope.pageLifeCycle) {\r\n\t\t\t\t\t//if the component is owned by a page/fragment, we process the control according to page lifecycle\r\n\t\t\t\t    scope.pageLifeCycle.steps.render.attach(process);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tprocess();\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t};\r\n\r\n\t\t\tproto.attributeChangedCallback = function (attrName, oldValue, newValue) {\r\n\t\t\t\tvar element = this;\r\n\t\t\t\tif (element.winControl) {\r\n\t\t\t\t\tvar definition = element.winControl.constructor.mcnWebComponent;\r\n\t\t\t\t\tif (definition) {\r\n\t\t\t\t\t\tvar map = definition.map[attrName.toUpperCase()];\r\n\t\t\t\t\t\tif (map) {\r\n\t\t\t\t\t\t\tdefinition.applyAttribute(attrName, element, newValue, { control: element.winControl, name: map.property, data: {} });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t};\r\n\r\n\t\t\tglobal.document.registerElement(tagname, { prototype: proto });\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getWinJSOptions(elt) {\r\n\t\treturn WinJS.UI.optionsParser(elt.dataset.winOptions, window, {\r\n\t\t\tselect: WinJS.Utilities.markSupportedForProcessing(function (text) {\r\n\t\t\t\tvar parent = WinJSContrib.Utils.getScopeControl(elt);\r\n\t\t\t\tif (parent) {\r\n\t\t\t\t\treturn parent.element.querySelector(text);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn document.querySelector(text);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n\tif (WinJS.Binding && WinJS.Binding.Template) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-template', WinJS.Binding.Template, {\r\n\t\t\tproperties: ['extractChild']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.AppBar) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-appbar', WinJS.UI.AppBar, {\r\n\t\t\tproperties: ['closedDisplayMode', 'disabled', 'hidden', 'layout', 'placement', 'sticky', 'commands', \r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.AutoSuggestBox) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-autosuggestbox', WinJS.UI.AutoSuggestBox, {\r\n\t\t\tproperties: ['chooseSuggestionOnEnter', 'disabled', 'onquerychanged', 'onquerysubmitted', \r\n\t\t\t\t'onresultsuggestionchosen', 'onsuggestionsrequested', 'placeholderText', 'queryText', \r\n\t\t\t\t'searchHistoryContext', 'searchHistoryDisabled'],\r\n\t\t\tevents: ['querychanged', 'querysubmitted', 'resultsuggestionchosen', 'suggestionsrequested']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.BackButton) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-backbutton', WinJS.UI.BackButton);\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ContentDialog) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-contentdialog', WinJS.UI.ContentDialog, {\r\n\t\t\tproperties: ['hidden', 'primaryCommandDisabled', 'primaryCommandText', 'secondaryCommandDisabled',\r\n\t\t\t\t'secondaryCommandText', 'title', 'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.DatePicker) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-datepicker', WinJS.UI.DatePicker, {\r\n\t\t\tproperties: ['calendar', 'datePattern', 'disabled', 'maxYear', 'minYear', \r\n\t\t\t\t'monthPattern', 'yearPattern', 'onchange', 'current'],\r\n\t\t\tevents: ['change']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.FlipView) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-flipview', WinJS.UI.FlipView, {\r\n\t\t\tproperties: ['currentPage', 'orientation', 'itemTemplate', 'itemDataSource', 'itemSpacing', 'ondatasourcecountchanged', 'onpagevisibilitychanged', 'onpageselected', 'onpagecompleted'],\r\n\t\t\tevents: ['datasourcecountchanged', 'pagevisibilitychanged', 'pageselected', 'pagecompleted']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Flyout) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-flyout', WinJS.UI.Flyout, {\r\n\t\t\tproperties: ['alignment', 'anchor', 'disabled', 'hidden', 'placement', \r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Hub) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-hub', WinJS.UI.Hub, {\r\n\t\t\tproperties: ['headerTemplate', 'indexOfFirstVisible', 'indexOfLastVisible', 'loadingState', \r\n\t\t\t\t'oncontentanimating', 'onheaderinvoked', 'onloadingstatechanged', \r\n\t\t\t\t'orientation', 'scrollPosition', 'sectionOnScreen', 'sections', 'zoomableView'],\r\n\t\t\tevents: ['contentanimating', 'headerinvoked', 'loadingstatechanged']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.HubSection) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-hubsection', WinJS.UI.HubSection, {\r\n\t\t\tproperties: ['contentElement', 'header', 'isHeaderStatic']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ItemContainer) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-itemcontainer', WinJS.UI.ItemContainer, {\r\n\t\t\tproperties: ['draggable', 'oninvoked', 'onselectionchanged', 'onselectionchanging', 'selected', 'selectionDisabled', \r\n\t\t\t\t'swipeBehavior', 'swipeOrientation', 'tapBehavior'],\r\n\t\t\tevents: ['invoked', 'selectionchanged', 'selectionchanging']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ListView) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-listview', WinJS.UI.ListView, {\r\n\t\t\tproperties: [\r\n\t\t\t\t'itemTemplate', 'itemDataSource', 'itemsDraggable', 'itemsReorderable',\r\n\t\t\t\t'oniteminvoked', 'groupHeaderTemplate', 'groupDataSource', 'swipeBehavior',\r\n\t\t\t\t'selectBehavior', 'tapBehavior', 'header', 'footer'\r\n\t\t\t],\r\n\t\t\tevents: ['iteminvoked']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Menu) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-menu', WinJS.UI.Menu, {\r\n\t\t\tproperties: ['alignment', 'anchor', 'commands', 'disabled', 'hidden', 'placement', \r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Pivot) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-pivot', WinJS.UI.Pivot, {\r\n\t\t\tproperties: ['items', 'locked', 'onitemanimationend', 'onitemanimationstart', 'onselectionchanged', \r\n\t\t\t\t'selectedIndex', 'selectedItem', 'title'],\r\n\t\t\tevents: ['itemanimationend', 'itemanimationstart', 'selectionchanged']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.PivotItem) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-pivotitem', WinJS.UI.PivotItem, {\r\n\t\t\tproperties: ['contentElement', 'header']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Rating) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-rating', WinJS.UI.Rating, {\r\n\t\t\tproperties: ['averageRating', 'disabled', 'enableClear', 'maxRating', \r\n\t\t\t\t'oncancel', 'onchange', 'onpreviewchange', 'tooltipStrings', 'userRating'],\r\n\t\t\tevents: ['cancel', 'change', 'previewchange']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Repeater) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-repeater', WinJS.UI.Repeater, {\r\n\t\t\tproperties: ['data', 'length', 'onitemchanged', 'onitemchanging', 'oniteminserted', 'oniteminserting', \r\n\t\t\t\t'onitemmoved', 'onitemmoving', 'onitemremoved', 'onitemremoving', 'onitemsloaded', \r\n\t\t\t\t'onitemsreloaded', 'onitemsreloading', 'template'],\r\n\t\t\tevents: ['itemchanged', 'itemchanging', 'iteminserted', 'iteminserting',\r\n\t\t\t\t'itemmoved', 'itemmoving', 'itemremoved', 'itemremoving', 'itemsloaded',\r\n\t\t\t\t'itemsreloaded', 'itemsreloading']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.SearchBox) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-searchbox', WinJS.UI.SearchBox, {\r\n\t\t\tproperties: ['chooseSuggestionOnEnter', 'disabled', 'focusOnKeyboardInput', 'onquerychanged', 'onquerysubmitted', \r\n\t\t\t\t'onresultsuggestionchosen', 'onsuggestionsrequested', 'placeholderText', 'queryText', \r\n\t\t\t\t'searchHistoryContext', 'searchHistoryDisabled'],\r\n\t\t\tevents: ['querychanged', 'querysubmitted', 'resultsuggestionchosen', 'suggestionsrequested']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.SemanticZoom) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-semanticzoom', WinJS.UI.SemanticZoom, {\r\n\t\t\tproperties: ['enableButton', 'locked', 'onzoomchanged', 'zoomedInItem', 'zoomedOut', 'zoomedOutItem', 'zoomFactor'],\r\n\t\t\tevents: ['zoomchanged']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.SplitView) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-splitview', WinJS.UI.SplitView, {\r\n\t\t\tproperties: ['contentElement', 'hiddenDisplayMode', 'paneElement', 'paneHidden', 'panePlacement', 'shownDisplayMode',\r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.TimePicker) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-timepicker', WinJS.UI.TimePicker, {\r\n\t\t\tproperties: ['onchange', 'clock', 'current', 'disabled', 'hourPattern',\r\n\t\t\t\t'minuteIncrement', 'minutePattern', 'periodPattern'],\r\n\t\t\tevents: ['onchange']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ToggleSwitch) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-toggleswitch', WinJS.UI.ToggleSwitch, {\r\n\t\t\tproperties: ['onchange', 'checked', 'disabled', 'labelOff', 'labelOn', 'title'],\r\n\t\t\tevents: ['onchange']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ToolBar) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-toolbar', WinJS.UI.ToolBar);\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Tooltip) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-tooltip', WinJS.UI.Tooltip, {\r\n\t\t\tproperties: ['contentElement', 'extraClass', 'infotip', 'innerHTML', 'onbeforeclose', \r\n\t\t\t\t'onbeforeopen', 'onclosed', 'onopened', 'placement'],\r\n\t\t\tevents: ['beforeclose', 'beforeopen', 'closed', 'opened']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ViewBox) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-viewbox', WinJS.UI.ViewBox);\r\n\t}\r\n\r\n\r\n\t/*\r\n\t\t\t\tWinJS.UI.MenuCommand\r\n\t\t\t\tWinJS.UI.NavBar\r\n\t\t\t\tWinJS.UI.NavBarCommand\r\n\t\t\t\tWinJS.UI.NavBarContainer\r\n\t\t\t\tToolbar\r\n\t*/\r\n})(this);","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var WinRT;\n    (function (WinRT) {\n        /**\n         * read protocol arguments from application activation event arguments\n         * @function WinJSContrib.WinRT.readProtocol\n         * @param {Object} args WinJS application activation argument\n         * @returns {Object} protocol arguments\n         */\n        function readProtocol(args) {\n            if (args.detail.kind === Windows.ApplicationModel.Activation.ActivationKind.protocol && args.detail.uri) {\n                var navArgs = { action: undefined };\n                var protocolArgs = {};\n                var queryargs = args.detail.uri.query;\n                if (queryargs[0] == '?') {\n                    queryargs = queryargs.substr(1);\n                }\n                if (queryargs) {\n                    queryargs.split('&').forEach(function (item) {\n                        var arg = item.split('=');\n                        protocolArgs[arg[0]] = decodeURIComponent(arg[1]);\n                    });\n                }\n                navArgs.protocol = {\n                    action: args.detail.uri.host,\n                    args: protocolArgs\n                };\n                return navArgs;\n            }\n        }\n        WinRT.readProtocol = readProtocol;\n        ;\n        /**\n         * Indicate if a valid internet connection is available, even with constrained access\n         * @function WinJSContrib.WinRT.isConnected\n         * @returns {boolean}\n         */\n        function isConnected() {\n            var nlvl = Windows.Networking.Connectivity.NetworkConnectivityLevel;\n            var profile = Windows.Networking.Connectivity.NetworkInformation.getInternetConnectionProfile();\n            if (profile !== null) {\n                var level = profile.getNetworkConnectivityLevel();\n                return level === nlvl.constrainedInternetAccess || level === nlvl.internetAccess;\n            }\n            return false;\n        }\n        WinRT.isConnected = isConnected;\n        ;\n        /**\n         * Indicate if a valid internet connection is available\n         * @function WinJSContrib.WinRT.hasInternetAccess\n         * @returns {boolean}\n         */\n        function hasInternetAccess() {\n            var nlvl = Windows.Networking.Connectivity.NetworkConnectivityLevel;\n            var profile = Windows.Networking.Connectivity.NetworkInformation.getInternetConnectionProfile();\n            if (profile !== null) {\n                var level = profile.getNetworkConnectivityLevel();\n                return level === nlvl.internetAccess;\n            }\n            return false;\n        }\n        WinRT.hasInternetAccess = hasInternetAccess;\n        ;\n        /**\n         * trigger callback when internet connection status is changing\n         * @function WinJSContrib.WinRT.onInternetStatusChanged\n         * @param {function} callback callback for internet status change notification\n         * @returns {function} function to call for unregistering the callback\n         */\n        function onInternetStatusChanged(callback) {\n            var handler = function (arg) {\n                var e = arg;\n                callback(WinJSContrib.WinRT.hasInternetAccess());\n            };\n            var network = Windows.Networking.Connectivity.NetworkInformation;\n            network.addEventListener('networkstatuschanged', handler);\n            return function () {\n                network.removeEventListener('networkstatuschanged', handler);\n            };\n        }\n        WinRT.onInternetStatusChanged = onInternetStatusChanged;\n    })(WinRT = WinJSContrib.WinRT || (WinJSContrib.WinRT = {}));\n})(WinJSContrib || (WinJSContrib = {}));\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Alerts;\n    (function (Alerts) {\n        /**\n         * show system alert box\n         * @function WinJSContrib.Alerts.messageBox\n         * @param {Object} opt message options\n         * @returns {WinJS.Promise}\n         */\n        function messageBox(opt) {\n            var _global = window;\n            if (opt) {\n                if (_global.Windows) {\n                    var md = new Windows.UI.Popups.MessageDialog(opt.content);\n                    if (opt.title) {\n                        md.title = opt.title;\n                    }\n                    if (opt.commands && opt.commands.forEach) {\n                        opt.commands.forEach(function (command, index) {\n                            var cmd = new Windows.UI.Popups.UICommand();\n                            if (command.id)\n                                cmd.id = command.id;\n                            cmd.label = command.label;\n                            if (command.callback) {\n                                cmd.invoked = command.callback;\n                            }\n                            ((md.commands)).append(cmd);\n                            if (command.isDefault) {\n                                md.defaultCommandIndex = index;\n                            }\n                        });\n                    }\n                    return (md.showAsync());\n                }\n                else {\n                    return new WinJS.Promise(function (complete, error) {\n                        var title = \"\";\n                        if (opt.title) {\n                            title = opt.title;\n                        }\n                        var commands = [];\n                        if (opt.commands && opt.commands.forEach) {\n                            //if (opt.commands.length > 2) {\n                            //    return WinJS.Promise.wrapError(\"you must specify maximum 2 commands on Cordova platforms\");\n                            //}\n                            opt.commands.forEach(function (command, index) {\n                                commands.push(command.label);\n                            });\n                        }\n                        else\n                            commands = ['Ok'];\n                        if (_global.navigator && _global.navigator.notification && _global.navigator.notification.confirm) {\n                            _global.navigator.notification.confirm(opt.content, function (res) {\n                                if (opt.commands && opt.commands[res - 1] && opt.commands[res - 1].callback) {\n                                    var c = opt.commands[res - 1].callback();\n                                    if (c && c.then) {\n                                        c.then(function () {\n                                            complete(true);\n                                        });\n                                    }\n                                    else {\n                                        complete(true);\n                                    }\n                                }\n                                else if (res != 0)\n                                    complete(true);\n                                else\n                                    complete(false);\n                            }, title, commands // buttonLabels\n                            );\n                        }\n                        else {\n                            if (window.confirm(title))\n                                complete(true);\n                            else\n                                complete(false);\n                        }\n                    });\n                }\n            }\n            return WinJS.Promise.wrapError(\"you must specify commands as an array of objects with properties text and callback such as {text: '', callback: function(c){}}\");\n        }\n        Alerts.messageBox = messageBox;\n        ;\n        /**\n         * show system alert box\n         * @function WinJSContrib.Alerts.message\n         * @param {string} title title of the alert\n         * @param {string} content text for the alert\n         * @returns {WinJS.Promise}\n         */\n        function message(title, content) {\n            return WinJSContrib.Alerts.messageBox({ title: title, content: content });\n        }\n        Alerts.message = message;\n        /**\n         * show system alert box\n         * @function WinJSContrib.Alerts.confirm\n         * @param {string} title title of the alert\n         * @param {string} content text for the alert\n         * @param {string} yes text for yes\n         * @param {string} no text for no\n         * @returns {WinJS.Promise}\n         */\n        function confirm(title, content, yes, no) {\n            return new WinJS.Promise(function (complete, error) {\n                WinJSContrib.Alerts.messageBox({\n                    title: title,\n                    content: content,\n                    commands: [\n                        {\n                            label: yes,\n                            callback: function (e) {\n                                complete(true);\n                            },\n                            isDefault: true\n                        },\n                        {\n                            label: no,\n                            callback: function (e) {\n                                complete(false);\n                            }\n                        }\n                    ]\n                });\n            });\n        }\n        Alerts.confirm = confirm;\n        /**\n         * show system toast notification\n         * @function WinJSContrib.Alerts.toastNotification\n         * @param {Object} data toast options\n         */\n        function toastNotification(data) {\n            if (Windows) {\n                var notifications = Windows.UI.Notifications;\n                var template = data.template || (data.picture ? notifications.ToastTemplateType.toastImageAndText01 : notifications.ToastTemplateType.toastText01);\n                //var template = notifications.ToastTemplateType[data.template]; //toastImageAndText01;\n                var toastXml = notifications.ToastNotificationManager.getTemplateContent(template);\n                var toastTextElements = toastXml.getElementsByTagName(\"text\");\n                var toastImageElements = toastXml.getElementsByTagName(\"image\");\n                if (data.launch) {\n                    var toastElements = toastXml.getElementsByTagName(\"toast\");\n                    toastElements[0].setAttribute(\"launch\", JSON.stringify(data.launch));\n                }\n                toastTextElements[0].appendChild(toastXml.createTextNode(data.text));\n                if (data.text2 && toastTextElements.length > 1) {\n                    toastTextElements[1].appendChild(toastXml.createTextNode(data.text2));\n                }\n                if (data.text3 && toastTextElements.length > 1) {\n                    toastTextElements[2].appendChild(toastXml.createTextNode(data.text3));\n                }\n                if (data.picture) {\n                    toastImageElements[0].setAttribute(\"src\", data.picture); //\"ms-appx:///images/logo.png\"\n                }\n                var toast = new notifications.ToastNotification(toastXml);\n                var toastNotifier = notifications.ToastNotificationManager.createToastNotifier();\n                toastNotifier.show(toast);\n            }\n            else {\n                throw \"No notification plugin found\";\n            }\n        }\n        Alerts.toastNotification = toastNotification;\n        /**\n         * show system toast notification\n         * @function WinJSContrib.Alerts.toast\n         * @param {string} text text displayed in the toast\n         * @param {string} picture path to a picture to display in the toast\n         */\n        function toast(text, picture) {\n            WinJSContrib.Alerts.toastNotification({ text: text, picture: picture });\n        }\n        Alerts.toast = toast;\n    })(Alerts = WinJSContrib.Alerts || (WinJSContrib.Alerts = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\n//# sourceMappingURL=../../Sources/WinRT/winjscontrib.winrt.core.js.map","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib = WinJSContrib || {};\r\nWinJSContrib.UPnP = WinJSContrib.UPnP || {};\r\n\r\n(function (global) {\r\n\r\n    WinJSContrib.UPnP.deviceTypes = {\r\n        ContentDirectory1: 'urn:schemas-upnp-org:service:ContentDirectory:1',\r\n        ContentDirectory2: 'urn:schemas-upnp-org:service:ContentDirectory:2',\r\n        ContentDirectory3: 'urn:schemas-upnp-org:service:ContentDirectory:3',\r\n        ContentDirectory4: 'urn:schemas-upnp-org:service:ContentDirectory:4',\r\n        MediaRenderer1: 'urn:schemas-upnp-org:device:MediaRenderer:1',\r\n        MediaRenderer2: 'urn:schemas-upnp-org:device:MediaRenderer:2',\r\n        MediaRenderer3: 'urn:schemas-upnp-org:device:MediaRenderer:3',\r\n        MediaRenderer4: 'urn:schemas-upnp-org:device:MediaRenderer:4',\r\n        MediaServer1: 'urn:schemas-upnp-org:device:MediaServer:1',\r\n        MediaServer2: 'urn:schemas-upnp-org:device:MediaServer:2',\r\n        MediaServer3: 'urn:schemas-upnp-org:device:MediaServer:3',\r\n        MediaServer4: 'urn:schemas-upnp-org:device:MediaServer:4',\r\n        AVTransport1:'urn:schemas-upnp-org:service:AVTransport:1',\r\n        AVTransport2: 'urn:schemas-upnp-org:service:AVTransport:2',\r\n        ConnectionManager1: 'urn:schemas-upnp-org:service:ConnectionManager:1',\r\n        ConnectionManager2: 'urn:schemas-upnp-org:service:ConnectionManager:2',\r\n        ConnectionManager3: 'urn:schemas-upnp-org:service:ConnectionManager:3'\r\n    };\r\n\r\n    WinJSContrib.UPnP.devicesDiscovery = function devicesDiscovery(filter, callback, timeout) {\r\n        var hostName;\r\n        try {\r\n            hostName = new Windows.Networking.HostName(\"239.255.255.250\");\r\n        } catch (ex) {\r\n            error({ message: \"Invalid host name.\" });\r\n            return;\r\n        }\r\n\r\n        var devices = new WinJS.Binding.List();\r\n\r\n        var discovery = {\r\n            devices: devices,\r\n            hasError: null,\r\n            promise: null,\r\n        };\r\n\r\n        function exists(url) {\r\n            var matches = devices.filter(function (d) {\r\n                return (url == d.deviceDescriptionUrl);\r\n            });\r\n            return matches.length > 0;\r\n        }\r\n\r\n        function discover(filter) {\r\n            return new WinJS.Promise(function (complete, error) {\r\n                var clientSocket = new Windows.Networking.Sockets.DatagramSocket();\r\n\r\n                function onsuccess(err) {\r\n                    try {\r\n                        if (clientSocket)\r\n                            clientSocket.close();\r\n                    } catch (ex) {\r\n                    }\r\n                    complete(devices);\r\n                }\r\n\r\n                function onerror(err) {\r\n                    try {\r\n                        if (clientSocket)\r\n                            clientSocket.close();\r\n                    } catch (ex) {\r\n                    }\r\n                    error(err);\r\n                }\r\n\r\n                clientSocket.onmessagereceived = function (args) {\r\n                    var e = args;\r\n                    var reader = args.getDataReader();\r\n                    var count = reader.unconsumedBufferLength;\r\n                    var data = reader.readString(count);\r\n                    var completed = false;\r\n\r\n                    if (data) {\r\n                        var items = data.split('\\n');\r\n                        items.forEach(function (item) {\r\n                            if (!completed && item.toLowerCase().indexOf('location:') == 0) {\r\n                                var url = item.substr(9, item.length - 9);\r\n                                completed = true;\r\n                                if (!exists(url)) {\r\n                                    WinJS.xhr({ url: url }).then(function (r) {\r\n\r\n                                        var rawdevice = xmlToJson(r.responseXML);\r\n                                        var device = rawdevice.root.device;\r\n\r\n                                        device.deviceDescriptionUrl = url;\r\n                                        device.rootUrl = url.substr(0, url.indexOf('/', 8));\r\n                                        if (!exists(url)) {\r\n                                            devices.push(new WinJSContrib.UPnP.UPnPDevice(device));\r\n                                        }\r\n\r\n                                        if (callback)\r\n                                            callback(device, url);\r\n                                    }, function (err) {\r\n                                        console.error('calling device failed');\r\n                                        console.error(err);\r\n                                    });\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n\r\n                }\r\n\r\n                clientSocket.getOutputStreamAsync(hostName, \"1900\").then(function (outputStream) {\r\n                    var message = \"M-SEARCH * HTTP/1.1\\r\\n\" +\r\n                                        \"HOST: 239.255.255.250:1900\\r\\n\" +\r\n                                          \"ST:\" + (filter || \"upnp:rootdevice\") + \"\\r\\n\" +\r\n                                          \"MAN:\\\"ssdp:discover\\\"\\r\\n\" +\r\n                                          \"MX:3\\r\\n\\r\\n\";\r\n\r\n\r\n                    var writer = new Windows.Storage.Streams.DataWriter(outputStream);\r\n                    writer.unicodeEncoding = Windows.Storage.Streams.UnicodeEncoding.Utf8;\r\n                    writer.writeString(message);\r\n                    return writer.storeAsync();\r\n                }).then(function () {\r\n                    return WinJS.Promise.timeout(timeout || 20000);\r\n                }).then(onsuccess, onerror);\r\n            }).then(function (res) {\r\n                discovery.hasError = false;\r\n            }, function (err) {\r\n                discovery.hasError = true;\r\n                discovery.error = err;\r\n            });\r\n        }\r\n\r\n        var promises = [];\r\n\r\n        if (!filter || (typeof filter == 'string')) {\r\n            promises.push(discover(filter));\r\n        }\r\n        else if (filter && typeof filter != 'string' && filter.length) {\r\n            for (var i = 0 ; i < filter.length; i++) {\r\n                promises.push(discover(filter[i]));\r\n            }\r\n        }\r\n\r\n        discovery.promise = WinJS.Promise.join(promises);\r\n\r\n        return discovery;\r\n    }\r\n\r\n    function endsWith(text, search) {\r\n        return text.indexOf(search) == text.length - search.length;\r\n    }\r\n\r\n    WinJSContrib.UPnP.getContentType = function (url, extension) {\r\n        var lowerUrl = url.toLowerCase();\r\n\r\n        if (extension == \"mp3\" || endsWith(lowerUrl, \".mp3\"))\r\n            return \"audio/mp3\";\r\n\r\n        if (extension == \"mp4\" || endsWith(lowerUrl, \".mp4\"))\r\n            return \"video/mp4\";\r\n\r\n        if (extension == \"avi\" || endsWith(lowerUrl, \".avi\"))\r\n            return \"video/avi\";\r\n\r\n        if (extension == \"mkv\" || endsWith(lowerUrl, \".mkv\"))\r\n            return \"video/x-matroska\";\r\n    }\r\n\r\n    function xmlToJson(xml) {\r\n\r\n        // Create the return object\r\n        var obj = {};\r\n\r\n        if (xml.nodeType == 1) { // element\r\n            // do attributes\r\n            if (xml.attributes.length > 0) {\r\n                obj[\"@attributes\"] = {};\r\n                for (var j = 0; j < xml.attributes.length; j++) {\r\n                    var attribute = xml.attributes.item(j);\r\n\r\n                    obj[\"@attributes\"][attribute.nodeName] = attribute.nodeValue;\r\n                }\r\n            }\r\n        } else if (xml.nodeType == 3) { // text\r\n            obj = xml.nodeValue;\r\n        }\r\n\r\n        // do children\r\n        if (xml.hasChildNodes()) {\r\n            var properties = 0;\r\n            for (var i = 0; i < xml.childNodes.length; i++) {\r\n                var item = xml.childNodes.item(i);\r\n                var nodeName = item.nodeName;\r\n                if (typeof (obj[nodeName]) == \"undefined\") {\r\n                    var tmp = xmlToJson(item);\r\n                    var colonIdx = nodeName.indexOf(':');\r\n                    if (colonIdx > 0) {\r\n                        var clearNode = nodeName.substr(colonIdx + 1, nodeName.length - colonIdx - 1);\r\n\r\n                    }\r\n\r\n                    if (clearNode && !obj[clearNode]) {\r\n                        obj[clearNode] = tmp;\r\n                    } else {\r\n                        obj[nodeName] = tmp;\r\n                    }\r\n\r\n                    properties++;\r\n                } else {\r\n                    if (typeof (obj[nodeName].push) == \"undefined\") {\r\n                        var old = obj[nodeName];\r\n                        obj[nodeName] = [];\r\n                        obj[nodeName].push(old);\r\n                    }\r\n                    obj[nodeName].push(xmlToJson(item));\r\n                    properties++;\r\n                }\r\n            }\r\n\r\n            if (obj['#text'] && typeof obj['#text'] == 'string') {\r\n                obj['#text'] = obj['#text'].trim();\r\n            }\r\n            if (properties == 1 && obj['#text'] && typeof obj['#text'] == 'string') {\r\n                obj = obj['#text'];\r\n            }\r\n        }\r\n\r\n        for (var e in obj[\"@attributes\"]) {\r\n            if (!obj[e])\r\n                obj[e] = obj[\"@attributes\"][e];\r\n        }\r\n\r\n        return obj;\r\n    };\r\n\r\n    /**\r\n     * UPnP device\r\n     * @class\r\n     */\r\n    WinJSContrib.UPnP.UPnPDevice = function (deviceObj) {\r\n        for (var p in deviceObj) {\r\n            this[p] = deviceObj[p];\r\n        }\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getService = function (serviceType) {\r\n        var device = this;\r\n        var service = null;\r\n\r\n        if (typeof serviceType == 'string')\r\n            serviceType = [serviceType];\r\n\r\n        if (device.serviceList && device.serviceList.service) {\r\n            service = device.serviceList.service.filter(function (s) {\r\n                return serviceType.indexOf(s.serviceType) >= 0;\r\n            })[0];\r\n\r\n            if (!service && device.deviceList) {\r\n                device.deviceList.device.forEach(function (childdevice) {\r\n                    var childService = childdevice.serviceList.service.filter(function (s) {\r\n                        return serviceType.indexOf(s.serviceType) >= 0;\r\n                    })[0];\r\n\r\n                    if (childService)\r\n                        service = childService;\r\n                });\r\n            }\r\n        }\r\n\r\n        if (service) {\r\n            service.rootUrl = device.rootUrl;\r\n            service.url = device.rootUrl + service.controlURL;\r\n        }\r\n\r\n        return service;\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getAVTransport = function () {\r\n        var service = this.getService([WinJSContrib.UPnP.deviceTypes.AVTransport1, WinJSContrib.UPnP.deviceTypes.AVTransport2]);\r\n        if (service) {\r\n            return new WinJSContrib.UPnP.UPnPAVTransport(service);\r\n        }\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getContentDirectory = function () {\r\n        var service = this.getService([WinJSContrib.UPnP.deviceTypes.ContentDirectory1, WinJSContrib.UPnP.deviceTypes.ContentDirectory2, WinJSContrib.UPnP.deviceTypes.ContentDirectory3, WinJSContrib.UPnP.deviceTypes.ContentDirectory4]);\r\n        if (service) {\r\n            return new WinJSContrib.UPnP.UPnPContentDirectory(service);\r\n        }\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getConnectionManager = function () {\r\n        var service = this.getService([WinJSContrib.UPnP.deviceTypes.ConnectionManager1, WinJSContrib.UPnP.deviceTypes.ConnectionManager2, WinJSContrib.UPnP.deviceTypes.ConnectionManager3]);\r\n        if (service) {\r\n            return new WinJSContrib.UPnP.UPnPConnectionManager(service);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Code largely from https://github.com/richtr/plug.play.js\r\n     */\r\n\r\n    WinJSContrib.UPnP.UPnPService = function (serviceObj, opts) {\r\n\r\n        this.options = opts || { debug: false };\r\n        this.svc = serviceObj;\r\n\r\n        // API stub\r\n        this.action = function () { };\r\n\r\n        //if (!this.svc || !(this.svc instanceof NetworkService)) {\r\n\r\n        //    this.debugLog('First argument provided in constructor MUST be a valid NetworkService object');\r\n\r\n        //    return this;\r\n        //}\r\n\r\n        //if (!this.svc.type || this.svc.type.indexOf('upnp:') !== 0) {\r\n\r\n        //    this.debugLog('First argument provided in constructor MUST be a _UPnP_ NetworkService object');\r\n\r\n        //    return this;\r\n\r\n        //}\r\n\r\n        //this.svcType = this.svc.type.replace('upnp:', '');\r\n        this.svcType = this.svc.serviceType;\r\n        this.svcUrl = this.svc.url;\r\n\r\n        var self = this;\r\n\r\n        // Full API\r\n        this.action = function (upnpAction, upnpParameters, callback) {\r\n\r\n            return new WinJS.Promise(function (promiseComplete, promiseError) {\r\n\r\n                // Handle .action( name, callback )\r\n                if (!callback && Object.prototype.toString.call(upnpParameters) == '[object Function]') {\r\n                    callback = upnpParameters;\r\n                    upnpParameters = {};\r\n                }\r\n\r\n                // Generate a callback stub if a Function has not been provided\r\n                if (!callback || Object.prototype.toString.call(callback) !== '[object Function]') {\r\n                    callback = function (e, response) { };\r\n                }\r\n\r\n                // Create a UPnP XML Request message\r\n                var svcMsg = self.createRequest(self.svcType, upnpAction, upnpParameters);\r\n\r\n                // Send the UPnP XML Request message to the current service\r\n                self.sendRequest(self.svcType, upnpAction, self.svcUrl, svcMsg, function (e, xmlResponse) {\r\n\r\n                    if (e !== null) {\r\n                        callback.apply(self, [e, null]);\r\n                        promiseError(e);\r\n                        return;\r\n                    }\r\n\r\n                    // Parse UPnP XML Response message\r\n                    self.handleResponse(upnpAction, xmlResponse.responseXML || \"\", upnpParameters, function (e, upnpResponse) {\r\n\r\n                        // Fire callback\r\n                        callback.apply(self, [e, upnpResponse]);\r\n\r\n                        // Fire promise\r\n                        if (e !== null) {\r\n                            promiseError(e);\r\n                        } else {\r\n                            promiseComplete(upnpResponse);\r\n                        }\r\n\r\n                    });\r\n\r\n                });\r\n            });\r\n        }\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.constructor = WinJSContrib.UPnP.UPnPService;\r\n\r\n    // UPnP XML MESSAGING TEMPLATES\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.requestTemplate = \"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?>\\n\" +\r\n     \"<s:Envelope s:encodingStyle=\\\"http://schemas.xmlsoap.org/soap/encoding/\\\" \" +\r\n       \"xmlns:s=\\\"http://schemas.xmlsoap.org/soap/envelope/\\\">\\n\" +\r\n       \"\\t<s:Body>\\n\" +\r\n         \"\\t\\t<u:{ACTION_NAME} xmlns:u=\\\"{ACTION_TYPE}\\\">\\n\" +\r\n           \"{ACTION_VARS}\" +\r\n         \"\\t\\t</u:{ACTION_NAME}>\\n\" +\r\n       \"\\t</s:Body>\\n\" +\r\n     \"</s:Envelope>\\n\";\r\n\r\n    // UPNP PRIMITIVE VARIABLE TYPE CHECKERS\r\n    // from http://upnp.org/specs/arch/UPnP-arch-DeviceArchitecture-v1.0.pdf\r\n    WinJSContrib.UPnP.UPnPService.prototype.types = {\r\n\r\n        \"i1\": function (val, allowedValues, toNative) {\r\n            var i8 = new Int8Array(1);\r\n            i8[0] = val;\r\n\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(i8[0], allowedValues);\r\n\r\n        },\r\n\r\n        \"i2\": function (val, allowedValues, toNative) {\r\n            var i16 = new Int16Array(1);\r\n            i16[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(i16[0], allowedValues);\r\n        },\r\n\r\n        \"i4\": function (val, allowedValues, toNative) {\r\n            var i32 = new Int32Array(1);\r\n            i32[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(i32[0], allowedValues);\r\n        },\r\n\r\n        \"ui1\": function (val, allowedValues, toNative) {\r\n            var ui8 = new Uint8Array(1);\r\n            ui8[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(ui8[0], allowedValues);\r\n        },\r\n\r\n        \"ui2\": function (val, allowedValues, toNative) {\r\n            var ui16 = new Uint16Array(1);\r\n            ui16[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(ui16[0], allowedValues);\r\n        },\r\n\r\n        \"ui4\": function (val, allowedValues, toNative) {\r\n            var ui32 = new Uint32Array(1);\r\n            ui32[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(ui32[0], allowedValues);\r\n        },\r\n\r\n        \"int\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || isNaN(val)) {\r\n                val = 0;\r\n            } else if (typeof val !== 'number') {\r\n                if (val === true) {\r\n                    val = 1;\r\n                } else {\r\n                    val = parseInt(val + \"\", 10);\r\n                }\r\n            }\r\n            if (!toNative) {\r\n                val = expandExponential(val + \"\");\r\n            }\r\n            if (isNaN(val)) val = 0;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n        },\r\n\r\n        \"r4\": function (val, allowedValues, toNative) {\r\n            var f32 = new Float32Array(1);\r\n            f32[0] = val;\r\n            if (!toNative) {\r\n                return f32[0] ? expandExponential(f32[0] + \"\") : \"0\";\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(f32[0], allowedValues);\r\n        },\r\n\r\n        \"r8\": function (val, allowedValues, toNative) {\r\n            var f64 = new Float64Array(1);\r\n            f64[0] = val;\r\n            if (!toNative) {\r\n                return f64[0] ? expandExponential(f64[0] + \"\") : \"0\";\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(f64[0], allowedValues);\r\n        },\r\n\r\n        \"number\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['r8'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"fixed_14_4\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['float'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"float\": function (val, allowedValues, toNative) {\r\n            var _float = parseFloat(val);\r\n            if (!toNative) {\r\n                return _float ? expandExponential(_float + \"\") : \"0\";\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(_float, allowedValues);\r\n        },\r\n\r\n        \"char\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            } else if (val === false || val === true || val == \"true\" || val == \"yes\" || val == \"false\" || val == \"no\") {\r\n                val = (val === true || val == \"true\" || val == \"yes\") ? \"1\" : \"0\";\r\n            } else {\r\n                val = val.toString();\r\n            }\r\n            if (val.length > 0) {\r\n                val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n                return val.charAt(0);\r\n            }\r\n            return val;\r\n        },\r\n\r\n        \"string\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            val = val + \"\";\r\n\r\n            val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n            return val;\r\n        },\r\n\r\n        \"xmlObj\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            val = val + \"\";\r\n\r\n            val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n            try {\r\n                var s = '';\r\n\r\n                var currentPos = val.indexOf('&');\r\n                while (currentPos > 0) {\r\n                    var idx = val.indexOf(';', currentPos);\r\n                    if (idx < 0 || (idx - currentPos) > 5) {\r\n                        val = val.substr(0, currentPos) + \"&amp;\" + val.substr(currentPos + 1, val.length - (currentPos + 1));\r\n                    }\r\n                    currentPos = val.indexOf('&', currentPos + 1);\r\n                }\r\n\r\n                var xml = parseXML(val);\r\n                return xmlToJson(xml);\r\n            } catch (exception) {\r\n                console.error(exception);\r\n                return val;\r\n            }\r\n        },\r\n\r\n        \"date\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"dateTime\": function (val, allowedValues, toNative) {\r\n            if (toNative) { // Parse to ECMA Date object\r\n                if (Object.prototype.toString.call(val) == '[object String]') {\r\n                    val = new Date(parseDate(val));\r\n                    if (isNaN(val)) val = \"\";\r\n                } else if (Object.prototype.toString.call(val) == '[object Date]') {\r\n                    val = val;\r\n                }\r\n            } else { // Parse to ISO-8601 string\r\n                if (Object.prototype.toString.call(val) == '[object String]') {\r\n                    val = val + \"\";\r\n                } else if (Object.prototype.toString.call(val) == '[object Date]') {\r\n                    if (val.toString() == \"Invalid Date\") { // opera specific functionality\r\n                        val = \"\";\r\n                    } else {\r\n                        val = val.toISOString();\r\n                    }\r\n                }\r\n            }\r\n            val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n            return val;\r\n        },\r\n\r\n        \"dateTime_tz\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"time\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"time_tz\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"boolean\": function (val, allowedValues, toNative) {\r\n            if (val == 'false' || val == 'f' || val == 'no' || val == 'n' || val instanceof RegExp || val <= 0 || !val) {\r\n                if (toNative) {\r\n                    val = false;\r\n                } else {\r\n                    val = \"0\";\r\n                }\r\n            } else {\r\n                if (toNative) {\r\n                    val = true;\r\n                } else {\r\n                    val = \"1\";\r\n                }\r\n            }\r\n            return val;\r\n        },\r\n\r\n        \"bin_base64\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            if (val === true || val === false) {\r\n                val = val === true ? \"1\" : \"0\";\r\n            }\r\n            if (toNative) { // convert to string\r\n                val = atob(val + \"\");\r\n            } else { // convert to base64\r\n                val = btoa(val + \"\");\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n        },\r\n\r\n        \"bin_hex\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            if (val === true || val === false) {\r\n                val = val === true ? \"1\" : \"0\";\r\n            }\r\n            if (toNative) { // convert to string\r\n                val = htoa(val + \"\");\r\n            } else { // convert to hex\r\n                val = atoh(val + \"\");\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n        },\r\n\r\n        \"uri\": function (val, allowedValues, toNative) {\r\n            if (toNative) {\r\n                val = decodeURI(val + \"\");\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['string'](val, allowedValues); // No URI syntax checking\r\n        },\r\n\r\n        \"uuid\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['string'](val, allowedValues); // No UUID syntax checking\r\n        }\r\n\r\n    };\r\n\r\n    // Override .types toString function\r\n    for (var type in WinJSContrib.UPnP.UPnPService.prototype.types) {\r\n        WinJSContrib.UPnP.UPnPService.prototype.types[type]._name = type;\r\n        WinJSContrib.UPnP.UPnPService.prototype.types[type][\"toString\"] = function () { return this._name; };\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.createRequest = function (upnpServiceType, upnpActionName, parameters) {\r\n\r\n        parameters = this.formatParameters(parameters);\r\n\r\n        this.debugLog('Creating UPnP XML Control Message for [' + upnpActionName + '] with parameters:');\r\n        this.debugLog(JSON ? JSON.stringify(parameters) : null);\r\n\r\n        // Build basic part of XML request\r\n        var svcMsg = this.requestTemplate.replace(/\\{ACTION_TYPE\\}/g, encodeXML(trim(upnpServiceType)));\r\n\r\n        svcMsg = svcMsg.replace(/\\{ACTION_NAME\\}/g, encodeXML(trim(upnpActionName)));\r\n\r\n        var svcInParams = parameters['request'],\r\n            svcInParams_xml = \"\";\r\n\r\n        if (svcInParams) {\r\n\r\n            // Generate XML parameters syntax\r\n            for (var svcParam in svcInParams) {\r\n\r\n                // Perform type checking sanitization\r\n                if (svcInParams[svcParam]['type'] !== undefined && svcInParams[svcParam]['type'] !== null) {\r\n\r\n                    // get the primitive sanitization function\r\n                    var typeCheck = this.types[svcInParams[svcParam]['type']];\r\n\r\n                    if (typeCheck) {\r\n                        svcInParams[svcParam]['value'] = typeCheck(svcInParams[svcParam]['value'], svcInParams[svcParam]['allowedValueList'], false);\r\n                    }\r\n\r\n                }\r\n\r\n                if (svcInParams[svcParam]['value'] === null || svcInParams[svcParam]['value'] === undefined) {\r\n\r\n                    svcInParams[svcParam]['value'] = \"\"; // pass through empty value\r\n\r\n                }\r\n\r\n                svcInParams_xml += \"\\t\\t\\t<\" + svcParam + \">\" + encodeXML(trim(svcInParams[svcParam]['value'] + \"\")) + \"</\" + svcParam + \">\\n\";\r\n\r\n            }\r\n\r\n        }\r\n\r\n        // Add ACTION_VARS, if any\r\n        svcMsg = svcMsg.replace(/\\{ACTION_VARS\\}/g, svcInParams_xml);\r\n\r\n        // DEBUG\r\n        this.debugLog('[REQUEST] (SOAPAction: ' + upnpServiceType + '#' + upnpActionName + ') ' + svcMsg);\r\n\r\n        return svcMsg;\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.sendRequest = function (upnpServiceType, upnpActionName, upnpEndpointURL, upnpRequestXML, onUPnPResponse) {\r\n\r\n        var soapaction = '\\\"' + upnpServiceType.replace(/[\\\"\\#]/g, '') + '#' + upnpActionName.replace(/[\\\"\\#]/g, '') + '\\\"'\r\n        var httpClient = new Windows.Web.Http.HttpClient();\r\n        var uri = new Windows.Foundation.Uri(upnpEndpointURL);\r\n        var request = new Windows.Web.Http.HttpRequestMessage(Windows.Web.Http.HttpMethod.post, uri);\r\n        request.headers.append('SOAPACTION', soapaction);\r\n        //request.headers.append('Content-Type', 'text/xml; charset=\"utf-8\";');        \r\n\r\n        request.content = new Windows.Web.Http.HttpStringContent(upnpRequestXML, Windows.Storage.Streams.UnicodeEncoding.utf8, \"text/xml\");\r\n\r\n        httpClient.sendRequestAsync(request).then(function (r) {\r\n            var content = r.content.readAsStringAsync().then(function (text) {\r\n                var xml = parseXML(text);\r\n                var r = {\r\n                    status: 200,\r\n                    responseText: text,\r\n                    responseXML: xml\r\n                };\r\n                onUPnPResponse.apply(this, [null, r]);\r\n            });\r\n\r\n        }, function (err) {\r\n            onUPnPResponse.apply(undefined, [new UPnPError('XmlHttpRequest failed'), null]);\r\n        });\r\n\r\n        return this;\r\n\r\n        try {\r\n\r\n            var xhr = new XMLHttpRequest();\r\n\r\n            xhr.open('POST', upnpEndpointURL);\r\n            xhr.setRequestHeader('Content-Type', 'text/xml; charset=\"utf-8\";');\r\n            xhr.setRequestHeader('action', soapaction);\r\n            xhr.setRequestHeader('zurgl', soapaction);\r\n            xhr.setRequestHeader('SOAPAction', soapaction);\r\n\r\n            xhr.onabort = xhr.onerror = function () {\r\n\r\n                onUPnPResponse.apply(undefined, [new UPnPError('XmlHttpRequest failed'), null]);\r\n\r\n                //xhrManager.release(xhr);\r\n\r\n            };\r\n\r\n            var self = this;\r\n\r\n            xhr.onreadystatechange = function () {\r\n\r\n                if (this.readyState < 4) return;\r\n\r\n                if (this.status !== 200) {\r\n\r\n                    onUPnPResponse.apply(undefined, [new UPnPError('XmlHttpRequest expected 200 OK. Received ' + this.status + ' response.'), null]);\r\n\r\n                    self.debugLog(\"[ERROR-RESPONSE] \" + this.responseText);\r\n\r\n                    //xhrManager.release(xhr);\r\n\r\n                    return;\r\n\r\n                }\r\n\r\n                self.debugLog(\"[SUCCESS-RESPONSE] \" + this.responseText);\r\n\r\n                onUPnPResponse.apply(this, [null, this]);\r\n\r\n                //xhrManager.release(xhr);\r\n\r\n            };\r\n\r\n            xhr.send(upnpRequestXML);\r\n\r\n        } catch (e) {\r\n\r\n            onUPnPResponse.apply(undefined, [new UPnPError(e), null]);\r\n\r\n        }\r\n\r\n        return this; // allow method chaining\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.handleResponse = function (upnpActionName, upnpResponseXML, parameters, onUPnPResolved) {\r\n\r\n        parameters = this.formatParameters(parameters);\r\n\r\n        var svcOutParams = parameters['response'];\r\n\r\n        var responseJSON = {};\r\n\r\n        // Process all XML response variables\r\n        var responseContainer = upnpResponseXML.getElementsByTagName ?\r\n                                  upnpResponseXML.getElementsByTagName(upnpActionName + \"Response\") : null;\r\n\r\n        // If we don't have any response variables, try again with the namespace attached (required for lib to work in Firefox)\r\n        if (responseContainer === null || responseContainer.length <= 0) {\r\n            responseContainer = upnpResponseXML.getElementsByTagName ?\r\n                                      upnpResponseXML.getElementsByTagName(\"u:\" + upnpActionName + \"Response\") : null;\r\n        }\r\n\r\n        if (responseContainer !== null && responseContainer.length > 0) {\r\n\r\n            var responseVars = responseContainer[0].childNodes;\r\n\r\n            if (responseVars && responseVars.length > 0) {\r\n\r\n                for (var i = 0, l = responseVars.length; i < l; i++) {\r\n\r\n                    var varName = responseVars[i].nodeName;\r\n                    var varVal = responseVars[i].firstChild ? trim(decodeXML(responseVars[i].firstChild.nodeValue + \"\")) : null;\r\n\r\n                    // Perform type checking sanitization if requested\r\n                    if (svcOutParams[varName] && svcOutParams[varName]['type'] !== undefined && svcOutParams[varName]['type'] !== null) {\r\n\r\n                        // get the primitive sanitization function\r\n                        var typeCheck = this.types[svcOutParams[varName]['type']];\r\n\r\n                        if (typeCheck) {\r\n                            varVal = typeCheck(varVal, svcOutParams[varName]['allowedValueList'] || null, true);\r\n                        }\r\n\r\n                    }\r\n\r\n                    responseJSON[varName] = (varVal !== undefined && varVal !== null) ? varVal : \"\";\r\n\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n\r\n        // Fire callback with the parsed action response data\r\n        onUPnPResolved.apply(undefined, [null, { data: responseJSON }]);\r\n\r\n        return this; // allow method chaining\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.formatParameter = function (parameter) {\r\n\r\n        var param = {};\r\n\r\n        if (parameter['type'] !== undefined || parameter['value'] !== undefined || parameter['allowedValueList'] !== undefined) {\r\n\r\n            param = parameter;\r\n\r\n            if (parameter['allowedValueList'] !== undefined && typeof parameter['allowedValueList'] !== 'array') {\r\n                parameter['allowedValueList'] = [];\r\n            }\r\n\r\n        } else {\r\n\r\n            param = { value: parameter };\r\n\r\n        }\r\n\r\n        // check type is valid, otherwise discard requested type\r\n        if (param['type'] !== undefined && param['type'] !== null) {\r\n\r\n            if (!this.types[(param['type'] + \"\")]) {\r\n\r\n                delete param['type'];\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return param;\r\n\r\n    };\r\n\r\n    // Normalize the input parameters argument\r\n    WinJSContrib.UPnP.UPnPService.prototype.formatParameters = function (parameters) {\r\n\r\n        if (parameters === undefined || parameters === null) {\r\n            parameters = {};\r\n        }\r\n\r\n        if (!parameters['request']) {\r\n            parameters['request'] = {};\r\n        }\r\n\r\n        if (!parameters['response']) {\r\n            parameters['response'] = {};\r\n        }\r\n\r\n        for (var param in parameters) {\r\n\r\n            if (param === 'request' || param === 'response') {\r\n\r\n                for (var processParam in parameters[param]) {\r\n\r\n                    parameters[param][processParam] = this.formatParameter(parameters[param][processParam]);\r\n\r\n                }\r\n\r\n            } else { // append as 'request' parameter and remove from root object\r\n\r\n                parameters['request'][param] = this.formatParameter(parameters[param]);\r\n\r\n                delete parameters[param];\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return parameters;\r\n\r\n    };\r\n\r\n    // ALLOWED VALUE LIST CHECKER\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues = function (val, allowedValueList) {\r\n\r\n        // Check against allowedValues if provided\r\n        if (val && allowedValueList && Object.prototype.toString.call(allowedValueList) == '[object Array]') {\r\n\r\n            var matchFound = false;\r\n\r\n            for (var i = 0, l = allowedValueList.length; i < l; i++) {\r\n\r\n                if (val == allowedValueList[i]) {\r\n\r\n                    matchFound = true;\r\n                    break;\r\n\r\n                }\r\n            }\r\n\r\n            if (!matchFound) {\r\n                return \"\";\r\n            }\r\n        }\r\n\r\n        return val;\r\n\r\n    };\r\n\r\n    // UPnP DEBUGGER\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.debugLog = function (msg, level) {\r\n        if ((this.options && this.options.debug)) {\r\n            console[level || 'log'](\"Plug.UPnP: \" + msg);\r\n        }\r\n    };\r\n\r\n    // UPnP ERROR OBJECT\r\n\r\n    var UPnPError = function (description) {\r\n        return {\r\n            'description': description\r\n        };\r\n    };\r\n\r\n    function parseXML(text) {\r\n        return (new DOMParser()).parseFromString(text, \"text/xml\");\r\n    }\r\n\r\n    // *** CUSTOM TYPE FUNCTIONS ***\r\n\r\n    // BASE64 FUNCTIONS\r\n    // (forked from https://github.com/dankogai/js-base64/blob/master/base64.js)\r\n\r\n    var b64chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\r\n\r\n    var b64tab = (function (bin) {\r\n        var t = {};\r\n        for (var i = 0, l = bin.length; i < l; i++) t[bin.charAt(i)] = i;\r\n        return t;\r\n    })(b64chars);\r\n\r\n    var cb_encode = function (ccc) {\r\n        var padlen = [0, 2, 1][ccc.length % 3],\r\n            ord = ccc.charCodeAt(0) << 16\r\n                | ((ccc.length > 1 ? ccc.charCodeAt(1) : 0) << 8)\r\n                | ((ccc.length > 2 ? ccc.charCodeAt(2) : 0)),\r\n            chars = [\r\n                b64chars.charAt(ord >>> 18),\r\n                b64chars.charAt((ord >>> 12) & 63),\r\n                padlen >= 2 ? '=' : b64chars.charAt((ord >>> 6) & 63),\r\n                padlen >= 1 ? '=' : b64chars.charAt(ord & 63)\r\n            ];\r\n        return chars.join('');\r\n    };\r\n\r\n    var cb_decode = function (cccc) {\r\n        var len = cccc.length,\r\n            padlen = len % 4,\r\n            n = (len > 0 ? b64tab[cccc.charAt(0)] << 18 : 0)\r\n              | (len > 1 ? b64tab[cccc.charAt(1)] << 12 : 0)\r\n              | (len > 2 ? b64tab[cccc.charAt(2)] << 6 : 0)\r\n              | (len > 3 ? b64tab[cccc.charAt(3)] : 0),\r\n            chars = [\r\n                String.fromCharCode(n >>> 16),\r\n                String.fromCharCode((n >>> 8) & 0xff),\r\n                String.fromCharCode(n & 0xff)\r\n            ];\r\n        chars.length -= [0, 0, 2, 1][padlen];\r\n        return chars.join('');\r\n    };\r\n\r\n    var btoa = global.btoa || function (b) {\r\n        return b.replace(/[\\s\\S]{1,3}/g, cb_encode);\r\n    };\r\n\r\n    var atob = global.atob || function (a) {\r\n        return a.replace(/[\\s\\S]{1,4}/g, cb_decode);\r\n    };\r\n\r\n    // HEX FUNCTIONS\r\n\r\n    var hexChars = '0123456789abcdef';\r\n\r\n    var hextab = (function (bin) {\r\n        var t = {};\r\n        for (var i = 0, l = bin.length; i < l; i++) t[i] = bin.charAt(i);\r\n        return t;\r\n    })(hexChars);\r\n\r\n    function toHex(n) {\r\n        var result = ''\r\n        var start = true;\r\n        for (var i = 32; i > 0;) {\r\n            i -= 4;\r\n            var digit = (n >> i) & 0xf;\r\n            if (!start || digit != 0) {\r\n                start = false;\r\n                result += hextab[digit];\r\n            }\r\n        }\r\n        return (result == '' ? '0' : result);\r\n    }\r\n\r\n    function pad(str, len, pad) {\r\n        var result = str;\r\n        for (var i = str.length; i < len; i++) {\r\n            result = pad + result;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function ntos(n) {\r\n        n = n.toString(16);\r\n        if (n.length == 1) n = \"0\" + n;\r\n        n = \"%\" + n;\r\n        return unescape(n);\r\n    }\r\n\r\n    function htoa(str) {\r\n        str = str.toUpperCase().replace(new RegExp(\"s/[^0-9A-Z]//g\"));\r\n        var result = \"\";\r\n        var nextchar = \"\";\r\n        for (var i = 0; i < str.length; i++) {\r\n            nextchar += str.charAt(i);\r\n            if (nextchar.length == 2) {\r\n                result += ntos(parseInt(nextchar, 16));\r\n                nextchar = \"\";\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function atoh(str) {\r\n        var result = \"\";\r\n        for (var i = 0; i < str.length; i++) {\r\n            result += pad(toHex(str.charCodeAt(i) & 0xff), 2, '0');\r\n        }\r\n        return result;\r\n    }\r\n\r\n    // NUMBER FUNCTIONS\r\n\r\n    function expandExponential(str) {\r\n        return str.replace(/^([+-])?(\\d+).?(\\d*)[eE]([-+]?\\d+)$/, function (x, s, n, f, c) {\r\n            var l = +c < 0, i = n.length + +c, x = (l ? n : f).length,\r\n            c = ((c = Math.abs(c)) >= x ? c - x + l : 0),\r\n            z = (new Array(c + 1)).join(\"0\"), r = n + f;\r\n            return (s || \"\") + (l ? r = z + r : r += z).substr(0, i += l ? z.length : 0) + (i < r.length ? \".\" + r.substr(i) : \"\");\r\n        });\r\n    };\r\n\r\n    // STRING FUNCTIONS\r\n\r\n    var trim = function (str) {\r\n        if (String.prototype.trim) {\r\n            return str.trim();\r\n        } else {\r\n            return str.replace(/^\\s+|\\s+$/g, \"\");\r\n        }\r\n    };\r\n\r\n    var encodeXML = function (str) {\r\n        return str.replace(/\\&/g, '&amp;')\r\n                   .replace(/</g, '&lt;')\r\n                   .replace(/>/g, '&gt;')\r\n                   .replace(/'/g, '&#39;')\r\n                   .replace(/\"/g, '&quot;');\r\n    };\r\n\r\n    var decodeXML = function (str) {\r\n        return str.replace(/\\&quot;/g, '\"')\r\n                   .replace(/\\&\\#39;/g, '\\'')\r\n                   .replace(/\\&gt;/g, '>')\r\n                   .replace(/\\&lt;/g, '<')\r\n                   .replace(/\\&amp;/g, '&');\r\n    };\r\n\r\n    /**\r\n     * Date.parse with progressive enhancement for ISO 8601 <https://github.com/csnover/js-iso8601>\r\n     * © 2011 Colin Snover <http://zetafleet.com>\r\n     * Released under MIT license.\r\n     *\r\n     * 2012 - Modifications to accept times without dates - by Rich Tibbett\r\n     */\r\n\r\n    var parseDate = function (date) {\r\n        var timestamp, struct, minutesOffset = 0, numericKeys = [1, 4, 5, 6, 7, 10, 11];\r\n\r\n        if (typeof date !== 'string') date += \"\";\r\n\r\n        if ((struct = /^((\\d{4}|[+\\-]\\d{6})(?:-(\\d{2})(?:-(\\d{2}))?)?)?(?:[T\\s]?(\\d{2}):(\\d{2})(?::(\\d{2})(?:\\.(\\d{3}))?)?(?:(Z)|([+\\-])(\\d{4}))?)?$/.exec(date))) {\r\n\r\n            struct = struct.slice(1, struct.length);\r\n\r\n            // avoid NaN timestamps caused by “undefined” values being passed to Date.UTC\r\n            for (var i = 0, k; (k = numericKeys[i]) ; ++i) {\r\n                struct[k] = +struct[k] || 0;\r\n            }\r\n\r\n            // allow undefined days and months\r\n            struct[2] = (+struct[2] || 1) - 1;\r\n            struct[3] = +struct[3] || 1;\r\n\r\n            if (struct[8] !== 'Z' && struct[9] !== undefined) {\r\n                minutesOffset = ((struct[10] / 100) - ((struct[10] / 100) % 1)) * 60 + (struct[10] % 100);\r\n\r\n                if (struct[9] === '+') {\r\n                    minutesOffset = 0 - minutesOffset;\r\n                }\r\n            }\r\n\r\n            timestamp = Date.UTC(struct[1], struct[2], struct[3], struct[4], struct[5] + minutesOffset, struct[6], struct[7]);\r\n        }\r\n        else {\r\n            timestamp = Date.parse ? Date.parse(date) : NaN;\r\n        }\r\n\r\n        return timestamp;\r\n    };\r\n\r\n    var allowedContentDirectoryTypes = {\r\n        'urn:schemas-upnp-org:service:ContentDirectory:1': true,\r\n        'urn:schemas-upnp-org:service:ContentDirectory:2': true,\r\n        'urn:schemas-upnp-org:service:ContentDirectory:3': true,\r\n        'urn:schemas-upnp-org:service:ContentDirectory:4': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPContentDirectory = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedContentDirectoryTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Media Server Service\");\r\n            return;\r\n        }\r\n\r\n        // *** ContentDirectory:1 methods\r\n\r\n        this.getSystemUpdateId = function (callback) {\r\n\r\n            return this.action('GetSystemUpdateID', {\r\n                request: {},\r\n                response: {\r\n                    Id: {\r\n                        type: this.types.ui4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getSearchCapabilities = function (callback) {\r\n\r\n            return this.action('GetSearchCapabilities', {\r\n                request: {},\r\n                response: {\r\n                    SearchCaps: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getSortCapabilities = function (callback) {\r\n\r\n            return this.action('GetSortCapabilities', {\r\n                request: {},\r\n                response: {\r\n                    SortCaps: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.browse = function (objectId, browseFlag, filter, startingIndex, requestedCount, sortCriteria, callback) {\r\n\r\n            return this.action('Browse', {\r\n                request: {\r\n                    ObjectID: {\r\n                        value: objectId || '0',\r\n                        type: this.types.string\r\n                    },\r\n                    BrowseFlag: {\r\n                        value: browseFlag || 'BrowseDirectChildren',\r\n                        type: this.types.string\r\n                    },\r\n                    Filter: {\r\n                        value: filter || '*',\r\n                        type: this.types.string\r\n                    },\r\n                    StartingIndex: {\r\n                        value: startingIndex || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    RequestedCount: {\r\n                        value: requestedCount || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    SortCriteria: {\r\n                        value: sortCriteria,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    Result: {\r\n                        type: this.types.xmlObj\r\n                    },\r\n                    NumberReturned: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    TotalMatches: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    UpdateID: {\r\n                        type: this.types.ui4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.search = function (objectId, browseFlag, filter, startingIndex, requestedCount, sortCriteria, callback) {\r\n\r\n            return this.action('Search', {\r\n                request: {\r\n                    ObjectID: {\r\n                        value: objectId || '0',\r\n                        type: this.types.string\r\n                    },\r\n                    BrowseFlag: {\r\n                        value: browseFlag || 'BrowseDirectChildren',\r\n                        type: this.types.string\r\n                    },\r\n                    Filter: {\r\n                        value: filter || '*',\r\n                        type: this.types.string\r\n                    },\r\n                    StartingIndex: {\r\n                        value: startingIndex || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    RequestedCount: {\r\n                        value: requestedCount || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    SortCriteria: {\r\n                        value: sortCriteria,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    Result: {\r\n                        type: this.types.xmlObj\r\n                    },\r\n                    NumberReturned: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    TotalMatches: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    UpdateID: {\r\n                        type: this.types.ui4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n\r\n        // *** ContentDirectory:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ContentDirectory:2') {\r\n\r\n            // TODO: GetFeatureList, GetSortExtensionCapabilities, MoveObject\r\n\r\n        }\r\n\r\n\r\n        // *** ContentDirectory:3 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ContentDirectory:3') {\r\n\r\n            // TODO\r\n\r\n        }\r\n\r\n        // *** ContentDirectory:4 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ContentDirectory:4') {\r\n            // TODO\r\n        }\r\n    };\r\n    WinJSContrib.UPnP.UPnPContentDirectory.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n    var allowedConnectionManagerTypes = {\r\n        'urn:schemas-upnp-org:service:ConnectionManager:1': true,\r\n        'urn:schemas-upnp-org:service:ConnectionManager:2': true,\r\n        'urn:schemas-upnp-org:service:ConnectionManager:3': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPConnectionManager = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedConnectionManagerTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Service\");\r\n            return;\r\n        }\r\n\r\n        // *** ConnectionManager:1 methods\r\n\r\n        this.getCurrentConnectionIDs = function (callback) {\r\n\r\n            return this.action('GetCurrentConnectionIDs', {\r\n                request: {},\r\n                response: {\r\n                    ConnectionIDs: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getCurrentConnectionInfo = function (connectionId, callback) {\r\n\r\n            return this.action('GetCurrentConnectionInfo', {\r\n                request: {\r\n                    ConnectionID: {\r\n                        value: connectionId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    RcsID: {\r\n                        type: this.types.i4\r\n                    },\r\n                    AVTransportID: {\r\n                        type: this.types.i4\r\n                    },\r\n                    ProtocolInfo: {\r\n                        type: this.types.string\r\n                    },\r\n                    PeerConnectionManager: {\r\n                        type: this.types.string\r\n                    },\r\n                    PeerConnectionID: {\r\n                        type: this.types.i4\r\n                    },\r\n                    Direction: {\r\n                        type: this.types.string\r\n                    },\r\n                    Status: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getProtocolInfo = function (callback) {\r\n\r\n            return this.action('GetProtocolInfo', {\r\n                request: {},\r\n                response: {\r\n                    Source: {\r\n                        type: this.types.string\r\n                    },\r\n                    Sink: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        // *** ConnectionManager:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ConnectionManager:2') {\r\n            // TODO\r\n        }\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPConnectionManager.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n    var allowedAVTransportTypes = {\r\n        'urn:schemas-upnp-org:service:AVTransport:1': true,\r\n        'urn:schemas-upnp-org:service:AVTransport:2': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPAVTransport = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedAVTransportTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Media Renderer Service\");\r\n            return;\r\n        }\r\n\r\n        // *** AVTransport:1 methods\r\n\r\n        this.getDeviceCapabilities = function (instanceId, callback) {\r\n\r\n            return this.action('GetDeviceCapabilities', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    PlayMedia: {\r\n                        type: this.types.string\r\n                    },\r\n                    RecMedia: {\r\n                        type: this.types.string\r\n                    },\r\n                    RecQualityModes: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getMediaInfo = function (instanceId, callback) {\r\n\r\n            return this.action('GetMediaInfo', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    NrTracks: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    MediaDuration: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentURI: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentURIMetaData: {\r\n                        type: this.types.string\r\n                    },\r\n                    NextURI: {\r\n                        type: this.types.string\r\n                    },\r\n                    NextURIMetaData: {\r\n                        type: this.types.string\r\n                    },\r\n                    PlayMedium: {\r\n                        type: this.types.string\r\n                    },\r\n                    RecordMedium: {\r\n                        type: this.types.string\r\n                    },\r\n                    WriteStatus: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getPositionInfo = function (instanceId, callback) {\r\n\r\n            return this.action('GetPositionInfo', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    Track: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    TrackDuration: {\r\n                        type: this.types.string\r\n                    },\r\n                    TrackMetaData: {\r\n                        type: this.types.xmlObj\r\n                    },\r\n                    TrackURI: {\r\n                        type: this.types.string\r\n                    },\r\n                    RelTime: {\r\n                        type: this.types.string\r\n                    },\r\n                    AbsTime: {\r\n                        type: this.types.string\r\n                    },\r\n                    RelCount: {\r\n                        type: this.types.i4\r\n                    },\r\n                    AbsCount: {\r\n                        type: this.types.i4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getTransportInfo = function (instanceId, callback) {\r\n\r\n            return this.action('GetTransportInfo', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentTransportState: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentTransportStatus: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentSpeed: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getTransportSettings = function (instanceId, callback) {\r\n\r\n            return this.action('GetTransportSettings', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    PlayMode: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    RecQualityMode: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setAVTransportURI = function (instanceId, currentURI, currentURIMetaData, callback) {\r\n\r\n            return this.action('SetAVTransportURI', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    CurrentURI: {\r\n                        value: currentURI,\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentURIMetaData: {\r\n                        value: currentURIMetaData,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.play = function (instanceId, speed, callback) {\r\n\r\n            return this.action('Play', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Speed: {\r\n                        value: speed || '1',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.pause = function (instanceId, callback) {\r\n\r\n            return this.action('Pause', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.stop = function (instanceId, callback) {\r\n\r\n            return this.action('Stop', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.next = function (instanceId, callback) {\r\n\r\n            return this.action('Next', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.previous = function (instanceId, callback) {\r\n\r\n            return this.action('Previous', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.seek = function (instanceId, unit, target, callback) {\r\n\r\n            return this.action('Seek', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Unit: {\r\n                        value: unit,\r\n                        type: this.types.string\r\n                    },\r\n                    Target: {\r\n                        value: target,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        // *** AVTransport:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:AVTransport:2') {\r\n\r\n            // TODO\r\n\r\n        }\r\n    };\r\n    WinJSContrib.UPnP.UPnPAVTransport.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n    var allowedRenderingControlTypes = {\r\n        'urn:schemas-upnp-org:service:RenderingControl:1': true,\r\n        'urn:schemas-upnp-org:service:RenderingControl:2': true,\r\n        'urn:schemas-upnp-org:service:RenderingControl:3': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPRenderingControl = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedRenderingControlTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Media Renderer Service\");\r\n            return;\r\n        }\r\n\r\n        // *** RenderingControl:1 methods\r\n\r\n        this.listPresets = function (instanceId, callback) {\r\n\r\n            return this.action('ListPresets', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentPresetNameList: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.selectPreset = function (instanceId, presetName, callback) {\r\n\r\n            return this.action('SelectPreset', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    PresetName: {\r\n                        value: presetName || \"FactoryDefaults\",\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBrightness = function (instanceId, callback) {\r\n\r\n            return this.action('GetBrightness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBrightness: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setBrightness = function (instanceId, desiredBrightness, callback) {\r\n\r\n            return this.action('SetBrightness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredBrightness: {\r\n                        value: desiredBrightness,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getContrast = function (instanceId, callback) {\r\n\r\n            return this.action('GetContrast', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentContrast: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setContrast = function (instanceId, desiredContrast, callback) {\r\n\r\n            return this.action('SetContrast', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredContrast: {\r\n                        value: desiredContrast,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getSharpness = function (instanceId, callback) {\r\n\r\n            return this.action('GetSharpness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentSharpness: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setSharpness = function (instanceId, desiredSharpness, callback) {\r\n\r\n            return this.action('SetSharpness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredSharpness: {\r\n                        value: desiredSharpness,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getRedVideoGain = function (instanceId, callback) {\r\n\r\n            return this.action('GetRedVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentRedVideoGain: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setRedVideoGain = function (instanceId, desiredRedVideoGain, callback) {\r\n\r\n            return this.action('SetRedVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredRedVideoGain: {\r\n                        value: desiredRedVideoGain,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getGreenVideoGain = function (instanceId, callback) {\r\n\r\n            return this.action('GetGreenVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentGreenVideoGain: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setGreenVideoGain = function (instanceId, desiredGreenVideoGain, callback) {\r\n\r\n            return this.action('SetGreenVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredGreenVideoGain: {\r\n                        value: desiredGreenVideoGain,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBlueVideoGain = function (instanceId, callback) {\r\n\r\n            return this.action('GetBlueVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBlueVideoGain: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setBlueVideoGain = function (instanceId, desiredBlueVideoGain, callback) {\r\n\r\n            return this.action('SetBlueVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredBlueVideoGain: {\r\n                        value: desiredBlueVideoGain,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getRedVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetRedVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentRedVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setRedVideoBlackLevel = function (instanceId, desiredRedVideoBlackLevel, callback) {\r\n\r\n            return this.action('SetRedVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredRedVideoBlackLevel: {\r\n                        value: desiredRedVideoBlackLevel,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getGreenVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetGreenVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentGreenVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setGreenVideoBlackLevel = function (instanceId, desiredGreenVideoBlackLevel, callback) {\r\n\r\n            return this.action('SetGreenVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredGreenVideoBlackLevel: {\r\n                        value: desiredGreenVideoBlackLevel,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBlueVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetBlueVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBlueVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setBlueVideoBlackLevel = function (instanceId, desiredBlueVideoBlackLevel, callback) {\r\n\r\n            return this.action('SetBlueVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredBlueVideoBlackLevel: {\r\n                        value: desiredBlueVideoBlackLevel,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBlueVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetBlueVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBlueVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getColorTemperature = function (instanceId, callback) {\r\n\r\n            return this.action('GetColorTemperature', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentColorTemperature: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setColorTemperature = function (instanceId, desiredColorTemperature, callback) {\r\n\r\n            return this.action('SetColorTemperature', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredColorTemperature: {\r\n                        value: desiredColorTemperature,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getHorizontalKeystone = function (instanceId, callback) {\r\n\r\n            return this.action('GetHorizontalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentHorizontalKeystone: {\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setHorizontalKeystone = function (instanceId, desiredHorizontalKeystone, callback) {\r\n\r\n            return this.action('SetHorizontalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredHorizontalKeystone: {\r\n                        value: desiredHorizontalKeystone,\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVerticalKeystone = function (instanceId, callback) {\r\n\r\n            return this.action('GetVerticalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentVerticalKeystone: {\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setVerticalKeystone = function (instanceId, desiredVerticalKeystone, callback) {\r\n\r\n            return this.action('SetVerticalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredVerticalKeystone: {\r\n                        value: desiredVerticalKeystone,\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getMute = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetMute', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentMute: {\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setMute = function (instanceId, channel, desiredMute, callback) {\r\n\r\n            return this.action('SetMute', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredMute: {\r\n                        value: desiredMute,\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVolume = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetVolume', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentVolume: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setVolume = function (instanceId, channel, desiredVolume, callback) {\r\n\r\n            return this.action('SetVolume', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredVolume: {\r\n                        value: desiredVolume,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVolumeDB = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetVolumeDB', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentVolume: {\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setVolumeDB = function (instanceId, channel, desiredVolume, callback) {\r\n\r\n            return this.action('SetVolumeDB', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredVolume: {\r\n                        value: desiredVolume,\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVolumeDBRange = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetVolumeDBRange', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    MinValue: {\r\n                        type: this.types.i2\r\n                    },\r\n                    MaxValue: {\r\n                        type: this.types.i2\r\n                    },\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getLoudness = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetLoudness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentLoudness: {\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setLoudness = function (instanceId, channel, desiredLoudness, callback) {\r\n\r\n            return this.action('SetLoudness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredLoudness: {\r\n                        value: desiredLoudness,\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        // *** RenderingControl:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:RenderingControl:2' ||\r\n              this.upnpType === 'urn:schemas-upnp-org:service:RenderingControl:3') {\r\n\r\n            this.getStateVariables = function (instanceId, stateVariableList, callback) {\r\n\r\n                return this.action('GetStateVariables', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        },\r\n                        StateVariableList: {\r\n                            value: stateVariableList,\r\n                            type: this.types.string\r\n                        }\r\n                    },\r\n                    response: {\r\n                        StateVariableValuePairs: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.setStateVariables = function (instanceId, renderingControlUDN, serviceType, serviceId, stateVariableValuePairs, callback) {\r\n\r\n                return this.action('SetStateVariables', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        },\r\n                        RenderingControlUDN: {\r\n                            value: renderingControlUDN,\r\n                            type: this.types.string\r\n                        },\r\n                        ServiceType: {\r\n                            value: serviceType,\r\n                            type: this.types.string\r\n                        },\r\n                        ServiceId: {\r\n                            value: serviceId,\r\n                            type: this.types.string\r\n                        },\r\n                        StateVariableValuePairs: {\r\n                            value: stateVariableValuePairs,\r\n                            type: this.types.string\r\n                        }\r\n                    },\r\n                    response: {\r\n                        StateVariableList: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n        }\r\n\r\n        // *** RenderingControl:3 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:RenderingControl:3') {\r\n\r\n            this.getAllowedTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetAllowedTransforms', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        }\r\n                    },\r\n                    response: {\r\n                        CurrentAllowedTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetTransforms', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        }\r\n                    },\r\n                    response: {\r\n                        CurrentTransformValues: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.setTransforms = function (instanceId, desiredTransformValues, callback) {\r\n\r\n                return this.action('SetTransforms', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        },\r\n                        DesiredTransformValues: {\r\n                            value: desiredTransformValues,\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getAllAvailableTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetAllAvailableTransforms', {\r\n                    response: {\r\n                        AllAllowedTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getAllowedDefaultTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetAllowedDefaultTransforms', {\r\n                    response: {\r\n                        AllowedDefaultTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getDefaultTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetDefaultTransforms', {\r\n                    response: {\r\n                        CurrentDefaultTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.setDefaultTransforms = function (instanceId, desiredDefaultTransformSettings, callback) {\r\n\r\n                return this.action('SetDefaultTransforms', {\r\n                    request: {\r\n                        DesiredDefaultTransformSettings: {\r\n                            value: desiredDefaultTransformSettings,\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n        }\r\n\r\n    };\r\n    WinJSContrib.UPnP.UPnPRenderingControl.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n})(window);","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib;\r\n(function (WinJSContrib) {\r\n    'use strict';\r\n\r\n    /**\r\n     * Custom WinJS Bindings\r\n     * @namespace WinJSContrib.Bindings\r\n     */\r\n    (function (Bindings) {\r\n\r\n        /**\r\n         * path for default picture\r\n         */\r\n        WinJSContrib.Bindings.pictureUnavailable = '/images/unavailable.png';\r\n\r\n        /**\r\n         * Helper for reading arguments for an element\r\n         * @param {HTMLElement} element\r\n         * @param {string} argument name\r\n         */\r\n        WinJSContrib.Bindings.bindingArguments = function bindingArguments(elt, argname) {\r\n            var data;\r\n            if (WinJS.UI._optionsParser) {\r\n                var text = elt.getAttribute(\"data-win-bind-args\");\r\n                if (text) {\r\n                    data = WinJS.UI.optionsParser(text, window);\r\n                }\r\n            } else {\r\n                data = elt.dataset.winBindArgs;\r\n            }\r\n\r\n            if (data) {\r\n                if (argname) {\r\n                    return data[argname];\r\n                } else {\r\n                    return data;\r\n                }\r\n            }\r\n        };\r\n        var bindingArguments = WinJSContrib.Bindings.bindingArguments;\r\n\r\n        /**\r\n         * Binding function to remove HTML from data and add it to destination\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.removeHTML = WinJS.Binding.initializer(function (source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            var elt = document.createElement('DIV');\r\n            elt.innerHTML = data;\r\n            WinJS.Binding.oneTime({ value: elt.innerText }, ['value'], dest, [destProperty]);\r\n        });\r\n\r\n        /**\r\n         * Binding function to remove HTML from data and add it to destination with an ellipse after X characters. The number of characters is specified with \"ellipsisize\" argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.removeHTMLAndEllipsisize = WinJS.Binding.initializer(function (source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            var elt = document.createElement('DIV');\r\n            elt.innerHTML = data;\r\n            var textRes = elt.innerText;\r\n            var size = bindingArguments(dest, 'ellipsisize');\r\n\r\n            if (size)\r\n                textRes = toStaticHTML(WinJSContrib.Utils.ellipsisizeString(elt.innerText, size, true));\r\n            WinJS.Binding.oneTime({ value: textRes }, ['value'], dest, [destProperty]);\r\n        });\r\n\r\n        /**\r\n         * Binding function to remove HTML from data and add it to destination with an ellipse after X characters. The number of characters is specified with \"ellipsisize\" argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.staticHTML = WinJS.Binding.initializer(function (source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            dest[destProperty] = toStaticHTML(data);\r\n        });\r\n\r\n        /**\r\n         * Binding function to add a data-* attribute to the element. Use the destination name to specifiy attribute name\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         * @example\r\n         * //assuming object is { myproperty: 42 }\r\n         * <div data-win-bind=\"foo : myproperty WinJSContrib.Bindings.dataAttr\"></div>\r\n         * //will result to\r\n         * <div data-foo=\"42\" data-win-bind=\"foo : myproperty WinJSContrib.Bindings.dataAttr\"></div>\r\n         */\r\n        WinJSContrib.Bindings.dataAttr = WinJS.Binding.initializer(function dataAttrBinding(source, sourceProperty, dest, destProperty) {\r\n        \tvar data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n        \tdest.setAttribute('data-' + destProperty, data)\r\n        });\r\n\r\n        /**\r\n         * Binding function to add css class named after object property. You could format class by using a \"format\" argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.addClass = WinJS.Binding.initializer(function addClassBinding(source, sourceProperty, dest, destProperty) {\r\n            function setClass(newval, oldval) {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                var formatParameter = bindingArguments(dest, 'format');\r\n                if (formatParameter) {\r\n                    dest.classList.remove(formatParameter.format(oldval));\r\n                    dest.classList.add(formatParameter.format(data));\r\n                }\r\n                else {\r\n                    dest.classList.remove(oldval);\r\n                    dest.classList.add(data);\r\n                }\r\n            }\r\n\r\n            var bindingDesc = {};\r\n            bindingDesc[sourceProperty] = setClass;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * add css class based on a prefix defined with destProperty and the value from the source object\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.asClass = WinJS.Binding.initializer(function asClassBinding(source, sourceProperty, dest, destProperty) {\r\n            function setClass(newval, oldval) {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                dest.classList.remove(destProperty + '-' + oldval);\r\n                dest.classList.add(destProperty + '-' + data);\r\n            }\r\n            var bindingDesc = {};\r\n            bindingDesc[sourceProperty] = setClass;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * convert a url string for use as a background image url\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.toBgImage = WinJS.Binding.initializer(function toBgImageBinding(source, sourceProperty, dest, destProperty) {\r\n            function setImage() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data || !data.length) {\r\n                    dest.style.backgroundImage = '';\r\n                    return;\r\n                }\r\n                dest.style.backgroundImage = 'url(\"' + data + '\")';\r\n            }\r\n\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setImage;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n\r\n        WinJSContrib.Bindings.ToRealDate = WinJS.Binding.initializer(function ToRealDateBinding(source, sourceProperty, dest, destProperty) {\r\n            var date = new Date(source.date * 1000);\r\n            dest.innerHTML = date.toLocaleDateString();\r\n        });\r\n\r\n        function _setPic(dest, url) {\r\n            if (dest.nodeName.toLowerCase() == 'img') {\r\n                dest.src = url;\r\n            }\r\n            else {\r\n                dest.style.backgroundImage = 'url(\"' + url + '\")';\r\n            }\r\n            dest.classList.add('imageLoaded');\r\n        }\r\n\r\n        /**\r\n         * Asynchronously load a picture (using src for image tag and background-image for other elements) from url path, and add 'imageLoaded' css class once picture is ready. \r\n         * You could rely on '.imageLoaded' to add transitions for image loading\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.picture = WinJS.Binding.initializer(function toSmartBgImageBinding(source, sourceProperty, dest, destProperty) {\r\n            function setImage() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data || !data.length) {\r\n                    data = Bindings.pictureUnavailable;\r\n                }\r\n\r\n                dest.classList.remove('imageLoaded');\r\n                setTimeout(function () {\r\n                    WinJSContrib.UI.loadImage(data).done(function () {\r\n                        _setPic(dest, data);\r\n                    }, function () {\r\n                        _setPic(dest, Bindings.pictureUnavailable);\r\n                        WinJS.Utilities.addClass(dest, 'imageLoaded');\r\n                    });\r\n                }, 200);\r\n            }\r\n\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setImage;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n        WinJSContrib.Bindings.toSmartBgImage = WinJSContrib.Bindings.picture; //deprecated method name\r\n\r\n        /**\r\n         * show element if property is filled or true. The dest property can be used to choose what to use for showing/hiding object (opacity, visibility, or display)\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.showIf = WinJS.Binding.initializer(function hideUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.classList.remove('mcn-show');\r\n                    dest.classList.add('mcn-hide');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '0';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = 'hidden';\r\n                    } else {\r\n                        dest.style.display = 'none';\r\n                    }\r\n                } else {\r\n                    dest.classList.remove('mcn-hide');\r\n                    dest.classList.add('mcn-show');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = '';\r\n                    } else {\r\n                        dest.style.display = '';\r\n                    }\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * Alias for {@link WinJSContrib.Bindings.showIf}, just for semantic purpose\r\n         * @function\r\n         * @see WinJSContrib.Bindings.showIf\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.hideIfNot = WinJSContrib.Bindings.showIf;\r\n        WinJSContrib.Bindings.hideIfNotDefined = WinJSContrib.Bindings.showIf;//warning, deprecated\r\n\r\n        /**\r\n         * hide element if property is filled or true. The dest property can be used to choose what to use for showing/hiding object (opacity, visibility, or display)\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.hideIf = WinJS.Binding.initializer(function showUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.classList.remove('mcn-hide');\r\n                    dest.classList.add('mcn-show');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = '';\r\n                    } else {\r\n                        dest.style.display = '';\r\n                    }\r\n                } else {\r\n                    dest.classList.remove('mcn-show');\r\n                    dest.classList.add('mcn-hide');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '0';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = 'hidden';\r\n                    } else {\r\n                        dest.style.display = 'none';\r\n                    }\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * Alias for {@link WinJSContrib.Bindings.hideIf}, just for semantic purpose\r\n         * @function\r\n         * @see WinJSContrib.Bindings.hideIf\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.showIfNot = WinJSContrib.Bindings.hideIf; //warning, deprecated\r\n\r\n        WinJSContrib.Bindings.showIfNotDefined = WinJSContrib.Bindings.hideIf; //warning, deprecated\r\n\r\n        /**\r\n         * enable element if property is filled or true\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.enableIf = WinJS.Binding.initializer(function disableUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.disabled = true;\r\n                } else {\r\n                    dest.disabled = false;\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n        WinJSContrib.Bindings.disableIfNot = WinJSContrib.Bindings.enableIf;\r\n\r\n        /**\r\n         * disable element if property is filled or true\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.disableIf = WinJS.Binding.initializer(function enableUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.disabled = false;\r\n                } else {\r\n                    dest.disabled = true;\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n        WinJSContrib.Bindings.enableIfNot = WinJSContrib.Bindings.disableIf;\r\n\r\n        /**\r\n         * apply a percent number as width (in percent) on the element\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.toWidth = WinJS.Binding.initializer(function progressToWidth(source, sourceProperty, dest, destProperty) {\r\n            function setWidth() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.style.width = '';\r\n                } else {\r\n                    dest.style.width = data + '%';\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setWidth;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * truncate a string and add ellipse to the text if string is longer than a limit. The max size of text is determined by a 'ellipsisize' argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         * @example {@lang xml}\r\n         * <p data-win-bind=\"innerText : someLongText WinJSContrib.Bindings.ellipsisize\" data-win-bind-args='{ \"ellipsisize\" : 50}'></p>\r\n         */\r\n        WinJSContrib.Bindings.ellipsisize = WinJS.Binding.initializer(function toEllipsisizedBinding(source, sourceProperty, dest, destProperty) {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            var size = bindingArguments(dest, 'ellipsisize');\r\n            dest[destProperty] = toStaticHTML(WinJSContrib.Utils.ellipsisizeString(sourcedata, size, true));\r\n        });\r\n        WinJSContrib.Bindings.toEllipsisized = WinJSContrib.Bindings.ellipsisize; //deprecated name\r\n\r\n        WinJSContrib.Bindings.emptyIfNull = WinJS.Binding.initializer(function emptyIfNull(source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (typeof data === \"undefined\" || data === null) {\r\n                dest[destProperty] = \"\";\r\n            } else {\r\n                dest[destProperty] = data;\r\n            }\r\n        });\r\n\r\n\r\n        /**\r\n         * Two way binding triggered by \"change\" event on inputs\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.twoWayOnChange = WinJS.Binding.initializer(function twoWayOnChangeBinding(source, sourceProperty, dest, destProperty) {\r\n            function setVal() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                WinJSContrib.Utils.writeProperty(dest, destProperty, data || '');\r\n            }\r\n\r\n            function getVal() {\r\n                var val = WinJSContrib.Utils.getProperty(dest, destProperty);\r\n                WinJSContrib.Utils.writeProperty(source, sourceProperty, val.propValue);\r\n            }\r\n\r\n            dest.addEventListener('change', getVal, false);\r\n            if (!dest.winControl) {\r\n                dest.classList.add('win-disposable');\r\n                dest.winControl = {\r\n                    dispose: function () {\r\n                        dest.removeEventListener('change', getVal);\r\n                    }\r\n                };\r\n            }\r\n\r\n            var bindingDesc = {\r\n            };\r\n\r\n            bindingDesc[sourceProperty] = setVal;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /** \r\n         * cleans up a binding list by returning its items as non-observable \r\n         * @function \r\n         * @param {Object[]} bindingList binding list to clean up \r\n         * @returns {Object[]} array containing the cleaned up items \r\n         */\r\n        Bindings.cleanUpBindingList = function (bindingList) {\r\n            var result = [];\r\n\r\n            bindingList.forEach(function (item) {\r\n                var unwrappedItem = WinJS.Binding.unwrap(item);\r\n                result.push(unwrappedItem);\r\n            });\r\n\r\n            return result;\r\n        };\r\n\r\n\r\n    })(WinJSContrib.Bindings || (WinJSContrib.Bindings = {}));\r\n    var Bindings = WinJSContrib.Bindings;\r\n})(WinJSContrib || (WinJSContrib = {}));\r\n","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/// <reference path=\"WinJSContrib.binding.utils.js\" />\r\n/// <reference path=\"moment.min.js\" />\r\n\r\nvar WinJSContrib;\r\nWinJSContrib.Utils = WinJSContrib.Utils || {};\r\nWinJSContrib.Bindings = WinJSContrib.Bindings || {};\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    /** \r\n     * format date using binding argument 'formatDate'\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.formatDate = WinJS.Utilities.markSupportedForProcessing(function formatDateBinding(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                var arg = WinJSContrib.Bindings.bindingArguments(dest, 'formatDate') || 'L';\r\n                dest.innerText = moment(sourcedata).format(arg);\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n    /** \r\n     * format date using calendar function\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.calendar = WinJS.Utilities.markSupportedForProcessing(function formatDateBinding(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                dest.innerText = moment(sourcedata).calendar();\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n    function daysSince(m, d, y) {\r\n        if (d == '' || m == '' || y == '') {\r\n            //alert(\"All fields must be entered\");\r\n            return;\r\n        }\r\n\r\n        if (isNaN(m) || isNaN(y) || isNaN(d)) {\r\n            //alert(\"Only numbers .\");\r\n            return;\r\n        }\r\n\r\n        var myDate = new Date();\r\n        var yourDate = new Date(y, m - 1, d);\r\n\r\n        var secondsInADay = 1000 * 60 * 60 * 24;\r\n        var diff = Math.floor((myDate.getTime() - yourDate.getTime()) / secondsInADay);\r\n        return diff;\r\n    }\r\n\r\n\r\n    /**\r\n     * display number of days since a date\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.daysSinceDate = WinJS.Utilities.markSupportedForProcessing(function daysSinceDateBinding(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                sourcedata = new Date(sourcedata);\r\n                var m = sourcedata.getMonth() + 1, d = sourcedata.getDate(), y = sourcedata.getFullYear();\r\n                var fromdate = daysSince(m, d, y);\r\n                dest.innerText = fromdate;\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n    /**\r\n     * apply moment.js humanize formatting on a date. Use 'humanizeFormat' and 'addSuffix' arguments to configure binding\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.humanizeDate = WinJS.Utilities.markSupportedForProcessing(function humanizeDate(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                var arg = WinJSContrib.Bindings.bindingArguments(dest, \"humanizeFormat\"),\r\n                    addSuffix = WinJSContrib.Bindings.bindingArguments(dest, \"addSuffix\");\r\n                dest.innerText = moment.duration(sourcedata, arg).humanize(addSuffix);\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n\r\n})();","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        /*\n         look at http://burakkanber.com/blog/machine-learning-full-text-search-in-javascript-relevance-scoring/\n         */\n        /**\n         * definition for a field\n         * @typedef {Object} WinJSContrib.Search.FieldDefinition\n         * @property {number} weight weight of the item to rank search results\n         * @example\n         * { weight : 2}\n         */\n        /**\n         * Definition of an index content\n         * @typedef {Object} WinJSContrib.Search.IndexDefinition\n         * @property {string} key name of the property considered as a key for the items\n         * @property {Object} fields object containing item's property path as name, and {@link WinJSContrib.Search.FieldDefinition} as value\n         * @example\n         * { key: 'id', fields: { \"title\": { weight : 5}, \"description.detail\": { weight : 2}}}\n         */\n        /**\n         * Small text search features based on objet indexing and text stemming. It's inspired by tools like Lucene.\n         * For now indexes are stored with WinRT files, but it will soon be extended to support an extensible storage mecanism\n         * @namespace WinJSContrib.Search\n         */\n        /**\n         * path for search worker script file\n         * @field WinJSContrib.Search.workerPath\n         * @type {string}\n         */\n        Search.workerPath = './scripts/winjscontrib/winjscontrib.search.worker.js';\n        function writeFile(folder, fileName, CreationCollisionOption, objectGraph) {\n            return new WinJS.Promise(function (complete, error) {\n                folder.createFileAsync(fileName, CreationCollisionOption).done(function (docfile) {\n                    Windows.Storage.FileIO.writeTextAsync(docfile, JSON.stringify(objectGraph)).done(function () {\n                        if (WinJS && WinJS.log)\n                            WinJS.log(\"File written \" + docfile.path);\n                        complete();\n                    }, error);\n                }, error);\n            });\n        }\n        Search.writeFile = writeFile;\n        function openFile(folder, fileName) {\n            return new WinJS.Promise(function (complete, error) {\n                folder.createFileAsync(fileName, Windows.Storage.CreationCollisionOption.openIfExists).then(function (file) {\n                    Windows.Storage.FileIO.readTextAsync(file).done(function (text) {\n                        if (text)\n                            complete(JSON.parse(text));\n                        else\n                            complete();\n                    }, error);\n                }, error);\n            });\n        }\n        Search.openFile = openFile;\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var Index = (function () {\n            /**\n             * Search index\n             * @class WinJSContrib.Search.Index\n             * @classdesc\n             * This class is the heart of the search engine. operations performed by this object are synchronous but exposes as promises.\n             * This way Index is almost interchangeable with {@link WinJSContrib.Search.IndexWorkerProxy}\n             * @param {string} name index name\n             * @param {WinJSContrib.Search.IndexDefinition} definition index definition\n             */\n            function Index(name, definition) {\n                this.items = [];\n                this.storeData = true;\n                var index = this;\n                index.name = name || 'defaultIndex';\n                index.definition = definition || {};\n                index.items = [];\n                index.storeData = true;\n                index.onprogress = undefined;\n                index.stopWords = WinJSContrib.Search.Stemming.StopWords.common;\n                index.pipeline = new WinJSContrib.Search.Stemming.Pipeline(definition);\n                //index.pipeline.registerDefault();\n                index.folderPromise = Windows.Storage.ApplicationData.current.localFolder.createFolderAsync(\"WinJSContrib\\\\Search\", Windows.Storage.CreationCollisionOption.openIfExists).then(function (folder) {\n                    return folder;\n                }, function (err) {\n                    if (WinJS && WinJS.log)\n                        WinJS.log(\"Folder init error \" + err.message);\n                    return null;\n                });\n            }\n            /**\n             * get number of items in index\n             * @function WinJSContrib.Search.Index.prototype.count\n             * @returns {WinJS.Promise}\n             */\n            Index.prototype.count = function () {\n                return WinJS.Promise.wrap(this.items.length);\n            };\n            /**\n             * clear index\n             * @function WinJSContrib.Search.Index.prototype.clear\n             * @returns {WinJS.Promise}\n             */\n            Index.prototype.clear = function () {\n                this.items = [];\n                return WinJS.Promise.wrap();\n            };\n            /**\n             * release index\n             * @function WinJSContrib.Search.Index.prototype.dispose\n             */\n            Index.prototype.dispose = function () {\n                this.items = [];\n                this.definition = undefined;\n                this.stopWords = undefined;\n                this.pipeline.clear();\n                this.pipeline = undefined;\n                this.onprogress = undefined;\n                this.folderPromise = undefined;\n            };\n            /**\n             * export index\n             * @function WinJSContrib.Search.Index.prototype.export\n             */\n            Index.prototype.export = function () {\n                return { definition: this.definition, items: this.items };\n            };\n            /**\n             * serialize index to string\n             * @function WinJSContrib.Search.Index.prototype.toString\n             */\n            Index.prototype.toString = function () {\n                return JSON.stringify(this.export());\n            };\n            /**\n             * load index from serialized string\n             * @function WinJSContrib.Search.Index.prototype.loadData\n             */\n            Index.prototype.loadData = function (indexString) {\n                var tmp = indexString;\n                if (typeof tmp == 'String')\n                    tmp = JSON.parse(indexString);\n                if (tmp) {\n                    if (tmp.definition && tmp.definition.fields && tmp.items && tmp.items.length) {\n                        this.definition = tmp.definition;\n                        this.pipeline.reload(this.definition);\n                    }\n                    this.items = tmp.items || [];\n                }\n            };\n            /**\n             * save index to storage\n             * @function WinJSContrib.Search.Index.prototype.save\n             * @returns {WinJS.Promise}\n             */\n            Index.prototype.save = function () {\n                var idx = this;\n                var exp = idx.export();\n                return idx.folderPromise.then(function (folder) {\n                    return Search.writeFile(folder, idx.name, Windows.Storage.CreationCollisionOption.replaceExisting, exp).then(function (filename) {\n                        return { index: idx };\n                    });\n                });\n            };\n            /**\n             * load index from storage\n             * @function WinJSContrib.Search.Index.prototype.load\n             * @returns {WinJS.Promise}\n             */\n            Index.prototype.load = function () {\n                var idx = this;\n                return idx.folderPromise.then(function (folder) {\n                    return Search.openFile(folder, idx.name).then(function (savedidx) {\n                        idx.loadData(savedidx);\n                    });\n                });\n            };\n            Index.prototype._runSearch = function (querytext, options) {\n                var index = this;\n                var preparedTokens = index.processText(querytext);\n                var searchResult = [];\n                var size = index.items.length;\n                var lastprogress = -1;\n                for (var i = 0; i < size; i++) {\n                    var itemResult = index._searchItem(preparedTokens, index.items[i]);\n                    if (itemResult)\n                        searchResult.push(itemResult);\n                    var p = (100 * i / size) << 0;\n                    if (index.onprogress && p != lastprogress)\n                        index.onprogress({ progressPercent: p, items: size, current: i });\n                    lastprogress = p;\n                }\n                searchResult = searchResult.sort(function (a, b) {\n                    return b.rank - a.rank;\n                });\n                if (options && options.limit) {\n                    searchResult = searchResult.slice(0, options.limit);\n                }\n                return searchResult;\n            };\n            /**\n             * search index\n             * @function WinJSContrib.Search.Index.prototype.search\n             * @param {string} querytext\n             * @returns {WinJS.Promise} search result\n             */\n            Index.prototype.search = function (querytext, options) {\n                return WinJS.Promise.wrap(this._runSearch(querytext, options));\n            };\n            Index.prototype._searchItem = function (searchtokens, indexitem) {\n                var index = this;\n                var size = indexitem.items.length;\n                var points = 0;\n                for (var i = 0; i < size; i++) {\n                    var tokenitem = indexitem.items[i];\n                    if (searchtokens.untokenized && tokenitem.tokens.untokenized == searchtokens.untokenized) {\n                        points += 4 * tokenitem.weight;\n                    }\n                    if (searchtokens.untokenized && tokenitem.tokens.untokenized && tokenitem.tokens.untokenized.indexOf(searchtokens.untokenized) >= 0) {\n                        points += 2 * tokenitem.weight;\n                    }\n                    for (var t = 0; t < tokenitem.tokens.items.length; t++) {\n                        var token = tokenitem.tokens.items[t];\n                        for (var s = 0; s < searchtokens.items.length; s++) {\n                            var stoken = searchtokens.items[s];\n                            if (stoken.length > 1 && token == stoken) {\n                                points += tokenitem.weight;\n                            }\n                            if (stoken.length > 2 && token.indexOf(stoken) >= 0) {\n                                points += tokenitem.weight * 0.2;\n                            }\n                        }\n                    }\n                }\n                if (points) {\n                    return { rank: points, key: indexitem.key, item: indexitem.rawdata };\n                }\n            };\n            /**\n             * set index definition\n             * @function WinJSContrib.Search.Index.prototype.define\n             */\n            Index.prototype.define = function (obj) {\n                this.definition = obj;\n            };\n            Index.prototype._add = function (obj) {\n                var index = this;\n                var key = undefined;\n                var def = index.definition;\n                var res = {\n                    items: [],\n                    rawdata: undefined,\n                    key: undefined\n                };\n                if (!def || !def.fields)\n                    return;\n                if (index.storeData)\n                    res.rawdata = obj;\n                if (def.key)\n                    res.key = WinJSContrib.Utils.readProperty(obj, def.key);\n                for (var elt in def.fields) {\n                    if (def.fields.hasOwnProperty(elt)) {\n                        var weight = def.fields[elt].weight || 1;\n                        var value = WinJSContrib.Utils.readProperty(obj, elt.split('.'));\n                        if (value)\n                            res.items.push({ tokens: index.processText(value), weight: weight });\n                    }\n                }\n                index.items.push(res);\n                return WinJS.Promise.wrap(res);\n            };\n            /**\n             * add an object to index\n             * @function WinJSContrib.Search.Index.prototype.add\n             * @param {Object} obj object to index\n             * @param {WinJSContrib.Search.IndexDefinition} definition index definition (optional), use index's definition if not defined\n             * @returns {WinJS.Promise}\n             */\n            Index.prototype.add = function (obj) {\n                return WinJS.Promise.wrap(this._add(obj));\n            };\n            /**\n             * add an array of objects to index\n             * @function WinJSContrib.Search.Index.prototype.addRange\n             * @param {Array} items items array\n             * @returns {WinJS.Promise}\n             */\n            Index.prototype.addRange = function (arr, progress) {\n                var index = this;\n                var size = arr.length;\n                var indexed = [];\n                var lastprogress = -1;\n                for (var i = 0; i < size; i++) {\n                    var item = index._add(arr[i]);\n                    if (item)\n                        indexed.push(item);\n                    var p = (100 * i / size) << 0;\n                    if (progress && p != lastprogress)\n                        progress({ progressPercent: p, items: size, current: i });\n                    lastprogress = p;\n                }\n                return WinJS.Promise.wrap({ indexed: indexed.length });\n            };\n            Index.prototype.refresh = function () {\n                var index = this;\n                var old = index.items;\n                var size = old.length;\n                index.items = [];\n                for (var i = 0; i < size; i++) {\n                    var item = index.items[i];\n                    index.add(item.rawdata);\n                }\n            };\n            /**\n             * prepare a text for search by applying stemming and tokenizing text\n             * @function WinJSContrib.Search.Index.prototype.processText\n             * @param {string} text\n             */\n            Index.prototype.processText = function (text) {\n                if (typeof text == \"number\")\n                    text = text.toString();\n                var tokens = this.tokenize(text);\n                var res = [];\n                var size = tokens.length;\n                for (var i = 0; i < size; i++) {\n                    var txt = this.pipeline.run(tokens[i]);\n                    if (txt.length > 1)\n                        res.push(txt);\n                }\n                return { items: res, untokenized: this.pipeline.run(text) };\n            };\n            /**\n             * Check if a word is a stopword\n             * @function WinJSContrib.Search.Index.prototype.checkWord\n             * @param {string} word\n             */\n            Index.prototype.checkWord = function (token) {\n                var size = this.stopWords.length;\n                for (var i = 0; i < size; i++) {\n                    if (token == this.stopWords[i])\n                        return '';\n                }\n                return token;\n            };\n            /**\n             * split a string into words\n             * @function WinJSContrib.Search.Index.prototype.tokenize\n             * @param {string} text\n             */\n            Index.prototype.tokenize = function (token) {\n                var index = this;\n                var tokens = [];\n                if (!token || !token.split)\n                    return tokens;\n                var words = token.split(/\\W+/);\n                for (var i = 0; i < words.length; i++) {\n                    if (words[i].length > 0) {\n                        tokens.push(words[i]);\n                    }\n                }\n                return tokens;\n            };\n            return Index;\n        })();\n        Search.Index = Index;\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var IndexGroup = (function () {\n            /**\n             * group of indexes\n             * @class WinJSContrib.Search.IndexGroup\n             * @param {Object} definitions object containing definitions\n             * @example\n             * var idxgroup = new WinJSContrib.Search.IndexGroup({ peoples: { \"firstname\": { weight: 42 }} });\n             */\n            function IndexGroup(definitions) {\n                /**\n                 * object containing indexes, stored by name\n                 * @field\n                 * @type Object\n                 */\n                this.indexes = {};\n                if (definitions) {\n                    for (var n in definitions) {\n                        var elt = definitions[n];\n                        if (!elt.useworker)\n                            this.indexes[n] = new WinJSContrib.Search.Index(n, elt.definition);\n                        else\n                            this.indexes[n] = new WinJSContrib.Search.IndexWorkerProxy(n, elt.definition);\n                    }\n                }\n            }\n            /**\n             * add an index to group\n             * @function WinJSContrib.Search.IndexGroup.prototype.addIndex\n             * @param {string} name index name\n             * @param {WinJSContrib.Search.IndexDefinition} definition index definition\n             * @params {boolean} async true if index must operate on a web worker\n             * @params {Array} items array of items to index\n             * @returns {WinJS.Promise}\n             */\n            IndexGroup.prototype.addIndex = function (name, definition, async, items) {\n                if (async)\n                    var idx = new WinJSContrib.Search.IndexWorkerProxy(name, definition);\n                else\n                    var idx = new WinJSContrib.Search.Index(name, definition);\n                this.indexes[name] = idx;\n                if (items && items.length) {\n                    return idx.addRange(items).then(function () {\n                        return idx;\n                    });\n                }\n                return WinJS.Promise.wrap(idx);\n            };\n            /**\n             * add items to an index\n             * @function WinJSContrib.Search.IndexGroup.prototype.addRange\n             * @param {string} name index name\n             * @params {Array} items array of items to index\n             * @returns {WinJS.Promise}\n             */\n            IndexGroup.prototype.addRangefunction = function (name, items) {\n                var idx = this.indexes[name];\n                if (idx && items && items.length) {\n                    return idx.addRange(items);\n                }\n                return WinJS.Promise.wrapError({ message: 'search index ' + name + ' not found' });\n            };\n            /**\n             * search group's indexes\n             * @function WinJSContrib.Search.IndexGroup.prototype.search\n             * @param {string} querytext search query\n             */\n            IndexGroup.prototype.search = function (querytext) {\n                var group = this;\n                var searchresult = { hasResult: false, allResults: [] };\n                function searchindex(name, index) {\n                    return index.search(querytext).then(function (res) {\n                        if (res && res.length) {\n                            res.forEach(function (item) {\n                                item.searchItemType = name;\n                                searchresult.allResults.push(item);\n                            });\n                        }\n                        searchresult[name] = res;\n                    });\n                }\n                var promises = [];\n                for (var n in this.indexes) {\n                    promises.push(searchindex(n, this.indexes[n]));\n                }\n                return WinJS.Promise.join(promises).then(function () {\n                    searchresult.allResults.sort(function (a, b) {\n                        return b.rank - a.rank;\n                    });\n                    searchresult.hasResult = searchresult.allResults.length > 0;\n                    return searchresult;\n                });\n            };\n            /**\n             * save group indexes\n             * @function WinJSContrib.Search.IndexGroup.prototype.save\n             * @returns {WinJS.Promise}\n             */\n            IndexGroup.prototype.save = function () {\n                var promises = [];\n                for (var n in this.indexes) {\n                    promises.push(this.indexes[n].save());\n                }\n                return WinJS.Promise.join(promises);\n            };\n            /**\n             * load group indexes\n             * @function WinJSContrib.Search.IndexGroup.prototype.load\n             * @returns {WinJS.Promise}\n             */\n            IndexGroup.prototype.load = function () {\n                var promises = [];\n                for (var n in this.indexes) {\n                    promises.push(this.indexes[n].load());\n                }\n                return WinJS.Promise.join(promises);\n            };\n            /**\n             * release all indexes\n             * @function WinJSContrib.Search.IndexGroup.prototype.dispose\n             */\n            IndexGroup.prototype.dispose = function () {\n                for (var n in this.indexes) {\n                    this.indexes[n].dispose();\n                }\n                this.indexes = {};\n            };\n            return IndexGroup;\n        })();\n        Search.IndexGroup = IndexGroup;\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var IndexWorkerProxy = (function () {\n            /**\n             * @classdesc\n             * Proxy for a {@link WinJSContrib.Search.Index} running in a web worker\n             * @class\n             * @param {string} name index name\n             * @param {WinJSContrib.Search.IndexDefinition} definition index definition\n             * @param {string} workerpath path for web worker script file (optional)\n             */\n            function IndexWorkerProxy(name, definition, workerpath) {\n                var wrapper = this;\n                wrapper.worker = new WinJSContrib.Messenger.SmartWorker(workerpath || WinJSContrib.Search.workerPath);\n                wrapper.init(name, definition);\n            }\n            /**\n             * initialize worker\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.init\n             * @param {string} name\n             * @param {WinJSContrib.Search.IndexDefinition} definition index definition (optional), use index's definition if not defined\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.init = function (name, definition, load) {\n                return this.worker.start('init', { name: name, load: load, definition: definition });\n            };\n            /**\n             * start search\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.search\n             * @param {string} searchTerm search query\n             * @param {Object} options\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.search = function (searchTerm, options) {\n                return this.worker.start('search', { searchTerm: searchTerm, options: options });\n            };\n            /**\n             * get the number of items in index\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.count\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.count = function () {\n                return this.worker.start('count');\n            };\n            /**\n             * add an object to index\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.add\n             * @param {Object} obj object to index\n             * @param {Object} options\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.add = function (data, options) {\n                return this.worker.start('index', { items: [data], options: options });\n            };\n            /**\n             * add an array of objects to index\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.addRange\n             * @param {Array} items items array\n             * @param {Object} options\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.addRange = function (data, options) {\n                return this.worker.start('index', { items: data, options: options });\n            };\n            /**\n             * release proxy\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.dispose\n             */\n            IndexWorkerProxy.prototype.dispose = function () {\n                this.worker.dispose();\n            };\n            /**\n             * clear index\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.clear\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.clear = function () {\n                return this.worker.start('clear');\n            };\n            /**\n             * load index from storage\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.load\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.load = function () {\n                return this.worker.start('load');\n            };\n            /**\n             * save index to storage\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.save\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.save = function () {\n                return this.worker.start('save');\n            };\n            return IndexWorkerProxy;\n        })();\n        Search.IndexWorkerProxy = IndexWorkerProxy;\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var Stemming;\n        (function (Stemming) {\n            /**\n             * @namespace\n             */\n            var Pipeline = (function () {\n                /**\n                 * stemming pipeline\n                 * @class WinJSContrib.Search.Stemming.Pipeline\n                 */\n                function Pipeline(definition) {\n                    this.reload = function (definition) {\n                        var pipe = this;\n                        var sets = WinJSContrib.Search.Stemming.Presets;\n                        var ops = WinJSContrib.Search.Stemming.Op;\n                        pipe._processors = [];\n                        var processorNames = null;\n                        if (definition) {\n                            var type = typeof definition.stemming;\n                            if (type === 'string') {\n                                processorNames = sets[definition.stemming];\n                            }\n                            else if (definition.stemming && definition.stemming.length) {\n                                processorNames = definition.stemming;\n                            }\n                        }\n                        if (!processorNames) {\n                            processorNames = WinJSContrib.Search.Stemming.Presets.standard;\n                        }\n                        processorNames.forEach(function (name) {\n                            var processor = ops[name];\n                            if (processor) {\n                                pipe._processors.push(processor);\n                            }\n                        });\n                    };\n                    this.reload(definition);\n                }\n                /**\n                 * add a stemming function to pipeline\n                 * @function WinJSContrib.Search.Stemming.Pipeline.prototype.add\n                 * @param {function} callback stemming function\n                 */\n                Pipeline.prototype.add = function (callback) {\n                    this._processors.push(callback);\n                };\n                /**\n                 * @function WinJSContrib.Search.Stemming.Pipeline.prototype.clear\n                 * remove all stemming functions from pipeline\n                 */\n                Pipeline.prototype.clear = function () {\n                    this._processors = [];\n                };\n                /**\n                 * apply stemming pipeline to text\n                 * @function WinJSContrib.Search.Stemming.Pipeline.prototype.run\n                 * @param {string} text\n                 */\n                Pipeline.prototype.run = function (text) {\n                    var size = this._processors.length;\n                    var res = text;\n                    for (var i = 0; i < size; i++) {\n                        res = this._processors[i](res);\n                    }\n                    return res;\n                };\n                return Pipeline;\n            })();\n            Stemming.Pipeline = Pipeline;\n        })(Stemming = Search.Stemming || (Search.Stemming = {}));\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var Stemming;\n        (function (Stemming) {\n            var Presets;\n            (function (Presets) {\n                Presets.standard = [\n                    \"lowerCase\",\n                    \"removeDiacritics\"\n                ];\n                Presets.full = [\n                    \"lowerCase\",\n                    \"removeDiacritics\",\n                    \"dedup\",\n                    \"dropInitialLetters\",\n                    \"dropBafterMAtEnd\",\n                    \"transformCK\",\n                    \"cTransform\",\n                    \"dTransform\",\n                    \"dropG\",\n                    \"transformG\",\n                    \"dropH\",\n                    \"transformPH\",\n                    \"transformQ\",\n                    \"transformS\",\n                    \"transformX\",\n                    \"transformT\",\n                    \"dropT\",\n                    \"transformV\",\n                    \"transformWH\",\n                    \"dropW\",\n                    \"dropY\",\n                    \"transformZ\"\n                ];\n            })(Presets = Stemming.Presets || (Stemming.Presets = {}));\n        })(Stemming = Search.Stemming || (Search.Stemming = {}));\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var Stemming;\n        (function (Stemming) {\n            var StopWords;\n            (function (StopWords) {\n                /**\n                * common stop words\n                * @field WinJSContrib.Search.Stemming.StopWords.common\n                */\n                StopWords.common = [\n                    //french\n                    \"de\",\n                    \"du\",\n                    \"des\",\n                    \"le\",\n                    \"la\",\n                    \"les\",\n                    \"te\",\n                    \"ta\",\n                    \"ton\",\n                    \"tes\",\n                    \"un\",\n                    \"une\",\n                    \"et\",\n                    \"ou\",\n                    \"mais\",\n                    \"pour\",\n                    \"par\",\n                    \"avec\",\n                    \"si\",\n                    //english\n                    \"a\",\n                    \"able\",\n                    \"about\",\n                    \"across\",\n                    \"after\",\n                    \"all\",\n                    \"almost\",\n                    \"also\",\n                    \"am\",\n                    \"among\",\n                    \"an\",\n                    \"and\",\n                    \"any\",\n                    \"are\",\n                    \"as\",\n                    \"at\",\n                    \"be\",\n                    \"because\",\n                    \"been\",\n                    \"but\",\n                    \"by\",\n                    \"can\",\n                    \"cannot\",\n                    \"could\",\n                    \"dear\",\n                    \"did\",\n                    \"do\",\n                    \"does\",\n                    \"either\",\n                    \"else\",\n                    \"ever\",\n                    \"every\",\n                    \"for\",\n                    \"from\",\n                    \"get\",\n                    \"got\",\n                    \"had\",\n                    \"has\",\n                    \"have\",\n                    \"he\",\n                    \"her\",\n                    \"hers\",\n                    \"him\",\n                    \"his\",\n                    \"how\",\n                    \"however\",\n                    \"i\",\n                    \"if\",\n                    \"in\",\n                    \"into\",\n                    \"is\",\n                    \"it\",\n                    \"its\",\n                    \"just\",\n                    \"least\",\n                    \"let\",\n                    \"like\",\n                    \"likely\",\n                    \"may\",\n                    \"me\",\n                    \"might\",\n                    \"most\",\n                    \"must\",\n                    \"my\",\n                    \"neither\",\n                    \"no\",\n                    \"nor\",\n                    \"not\",\n                    \"of\",\n                    \"off\",\n                    \"often\",\n                    \"on\",\n                    \"only\",\n                    \"or\",\n                    \"other\",\n                    \"our\",\n                    \"own\",\n                    \"rather\",\n                    \"said\",\n                    \"say\",\n                    \"says\",\n                    \"she\",\n                    \"should\",\n                    \"since\",\n                    \"so\",\n                    \"some\",\n                    \"than\",\n                    \"that\",\n                    \"the\",\n                    \"their\",\n                    \"them\",\n                    \"then\",\n                    \"there\",\n                    \"these\",\n                    \"they\",\n                    \"this\",\n                    \"tis\",\n                    \"to\",\n                    \"too\",\n                    \"twas\",\n                    \"us\",\n                    \"wants\",\n                    \"was\",\n                    \"we\",\n                    \"were\",\n                    \"what\",\n                    \"when\",\n                    \"where\",\n                    \"which\",\n                    \"while\",\n                    \"who\",\n                    \"whom\",\n                    \"why\",\n                    \"will\",\n                    \"with\",\n                    \"would\",\n                    \"yet\",\n                    \"you\",\n                    \"your\"\n                ];\n            })(StopWords = Stemming.StopWords || (Stemming.StopWords = {}));\n        })(Stemming = Search.Stemming || (Search.Stemming = {}));\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var Stemming;\n        (function (Stemming) {\n            var Op;\n            (function (Op) {\n                /**\n                 * built-in stemmings\n                 * @namespace\n                 */\n                /**\n                 *\n                 */\n                function lowerCase(token) {\n                    if (!token)\n                        return;\n                    return token.toLowerCase();\n                }\n                Op.lowerCase = lowerCase;\n                /**\n                 *\n                 */\n                function dedup(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/([^c])\\1/g, '$1');\n                }\n                Op.dedup = dedup;\n                /**\n                 *\n                 */\n                function dropInitialLetters(token) {\n                    if (!token)\n                        return;\n                    if (token.match(/^(kn|gn|pn|ae|wr)/))\n                        return token.substr(1, token.length - 1);\n                    return token;\n                }\n                Op.dropInitialLetters = dropInitialLetters;\n                /**\n                 *\n                 */\n                function dropBafterMAtEnd(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/mb$/, 'm');\n                }\n                Op.dropBafterMAtEnd = dropBafterMAtEnd;\n                /**\n                 *\n                 */\n                function cTransform(token) {\n                    if (!token)\n                        return;\n                    token = token.replace(/([^s]|^)(c)(h)/g, '$1x$3').trim();\n                    token = token.replace(/cia/g, 'xia');\n                    token = token.replace(/c(i|e|y)/g, 's$1');\n                    token = token.replace(/c/g, 'k');\n                    return token;\n                }\n                Op.cTransform = cTransform;\n                /**\n                 *\n                 */\n                function dTransform(token) {\n                    if (!token)\n                        return;\n                    token = token.replace(/d(ge|gy|gi)/g, 'j$1');\n                    token = token.replace(/d/g, 't');\n                    return token;\n                }\n                Op.dTransform = dTransform;\n                /**\n                 *\n                 */\n                function dropG(token) {\n                    if (!token)\n                        return;\n                    token = token.replace(/gh(^$|[^aeiou])/g, 'h$1');\n                    token = token.replace(/g(n|ned)$/g, '$1');\n                    return token;\n                }\n                Op.dropG = dropG;\n                /**\n                 *\n                 */\n                function transformG(token) {\n                    if (!token)\n                        return;\n                    token = token.replace(/([^g]|^)(g)(i|e|y)/g, '$1j$3');\n                    token = token.replace(/gg/g, 'g');\n                    token = token.replace(/g/g, 'k');\n                    return token;\n                }\n                Op.transformG = transformG;\n                /**\n                 *\n                 */\n                function dropH(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/([aeiou])h([^aeiou])/g, '$1$2');\n                }\n                Op.dropH = dropH;\n                /**\n                 *\n                 */\n                function transformCK(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/ck/g, 'k');\n                }\n                Op.transformCK = transformCK;\n                /**\n                 *\n                 */\n                function transformPH(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/ph/g, 'f');\n                }\n                Op.transformPH = transformPH;\n                /**\n                 *\n                 */\n                function transformQ(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/q/g, 'k');\n                }\n                Op.transformQ = transformQ;\n                /**\n                 *\n                 */\n                function transformS(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/s(h|io|ia)/g, 'x$1');\n                }\n                Op.transformS = transformS;\n                /**\n                 *\n                 */\n                function transformT(token) {\n                    if (!token)\n                        return;\n                    token = token.replace(/t(ia|io)/g, 'x$1');\n                    token = token.replace(/th/, '0');\n                    return token;\n                }\n                Op.transformT = transformT;\n                /**\n                 *\n                 */\n                function dropT(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/tch/g, 'ch');\n                }\n                Op.dropT = dropT;\n                /**\n                 *\n                 */\n                function transformV(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/v/g, 'f');\n                }\n                Op.transformV = transformV;\n                /**\n                 *\n                 */\n                function transformWH(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/^wh/, 'w');\n                }\n                Op.transformWH = transformWH;\n                /**\n                 *\n                 */\n                function dropW(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/w([^aeiou]|$)/g, '$1');\n                }\n                Op.dropW = dropW;\n                /**\n                 *\n                 */\n                function transformX(token) {\n                    if (!token)\n                        return;\n                    token = token.replace(/^x/, 's');\n                    token = token.replace(/x/g, 'ks');\n                    return token;\n                }\n                Op.transformX = transformX;\n                /**\n                 *\n                 */\n                function dropY(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/y([^aeiou]|$)/g, '$1');\n                }\n                Op.dropY = dropY;\n                /**\n                 *\n                 */\n                function transformZ(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/z/, 's');\n                }\n                Op.transformZ = transformZ;\n                /**\n                 *\n                 */\n                function dropVowels(token) {\n                    if (!token)\n                        return;\n                    return token.charAt(0) + token.substr(1, token.length).replace(/[aeiou]/g, '');\n                }\n                Op.dropVowels = dropVowels;\n                /**\n                 *\n                 */\n                function removeDiacritics(s) {\n                    if (!s)\n                        return;\n                    var r = s.toLowerCase();\n                    r = r.replace(new RegExp(\"/.../g\", 'g'), \" \");\n                    r = r.replace(new RegExp(\"[àáâãäå]\", 'g'), \"a\");\n                    r = r.replace(new RegExp(\"æ\", 'g'), \"ae\");\n                    r = r.replace(new RegExp(\"ç\", 'g'), \"c\");\n                    r = r.replace(new RegExp(\"[èéêë]\", 'g'), \"e\");\n                    r = r.replace(new RegExp(\"[ìíîï]\", 'g'), \"i\");\n                    r = r.replace(new RegExp(\"ñ\", 'g'), \"n\");\n                    r = r.replace(new RegExp(\"[òóôõö]\", 'g'), \"o\");\n                    r = r.replace(new RegExp(\"œ\", 'g'), \"oe\");\n                    r = r.replace(new RegExp(\"[ùúûü]\", 'g'), \"u\");\n                    r = r.replace(new RegExp(\"[ýÿ]\", 'g'), \"y\");\n                    r = r.replace(new RegExp(\"['\\\"]\", 'g'), \" \");\n                    return r;\n                }\n                Op.removeDiacritics = removeDiacritics;\n            })(Op = Stemming.Op || (Stemming.Op = {}));\n        })(Stemming = Search.Stemming || (Search.Stemming = {}));\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\n//# sourceMappingURL=winjscontrib.search.js.map","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/**\n * @namespace WinJSContrib.UI.Animation\n */\n/**\n */\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var UI;\n    (function (UI) {\n        var Animation;\n        (function (Animation) {\n            /**\n             * @enum\n             * @memberof WinJSContrib.UI.Animation\n             */\n            Animation.Easings = {\n                /**\n                 * Quad ease in\n                 */\n                easeInQuad: 'cubic-bezier(0.550, 0.085, 0.680, 0.530)',\n                /**\n                 * Cubic ease in\n                 */\n                easeInCubic: 'cubic-bezier(0.550, 0.055, 0.675, 0.190)',\n                /**\n                 * Quart ease in\n                 */\n                easeInQuart: 'cubic-bezier(0.895, 0.030, 0.685, 0.220)',\n                /**\n                 * Quint ease in\n                 */\n                easeInQuint: 'cubic-bezier(0.755, 0.050, 0.855, 0.060)',\n                /**\n                 * Sine ease in\n                 */\n                easeInSine: 'cubic-bezier(0.470, 0.000, 0.745, 0.715)',\n                /**\n                 * Expo ease in\n                 */\n                easeInExpo: 'cubic-bezier(0.950, 0.050, 0.795, 0.035)',\n                /**\n                 * Circ ease in\n                 */\n                easeInCirc: 'cubic-bezier(0.600, 0.040, 0.980, 0.335)',\n                /**\n                 * Back ease in\n                 */\n                easeInBack: 'cubic-bezier(0.600, -0.280, 0.735, 0.045)',\n                /**\n                 * Quad ease out\n                 */\n                easeOutQuad: 'cubic-bezier(0.250, 0.460, 0.450, 0.940)',\n                /**\n                 * Cubic ease out\n                 */\n                easeOutCubic: 'cubic-bezier(0.215, 0.610, 0.355, 1.000)',\n                /**\n                 * Quart ease out\n                 */\n                easeOutQuart: 'cubic-bezier(0.165, 0.840, 0.440, 1.000)',\n                /**\n                 * Quint ease out\n                 */\n                easeOutQuint: 'cubic-bezier(0.230, 1.000, 0.320, 1.000)',\n                /**\n                 * Sine ease out\n                 */\n                easeOutSine: 'cubic-bezier(0.390, 0.575, 0.565, 1.000)',\n                /**\n                 * Expo ease out\n                 */\n                easeOutExpo: 'cubic-bezier(0.190, 1.000, 0.220, 1.000)',\n                /**\n                 * Circ ease out\n                 */\n                easeOutCirc: 'cubic-bezier(0.075, 0.820, 0.165, 1.000)',\n                /**\n                 * Back ease out\n                 */\n                easeOutBack: 'cubic-bezier(0.175, 0.885, 0.320, 1.275)',\n                /**\n                 * Quad ease in-out\n                 */\n                easeInOutQuad: 'cubic-bezier(0.455, 0.030, 0.515, 0.955)',\n                /**\n                 * Cubic ease in-out\n                 */\n                easeInOutCubic: 'cubic-bezier(0.645, 0.045, 0.355, 1.000)',\n                /**\n                 * Quart ease in-out\n                 */\n                easeInOutQuart: 'cubic-bezier(0.770, 0.000, 0.175, 1.000)',\n                /**\n                 * Quint ease in-out\n                 */\n                easeInOutQuint: 'cubic-bezier(0.860, 0.000, 0.070, 1.000)',\n                /**\n                 * Sine ease in-out\n                 */\n                easeInOutSine: 'cubic-bezier(0.445, 0.050, 0.550, 0.950)',\n                /**\n                 * Expo ease in-out\n                 */\n                easeInOutExpo: 'cubic-bezier(1.000, 0.000, 0.000, 1.000)',\n                /**\n                 * Circ ease in-out\n                 */\n                easeInOutCirc: 'cubic-bezier(0.785, 0.135, 0.150, 0.860)',\n                /**\n                 * Back ease in-out\n                 */\n                easeInOutBack: 'cubic-bezier(0.680, -0.550, 0.265, 1.550)',\n            };\n            var equivalents = WinJS.Utilities._browserStyleEquivalents || { transform: { cssName: 'transform' } };\n            function getOpt(options) {\n                if (options && typeof options == 'number')\n                    return { duration: options };\n                else\n                    return options || {};\n            }\n            /**\n             * configurable fade out\n             * @function WinJSContrib.UI.Animation.fadeOut\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function fadeOut(elements, options) {\n                options = getOpt(options);\n                var args = {\n                    property: \"opacity\",\n                    delay: staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333),\n                    duration: options.duration || 167,\n                    timing: options.easing || \"ease-in-out\",\n                    to: 0\n                };\n                return WinJS.UI.executeTransition(elements, args);\n            }\n            Animation.fadeOut = fadeOut;\n            /**\n             * configurable fade in\n             * @function WinJSContrib.UI.Animation.fadeIn\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function fadeIn(elements, options) {\n                options = getOpt(options);\n                return WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333),\n                    duration: options.duration || 167,\n                    timing: options.easing || \"ease-in-out\",\n                    to: 1\n                });\n            }\n            Animation.fadeIn = fadeIn;\n            function staggerDelay(initialDelay, extraDelay, delayFactor, delayCap) {\n                return function (i) {\n                    var ret = initialDelay;\n                    for (var j = 0; j < i; j++) {\n                        extraDelay *= delayFactor;\n                        ret += extraDelay;\n                    }\n                    if (delayCap) {\n                        ret = Math.min(ret, delayCap);\n                    }\n                    return ret;\n                };\n            }\n            /**\n             * configurable page exit effect\n             * @function WinJSContrib.UI.Animation.pageExit\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function pageExit(elements, options) {\n                options = getOpt(options);\n                var args = {\n                    property: \"opacity\",\n                    delay: staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333),\n                    duration: options.duration || 160,\n                    timing: options.easing || \"ease-in\",\n                    to: 0\n                };\n                return WinJS.UI.executeTransition(elements, args);\n            }\n            Animation.pageExit = pageExit;\n            /**\n             * configurable page enter effect\n             * @function WinJSContrib.UI.Animation.enterPage\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function enterPage(elements, options) {\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 120, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var animationParams = {\n                    keyframe: 'WinJSContrib-EnterPage',\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: options.duration || 600,\n                    timing: options.easing || \"cubic-bezier(0.1, 0.9, 0.2, 1)\"\n                };\n                var promise1 = WinJS.UI.executeAnimation(elements, animationParams);\n                var args = {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: options.duration || 600,\n                    timing: options.easing || \"ease-out\",\n                    to: 1\n                };\n                var promise2 = WinJS.UI.executeTransition(elements, args);\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.enterPage = enterPage;\n            function slideAnim(element, keyframeName, isIn, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var duration = options.duration || isIn ? 250 : 150;\n                var delay = options.delay || 5;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var easing = WinJSContrib.UI.Animation.Easings.easeInQuad;\n                if (isIn)\n                    easing = WinJSContrib.UI.Animation.Easings.easeOutQuad;\n                var animationParams = {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: duration,\n                    timing: options.easing || easing\n                };\n                var promise1 = WinJS.UI.executeAnimation(element, animationParams);\n                var transitionParams = {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: duration / 2,\n                    timing: easing,\n                    from: 0,\n                    to: 1\n                };\n                if (!isIn) {\n                    transitionParams.from = 1;\n                    transitionParams.to = 0;\n                    if (transitionParams.delay < duration / 2)\n                        transitionParams.delay = duration / 2;\n                }\n                var promise2 = WinJS.UI.executeTransition(element, transitionParams);\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromBottom\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromBottom(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromBottom', true, options);\n            }\n            Animation.slideFromBottom = slideFromBottom;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromTop\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromTop(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromTop', true, options);\n            }\n            Animation.slideFromTop = slideFromTop;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromLeft\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromLeft(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromLeft', true, options);\n            }\n            Animation.slideFromLeft = slideFromLeft;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromRight\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromRight(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromRight', true, options);\n            }\n            Animation.slideFromRight = slideFromRight;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToBottom\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToBottom(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToBottom', false, options);\n            }\n            Animation.slideToBottom = slideToBottom;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToTop\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToTop(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToTop', false, options);\n            }\n            Animation.slideToTop = slideToTop;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToLeft\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToLeft(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToLeft', false, options);\n            }\n            Animation.slideToLeft = slideToLeft;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToRight\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToRight(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToRight', false, options);\n            }\n            Animation.slideToRight = slideToRight;\n            /**\n             * animation for tab exit\n             * @function WinJSContrib.UI.Animation.tabExitPage\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function tabExitPage(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var animationParams = {\n                    keyframe: \"WinJSContrib-tabExitPage\",\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: options.duration || 160,\n                    timing: \"ease-in\"\n                };\n                var promise1 = WinJS.UI.executeAnimation(elements, animationParams);\n                var transitionParams = {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: options.duration || 160,\n                    timing: \"linear\",\n                    from: 1,\n                    to: 0\n                };\n                var promise2 = WinJS.UI.executeTransition(elements, transitionParams);\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.tabExitPage = tabExitPage;\n            /**\n             * animation for tab exit\n             * @function WinJSContrib.UI.Animation.tabEnterPage\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function tabEnterPage(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: \"WinJSContrib-tabEnterPage\",\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: options.duration || 250,\n                    timing: WinJSContrib.UI.Animation.Easings.easeOutQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: options.duration || 250,\n                    timing: \"ease-out\",\n                    from: 0,\n                    to: 1\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.tabEnterPage = tabEnterPage;\n            /**\n             * exit and grow animation\n             * @function WinJSContrib.UI.Animation.exitGrow\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function exitGrow(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-exitGrow\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var dur = options.duration || 250;\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeInQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeInQuint,\n                    from: 1,\n                    to: 0\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.exitGrow = exitGrow;\n            /**\n             * exit and shrink animation\n             * @function WinJSContrib.UI.Animation.exitShrink\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function exitShrink(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-exitShrink\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var dur = options.duration || 250;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 10, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeInQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: WinJSContrib.UI.Animation.Easings.easeInQuint,\n                    from: 1,\n                    to: 0\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.exitShrink = exitShrink;\n            /**\n             * shrink and fall animation\n             * @function WinJSContrib.UI.Animation.shrinkAndFall\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function shrinkAndFall(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var dur = options.duration || 250;\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: \"WinJSContrib-shrinkAndFall\",\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || \"ease-in\"\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: \"ease-in\",\n                    from: 1,\n                    to: 0\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.shrinkAndFall = shrinkAndFall;\n            /**\n             * enter and shrink animation\n             * @function WinJSContrib.UI.Animation.enterShrink\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function enterShrink(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-enterShrink\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var dur = options.duration || 350;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeOutQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeOutQuint,\n                    from: 0,\n                    to: 1\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.enterShrink = enterShrink;\n            /**\n             * enter and shrink animation\n             * @function WinJSContrib.UI.Animation.enterGrow\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function enterGrow(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-enterGrow\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var dur = options.duration || 350;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeOutQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: WinJSContrib.UI.Animation.Easings.easeOutQuint,\n                    from: 0,\n                    to: 1\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.enterGrow = enterGrow;\n        })(Animation = UI.Animation || (UI.Animation = {}));\n    })(UI = WinJSContrib.UI || (WinJSContrib.UI = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\n//# sourceMappingURL=../../Sources/Common/winjscontrib.ui.animation.js.map","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n//this control requires snap.svg\r\n\r\n(function () {\r\n    'use strict';\r\n    var elasticbuttonkinds = {\r\n        rectangle: {\r\n            morphpath: 'M286,113c0,0-68.8,6-136,6c-78.2,0-137-6-137-6S6,97.198,6,62.5C6,33.999,13,12,13,12s59-7,137-7c85,0,136,7,136,7s8,17.598,8,52C294,96.398,286,113,286,113z',\r\n            svg: '<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 300 125\" preserveAspectRatio=\"none\"><path d=\"M286.5,113c0,0-104,0-136.5,0c-35.75,0-136.5,0-136.5,0s0-39.417,0-52.5c0-12.167,0-48.5,0-48.5s101.833,0,136.5,0c33.583,0,136.5,0,136.5,0s0,35.917,0,48.5C286.5,73.167,286.5,113,286.5,113z\"/></svg>'\r\n        },\r\n        roundedrectangle: {\r\n            morphpath: 'M287,95.25c0,11.046-5.954,19.75-17,19.75c0,0-90-4-120-4s-120,4-120,4c-11.046,0-17.25-9.5-17.25-20.5c0-8.715,0.25-10.75,0.25-34s-0.681-26.257-1-33.75C11.5,15,18.954,10,30,10c0,0,90,3,120,3s120-3,120-3c11.046,0,17.75,6.5,17,20c-0.402,7.239,0,6.75,0,30.5C287,83.5,287,84.75,287,95.25z',\r\n            svg: '<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 300 125\" preserveAspectRatio=\"none\"><path d=\"M290,95c0,11.046-8.954,20-20,20c0,0-90,0-120,0s-120,0-120,0c-11.046,0-20-9-20-20c0-8.715,0-25.875,0-34.5c0-7.625,0-22.774,0-30.5c0-11.625,8.954-20,20-20c0,0,90,0,120,0s120,0,120,0c11.046,0,20,8.954,20,20c0,7.25,0,22.875,0,30.5C290,69.125,290,84.5,290,95z\"/></svg>'\r\n        },\r\n        round: {\r\n            morphpath: 'M251,150c0,93.5-29.203,143-101,143S49,243.5,49,150C49,52.5,78.203,7,150,7S251,51.5,251,150z',\r\n            svg: '<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 300 300\" preserveAspectRatio=\"none\"><path d=\"M281,150c0,71.797-59.203,131-131,131S19,221.797,19,150S78.203,19,150,19S281,78.203,281,150z\"/></svg>'\r\n        },\r\n    };\r\n\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        ElasticButton: WinJS.Class.mix(WinJS.Class.define(function ctor(element, options) {\r\n            this.element = element || document.createElement('DIV');\r\n            options = options || {};\r\n            this.element.winControl = this;\r\n            this.behavior = {\r\n                speed: { reset: 800, active: 150 },\r\n                easing: { reset: mina.elastic, active: mina.easein }\r\n            };\r\n\r\n            this.element.classList.add('mcn-elasticbutton');\r\n            this.element.classList.add('win-disposable');\r\n            WinJS.UI.setOptions(this, options);\r\n        }, {\r\n            kind: {\r\n                get: function () {\r\n                    return this._kind;\r\n                },\r\n                set: function (val) {\r\n                    this._kind = val;\r\n                    this.render();\r\n                }\r\n            },\r\n\r\n            render: function () {\r\n                var ctrl = this;\r\n                this.element.classList.add('mcn-elasticbutton-' + ctrl.kind);\r\n                var contentCreated = false;\r\n                if (!ctrl.contentElement) {\r\n                    ctrl.contentElement = document.createElement('DIV');\r\n                    ctrl.contentElement.className = 'mcn-elasticbutton-content';\r\n                    WinJSContrib.Utils.moveChilds(ctrl.element, ctrl.contentElement);\r\n                    contentCreated = true;\r\n                }\r\n\r\n                if (!ctrl.bgElement) {\r\n                    ctrl.bgElement = document.createElement('DIV');\r\n                    ctrl.bgElement.className = 'mcn-elasticbutton-bg';\r\n                    ctrl.element.appendChild(ctrl.bgElement);\r\n                }\r\n\r\n                if (contentCreated) {\r\n                    ctrl.element.appendChild(ctrl.contentElement);\r\n                }\r\n\r\n                if (!ctrl.contentElement) {\r\n                    ctrl.contentElement = document.createElement('DIV');\r\n                    ctrl.contentElement.className = 'mcn-elasticbutton-content';\r\n                    while (ctrl.element.children.length > 0) {\r\n                        ctrl.contentElement.appendChild(ctrl.element.children[0]);\r\n                    }\r\n                    ctrl.element.appendChild(ctrl.contentElement);\r\n                }\r\n\r\n                ctrl.currentKind = elasticbuttonkinds[this.kind];\r\n                if (ctrl.currentKind) {\r\n                    ctrl.bgElement.innerHTML = ctrl.currentKind.svg;\r\n                    ctrl.snap = Snap(ctrl.bgElement.querySelector('svg'));\r\n                    ctrl.pathEl = ctrl.snap.select('path');\r\n                    ctrl.paths = {\r\n                        reset: ctrl.pathEl.attr('d'),\r\n                        active: ctrl.currentKind.morphpath\r\n                    };\r\n                    if (ctrl.eventTracker)\r\n                        ctrl.eventTracker.dispose();\r\n                    ctrl.eventTracker = new WinJSContrib.UI.EventTracker();\r\n                    ctrl.eventTracker.addEvent(ctrl.element, 'pointerdown', function (arg) { ctrl._ptdown(arg); });\r\n                    ctrl.eventTracker.addEvent(ctrl.element, 'pointerup', function (arg) { ctrl._ptup(arg); });\r\n                    ctrl.eventTracker.addEvent(ctrl.element, 'pointerleave', function (arg) { ctrl._ptup(arg); })\r\n                }\r\n            },\r\n\r\n            _ptdown: function (arg) {\r\n                this.element.classList.add(\"pressed\");\r\n                this.pathEl.stop().animate({ 'path': this.paths.active }, this.behavior.speed.active, this.behavior.easing.active);\r\n            },\r\n\r\n            _ptup: function (arg) {\r\n                this.element.classList.remove(\"pressed\");\r\n                this.pathEl.stop().animate({ 'path': this.paths.reset }, this.behavior.speed.reset, this.behavior.easing.reset);\r\n            },\r\n\r\n            dispose: function () {\r\n                if (this.eventTracker) this.eventTracker.dispose();\r\n                WinJS.Utilities.disposeSubTree(this.element);\r\n                this.element = null;\r\n            }\r\n        }),\r\n\t\tWinJS.Utilities.eventMixin,\r\n\t\tWinJS.Utilities.createEventProperties(\"myevent\"))\r\n    });\r\n})();","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/// <reference path=\"winjscontrib.core.js\" />\r\n\r\n//this controls requires snap.svg\r\n\r\n(function () {\r\n    'use strict';\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        FOWrapper: WinJS.Class.mix(WinJS.Class.define(function ctor(element, options) {\r\n            this.element = element || document.createElement('DIV');\r\n            options = options || {};\r\n            this.element.winControl = this;\r\n            this.element.classList.add('mcn-fowrapper');\r\n            this.element.classList.add('mcn-layout-ctrl');\r\n            this.element.classList.add('win-disposable');\r\n            WinJS.UI.setOptions(this, options);\r\n            this.render();\r\n        }, {\r\n            someProperty: {\r\n                get: function () {\r\n                    return this._someProperty;\r\n                },\r\n                set: function (val) {\r\n                    this._someProperty = val;\r\n                }\r\n            },\r\n\r\n            render: function () {\r\n                var ctrl = this;\r\n                ctrl.wrapperId = WinJSContrib.Utils.guid();\r\n                var body = document.createElement(\"BODY\");\r\n                body.className = \"mcn-fowrapper-content\";\r\n                body.style.width = '100%';\r\n                body.style.height = '100%';\r\n                WinJSContrib.Utils.moveChilds(ctrl.element, body);\r\n                ctrl.element.innerHTML = '<svg id=\"' + ctrl.wrapperId + '\" class=\"mcn-fowrapper-svg\" xmlns=\"http://www.w3.org/2000/svg\" style=\"width:100%; height: 100%\">' +\r\n                    '<defs>' +\r\n                        '<filter id=\"blur-' + ctrl.wrapperId + '\" x=\"0\" y=\"0\"><feGaussianBlur class=\"gblur\" in=\"SourceGraphic\" stdDeviation=\"0\" /></filter>' +\r\n                    '</defs>' +\r\n                    '<foreignObject class=\"fowrapper\" width=\"100%\" height=\"100%\" requiredExtensions=\"http://www.w3.org/1999/xhtml\" filter=\"url(#blur-' + ctrl.wrapperId + ')\">' +\r\n                    '</foreignObject>' +\r\n                '</svg>';\r\n                var container = ctrl.element.querySelector(\".fowrapper\");\r\n                ctrl.svg = ctrl.element.querySelector(\"svg\");\r\n                ctrl.container = container;\r\n                ctrl.content = body;\r\n                ctrl.blurFilter = ctrl.element.querySelector(\".gblur\");\r\n                ctrl.sblurFilter = Snap(ctrl.blurFilter);\r\n                container.appendChild(body);\r\n            },\r\n\r\n            blurTo: function (blur, duration, easing) {\r\n                var ctrl = this;\r\n\r\n                ctrl.sblurFilter.stop();\r\n                if (!duration) {\r\n                    ctrl.blurFilter.setAttribute(\"stdDeviation\", blur);                    \r\n                    return;\r\n                }\r\n\r\n                ctrl.sblurFilter.animate({ stdDeviation: blur }, duration, easing || mina.easeout);\r\n                ctrl.dispatchEvent('blur');\r\n            },\r\n\r\n            updateLayout: function () {\r\n                if (this.container) {\r\n                    this.container.setAttribute(\"width\", \"100%\");\r\n                    this.container.setAttribute(\"height\", \"100%\");\r\n                }\r\n            },\r\n\r\n            dispose: function () {\r\n                WinJS.Utilities.disposeSubTree(this.element);                \r\n                this.element = null;\r\n            }\r\n        }),\r\n        WinJS.Utilities.eventMixin,\r\n        WinJS.Utilities.createEventProperties(\"blur\"))\r\n    });\r\n})();","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib = WinJSContrib || {};\r\nWinJSContrib.UI = WinJSContrib.UI || {};\r\n\r\n(function () {\r\n    \"use strict\";\r\n\r\n    WinJSContrib.UI.MultiPassRenderer = WinJS.Class.define(\r\n    /**\r\n     * This control manage multi-pass rendering for improving performances when showing a list of items.\r\n     * The renderer will render \"shells\" for the items to enable page layout, and render items content on demand, or when items scrolls to view.  \r\n     * @class WinJSContrib.UI.MultiPassRenderer\r\n     */\r\n    function (element, options) {\r\n        options = options || {};\r\n        this.items = [];\r\n        this.element = element;\r\n        this._scrollProcessor = null;\r\n        this._tolerance = 1;\r\n        this._virtualize = false;\r\n        this._scrollContainer = options.scrollContainer || null;\r\n        this._multipass = options.multipass || false;\r\n        this._orientation = options.orientation || '';\r\n        this.itemClassName = options.itemClass || options.className || options.itemClassName;\r\n        this.itemTemplate = WinJSContrib.Utils.getTemplate(options.template || options.itemTemplate);\r\n        this.itemInvoked = options.invoked || options.itemInvoked;\r\n        this.onitemContent = options.onitemContent;\r\n        this._onScrollBinded = this._onScroll.bind(this);\r\n\r\n        if (element) {\r\n            element.className = element.className + ' mcn-items-ctrl mcn-layout-ctrl win-disposable';\r\n        }\r\n\r\n        //element.mcnRenderer = this;\r\n        //WinJS.UI.setOptions(this, options);\r\n    },\r\n    /**\r\n      * @lends WinJSContrib.UI.MultiPassRenderer.prototype\r\n      */\r\n    {\r\n        dispose : function(){\r\n            var ctrl = this;\r\n            WinJSContrib.UI.untapAll(ctrl.element);\r\n            WinJS.Utilities.disposeSubTree(ctrl.element);\r\n            ctrl._unregisterScrollEvents();\r\n            ctrl._scrollContainer = null;\r\n            ctrl.element = null;\r\n            ctrl._scrollProcessor = null;\r\n            ctrl.rect = null;           \r\n            ctrl.items = [];\r\n        },\r\n\r\n        clear: function () {\r\n            var ctrl = this;\r\n            WinJS.Utilities.disposeSubTree(ctrl.element);\r\n            ctrl.element.innerHTML = '';\r\n        },\r\n\r\n        /**\r\n         * kind of multipass, can be 'section', or 'item'\r\n         * @type {String}\r\n         * @field\r\n         */\r\n        multipass: {\r\n            get: function () {\r\n                return this._multipass;\r\n            },\r\n            set: function (val) {\r\n                this._multipass = val;\r\n                this.refreshScrollEvents();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * tolerance for determining if the rendering should apply. Tolerance is expressed in scroll container proportion. For example, 1 means that tolerance is equal to scroll container size\r\n         * @type {number}\r\n         * @field\r\n         */\r\n        tolerance: {\r\n            get: function () {\r\n                return this._tolerance;\r\n            },\r\n            set: function (val) {\r\n                this._tolerance = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * indicate if renderer empty items out of sight\r\n         * @type {boolean}\r\n         * @field\r\n         */\r\n        virtualize: {\r\n            get: function () {\r\n                return this._virtualize;\r\n            },\r\n            set: function (val) {\r\n                this._virtualize = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * could be 'vertical' or 'horizontal'\r\n         * @type {String}\r\n         * @field\r\n         */\r\n        orientation: {\r\n            get: function () {\r\n                return this._orientation;\r\n            },\r\n            set: function (val) {\r\n                this._orientation = val;\r\n                this.refreshScrollEvents();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Element containing scroll. If scrollContainer is filled, items content will get rendered when coming into view\r\n         * @type {HTMLElement}\r\n         * @field\r\n         */\r\n        scrollContainer: {\r\n            get: function () {\r\n                return this._scrollContainer;\r\n            },\r\n            set: function (val) {\r\n                this._unregisterScrollEvents();\r\n                this._scrollContainer = val;\r\n                this._registerScrollEvents();\r\n                //this.checkRendering();\r\n            }\r\n        },\r\n\r\n        _onScroll: function () {\r\n            var ctrl = this;\r\n            if (ctrl.scrollContainer && ctrl._scrollProcessor) {\r\n                if (ctrl._scrollRequest) {\r\n                    cancelAnimationFrame(ctrl._scrollRequest);\r\n                }\r\n\r\n                ctrl._scrollRequest = requestAnimationFrame(function () {\r\n                    ctrl.checkRendering();\r\n                });\r\n            }\r\n        },\r\n\r\n        _unregisterScrollEvents: function () {\r\n            this._scrollProcessor = null;\r\n            this.clearOffsets();\r\n            if (this.scrollContainer) {\r\n                this.scrollContainer.removeEventListener('scroll', this._onScrollBinded);\r\n            }\r\n        },\r\n\r\n        _registerScrollEvents: function () {\r\n            var ctrl = this;\r\n            if (ctrl.scrollContainer) {\r\n                this.scrollContainer.addEventListener('scroll', this._onScrollBinded);\r\n\r\n                if (ctrl.orientation == 'vertical') {\r\n                    if (ctrl.multipass == 'section') {\r\n                        ctrl._scrollProcessor = function () { ctrl._checkSection(ctrl._vIsInView); }\r\n                    } else if (ctrl.multipass == 'item') {\r\n                        ctrl._scrollProcessor = function () { ctrl._checkItem(ctrl._vIsInView); }\r\n                    }\r\n                } else {\r\n                    if (ctrl.multipass == 'section') {\r\n                        ctrl._scrollProcessor = function () { ctrl._checkSection(ctrl._hIsInView); }\r\n                    } else if (ctrl.multipass == 'item') {\r\n                        ctrl._scrollProcessor = function () { ctrl._checkItem(ctrl._hIsInView); }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * refresh scroll events associated to multi pass renderer\r\n         */\r\n        refreshScrollEvents: function () {\r\n            this._unregisterScrollEvents();\r\n            this._registerScrollEvents();\r\n            this.clearOffsets();\r\n        },\r\n\r\n        _vIsInView: function (rect, scrollContainer, tolerance) {\r\n            var pxTolerance = scrollContainer.clientHeight * tolerance;\r\n            if (rect.y >= scrollContainer.scrollTop - pxTolerance && rect.y <= scrollContainer.scrollTop + scrollContainer.clientHeight + pxTolerance)\r\n                return true;\r\n\r\n            if (rect.y + rect.height >= scrollContainer.scrollTop - pxTolerance && rect.y + rect.height <= scrollContainer.scrollTop + scrollContainer.clientHeight + pxTolerance)\r\n                return true;\r\n\r\n            if (rect.y <= scrollContainer.scrollTop - pxTolerance && rect.y + rect.height >= scrollContainer.scrollTop + scrollContainer.clientHeight + pxTolerance)\r\n                return true;\r\n\r\n            return false;\r\n        },\r\n\r\n        _hIsInView: function (rect, scrollContainer, tolerance) {\r\n            var pxTolerance = scrollContainer.clientWidth * (tolerance || 0);\r\n            if (rect.x >= scrollContainer.scrollLeft - pxTolerance && rect.x <= scrollContainer.scrollLeft + scrollContainer.clientWidth + pxTolerance)\r\n                return true;\r\n\r\n            if (rect.x + rect.width >= scrollContainer.scrollLeft - pxTolerance && rect.x + rect.width <= scrollContainer.scrollLeft + scrollContainer.clientWidth + pxTolerance)\r\n                return true;\r\n\r\n            if (rect.x <= scrollContainer.scrollLeft - pxTolerance && rect.x + rect.width >= scrollContainer.scrollLeft + scrollContainer.clientWidth + pxTolerance)\r\n                return true;\r\n\r\n            return false;\r\n        },\r\n\r\n        /**\r\n         * Clear cached offsets for bloc and for items\r\n         */\r\n        clearOffsets: function () {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n            \r\n            ctrl.rect = null;\r\n            ctrl.items.forEach(function (item) {\r\n                item.rect = null;\r\n            });\r\n        },\r\n\r\n        /**\r\n         * update ui related properties like cached offsets, scroll events, ...\r\n         */\r\n        updateLayout: function () {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n            ctrl.refreshScrollEvents();\r\n        },\r\n\r\n        _checkSection: function (check, tolerance, noRender) {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n            tolerance = tolerance || 0;\r\n\r\n            if (!ctrl.rect && ctrl.items && ctrl.items.length) {\r\n                ctrl.rect = WinJSContrib.UI.offsetFrom(ctrl.element, ctrl.scrollContainer);\r\n            } else {\r\n                ctrl.rect = ctrl.rect || { x: 0, y: 0, width: 0, height: 0 };\r\n                ctrl.rect.width = ctrl.element.clientWidth;\r\n                ctrl.rect.height = ctrl.element.clientHeight;\r\n            }\r\n\r\n            if (check(ctrl.rect, ctrl.scrollContainer, tolerance)) {\r\n                if (noRender)\r\n                    return true;\r\n\r\n                ctrl.renderItemsContent();\r\n                if (ctrl.onrendersection) {\r\n                    ctrl.onrendersection();\r\n                }\r\n            } else if (ctrl.virtualize && tolerance > 0 && ctrl.items && ctrl.items.length && ctrl.items[0].rendered) {\r\n                ctrl.items.forEach(function (item) {\r\n                    item.empty();\r\n                });\r\n            }\r\n\r\n            if (tolerance == 0 && ctrl.tolerance > 0) {\r\n                setImmediate(function () {\r\n                    ctrl._checkSection(check, ctrl.tolerance);\r\n                });\r\n            }\r\n        },\r\n\r\n        _checkItem: function (check, tolerance) {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n            tolerance = tolerance || 0;\r\n            var allRendered = true;\r\n\r\n            var countR = function () {\r\n                var countRendered = 0;\r\n                ctrl.items.forEach(function (item) {\r\n                    if (item.rendered) {\r\n                        countRendered++;\r\n                    }\r\n                });\r\n                console.log('rendered ' + countRendered);\r\n            }\r\n\r\n            if (ctrl._checkSection(check, tolerance, true)) {\r\n                ctrl.items.forEach(function (item) {\r\n                    if (!item.rect) {\r\n                        item.rect = WinJSContrib.UI.offsetFrom(item.element, ctrl.scrollContainer);\r\n                    }\r\n                    allRendered = allRendered & item.rendered;\r\n\r\n                    if (!item.rendered && check(item.rect, ctrl.scrollContainer, tolerance)) {\r\n                        item.render();\r\n                    } else if (item.rendered && ctrl.virtualize && tolerance > 0 && !check(item.rect, ctrl.scrollContainer, tolerance)) {\r\n                        item.empty();\r\n                    }\r\n                });\r\n                ctrl.allRendered = allRendered;\r\n                //countR();\r\n            } else if (tolerance > 0 && ctrl.items.length && (ctrl.items[0].rendered || ctrl.items[ctrl.items.length - 1].rendered)) {\r\n                ctrl.items.forEach(function (item) {\r\n                    if (!item.rect) {\r\n                        item.rect = WinJSContrib.UI.offsetFrom(item.element, ctrl.scrollContainer);\r\n                    }\r\n                    if (ctrl.virtualize && !check(item.rect, ctrl.scrollContainer, tolerance)) {\r\n                        item.empty();\r\n                    }\r\n                });\r\n                //countR();\r\n            }\r\n\r\n            if (tolerance == 0 && ctrl.tolerance > 0) {\r\n                setImmediate(function () {\r\n                    ctrl._checkItem(check, ctrl.tolerance);\r\n                });\r\n            }\r\n\r\n\r\n        },\r\n\r\n        /**\r\n         * render items shells to the page\r\n         * @param {Array} items array of items to render\r\n         * @param {Object} renderOptions options for rendering items, can override control options like item template\r\n         */\r\n        prepareItems: function (items, renderOptions) {\r\n            var ctrl = this;\r\n            items = items || [];\r\n            renderOptions = renderOptions || {};\r\n            var numItems = items.length;\r\n\r\n            var itemInvoked = renderOptions.itemInvoked || ctrl.itemInvoked;\r\n            if (typeof itemInvoked == 'string')\r\n                itemInvoked = WinJSContrib.Utils.resolveMethod(ctrl.element, itemInvoked);\r\n            var template = WinJSContrib.Utils.getTemplate(renderOptions.template) || ctrl.itemTemplate;\r\n            var className = renderOptions.itemClassName || ctrl.itemClassName;\r\n            var onitemInit = renderOptions.onitemInit || ctrl.onitemInit;\r\n            var onitemContent = renderOptions.onitemContent || ctrl.onitemContent;\r\n            var container = ctrl.element;\r\n            var registereditems = ctrl.items;\r\n\r\n            items.forEach(function (itemdata) {\r\n                var item = new WinJSContrib.UI.MultiPassItem(ctrl, null, {\r\n                    data: itemdata,\r\n                    template: template,\r\n                    className: className,\r\n                    itemInvoked: itemInvoked,\r\n                    onitemInit: onitemInit,\r\n                    onitemContent: onitemContent\r\n                });\r\n                registereditems.push(item);\r\n                container.appendChild(item.element);\r\n            });\r\n            //for (var i = 0 ; i < numItems; i++) {\r\n            //    var itemdata = items[i];\r\n            //    var item = new WinJSContrib.UI.MultiPassItem(ctrl, null, {\r\n            //        data: itemdata,\r\n            //        template: template,\r\n            //        className: className,\r\n            //        itemInvoked: itemInvoked,\r\n            //        onitemInit: onitemInit,\r\n            //        onitemContent: onitemContent\r\n            //    });\r\n            //    registereditems.push(item);\r\n            //    container.appendChild(item.element);\r\n            //}\r\n\r\n            if (renderOptions.renderItems || !this.multipass) {\r\n                ctrl.renderItemsContent();\r\n            }\r\n            //ctrl.element.style.display = '';\r\n        },\r\n\r\n        /**\r\n         * check rendering of items, based on multipass configuration (force items on screen to render)\r\n         */\r\n        checkRendering: function () {\r\n            var ctrl = this;\r\n            if (ctrl.element && ctrl._scrollProcessor)\r\n                ctrl._scrollProcessor();\r\n        },\r\n\r\n        /**\r\n         * force rendering of all unrendered items\r\n         */\r\n        renderItemsContent: function () {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n\r\n            ctrl.items.forEach(function (item) {\r\n                if (!item.rendered) {\r\n                    //setImmediate(function () {\r\n                    item.render();\r\n                    //});\r\n                }\r\n            });\r\n            ctrl.allRendered = true;\r\n        }\r\n    });\r\n\r\n    WinJSContrib.UI.MultiPassItem = WinJS.Class.define(\r\n        /**\r\n         * Item for multipass rendering\r\n         * @class WinJSContrib.UI.MultiPassItem\r\n         */\r\n    function (renderer, element, options) {\r\n        options = options || {};\r\n        var item = this;\r\n        item.renderer = renderer;\r\n        item.element = element || document.createElement('DIV');\r\n        item.element.className = item.element.className + ' ' + options.className + ' mcn-multipass-item unloaded win-disposable';\r\n        item.element.winControl = item;\r\n\r\n        item.itemInvoked = options.itemInvoked;\r\n        item.itemDataPromise = WinJS.Promise.as(options.data);\r\n\r\n        item.itemTemplate = options.template;\r\n        item.rendered = false;\r\n        item.onitemContent = options.onitemContent;\r\n        if (options.onitemInit) {\r\n            options.onitemInit(this);\r\n        }\r\n    },\r\n    /**\r\n     * @lends WinJSContrib.UI.MultiPassItem\r\n     */\r\n    {\r\n        dispose: function () {\r\n            var item = this;\r\n            item.renderer = null;\r\n            item.element = null;\r\n            item.itemInvoked = null;\r\n            item.itemData = null;\r\n            item.itemDataPromise = null;\r\n            item.itemTemplate = null;\r\n            item.onitemContent = null;\r\n        },\r\n\r\n        /**\r\n         * render item content\r\n         */\r\n        render: function (delayed) {\r\n            var ctrl = this;\r\n\r\n            if (ctrl.element && ctrl.itemTemplate && !ctrl.rendered) {\r\n\r\n                ctrl.rendered = true;\r\n                return ctrl._renderContent();\r\n            }\r\n\r\n            return WinJS.Promise.wrap(ctrl.contentElement);\r\n        },\r\n\r\n        /**\r\n         * empty item and mark it as unrendered\r\n         */\r\n        empty: function () {\r\n            var ctrl = this;\r\n            if (ctrl.element && ctrl.rendered) {\r\n                WinJSContrib.UI.untapAll(ctrl.element);\r\n                ctrl.element.classList.remove('loaded');\r\n                ctrl.element.innerHTML = '';\r\n                ctrl.rendered = false;\r\n            }\r\n        },\r\n\r\n        _renderItemContent: function (rendered) {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n\r\n            ctrl.element.appendChild(rendered);\r\n\r\n            if (ctrl.itemInvoked) {\r\n                if (typeof ctrl.itemInvoked == 'string')\r\n                    ctrl.itemInvoked = WinJSContrib.Utils.resolveMethod(ctrl.element, ctrl.itemInvoked);\r\n\r\n                if (ctrl.itemInvoked) {\r\n                    WinJSContrib.UI.tap(ctrl.element, function (arg) {\r\n                        ctrl.itemInvoked(ctrl);\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (ctrl.onitemContent) {\r\n                ctrl.onitemContent(ctrl.itemData, rendered);\r\n            }\r\n            else if (ctrl.renderer.onitemContent) {\r\n                ctrl.renderer.onitemContent(ctrl.itemData, rendered);\r\n            }\r\n\r\n            setImmediate(function () {\r\n                if (ctrl.element) {\r\n                    ctrl.element.classList.remove('unloaded');\r\n                    ctrl.element.classList.add('loaded');\r\n                }\r\n            });\r\n\r\n            ctrl.rendered = true;\r\n            ctrl.contentElement = rendered;\r\n            return rendered;\r\n        },\r\n\r\n        _renderContent: function () {\r\n            var ctrl = this;\r\n\r\n            if (ctrl.element && ctrl.itemTemplate) {\r\n                return ctrl.itemDataPromise.then(function (data) {\r\n                    ctrl.itemData = data;\r\n                    return ctrl.itemTemplate.render(data).then(function (rendered) {\r\n                        ctrl._renderItemContent(rendered);\r\n                    });\r\n                });\r\n            }\r\n\r\n            return WinJS.Promise.wrap();\r\n        }\r\n    });\r\n})();","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n(function () {\r\n\r\n\t\"use strict\";\r\n\r\n\t/**\r\n     * Object representing a layout configuration for the grid control\r\n     * @typedef {Object} WinJSContrib.UI.GridControlLayout\r\n     * @property {string} layout layout algorythm to apply (horizontal | vertical | flexhorizontal | flexvertical | hbloc\r\n     * @property {number} cellSpace space between grid cells\r\n     * @property {number} cellWidth width of grid cells\r\n     * @property {number} cellHeight height of grid cells\r\n     * @property {number} itemsPerColumn number of cells per column if using a layout with a fixed number of cells\r\n     * @property {number} itemsPerRow number of cells per row if using a layout with a fixed number of cells\r\n     * @example\r\n     * {\r\n     *     layout: 'horizontal',\r\n     *     itemsPerColumn: (options.itemsPerColumn) ? options.itemsPerColumn : undefined,\r\n     *     itemsPerRow: (options.itemsPerRow) ? options.itemsPerRow : undefined,\r\n     *     cellSpace: 10,\r\n     *     cellWidth: (options.cellWidth) ? options.cellWidth : undefined,\r\n     *     cellHeight: (options.cellHeight) ? options.cellHeight : undefined,\r\n     * }\r\n     */\r\n\r\n\tWinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n\t\tGridControl: WinJS.Class.define(\r\n            /**\r\n             * @classdesc\r\n             * Control that layout it's children with different algorythms. Used with {@link WinJSContrib.UI.Hub}, The Grid could rely on multipass rendering to optimize large hub pages load.\r\n             * @class WinJSContrib.UI.GridControl\r\n             * @param {HTMLElement} element DOM element containing the control\r\n             * @param {Object} options\r\n             */\r\n            function GridControl(element, options) {\r\n            \tvar grid = this;\r\n            \toptions = options || {};\r\n            \tgrid.element = element;\r\n\r\n            \tgrid.element.className = grid.element.className + ' mcn-grid-ctrl mcn-layout-ctrl win-disposable';\r\n            \tgrid.element.winControl = grid;\r\n\r\n\r\n            \t/**\r\n                 * multipass renderer for the grid\r\n                 * @field\r\n                 * @type WinJSContrib.UI.MultiPassRenderer\r\n                 */\r\n            \tgrid.renderer = new WinJSContrib.UI.MultiPassRenderer(grid.element, {\r\n            \t\tmultipass: options.multipass,\r\n            \t\titemClassName: options.itemClassName,\r\n            \t\titemTemplate: options.itemTemplate,\r\n            \t\titemInvoked: options.itemInvoked,\r\n            \t});\r\n\r\n\r\n            \tgrid.layouts = options.layouts;\r\n\r\n            \t/**\r\n                 * default layout definitions for the grid\r\n                 * @field\r\n                 * @type WinJSContrib.UI.GridControlLayout\r\n                 */\r\n            \tgrid.defaultLayout = {\r\n            \t\tlayout: options.layout || 'none',\r\n            \t\titemsPerColumn: (options.itemsPerColumn) ? options.itemsPerColumn : undefined,\r\n            \t\titemsPerRow: (options.itemsPerRow) ? options.itemsPerRow : undefined,\r\n            \t\tcellSpace: (options.cellSpace) ? options.cellSpace : 10,\r\n            \t\tcellWidth: (options.cellWidth) ? options.cellWidth : undefined,\r\n            \t\tcellHeight: (options.cellHeight) ? options.cellHeight : undefined,\r\n            \t};\r\n\r\n            \t/**\r\n                 * indicate if grid accept layout event from the page (if you use WinJS Contrib page events)\r\n                 * @field\r\n                 * @type boolean\r\n                 */\r\n            \tgrid.autolayout = options.autolayout || true;\r\n\r\n            \tvar parent = WinJSContrib.Utils.getScopeControl(grid.element);\r\n            \tif (parent && parent.pageLifeCycle) {\r\n            \t\tparent.pageLifeCycle.steps.layout.attach(function () {\r\n            \t\t\tif (grid.autolayout) {\r\n            \t\t\t\tgrid.layout();\r\n            \t\t\t}\r\n            \t\t});\r\n            \t}\r\n            \telse if (parent && parent.elementReady) {\r\n            \t\tparent.elementReady.then(function () {\r\n            \t\t\tparent.readyComplete.then(function () {\r\n            \t\t\t\tif (grid.autolayout) {\r\n            \t\t\t\t\tgrid.layout();\r\n            \t\t\t\t}\r\n            \t\t\t});\r\n            \t\t});\r\n            \t}\r\n            },\r\n            /**\r\n             * @lends WinJSContrib.UI.GridControl.prototype\r\n             */\r\n            {\r\n            \t/**\r\n                 * scroll element containing the grid. Required for multi pass rendering\r\n                 * @field\r\n                 * @type HTMLElement\r\n                 */\r\n            \tscrollContainer: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.scrollContainer;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.scrollContainer = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * indicate if grid layout itself according to the page lifecycle (default to true)\r\n                 * @field\r\n                 * @type boolean\r\n                 */\r\n            \tautolayout: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this._autolayout;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis._autolayout = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * layout definitions for the grid. It's an object containing several grid layout options. See {@link WinJSContrib.UI.GridControlLayout}\r\n                 * @field\r\n                 * @type Object\r\n                 */\r\n            \tlayouts: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.gridLayouts;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.gridLayouts = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * indicate the kind of multipass treatment\r\n                 * @field\r\n                 * @type string\r\n                 */\r\n            \tmultipass: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.multipass;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.multipass = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * callback triggered when clicking on an item\r\n                 * @field\r\n                 * @type HTMLElement\r\n                 */\r\n            \titemInvoked: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.itemInvoked;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.itemInvoked = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * item template (WinJS Template or template function)\r\n                 * @field\r\n                 * @type Object\r\n                 */\r\n            \titemTemplate: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.itemTemplate;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.itemTemplate = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * css class added on item's placeholder\r\n                 * @field\r\n                 * @type Object\r\n                 */\r\n            \titemClassName: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.itemClassName;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.itemClassName = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * items to render\r\n                 * @field\r\n                 * @type Object\r\n                 */\r\n            \titems: {\r\n            \t\tget: function () {\r\n            \t\t\treturn;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n\t\t\t\t\t\tif (val && val.length)\r\n            \t\t\t\tthis.prepareItems(val);\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * render HTML for items\r\n                 * @param {Array} items array of items to render\r\n                 * @param {Object} renderOptions\r\n                 */\r\n            \tprepareItems: function (items, renderOptions) {\r\n                    if (!this.element)\r\n                        return;\r\n                    \r\n            \t\tvar parent = WinJSContrib.Utils.getParentControlByClass('mcn-layout-ctrl', this.element);\r\n            \t\tvar parentMultipass = undefined;\r\n            \t\tif (!this.renderer.multipass && parent && parent.multipass) {\r\n            \t\t\tthis.renderer.multipass = parent.multipass;\r\n            \t\t}\r\n\r\n            \t\tthis.renderer.prepareItems(items, renderOptions);\r\n            \t},\r\n\r\n            \t/**\r\n                 * force items content to render\r\n                 */\r\n            \trenderItemsContent: function () {\r\n            \t\tif (!this.renderer)\r\n                        return;\r\n                    this.renderer.renderItemsContent();\r\n            \t},\r\n\r\n            \tresetElement: function (elt, isItem) {\r\n            \t\tvar style = elt.style;\r\n            \t\tif (isItem && style.position) style.position = '';\r\n            \t\tif (!isItem && style.display) style.display = '';\r\n            \t\tif (style.width) style.width = '';\r\n            \t\tif (style.height) style.height = '';\r\n            \t\tif (style.minWidth) style.minWidth = '';\r\n            \t\tif (style.minHeight) style.minHeight = '';\r\n            \t\tif (style.left) style.left = '';\r\n            \t\tif (style.top) style.top = '';\r\n            \t},\r\n\r\n            \tclearContent: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\tctrl.renderer.clear();\r\n            \t},\r\n\r\n            \t/**\r\n                 * Clear all layout and position styles on items\r\n                 */\r\n            \tclearLayout: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\t\r\n            \t\tctrl.resetElement(ctrl.element, false);\r\n            \t\tif (ctrl.element.children.length) {\r\n            \t\t\tfor (var i = 0, l = ctrl.element.children.length; i < l; i++) {\r\n            \t\t\t\tctrl.resetElement(ctrl.element.children[i], true);\r\n            \t\t\t}\r\n            \t\t}\r\n            \t},\r\n\r\n            \tfill: function (matrix, x, y, w, h) {\r\n            \t\tif (matrix.length < x + w) {\r\n            \t\t\tfor (var i = matrix.length ; i < x + w ; i++) {\r\n            \t\t\t\tmatrix.push([]);\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\tfor (var i = x ; i < x + w ; i++) {\r\n            \t\t\tvar col = matrix[i];\r\n            \t\t\tif (col.length < y + h) {\r\n            \t\t\t\tfor (var j = col.length ; j < y + h ; j++) {\r\n            \t\t\t\t\tcol.push(false);\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n\r\n            \t\t\tfor (var j = y ; j < y + h ; j++) {\r\n            \t\t\t\tcol[j] = true;\r\n            \t\t\t}\r\n            \t\t}\r\n            \t},\r\n\r\n            \tfit: function (matrix, x, y, w, h, maxW, maxH) {\r\n            \t\t//items to big\r\n            \t\tif (maxH && h > maxH && y === 0)\r\n            \t\t\treturn true;\r\n            \t\tif (maxW && w > maxW && x === 0)\r\n            \t\t\treturn true;\r\n\r\n            \t\t//overflow grid capacity\r\n            \t\tif (maxW && (x + w) > maxW)\r\n            \t\t\treturn false;\r\n            \t\tif (maxH && (y + h) > maxH)\r\n            \t\t\treturn false;\r\n\r\n            \t\tfor (var i = x ; i < x + w ; i++) {\r\n            \t\t\tvar col = matrix[i];\r\n            \t\t\tif (col) {\r\n            \t\t\t\tfor (var j = y ; j < y + h ; j++) {\r\n            \t\t\t\t\tif (col[j] === true)\r\n            \t\t\t\t\t\treturn false;\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\treturn true;\r\n            \t},\r\n\r\n            \tfirstFit: function (matrix, w, h, maxH, numItems) {\r\n            \t\tvar ctrl = this;\r\n            \t\tfor (var i = 0 ; i < numItems * maxH * 2 ; i++) {\r\n            \t\t\tvar col = matrix[i];\r\n            \t\t\tif (col) {\r\n            \t\t\t\tfor (var j = 0 ; j < maxH ; j++) {\r\n            \t\t\t\t\tif (col[j] !== true && ctrl.fit(matrix, i, j, w, h, undefined, maxH)) {\r\n            \t\t\t\t\t\treturn { x: i, y: j };\r\n            \t\t\t\t\t}\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n            \t\t\telse {\r\n            \t\t\t\treturn { x: i, y: 0 };\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\treturn undefined;\r\n            \t},\r\n\r\n            \tvisibleChilds: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\tvar res = [];\r\n\r\n            \t\tfor (var i = 0, l = ctrl.element.children.length; i < l ; i++) {\r\n            \t\t\tvar item = ctrl.element.children[i];\r\n            \t\t\tvar st = window.getComputedStyle(item);\r\n            \t\t\tif (st.display != 'none' && st.visibility != 'hidden') {\r\n            \t\t\t\tres.push(item);\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\treturn res;\r\n            \t},\r\n\r\n            \t/**\r\n                 * Layouts algorythm implementations\r\n                 */\r\n            \tGridLayoutsImpl: {\r\n            \t\tnone: function () {\r\n            \t\t},\r\n\r\n            \t\tflexhorizontal: function () {\r\n            \t\t\tvar ctrl = this;\r\n            \t\t\tctrl.renderer.orientation = 'horizontal';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\tctrl.element.style.display = 'flex';\r\n            \t\t\tctrl.element.style.flexFlow = 'column wrap';\r\n            \t\t\tctrl.element.style.alignContent = 'flex-start';\r\n            \t\t\t//ctrl.element.style.alignContent = 'flex-start';\r\n\r\n            \t\t\tif (ctrl.element.style.width)\r\n            \t\t\t\tctrl.element.style.width = '';\r\n\r\n            \t\t\tctrl.element.style.height = '';\r\n\r\n            \t\t\tif (ctrl.element.clientHeight)\r\n            \t\t\t\tctrl.element.style.height = ctrl.element.clientHeight + 'px';\r\n            \t\t\telse\r\n            \t\t\t\tctrl.element.style.height = '';\r\n\r\n            \t\t\tvar _itemsPerColumn = Math.floor(ctrl.element.clientHeight / (ctrl.data.cellHeight + ctrl.data.cellSpace));\r\n            \t\t\tif (_itemsPerColumn) {\r\n            \t\t\t\tvar visibleitems = ctrl.visibleChilds();\r\n            \t\t\t\tvar columns = Math.ceil(visibleitems.length / _itemsPerColumn);\r\n            \t\t\t\tctrl.element.style.minWidth = ((ctrl.data.cellWidth + ctrl.data.cellSpace) * columns) + 'px';\r\n            \t\t\t}\r\n            \t\t},\r\n\r\n            \t\tflexvertical: function () {\r\n            \t\t    var ctrl = this;\r\n                        ctrl.renderer.orientation = 'vertical';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\tctrl.element.style.display = 'flex';\r\n            \t\t\tctrl.element.style.flexFlow = 'row wrap';\r\n            \t\t\tctrl.element.style.alignContent = 'flex-start';\r\n\r\n            \t\t\tctrl.element.style.width = '';\r\n            \t\t\tif (ctrl.element.clientWidth)\r\n            \t\t\t\tctrl.element.style.width = ctrl.element.clientWidth + 'px';\r\n            \t\t\telse\r\n            \t\t\t\tctrl.element.style.width = '';\r\n\r\n            \t\t\tif (ctrl.element.style.height)\r\n            \t\t\t\tctrl.element.style.height = '';\r\n            \t\t},\r\n\r\n            \t\thbloc: function () {\r\n            \t\t\tvar ctrl = this;\r\n            \t\t\tctrl.renderer.orientation = 'horizontal';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\tctrl.element.style.height = '';\r\n            \t\t\tvar _containerH = ctrl.element.clientHeight;\r\n            \t\t\tif (!_containerH)\r\n            \t\t\t\treturn;\r\n\r\n            \t\t\tvar cellW = ctrl.data.cellWidth;\r\n            \t\t\tvar space = ctrl.data.cellSpace;\r\n            \t\t\tvar colCount = 1;\r\n            \t\t\tvar colOffset = 0;\r\n            \t\t\tvar topOffset = 0;\r\n\r\n            \t\t\tvar childs = ctrl.visibleChilds();\r\n            \t\t\tchilds.forEach(function (elt) {\r\n            \t\t\t\tif (elt.style.position != 'absolute')\r\n            \t\t\t\t\telt.style.position = 'absolute';\r\n            \t\t\t\tvar eltH = elt.clientHeight;\r\n            \t\t\t\tif (topOffset + eltH > _containerH) {\r\n            \t\t\t\t\tcolCount++;\r\n            \t\t\t\t\tcolOffset = colOffset + space + cellW;\r\n            \t\t\t\t\ttopOffset = 0;\r\n            \t\t\t\t}\r\n\r\n            \t\t\t\tif (elt.style.left != colOffset + 'px')\r\n            \t\t\t\t\telt.style.left = colOffset + 'px';\r\n            \t\t\t\tif (elt.style.top != topOffset + 'px')\r\n            \t\t\t\t\telt.style.top = topOffset + 'px';\r\n\r\n            \t\t\t\ttopOffset += eltH;\r\n            \t\t\t});\r\n\r\n            \t\t\tcolOffset = colOffset + cellW;\r\n            \t\t\tif (ctrl.element.style.width != colOffset + 'px')\r\n            \t\t\t\tctrl.element.style.width = colOffset + 'px';\r\n            \t\t},\r\n\r\n            \t\thorizontal: function () {\r\n            \t\t\tvar ctrl = this;\r\n            \t\t\tctrl.renderer.orientation = 'horizontal';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\tctrl.element.style.height = '';\r\n            \t\t\tvar _containerH = ctrl.element.clientHeight;\r\n            \t\t\tif (!_containerH)\r\n            \t\t\t\treturn;\r\n\r\n            \t\t\tvar _itemsPerColumn = Math.floor(_containerH / (ctrl.data.cellHeight + ctrl.data.cellSpace));\r\n            \t\t\tif (_itemsPerColumn <= 0)\r\n            \t\t\t\t_itemsPerColumn = 1;\r\n\r\n            \t\t\tvar cellW = ctrl.data.cellWidth;\r\n            \t\t\tvar cellH = ctrl.data.cellHeight;\r\n            \t\t\tvar space = ctrl.data.cellSpace;\r\n            \t\t\tvar aspectRatio = cellW / cellH;\r\n            \t\t\tvar ratioW = 1;\r\n            \t\t\tvar ratioH = 1;\r\n\r\n            \t\t\tif (ctrl.data.itemsPerColumn) {\r\n            \t\t\t\t_itemsPerColumn = ctrl.data.itemsPerColumn;\r\n            \t\t\t\tcellH = ((_containerH - ((_itemsPerColumn - 1) * space)) / _itemsPerColumn) >> 0;\r\n            \t\t\t\tcellW = (ctrl.data.cellWidth * cellH / ctrl.data.cellHeight) >> 0;\r\n            \t\t\t\tratioW = cellW / ctrl.data.cellWidth;\r\n            \t\t\t\tratioH = cellH / ctrl.data.cellHeight;\r\n            \t\t\t}\r\n\r\n            \t\t\tvar gridCellsMatrix = [[]];\r\n            \t\t\tvar childs = ctrl.visibleChilds();\r\n            \t\t\tchilds.forEach(function (elt) {\r\n            \t\t\t\telt.style.position = 'absolute';\r\n            \t\t\t\tvar eltW = elt.offsetWidth * ratioW;\r\n            \t\t\t\tvar eltH = elt.offsetHeight * ratioH;\r\n            \t\t\t\tvar eltColumns = (eltW / cellW) >> 0;\r\n            \t\t\t\tvar eltRows = (eltH / cellH) >> 0;\r\n\r\n            \t\t\t\tvar pos = ctrl.firstFit(gridCellsMatrix, eltColumns, eltRows, _itemsPerColumn, ctrl.element.children.length);\r\n            \t\t\t\tif (!pos)\r\n            \t\t\t\t\tpos = { x: 0, y: 0 };\r\n            \t\t\t\tctrl.fill(gridCellsMatrix, pos.x, pos.y, eltColumns, eltRows);\r\n\r\n            \t\t\t\tvar left = pos.x * (cellW + space);\r\n            \t\t\t\tvar top = pos.y * (cellH + space);\r\n            \t\t\t\tvar w = (eltColumns * cellW + ((eltColumns - 1) * space));\r\n            \t\t\t\tvar h = (eltRows * cellH + ((eltRows - 1) * space));\r\n            \t\t\t\telt.style.left = left + 'px';\r\n            \t\t\t\telt.style.top = top + 'px';\r\n            \t\t\t\telt.style.width = w + 'px';\r\n            \t\t\t\telt.style.height = h + 'px';\r\n            \t\t\t});\r\n\r\n            \t\t\tvar elementWidth = gridCellsMatrix.length * (cellW + space);\r\n            \t\t\tctrl.element.style.width = elementWidth + 'px';\r\n            \t\t},\r\n\r\n            \t\tvertical: function (plugin) {\r\n            \t\t\tvar ctrl = this;\r\n            \t\t\tctrl.renderer.orientation = 'vertical';\r\n            \t\t\tctrl.element.style.width = '';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\t//Be aware that in this case, we invert the matrix to crawl data in lines\r\n            \t\t\tvar _containerW = ctrl.element.clientWidth;\r\n            \t\t\tif (!_containerW)\r\n            \t\t\t\treturn;\r\n\r\n            \t\t\tvar _itemsPerLine = Math.floor(_containerW / (ctrl.data.cellWidth + ctrl.data.cellSpace));\r\n            \t\t\tif (_itemsPerLine <= 0)\r\n            \t\t\t\t_itemsPerLine = 1;\r\n\r\n            \t\t\tvar cellW = ctrl.data.cellWidth;\r\n            \t\t\tvar cellH = ctrl.data.cellHeight;\r\n            \t\t\tvar space = ctrl.data.cellSpace;\r\n            \t\t\tvar aspectRatio = cellW / cellH;\r\n            \t\t\tvar ratioW = 1;\r\n            \t\t\tvar ratioH = 1;\r\n\r\n            \t\t\tif (ctrl.data.itemsPerRow) {\r\n            \t\t\t\t_itemsPerLine = ctrl.data.itemsPerRow;\r\n            \t\t\t\tcellW = ((_containerW - ((_itemsPerLine - 1) * space)) / _itemsPerLine) >> 0;\r\n            \t\t\t\tcellH = (ctrl.data.cellHeight * cellW / ctrl.data.cellWidth) >> 0;\r\n            \t\t\t\tratioW = cellW / ctrl.data.cellWidth;\r\n            \t\t\t\tratioH = cellH / ctrl.data.cellHeight;\r\n            \t\t\t}\r\n\r\n            \t\t\tvar gridCellsMatrix = [[]];\r\n            \t\t\tvar childs = ctrl.visibleChilds();\r\n            \t\t\tchilds.forEach(function (elt) {\r\n            \t\t\t\telt.style.position = 'absolute';\r\n\r\n            \t\t\t\tvar eltW = elt.offsetWidth * ratioW;\r\n            \t\t\t\tvar eltH = elt.offsetHeight * ratioH;\r\n            \t\t\t\tvar eltColumns = (eltW / cellW) >> 0;\r\n            \t\t\t\tvar eltRows = (eltH / cellH) >> 0;\r\n\r\n            \t\t\t\tvar pos = ctrl.firstFit(gridCellsMatrix, eltRows, eltColumns, _itemsPerLine, ctrl.element.children.length);\r\n            \t\t\t\t//if (!pos)\r\n            \t\t\t\t//    return;\r\n\r\n            \t\t\t\tctrl.fill(gridCellsMatrix, pos.x, pos.y, eltRows, eltColumns);\r\n\r\n            \t\t\t\tvar left = pos.y * (cellW + space);\r\n            \t\t\t\tvar top = pos.x * (cellH + space);\r\n            \t\t\t\telt.style.left = left + 'px';\r\n            \t\t\t\telt.style.top = top + 'px';\r\n            \t\t\t\telt.style.width = (eltColumns * cellW + ((eltColumns - 1) * space)) + 'px';\r\n            \t\t\t\telt.style.height = (eltRows * cellH + ((eltRows - 1) * space)) + 'px';\r\n\r\n            \t\t\t});\r\n\r\n            \t\t\tvar elementHeight = gridCellsMatrix.length * (cellH + space);\r\n            \t\t\tctrl.element.style.height = elementHeight + 'px';\r\n            \t\t},\r\n            \t},\r\n\r\n            \t/**\r\n                 * layout content items\r\n                 */\r\n            \tlayout: function () {\r\n            \t    var ctrl = this;\r\n            \t    if (!ctrl.element)\r\n            \t        return;\r\n            \t\tvar oldlayout = ctrl.data;\r\n            \t\tctrl.data = ctrl.getLayout();\r\n\r\n            \t\tif (ctrl.data) {\r\n            \t\t\t//if (ctrl.data == oldlayout && ctrl.data.applyed)\r\n            \t\t\t//    return;\r\n\r\n            \t\t\tctrl.data.cellSpace = (ctrl.data.cellSpace != undefined ? ctrl.data.cellSpace : (ctrl.defaultLayout.cellSpace != undefined ? ctrl.defaultLayout.cellSpace : 10));\r\n            \t\t\tctrl.data.cellWidth = ctrl.data.cellWidth || ctrl.defaultLayout.cellWidth || 0;\r\n            \t\t\tctrl.data.cellHeight = ctrl.data.cellHeight || ctrl.defaultLayout.cellHeight || 0;\r\n\r\n            \t\t\t//if cell dimensions are not defined, take it from last child\r\n            \t\t\tif (!ctrl.data.cellWidth || !ctrl.data.cellHeight) {\r\n            \t\t\t    if (ctrl.element && ctrl.element.childNodes && ctrl.element.children.length > 0) {\r\n            \t\t\t\t\tvar childs = ctrl.visibleChilds();\r\n            \t\t\t\t\tif (childs && childs.length) {\r\n            \t\t\t\t\t\tvar firstChild = childs[0];\r\n            \t\t\t\t\t\tvar w = firstChild.clientWidth;\r\n            \t\t\t\t\t\tvar h = firstChild.clientHeight;\r\n            \t\t\t\t\t\tvar l = childs.length;\r\n            \t\t\t\t\t\tif (l > 10) l = 10;\r\n            \t\t\t\t\t\tfor (var i = 0, l = childs.length; i < l ; i++) {\r\n            \t\t\t\t\t\t\tvar item = childs[i];\r\n            \t\t\t\t\t\t\tif (w == 0 || item.clientWidth < w) {\r\n            \t\t\t\t\t\t\t\tw = item.clientWidth;\r\n            \t\t\t\t\t\t\t}\r\n            \t\t\t\t\t\t\tif (h == 0 || item.clientHeight < h) {\r\n            \t\t\t\t\t\t\t\th = item.clientHeight;\r\n            \t\t\t\t\t\t\t}\r\n            \t\t\t\t\t\t}\r\n            \t\t\t\t\t\tctrl.data.cellWidth = w;\r\n            \t\t\t\t\t\tctrl.data.cellHeight = h;\r\n            \t\t\t\t\t}\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n\r\n            \t\t\tvar layoutChanged = !oldlayout || ctrl.data.layout !== oldlayout.layout;\r\n            \t\t\tif (ctrl.data.layout) {\r\n            \t\t\t\tvar layoutfunc = ctrl.GridLayoutsImpl[ctrl.data.layout.toLowerCase()];\r\n            \t\t\t\tif (layoutfunc) {\r\n            \t\t\t\t\tif (layoutChanged)\r\n            \t\t\t\t\t\tctrl.changeLayout();\r\n\r\n            \t\t\t\t\tlayoutfunc.bind(ctrl)(layoutChanged);\r\n            \t\t\t\t\tctrl.data.applyed = true;\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n            \t\t\tctrl.renderer.checkRendering();\r\n            \t\t}\r\n            \t},\r\n\r\n            \tchangeLayout: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\tctrl.clearLayout();\r\n            \t\tctrl.renderer.updateLayout();\r\n            \t},\r\n\r\n            \t/**\r\n                 * update grid layout\r\n                 */\r\n            \tupdateLayout: function (element, viewState, lastViewState) {\r\n            \t    var ctrl = this;\r\n            \t    if (!ctrl.element)\r\n            \t        return;\r\n            \t\tctrl.layout();\r\n            \t},\r\n\r\n            \t/**\r\n                 * get layout applicable to the current context\r\n                 */\r\n            \tgetLayout: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\tvar matchingLayout = undefined;\r\n            \t\tif (ctrl.gridLayouts) {\r\n            \t\t\tfor (var name in ctrl.gridLayouts) {\r\n            \t\t\t\tvar layout = ctrl.gridLayouts[name];\r\n            \t\t\t\tif (ctrl.gridLayouts.hasOwnProperty(name)) {\r\n            \t\t\t\t\tif (layout.query) {\r\n            \t\t\t\t\t\tvar mq = window.matchMedia(layout.query);\r\n            \t\t\t\t\t\tif (mq.matches) {\r\n            \t\t\t\t\t\t\tmatchingLayout = layout;\r\n            \t\t\t\t\t\t}\r\n            \t\t\t\t\t} else if (!matchingLayout) {\r\n            \t\t\t\t\t\tmatchingLayout = layout;\r\n            \t\t\t\t\t}\r\n            \t\t\t\t}\r\n            \t\t\t\telse if (!matchingLayout) {\r\n            \t\t\t\t\tmatchingLayout = layout;\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\tif (!matchingLayout) {\r\n            \t\t\tmatchingLayout = ctrl.defaultLayout;\r\n            \t\t}\r\n\r\n            \t\treturn JSON.parse(JSON.stringify(matchingLayout));\r\n            \t},\r\n\r\n            \t/**\r\n                 * Release grid resources\r\n                 */\r\n            \tdispose: function () {\r\n            \t\tthis.element = null;\r\n            \t\tthis.renderer.dispose();\r\n            \t\tif (WinJS.Utilities.disposeSubTree)\r\n            \t\t\tWinJS.Utilities.disposeSubTree(this.element);\r\n            \t}\r\n            })\r\n\t});\r\n\r\n\tif (WinJSContrib.UI.WebComponents) {\r\n\t\tWinJSContrib.UI.WebComponents.register('mcn-grid', WinJSContrib.UI.GridControl, {\r\n\t\t\tproperties: ['multipass', 'autolayout', 'layouts', 'itemInvoked', 'itemTemplate', 'itemClassName', 'items']\r\n\t\t});\r\n\t}\r\n})();","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib = WinJSContrib || {};\r\nWinJSContrib.UI = WinJSContrib.UI || {};\r\n\r\n/** @namespace */\r\nWinJSContrib.UI.DataSources = WinJSContrib.UI.DataSources || {};\r\n\r\n\r\n(function (ds, gr) {\r\n    \"use strict\";\r\n\r\n    ds.DataSourceManager = WinJS.Class.mix(WinJS.Class.define(\r\n    /** \r\n     * \r\n     * @class WinJSContrib.UI.DataSources.DataSourceManager\r\n     * @classdesc helper class to manage an array with filter and grouping facilities and plug it into listview with or without semantic zoom. \r\n     * This is a low level helper object, it's likely that relying on {@link WinJSContrib.UI.SemanticListViews} will be easier.\r\n     * @param {Object} options\r\n     * @example\r\n     * {@lang javascript}\r\n     * var datamgr = new WinJSContrib.UI.DataSources.DataSourceManager({\r\n     *    defaultGroupLimit: 12,\r\n     *    groupKind: WinJSContrib.UI.DataSources.Grouping.byField,\r\n     *    field: 'metadata.genre',\r\n     *    listview: page.zoomedInList,\r\n     *    zoomedOutListView: page.zoomedOutList\r\n     * });\r\n     * \r\n     */\r\n    function (options) {\r\n        this.groupedList = null;\r\n        this.list = null;\r\n        this.defaultGroupLimit = 0;\r\n        this.filters = new WinJS.Binding.List();\r\n        this.filters.onitemchanged = this.init.bind(this);\r\n        this.filters.oniteminserted = this.init.bind(this);\r\n        this.filters.onitemremoved = this.init.bind(this);\r\n        this.apply(options);\r\n    },\r\n    /**\r\n     * @lends WinJSContrib.UI.DataSources.DataSourceManager.prototype\r\n     */\r\n    {\r\n        apply: function (options) {\r\n            options = options || {};\r\n\r\n            if (options.field)\r\n                this.field = options.field;\r\n\r\n            if (options.defaultGroupLimit) this.defaultGroupLimit = options.defaultGroupLimit;\r\n            if (options.filter) this.filter = options.filter;\r\n            if (options.groupKind) {\r\n                if (options.groupKind != this.groupKind) {\r\n                    this.groupKind = options.groupKind;\r\n                }\r\n                options = options.groupKind(options);\r\n            }\r\n            if (options.defaultGroupName) this.defaultGroupName = options.defaultGroupName;\r\n            if (options.compareGroups) this.compareGroups = options.compareGroups;\r\n            if (options.getGroupKey) this.getGroupKey = options.getGroupKey;\r\n            if (options.getGroupData) this.getGroupData = options.getGroupData;\r\n            if (options.listview) this.listview = options.listview;\r\n            if (options.zoomedOutListView) this.zoomedOutListView = options.zoomedOutListView;\r\n            if (options.items) this.items = options.items;\r\n\r\n        },\r\n\r\n        /**\r\n         * path to the field to use for groupings\r\n         * @field\r\n         * @type string\r\n         */\r\n        field: {\r\n            get: function () {\r\n                return this._field;\r\n            },\r\n            set: function (val) {\r\n                this._field = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * no grouping if items.length < defaultGroupLimit\r\n         * @field\r\n         * @type number\r\n         */\r\n        defaultGroupLimit: {\r\n            get: function () {\r\n                return this._defaultGroupLimit;\r\n            },\r\n            set: function (val) {\r\n                this._defaultGroupLimit = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * groupKind grouping manager function\r\n         * @field\r\n         * @type function\r\n         */\r\n        groupKind: {\r\n            get: function () {\r\n                return this._groupKind;\r\n            },\r\n            set: function (val) {\r\n                if (val != this._groupKind) {\r\n                    this._groupKind = val;\r\n                    this.apply({ groupKind: val });\r\n                    this.init();\r\n                }\r\n                if (!val) {\r\n                    this.compareGroups = null;\r\n                    this.getGroupData = null;\r\n                    this.getGroupKey = null;\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * items listview\r\n         * @field\r\n         * @type WinJS.UI.ListView\r\n         */\r\n        listview: {\r\n            get: function () {\r\n                return this._listview;\r\n            },\r\n            set: function (val) {\r\n                if (this._listview) {\r\n                    this.detach();\r\n                }\r\n\r\n                this._listview = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * listview for grouped items\r\n         * @field\r\n         * @type WinJS.UI.ListView\r\n         */\r\n        groupedList: {\r\n            get: function () {\r\n                return this._groupedList;\r\n            },\r\n            set: function (val) {\r\n                this._groupedList = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * item filter callback\r\n         * @field\r\n         * @type function\r\n         */\r\n        filter: {\r\n            get: function () {\r\n                return this._filter;\r\n            },\r\n            set: function (val) {\r\n                if (this._filter) {\r\n                    this.detach();\r\n                }\r\n\r\n                this._filter = val;\r\n                if (val) {\r\n                    this.init();\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * data items\r\n         * @field\r\n         * @type Array\r\n         */\r\n        items: {\r\n            get: function () {\r\n                return this._items;\r\n            },\r\n            set: function (val) {\r\n                if (this._items) {\r\n                    this.detach();\r\n                }\r\n                this._items = val;\r\n                if (val) {\r\n                    this.init();\r\n                }\r\n                else {\r\n                    this.list = null;\r\n                    this.groupedList = null;\r\n                    this.filteredlist = null;\r\n                    this.detach();\r\n                }\r\n            }\r\n        },\r\n\r\n        _filterItems: function (item) {\r\n            var ctrl = this;\r\n            var res = function (item) { return true; };\r\n\r\n            if (this.filter)\r\n                res = function (item) { return ctrl.filter(item) };\r\n\r\n            if (this.filters.length) {\r\n                var addFilter = function (f, newFilter) {\r\n                    return function (item) {\r\n                        var tmp = f(item);\r\n                        if (!tmp)\r\n                            return false;\r\n\r\n                        return newFilter(item);\r\n                    }\r\n                }\r\n\r\n                for (var i = 0 ; i < this.filters.length ; i++) {\r\n                    var filter = this.filters.getAt(i);\r\n                    res = addFilter(res, filter);\r\n                }\r\n            }\r\n\r\n            return res;\r\n        },\r\n\r\n        refresh: function () {\r\n            this.init();\r\n        },\r\n\r\n        /**\r\n         * initialise data\r\n         */\r\n        init: function (dontAttach) {\r\n            var ctrl = this;\r\n            this.detach();\r\n            if (this.items) {\r\n                this.list = new WinJS.Binding.List(this.items);\r\n\r\n                if (this.filter || this.filters.length) {\r\n                    var filterCallback = this._filterItems();\r\n                    this.filteredlist = this.list.createFiltered(filterCallback);\r\n                }\r\n                else {\r\n                    this.filteredlist = this.list;\r\n                }\r\n\r\n                if (this.getGroupKey && this.getGroupData && this.compareGroups) {\r\n                    this.groupedList = this.filteredlist.createGrouped(this.getGroupKey.bind(this), this.getGroupData.bind(this), this.compareGroups.bind(this));\r\n\r\n                    var g = ctrl.groupedList.groups;\r\n                    for (var n in g._groupItems) {\r\n                        console.log(n);\r\n                        var grp = ctrl.groupedList._groupsProjection._groupItems[n];\r\n                        if (grp && grp.groupSize !== undefined)\r\n                            grp.data.groupCount = grp.groupSize;\r\n                    }\r\n                } else {\r\n                    this.groupedList = null;\r\n                }\r\n\r\n                if (!dontAttach)\r\n                    this.attach();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * clean-up, initialise data and bind listviews to data\r\n         * @param {Array} items\r\n         */\r\n        prepareItems: function (items) {\r\n            this.detach();\r\n            this._items = items;\r\n            this.init(true);\r\n        },\r\n\r\n        /**\r\n         * attach listviews to data\r\n         */\r\n        attach: function () {\r\n            if ((this.groupedList || this.filteredlist) && this.listview) {\r\n                if (this.groupedList && this.groupedList.length >= this.defaultGroupLimit) {\r\n                    this.listview.itemDataSource = this.groupedList.dataSource;\r\n                    this.listview.groupDataSource = this.groupedList.groups.dataSource;\r\n\r\n                    if (this.zoomedOutListView)\r\n                        this.zoomedOutListView.itemDataSource = this.groupedList.groups.dataSource;\r\n\r\n                    var semzoom = this.parentSemanticZoom();\r\n                    if (semzoom) {\r\n                        semzoom.locked = false;\r\n                    }\r\n                }\r\n                else if (this.filteredlist && (this.filteredlist.length >= this.defaultGroupLimit || !this.groupedList)) {\r\n                    this.listview.itemDataSource = this.filteredlist.dataSource;\r\n                    this.listview.groupDataSource = null;\r\n                    var semzoom = this.parentSemanticZoom();\r\n                    if (semzoom) {\r\n                        semzoom.locked = true;\r\n                    }\r\n                }\r\n                //else if (this.filteredlist && this.filteredlist.length) {\r\n                //    this.listview.itemDataSource = this.filteredlist.dataSource;\r\n                //    this.listview.groupDataSource = null;\r\n                //    var semzoom = this.parentSemanticZoom();\r\n                //    if (semzoom) {\r\n                //        semzoom.locked = true;\r\n                //    }\r\n                //}\r\n                else {\r\n                    if (this.groupedList)\r\n                        this.listview.itemDataSource = this.groupedList.dataSource;\r\n                    this.listview.groupDataSource = null;\r\n                    if (this.zoomedOutListView)\r\n                        this.zoomedOutListView.itemDataSource = null;\r\n\r\n                    var semzoom = this.parentSemanticZoom();\r\n                    if (semzoom) {\r\n                        semzoom.locked = true;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * get parent semantic zoom control\r\n         * @returns {WinJS.UI.SemanticZoom}\r\n         */\r\n        parentSemanticZoom: function () {\r\n            var parent = this.listview.element.parentElement;\r\n            while (parent) {\r\n                if (parent.classList.contains('win-semanticzoom'))\r\n                    return parent.winControl;\r\n                parent = parent.parentElement;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * detach listviews from data\r\n         */\r\n        detach: function () {\r\n            if (this.listview) {\r\n                this.listview.itemDataSource = null;\r\n                this.listview.groupDataSource = null;\r\n                if (this.zoomedOutListView)\r\n                    this.zoomedOutListView.itemDataSource = null;\r\n            }\r\n        }\r\n    }), WinJS.UI.DOMEventMixin);\r\n\r\n    WinJSContrib.UI.SemanticListViews = WinJS.Class.mix(WinJS.Class.define(\r\n    /** \r\n     * \r\n     * @class WinJSContrib.UI.SemanticListViews\r\n     * @classdesc Control wrapping semantic zoom and listviews with a {@link WinJSContrib.UI.DataSources.DataSourceManager}\r\n     * @param {HTMLElement} element DOM element containing the control\r\n     * @param {Object} options\r\n     * \r\n     * @example {@lang xml}\r\n     * <div id=\"semanticzoom\" data-win-control=\"WinJSContrib.UI.SemanticListViews\" data-win-options=\"{\r\n     *      listview: { itemTemplate: select('#listItemTemplate'), groupHeaderTemplate : select('#groupItemTemplate')},\r\n     *      zoomedOutListview: { itemTemplate: select('#semanticItemTemplate')},\r\n     *      data: {\r\n     *          defaultGroupLimit: 12,\r\n     *          groupKind: WinJSContrib.UI.DataSources.Grouping.byField,\r\n     *          field: 'metadata.genre',\r\n     *          items: moviesSample\r\n     *      }}\">\r\n     * </div>\r\n     */\r\n    function ctor(element, options) {\r\n        this.element = element || document.createElement('DIV');\r\n        options = options || {};\r\n        this.element.winControl = this;\r\n        this.element.classList.add('win-disposable');\r\n        WinJS.UI.setOptions(this, options);\r\n        this._initControl(options);\r\n    },\r\n    /**\r\n     * @lends WinJSContrib.UI.SemanticListViews.prototype\r\n     */\r\n    {\r\n        /**\r\n         * semantic zoom control\r\n         * @field\r\n         * @type {WinJS.UI.SemanticZoom}\r\n         */\r\n        semanticZoom: {\r\n            get: function () {\r\n                return this._semanticZoom;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * items listview\r\n         * @field\r\n         * @type WinJS.UI.ListView \r\n         */\r\n        listview: {\r\n            get: function () {\r\n                return this._listview;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * listview for zoomed out items (usually groups)\r\n         * @field\r\n         * @type WinJS.UI.ListView \r\n         */\r\n        zoomedOutListview: {\r\n            get: function () {\r\n                return this._zoomedOutListview;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * dataManager datasource manager\r\n         * @field\r\n         * @type WinJSContrib.UI.DataSources.DataSourceManager \r\n         */\r\n        dataManager: {\r\n            get: function () {\r\n                return this._dataManager;\r\n            }\r\n        },\r\n\r\n        _initControl: function (options) {\r\n            var semanticPlaceholder = document.createElement('DIV')\r\n            semanticPlaceholder.style.width = '100%';\r\n            semanticPlaceholder.style.height = '100%';\r\n\r\n            var listviewPlaceholder = document.createElement('DIV');\r\n            listviewPlaceholder.style.width = '100%';\r\n            listviewPlaceholder.style.height = '100%';\r\n            listviewPlaceholder.className = 'zoomedinlist';\r\n\r\n            var zoomedOutListviewPlaceholder = document.createElement('DIV');\r\n            zoomedOutListviewPlaceholder.style.width = '100%';\r\n            zoomedOutListviewPlaceholder.style.height = '100%';\r\n            zoomedOutListviewPlaceholder.className = 'zoomedoutlist';\r\n\r\n            semanticPlaceholder.appendChild(listviewPlaceholder);\r\n            semanticPlaceholder.appendChild(zoomedOutListviewPlaceholder);\r\n            this.element.appendChild(semanticPlaceholder);\r\n\r\n            this._listview = new WinJS.UI.ListView(listviewPlaceholder, options.listview);\r\n            this._zoomedOutListview = new WinJS.UI.ListView(zoomedOutListviewPlaceholder, options.zoomedOutListview);\r\n\r\n            this._semanticZoom = new WinJS.UI.SemanticZoom(semanticPlaceholder, options.semanticzoom);\r\n\r\n            var dataOptions = options.data || {};\r\n            dataOptions.listview = this._listview;\r\n            dataOptions.zoomedOutListView = this._zoomedOutListview;\r\n            this._dataManager = new ds.DataSourceManager(dataOptions);\r\n        },\r\n\r\n        /**\r\n         * release control\r\n         */\r\n        dispose: function () {\r\n            WinJS.Utilities.disposeSubTree(this.element);\r\n        }\r\n    }), WinJS.UI.DOMEventMixin, WinJS.Utilities.createEventProperties(\"myevent\"));\r\n})(WinJSContrib.UI.DataSources, WinJSContrib.UI.DataSources.Grouping);\r\n\r\nif (WinJSContrib.UI.WebComponents) {\r\n    WinJSContrib.UI.WebComponents.register('mcn-semanticlistviews', WinJSContrib.UI.SemanticListViews, {\r\n        properties: [],\r\n        controls: {\r\n            \"listview\": WinJS.UI.ListView,\r\n            \"zoomedOutListview\": WinJS.UI.ListView,\r\n            \"semanticZoom\": WinJS.UI.SemanticZoom\r\n        },\r\n        map: {\r\n            \"DEFAULTGROUPLIMIT\": { attribute: 'defaultGroupLimit', property: '_dataManager.defaultGroupLimit', resolve: true },\r\n            \"GROUPKIND\": { attribute: 'groupKind', property: '_dataManager.groupKind', resolve: true },\r\n            \"FIELD\": { attribute: 'field', property: '_dataManager.field', resolve: true },\r\n            \"ITEMS\": { attribute: 'items', property: '_dataManager.items', resolve: true },\r\n        }\r\n    });\r\n}\r\n\r\n/** \r\n * Custom grouping settings for {@link WinJSContrib.UI.DataSources.DataSourceManager}\r\n * @namespace \r\n * @example\r\n * var datamgr = new WinJSContrib.UI.DataSources.DataSourceManager({\r\n *    defaultGroupLimit: 12,\r\n *    groupKind: WinJSContrib.UI.DataSources.Grouping.byField,\r\n *    field: 'metadata.genre',\r\n *    listview: page.zoomedInList,\r\n *    zoomedOutListView: page.zoomedOutList\r\n * });\r\n */\r\nWinJSContrib.UI.DataSources.Grouping = WinJSContrib.UI.DataSources.Grouping || {};\r\n\r\n(function (ds, gr) {\r\n    \"use strict\";\r\n\r\n    /**\r\n     * alphabetic grouping, use \"options.field\" to define the property used for grouping\r\n     * @param {Object} options grouping options\r\n     * @returns {Object} group manager\r\n     */\r\n    WinJSContrib.UI.DataSources.Grouping.alphabetic = WinJS.Utilities.markSupportedForProcessing(function (options) {\r\n        options = options || {};\r\n        options.defaultGroupName = options.defaultGroupName || '#';\r\n\r\n        options.compareGroups = options.compareGroups || function (left, right) {\r\n            return left.toUpperCase().charCodeAt(0) - right.toUpperCase().charCodeAt(0);\r\n        }\r\n\r\n        options.getGroupKey = options.getGroupKey || function (dataItem) {\r\n            if (!dataItem)\r\n                return this.defaultGroupName;\r\n\r\n            var val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                return this.defaultGroupName;\r\n\r\n            var key = val[0].toUpperCase();\r\n            return key;\r\n        }\r\n\r\n        options.getGroupData = options.getGroupData || function (dataItem) {\r\n            var val = '#';\r\n            if (dataItem)\r\n                val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                val = this.defaultGroupName;\r\n\r\n            var key = val[0].toUpperCase();\r\n            return {\r\n                title: key\r\n            };\r\n        }\r\n        return options;\r\n    });\r\n\r\n    /**\r\n     * grouping by a string field on items, use \"options.field\" to define the property used for grouping\r\n     * @param {Object} options grouping options\r\n     * @returns {Object} group manager\r\n     */\r\n    WinJSContrib.UI.DataSources.Grouping.byField = WinJS.Utilities.markSupportedForProcessing(function (options) {\r\n        options.defaultGroupName = options.defaultGroupName || '#';\r\n\r\n        options.compareGroups = options.compareGroups || function (a, b) {\r\n            if (a > b)\r\n                return 1;\r\n            if (a < b)\r\n                return -1;\r\n\r\n            return 0;\r\n        }\r\n\r\n        options.getGroupKey = options.getGroupKey || function (dataItem) {\r\n            if (!dataItem)\r\n                return this.defaultGroupName;\r\n\r\n            var val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                return this.defaultGroupName;\r\n\r\n            var key = val.toString().toUpperCase();\r\n            return key;\r\n        }\r\n\r\n        options.getGroupData = options.getGroupData || function (dataItem) {\r\n            var val = '#';\r\n            if (dataItem)\r\n                val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                val = this.defaultGroupName;\r\n\r\n            var key = val;\r\n            return {\r\n                title: key\r\n            };\r\n        }\r\n\r\n        return options;\r\n    });\r\n\r\n    /**\r\n     * grouping by year from a date field, use \"options.field\" to define the property used for grouping\r\n     * @param {Object} options grouping options\r\n     * @returns {Object} group manager\r\n     */\r\n    WinJSContrib.UI.DataSources.Grouping.byYear = WinJS.Utilities.markSupportedForProcessing(function (options) {\r\n        options.defaultGroupName = options.defaultGroupName || '#';\r\n\r\n        options.compareGroups = options.compareGroups || function (a, b) {\r\n            if (a > b)\r\n                return 1;\r\n            if (a < b)\r\n                return -1;\r\n\r\n            return 0;\r\n        }\r\n\r\n        options.getGroupKey = options.getGroupKey || function (dataItem) {\r\n            if (!dataItem)\r\n                return this.defaultGroupName;\r\n\r\n            var val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                return this.defaultGroupName;\r\n\r\n            var key = new Date(new Date(new Date(val).setMonth(0, 1)).setHours(0, 0, 0, 0));\r\n            return key.toISOString();\r\n        }\r\n\r\n        options.getGroupData = options.getGroupData || function (dataItem) {\r\n            var val = '#';\r\n            if (dataItem)\r\n                val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                val = this.defaultGroupName;\r\n\r\n            var key = new Date(new Date(new Date(val).setMonth(0, 1)).setHours(0, 0, 0, 0));\r\n            return {\r\n                title: key.getFullYear().toString(),\r\n                date: key\r\n            };\r\n        }\r\n\r\n        return options;\r\n    });\r\n\r\n    /**\r\n     * grouping by month from a date field, use \"options.field\" to define the property used for grouping\r\n     * @param {Object} options grouping options\r\n     * @returns {Object} group manager\r\n     */\r\n    WinJSContrib.UI.DataSources.Grouping.byMonth = WinJS.Utilities.markSupportedForProcessing(function (options) {\r\n        options.defaultGroupName = options.defaultGroupName || '#';\r\n\r\n        options.compareGroups = options.compareGroups || function (a, b) {\r\n            if (a > b)\r\n                return 1;\r\n            if (a < b)\r\n                return -1;\r\n\r\n            return 0;\r\n        }\r\n\r\n        options.getGroupKey = options.getGroupKey || function (dataItem) {\r\n            if (!dataItem)\r\n                return this.defaultGroupName;\r\n\r\n            var val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                return this.defaultGroupName;\r\n\r\n            var key = new Date(new Date(new Date(val).setDate(1)).setHours(0, 0, 0, 0));\r\n            return key.toISOString();\r\n        }\r\n\r\n        options.getGroupData = options.getGroupData || function (dataItem) {\r\n            var val = '#';\r\n            if (dataItem)\r\n                val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                val = this.defaultGroupName;\r\n\r\n            var key = new Date(new Date(new Date(val).setDate(1)).setHours(0, 0, 0, 0));\r\n            return {\r\n                title: WinJSContrib.Utils.pad2(key.getMonth() + 1) + '-' + key.getFullYear().toString(),\r\n                date: key\r\n            };\r\n        }\r\n\r\n        return options;\r\n    });\r\n\r\n    /**\r\n     * grouping by day from a date field, use \"options.field\" to define the property used for grouping\r\n     * @param {Object} options grouping options\r\n     * @returns {Object} group manager\r\n     */\r\n    WinJSContrib.UI.DataSources.Grouping.byDay = WinJS.Utilities.markSupportedForProcessing(function (options) {\r\n        options.defaultGroupName = options.defaultGroupName || '#';\r\n\r\n        options.compareGroups = options.compareGroups || function (a, b) {\r\n            if (a > b)\r\n                return 1;\r\n            if (a < b)\r\n                return -1;\r\n\r\n            return 0;\r\n        }\r\n\r\n        options.getGroupKey = options.getGroupKey || function (dataItem) {\r\n            if (!dataItem)\r\n                return this.defaultGroupName;\r\n\r\n            var val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                return this.defaultGroupName;\r\n\r\n            var key = new Date(new Date(val).setHours(0, 0, 0, 0));\r\n            return key.toISOString();\r\n        }\r\n\r\n        options.getGroupData = options.getGroupData || function (dataItem) {\r\n            var val = '#';\r\n            if (dataItem)\r\n                val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                val = this.defaultGroupName;\r\n\r\n            var key = new Date(new Date(val).setHours(0, 0, 0, 0));\r\n            return {\r\n                title: WinJSContrib.Utils.pad2(key.getMonth() + 1) + '-' + WinJSContrib.Utils.pad2(key.getDate()) + '-' + key.getFullYear().toString(),\r\n                date: key\r\n            };\r\n        }\r\n\r\n        return options;\r\n    });\r\n\r\n})(WinJSContrib.UI.DataSources, WinJSContrib.UI.DataSources.Grouping);\r\n"],"sourceRoot":" "}