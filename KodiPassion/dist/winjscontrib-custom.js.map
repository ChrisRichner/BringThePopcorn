{"version":3,"sources":["../scripts/winjscontrib/js/winjscontrib.core.js","../scripts/winjscontrib/js/winjscontrib.ui.webcomponents.js","../scripts/winjscontrib/js/winjscontrib.winrt.core.js","../scripts/winjscontrib/js/winjscontrib.winrt.upnp.js","../scripts/winjscontrib/js/winjscontrib.bindings.js","../scripts/winjscontrib/js/winjscontrib.date.utils.js","../scripts/winjscontrib/js/winjscontrib.messenger.js","../scripts/winjscontrib/js/winjscontrib.search.js","../scripts/winjscontrib/js/winjscontrib.ui.jquery.js","../scripts/winjscontrib/js/winjscontrib.ui.navigator.js","../scripts/winjscontrib/js/winjscontrib.ui.animation.js","../scripts/winjscontrib/js/winjscontrib.ui.elasticbutton.js","../scripts/winjscontrib/js/winjscontrib.ui.fowrapper.js","../scripts/winjscontrib/js/winjscontrib.ui.multipass-renderer.js","../scripts/winjscontrib/js/winjscontrib.ui.grid.js","../scripts/winjscontrib/js/winjscontrib.ui.datasourcemanager.js","../scripts/winjscontrib/js/winjscontrib.ui.aspectratio.js","../scripts/winjscontrib/js/winjscontrib.ui.visualstate.js"],"names":["_global","this","setImmediate","callback","args","_i","arguments","length","setTimeout","toStaticHTML","text","msapp","MSApp","execUnsafeLocalFunction","c","Object","map","obj","mapping","mapped","key","val","keys","forEach","transmuted","apply","String","prototype","format","replace","match","number","padLeft","leadingChar","undefined","WinJSContrib","Promise","waterfall","dataArray","promiseCallback","resultPromise","WinJS","wrap","results","dataPromise","as","then","items","queueP","p","item","r","push","i","l","getItem","parallel","promises","join","batch","batchSize","batcheditems","hasErrors","queueBatch","concat","errors","wrapError","Utils","extend","hasOwnProperty","startsWith","str","strToMatch","asyncForEach","array","batchsize","j","endsWith","queryStringFrom","encodeURIComponent","rawValue","value","hasValue","triggerEvent","element","eventName","bubbles","cancellable","eventToTrigger","document","createEvent","initEvent","dispatchEvent","triggerCustomEvent","data","initCustomEvent","getobject","prop","baseValue","idx","indexOf","end","substr","parseInt","setobject","setProperty","intval","readProperty","source","properties","getProperty","propValue","split","parent","previousDescriptor","descriptor","PropertyDescriptor","writeProperty","randomFromInterval","from","to","Math","random","alphabeticSort","a","b","distinctArray","property","ignorecase","sFind","sMatchedItems","foundCounter","newArray","toLowerCase","getDistinctPropertyValues","removeAccents","s","RegExp","removePageFromHistory","pageLoc","history","Navigation","backStack","page","location","pad2","ellipsisizeString","maxSize","useWordBoundary","toLong","text_","lastIndexOf","guid","d","Date","getTime","uuid","floor","toString","inherit","parentElement","current","winControl","moveChilds","target","childs","childNodes","elt","appendChild","getParent","parentNode","getParentControlByClass","className","classList","contains","getParentPage","getScopeControl","msParentSelectorScope","scope","scopeControl","getTemplate","template","templatetype","Binding","Template","href","render","res","resolveMethod","resolveValue","readValue","context","name","parser","ValueParsers","applyValue","targetPath","tmp","mcnMustResolve","formatXHRError","xhr","status","statusText","responseText","unwrapJoinError","errorCallback","errorArray","unwrappedError","tentativeError","inject","k","parentDescriptor","keyProp","ensureParent","defineProperty","get","set","enumerable","configurable","navpage","control","UI","Application","navigator","pageControl","parentControl","method","bind","ctrl","select","selector","querySelector","optionsParser","window","Utilities","markSupportedForProcessing","prom","list","List","dataSource","global","templ","Templates","event","eventTracker","addEvent","addEventListener","uri","cache","interactive","makeInteractive","message","itemPromise","rendered","tap","n","arg","click","onclick","offsetFrom","xPosition","yPosition","w","clientWidth","h","clientHeight","offsetLeft","scrollLeft","clientLeft","offsetTop","scrollTop","clientTop","offsetParent","x","y","width","height","appbarsOpen","querySelectorAll","e","show","appbarsClose","hide","appbarsDisable","disabled","appbarsEnable","elements","el","elementLoaded","url","complete","error","onerror","onload","onreadystatechange","naturalWidth","src","loadImage","imgUrl","image","path","Image","listElementsAfterMe","passed","children","removeElementAnimation","remainings","anim","Animation","createDeleteFromListAnimation","style","position","opacity","execute","done","bindAction","add","actionName","dataset","pageAction","getAttribute","action","eltarg","actionArgs","pageActionArgs","exception","bindPageActions","bindLink","applink","pageLink","options","pageActionOptions","parentNavigator","nav","navigate","bindPageLinks","mcnNavigator","bindMember","memberName","pageMember","id","bindMembers","bindActions","registerNavigationEvents","cancelNavigation","detail","setPromise","cancel","registration","registeredNavigationStack","backhandler","handled","Windows","Phone","Input","HardwareButtons","keypress","body","addLock","removeLock","splice","removeEventListener","untap","mcnTapTracking","dispose","untapAll","taps","ptDown","currentTarget","tracking","button","allowRickClickTap","lock","pointerId","setPointerCapture","stopPropagation","preventDefault","addClass","removeClass","clearTimeout","pendingErrorTimeout","pointerdown","changedTouches","clientX","clientY","animDown","tapOnDown","ptOut","releasePointerCapture","console","disableAnimation","animUp","ptUp","resolveTap","dX","abs","dY","stopImmediatePropagation","is","err","errorDelay","awaitAnim","attroptions","opt","EventTracker","defaultTapBehavior","pointerModel","onpointerdown","Touch","noWebkitTouch","cancelMouse","afterTransition","timeout","timeOutRef","onaftertransition","srcElement","close","disableAutoResources","events","handler","capture","tracker","unregister","addBinding","unbind","MediaTrigger","linkedControl","queries","query","registerMediaEvent","q","mq","matchMedia","internalQuery","f","matches","_mediaEvent","addListener","removeListener","setOptions","check","type","listener","useCapture","eventProperties","Class","mix","eventMixin","pointerDown","pointerUp","FluentDOM","nodeType","parentElt","createElement","fragment","createDocumentFragment","classname","display","visibility","textContent","html","innerHTML","attr","setAttribute","styles","st","appendTo","append","child","createChild","ctor","__global","profiler","msWriteProfilerMark","Pages","broadcast","before","after","index","childctrl","pageLifeCycle","steps","layout","promise","__checkLayout","renderFragment","container","preparePageControl","elementCtrl","getFragmentElement","injectToPage","navigationState","state","oncreate","oninit","init","attach","enterPageAnimation","enterPage","_enterAnimation","elts","getAnimationElements","onrender","process","Resources","processAll","closeOldPagePromise","ready","onready","fragmentCompleted","fragmentError","getComputedStyle","direction","fragmentPromise","parented","pageConstructor","defaultFragmentMixins","$","_element","qAll","slice","call","_promises","cancelPromises","addPromise","_eventTracker","PageLifeCycleStep","stepName","_this","queue","isDone","_resolvePromise","_rejectPromise","resolve","closeStep","step","reject","_Pages","_Global","_Base","_CorePages","_BaseUtils","_ElementUtilities","_WriteProfilerMark","Fragments","ControlProcessor","selfhost","injectMixin","base","mixin","mergeJavaScriptClass","baseCtor","classDef","addMembers","members","_attachedConstructor","that","parentedPromise","initialDisplay","profilerMarkIdentifier","_getProfilerMarkIdentifier","WebComponents","observer","watch","load","loadResult","realControl","dismissed","renderCalled","initResult","result","elementReady","renderComplete","processed","callComplete","layoutComplete","getBoundingClientRect","pageLayout","readyComplete","ended","delta","created","log","_value","updateLayoutArgs","updateLayout","getPageConstructor","refUri","viewMap","define","stop","disconnect","_disposed","msSourceLocation","parentedComplete","_mixinBase","DOMEventMixin","Pages_define","_viewMap","_corePages","Ctor","remove","clearCache","disposeSubTree","renderCopy","_remove","pageOverride","Namespace","_moduleDefine","HtmlControl","inspect","node","customElement","ctrlName","nodeName","attributes","registered","toUpperCase","mcnComponent","observeMutations","polyfill","MutationObserver","mutations","mutation","addedNodes","observe","childList","subtree","definition","getControlInstance","constructor","mcnWebComponent","ctx","applyAttribute","winOptions","getWinJSOptions","optionsCallback","applyAll","applyMapping","tagname","contextData","attrcontext","attrvalue","attribute","controls","ctKey","controlDefinition","mapKey","controlmap","registerElement","register","override","existing","proto","create","HTMLElement","createdCallback","attachedCallback","attributeChangedCallback","attrName","oldValue","newValue","AppBar","AutoSuggestBox","BackButton","ContentDialog","DatePicker","FlipView","Flyout","Hub","HubSection","ItemContainer","ListView","Menu","Pivot","PivotItem","Rating","Repeater","SearchBox","SemanticZoom","SplitView","TimePicker","ToggleSwitch","ToolBar","Tooltip","ViewBox","WinRT","readProtocol","kind","ApplicationModel","Activation","ActivationKind","protocol","navArgs","protocolArgs","queryargs","decodeURIComponent","host","isConnected","nlvl","Networking","Connectivity","NetworkConnectivityLevel","profile","NetworkInformation","getInternetConnectionProfile","level","getNetworkConnectivityLevel","constrainedInternetAccess","internetAccess","hasInternetAccess","onInternetStatusChanged","network","Alerts","messageBox","md","Popups","MessageDialog","content","title","commands","command","cmd","UICommand","label","invoked","isDefault","defaultCommandIndex","showAsync","notification","confirm","yes","no","toastNotification","notifications","Notifications","picture","ToastTemplateType","toastImageAndText01","toastText01","toastXml","ToastNotificationManager","getTemplateContent","toastTextElements","getElementsByTagName","toastImageElements","launch","toastElements","JSON","stringify","createTextNode","text2","text3","toast","ToastNotification","toastNotifier","createToastNotifier","UPnP","search","xmlToJson","xml","nodeValue","hasChildNodes","colonIdx","clearNode","old","trim","parseXML","DOMParser","parseFromString","toHex","start","digit","hextab","pad","len","ntos","unescape","htoa","nextchar","charAt","atoh","charCodeAt","expandExponential","z","Array","deviceTypes","ContentDirectory1","ContentDirectory2","ContentDirectory3","ContentDirectory4","MediaRenderer1","MediaRenderer2","MediaRenderer3","MediaRenderer4","MediaServer1","MediaServer2","MediaServer3","MediaServer4","AVTransport1","AVTransport2","ConnectionManager1","ConnectionManager2","ConnectionManager3","devicesDiscovery","filter","exists","devices","deviceDescriptionUrl","discover","onsuccess","clientSocket","ex","Sockets","DatagramSocket","onmessagereceived","reader","getDataReader","count","unconsumedBufferLength","readString","completed","rawdevice","responseXML","device","root","rootUrl","UPnPDevice","getOutputStreamAsync","hostName","outputStream","writer","Storage","Streams","DataWriter","unicodeEncoding","UnicodeEncoding","Utf8","writeString","storeAsync","discovery","hasError","HostName","getContentType","extension","lowerUrl","deviceObj","getService","serviceType","service","serviceList","deviceList","childdevice","childService","controlURL","getAVTransport","UPnPAVTransport","getContentDirectory","UPnPContentDirectory","getConnectionManager","UPnPConnectionManager","UPnPService","serviceObj","opts","debug","svc","svcType","svcUrl","self","upnpAction","upnpParameters","promiseComplete","promiseError","response","svcMsg","createRequest","sendRequest","xmlResponse","handleResponse","upnpResponse","requestTemplate","types","i1","allowedValues","toNative","i8","Int8Array","checkAllowedValues","i2","i16","Int16Array","i4","i32","Int32Array","ui1","ui8","Uint8Array","ui2","ui16","Uint16Array","ui4","ui32","Uint32Array","int","isNaN","r4","f32","Float32Array","r8","f64","Float64Array","fixed_14_4","float","_float","parseFloat","char","string","xmlObj","currentPos","date","dateTime","parseDate","toISOString","dateTime_tz","time","time_tz","boolean","bin_base64","atob","btoa","bin_hex","decodeURI","_name","upnpServiceType","upnpActionName","parameters","formatParameters","debugLog","encodeXML","svcInParams","svcInParams_xml","svcParam","typeCheck","upnpEndpointURL","upnpRequestXML","onUPnPResponse","soapaction","httpClient","Web","Http","HttpClient","Foundation","Uri","request","HttpRequestMessage","HttpMethod","post","headers","HttpStringContent","utf8","sendRequestAsync","readAsStringAsync","UPnPError","upnpResponseXML","onUPnPResolved","svcOutParams","responseJSON","responseContainer","responseVars","varName","varVal","firstChild","decodeXML","formatParameter","parameter","param","processParam","allowedValueList","matchFound","msg","description","b64chars","b64tab","bin","t","cb_encode","ccc","padlen","ord","chars","cb_decode","cccc","fromCharCode","hexChars","timestamp","struct","minutesOffset","numericKeys","exec","UTC","parse","NaN","allowedContentDirectoryTypes","urn:schemas-upnp-org:service:ContentDirectory:1","urn:schemas-upnp-org:service:ContentDirectory:2","urn:schemas-upnp-org:service:ContentDirectory:3","urn:schemas-upnp-org:service:ContentDirectory:4","upnpType","getSystemUpdateId","Id","getSearchCapabilities","SearchCaps","getSortCapabilities","SortCaps","browse","objectId","browseFlag","startingIndex","requestedCount","sortCriteria","ObjectID","BrowseFlag","Filter","StartingIndex","RequestedCount","SortCriteria","Result","NumberReturned","TotalMatches","UpdateID","allowedConnectionManagerTypes","urn:schemas-upnp-org:service:ConnectionManager:1","urn:schemas-upnp-org:service:ConnectionManager:2","urn:schemas-upnp-org:service:ConnectionManager:3","getCurrentConnectionIDs","ConnectionIDs","getCurrentConnectionInfo","connectionId","ConnectionID","RcsID","AVTransportID","ProtocolInfo","PeerConnectionManager","PeerConnectionID","Direction","Status","getProtocolInfo","Source","Sink","allowedAVTransportTypes","urn:schemas-upnp-org:service:AVTransport:1","urn:schemas-upnp-org:service:AVTransport:2","getDeviceCapabilities","instanceId","InstanceID","PlayMedia","RecMedia","RecQualityModes","getMediaInfo","NrTracks","MediaDuration","CurrentURI","CurrentURIMetaData","NextURI","NextURIMetaData","PlayMedium","RecordMedium","WriteStatus","getPositionInfo","Track","TrackDuration","TrackMetaData","TrackURI","RelTime","AbsTime","RelCount","AbsCount","getTransportInfo","CurrentTransportState","CurrentTransportStatus","CurrentSpeed","getTransportSettings","PlayMode","RecQualityMode","setAVTransportURI","currentURI","currentURIMetaData","play","speed","Speed","pause","next","previous","seek","unit","Unit","Target","allowedRenderingControlTypes","urn:schemas-upnp-org:service:RenderingControl:1","urn:schemas-upnp-org:service:RenderingControl:2","urn:schemas-upnp-org:service:RenderingControl:3","UPnPRenderingControl","listPresets","InstanceId","CurrentPresetNameList","selectPreset","presetName","PresetName","getBrightness","CurrentBrightness","setBrightness","desiredBrightness","DesiredBrightness","getContrast","CurrentContrast","setContrast","desiredContrast","DesiredContrast","getSharpness","CurrentSharpness","setSharpness","desiredSharpness","DesiredSharpness","getRedVideoGain","CurrentRedVideoGain","setRedVideoGain","desiredRedVideoGain","DesiredRedVideoGain","getGreenVideoGain","CurrentGreenVideoGain","setGreenVideoGain","desiredGreenVideoGain","DesiredGreenVideoGain","getBlueVideoGain","CurrentBlueVideoGain","setBlueVideoGain","desiredBlueVideoGain","DesiredBlueVideoGain","getRedVideoBlackLevel","CurrentRedVideoBlackLevel","setRedVideoBlackLevel","desiredRedVideoBlackLevel","DesiredRedVideoBlackLevel","getGreenVideoBlackLevel","CurrentGreenVideoBlackLevel","setGreenVideoBlackLevel","desiredGreenVideoBlackLevel","DesiredGreenVideoBlackLevel","getBlueVideoBlackLevel","CurrentBlueVideoBlackLevel","setBlueVideoBlackLevel","desiredBlueVideoBlackLevel","DesiredBlueVideoBlackLevel","getColorTemperature","CurrentColorTemperature","setColorTemperature","desiredColorTemperature","DesiredColorTemperature","getHorizontalKeystone","CurrentHorizontalKeystone","setHorizontalKeystone","desiredHorizontalKeystone","DesiredHorizontalKeystone","getVerticalKeystone","CurrentVerticalKeystone","setVerticalKeystone","desiredVerticalKeystone","DesiredVerticalKeystone","getMute","channel","Channel","CurrentMute","setMute","desiredMute","DesiredMute","getVolume","CurrentVolume","setVolume","desiredVolume","DesiredVolume","getVolumeDB","setVolumeDB","getVolumeDBRange","MinValue","MaxValue","getLoudness","CurrentLoudness","setLoudness","desiredLoudness","DesiredLoudness","getStateVariables","stateVariableList","StateVariableList","StateVariableValuePairs","setStateVariables","renderingControlUDN","serviceId","stateVariableValuePairs","RenderingControlUDN","ServiceType","ServiceId","getAllowedTransforms","CurrentAllowedTransformSettings","getTransforms","CurrentTransformValues","setTransforms","desiredTransformValues","DesiredTransformValues","getAllAvailableTransforms","AllAllowedTransformSettings","getAllowedDefaultTransforms","AllowedDefaultTransformSettings","getDefaultTransforms","CurrentDefaultTransformSettings","setDefaultTransforms","desiredDefaultTransformSettings","DesiredDefaultTransformSettings","Bindings","_setPic","dest","backgroundImage","pictureUnavailable","bindingArguments","argname","_optionsParser","winBindArgs","removeHTML","initializer","sourceProperty","destProperty","oneTime","innerText","removeHTMLAndEllipsisize","textRes","size","staticHTML","dataAttr","setClass","newval","oldval","bindingDesc","asClass","toBgImage","setImage","ToRealDate","toLocaleDateString","toSmartBgImage","showIf","setVisibility","hideIfNot","hideIfNotDefined","hideIf","showIfNot","showIfNotDefined","enableIf","disableIfNot","disableIf","enableIfNot","toWidth","setWidth","ellipsisize","sourcedata","toEllipsisized","emptyIfNull","twoWayOnChange","setVal","getVal","cleanUpBindingList","bindingList","unwrappedItem","unwrap","daysSince","m","myDate","yourDate","secondsInADay","diff","formatDate","setDate","moment","calendar","daysSinceDate","getMonth","getDate","getFullYear","fromdate","humanizeDate","addSuffix","duration","humanize","Messenger","receiver","sender","messenger","isWorker","_pendings","_receiver","_sender","_bindedProcessEvent","_processEvent","SmartWorkerPath","SmartWorker","Worker","_send","postMessage","importScripts","scriptPaths","_doImportScripts","func","_runFunction","functionArgs","eval","messengerFunction","object","functions","asArgs","wrapper","progress","warn","cleanUp","details","stack","terminate","Search","writeFile","folder","fileName","CreationCollisionOption","objectGraph","createFileAsync","docfile","FileIO","writeTextAsync","openFile","openIfExists","file","readTextAsync","workerPath","Index","storeData","onprogress","stopWords","Stemming","StopWords","common","pipeline","Pipeline","folderPromise","ApplicationData","localFolder","createFolderAsync","clear","loadData","indexString","fields","reload","save","exp","replaceExisting","filename","savedidx","_runSearch","querytext","preparedTokens","processText","searchResult","lastprogress","itemResult","_searchItem","progressPercent","sort","rank","limit","searchtokens","indexitem","points","tokenitem","untokenized","tokens","weight","token","stoken","rawdata","_add","def","addRange","arr","indexed","refresh","tokenize","txt","run","checkWord","words","IndexGroup","definitions","indexes","useworker","IndexWorkerProxy","addIndex","async","addRangefunction","searchindex","searchItemType","searchresult","allResults","hasResult","workerpath","worker","searchTerm","pipe","sets","Presets","ops","Op","_processors","processorNames","stemming","standard","processor","full","lowerCase","dedup","dropInitialLetters","dropBafterMAtEnd","cTransform","dTransform","dropG","transformG","dropH","transformCK","transformPH","transformQ","transformS","transformT","dropT","transformV","transformWH","dropW","transformX","dropY","transformZ","dropVowels","removeDiacritics","HSL","hVal","sVal","lVal","addH","increment","addS","addL","clone","hInc","sInc","lInc","fn","jQuery","each","hatchShow","css","hasClass","pw","fsize","fontSize","fadeIn","pressEnterDefaultTo","eltSelector","$this","which","keyCode","$elt","blur","focus","onPressEnter","throttleTextChanged","throttling","lastval","keydown","mcnTxtThrottling","transitionProperties","delay","targetValueCallback","toWinJSPromise","renderWith","templateSelector","renderWithEach","objectArray","itemCallback","templatedElt","scrollInView","offset","animate","viewState","ViewManagement","ApplicationView","horizontal","ApplicationViewState","snapped","fullScreenPortrait","scrollInParentView","loadedPromises","onloaded","whenLoaded","currentElement","success","afterAnimation","ontransition","classBasedAnimation","appView","defaultExitPageAnimation","exitPage","defaultEnterPageAnimation","PageControlNavigator","disableHistory","animationWaitForPreviousPageClose","animations","locks","exitPageAnimation","home","_lastViewstate","onkeyup","_keyupHandler","onkeypress","_keypressHandler","onmspointerup","_mspointerupHandler","_beforeNavigate","_navigated","systemNavigationManager","enableSystemBackButton","Core","SystemNavigationManager","getForCurrentView","canGoBack","back","navigationEvents","addNavigationEvents","_history","backstack","resizeHandler","cancelAnimationFrame","requestAnimationFrame","_resized","_lastNavigationPromise","pageElement","_pageElement","lastElementChild","_createPageElement","removeNavigationEvents","_checkBackNavigation","currentPage","canClose","_getAnimationElements","isExit","altKey","forward","initialState","skipHistory","isback","stacked","navigateStacked","pagePromise","clearHistory","closeAllPages","pages","removeChild","open","pick","_handleStackedBack","isStacked","stackNavigation","previousPage","closePage","_updateBackButton","navactivate","distance","pageindex","navlocation","navstate","openStacked","completeCallback","triggerPageExit","mcnNavigationDetails","navdeactivate","exitPagePromise","hidepage","exitPageResult","layoutCtrls","pageElementToClose","oldElement","oldPageExitPromise","youpla","stackedOn","stackedBy","unload","pagecontainer","oldPage","currentPageDetails","openNewPagePromise","fragmentInjector","mcnPage","clearNavigationHistory","layoutProcess","vw","_handleBack","appViewBackButtonVisibility","AppViewBackButtonVisibility","visible","collapsed","backButtons","clearNav","btn","ENTERPAGEANIMATION","EXITPAGEANIMATION","getOpt","fadeOut","staggerDelay","itemdelay","maxdelay","timing","easing","executeTransition","initialDelay","extraDelay","delayFactor","delayCap","ret","min","pageExit","stagger","animationParams","keyframe","equivalents","transform","cssName","promise1","executeAnimation","promise2","slideAnim","keyframeName","isIn","Easings","easeInQuad","easeOutQuad","transitionParams","slideFromBottom","slideFromTop","slideFromLeft","slideFromRight","slideToBottom","slideToTop","slideToLeft","slideToRight","tabExitPage","tabEnterPage","exitGrow","exagerated","dur","easeInQuint","exitShrink","shrinkAndFall","enterShrink","easeOutQuint","enterGrow","easeInCubic","easeInQuart","easeInSine","easeInExpo","easeInCirc","easeInBack","easeOutCubic","easeOutQuart","easeOutSine","easeOutExpo","easeOutCirc","easeOutBack","easeInOutQuad","easeInOutCubic","easeInOutQuart","easeInOutQuint","easeInOutSine","easeInOutExpo","easeInOutCirc","easeInOutBack","_browserStyleEquivalents","elasticbuttonkinds","rectangle","morphpath","svg","roundedrectangle","round","ElasticButton","behavior","reset","active","mina","elastic","easein","_kind","contentCreated","contentElement","bgElement","currentKind","snap","Snap","pathEl","paths","_ptdown","_ptup","createEventProperties","FOWrapper","someProperty","_someProperty","wrapperId","blurFilter","sblurFilter","blurTo","stdDeviation","easeout","MultiPassRenderer","_scrollProcessor","_tolerance","_virtualize","_scrollContainer","scrollContainer","_multipass","multipass","_orientation","orientation","itemClassName","itemClass","itemTemplate","itemInvoked","onitemContent","_onScrollBinded","_onScroll","_unregisterScrollEvents","rect","refreshScrollEvents","tolerance","virtualize","_registerScrollEvents","_scrollRequest","checkRendering","clearOffsets","_checkSection","_vIsInView","_checkItem","_hIsInView","pxTolerance","noRender","renderItemsContent","onrendersection","empty","allRendered","prepareItems","renderOptions","onitemInit","registereditems","itemdata","MultiPassItem","renderItems","renderer","itemDataPromise","itemData","delayed","_renderContent","_renderItemContent","GridControl","grid","layouts","defaultLayout","itemsPerColumn","itemsPerRow","cellSpace","cellWidth","cellHeight","autolayout","_autolayout","gridLayouts","resetElement","isItem","minWidth","minHeight","left","top","clearContent","clearLayout","fill","matrix","col","fit","maxW","maxH","firstFit","numItems","visibleChilds","GridLayoutsImpl","none","flexhorizontal","flexFlow","alignContent","_itemsPerColumn","visibleitems","columns","ceil","flexvertical","hbloc","_containerH","cellW","space","colCount","colOffset","topOffset","eltH","cellH","ratioW","ratioH","gridCellsMatrix","eltW","offsetWidth","offsetHeight","eltColumns","eltRows","pos","elementWidth","vertical","plugin","_containerW","_itemsPerLine","elementHeight","oldlayout","getLayout","layoutChanged","layoutfunc","changeLayout","applyed","lastViewState","matchingLayout","DataSources","ds","gr","DataSourceManager","groupedList","defaultGroupLimit","filters","onitemchanged","oniteminserted","onitemremoved","field","groupKind","defaultGroupName","compareGroups","getGroupKey","getGroupData","listview","zoomedOutListView","_field","_defaultGroupLimit","_groupKind","_listview","detach","_groupedList","_filter","_items","filteredlist","_filterItems","addFilter","newFilter","getAt","dontAttach","filterCallback","createFiltered","createGrouped","g","groups","_groupItems","grp","_groupsProjection","groupSize","groupCount","itemDataSource","groupDataSource","semzoom","parentSemanticZoom","locked","SemanticListViews","_initControl","semanticZoom","_semanticZoom","zoomedOutListview","_zoomedOutListview","dataManager","_dataManager","semanticPlaceholder","listviewPlaceholder","zoomedOutListviewPlaceholder","semanticzoom","dataOptions","Grouping","DEFAULTGROUPLIMIT","GROUPKIND","FIELD","ITEMS","alphabetic","right","dataItem","byField","byYear","setMonth","setHours","byMonth","byDay","AspectRatio","baseWidth","_baseWidth","baseWidthMin","_baseWidthMin","baseWidthMargin","_baseWidthMargin","baseHeight","_baseHeight","baseHeightMin","_baseHeightMin","baseHeightMargin","_baseHeightMargin","ratio","_ratio","basedOn","_basedOn","_target","styleElt","parentpage","updateLayoutBasedOnHeight","updateLayoutBasedOnWidth","prefix","nbitems","itemW","targetH","max","itemH","targetW","VisualState","states","_states","checkAllStates","checkState","evaluate","wGt","wLt","hGt","hLt"],"mappings":"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wC,aAClDxwC,eAAiBA,iBACpB,IAAIA,eACJ,SAAWA,GACP,GAAIwwC,IACJ,SAAWA,GACP,GAAImB,IACJ,SAAWA,GACP,GAAIC,IACJ,SAAWA,GAKPA,EAAUC,QAEN,KACA,KACA,MACA,KACA,KACA,MACA,KACA,KACA,MACA,MACA,KACA,MACA,KACA,KACA,OACA,OACA,MACA,OACA,KAEA,IACA,OACA,QACA,SACA,QACA,MACA,SACA,OACA,KACA,QACA,KACA,MACA,MACA,MACA,KACA,KACA,KACA,UACA,OACA,MACA,KACA,MACA,SACA,QACA,OACA,MACA,KACA,OACA,SACA,OACA,OACA,QACA,MACA,OACA,MACA,MACA,MACA,MACA,OACA,KACA,MACA,OACA,MACA,MACA,MACA,UACA,IACA,KACA,KACA,OACA,KACA,KACA,MACA,OACA,QACA,MACA,OACA,SACA,MACA,KACA,QACA,OACA,OACA,KACA,UACA,KACA,MACA,MACA,KACA,MACA,QACA,KACA,OACA,KACA,QACA,MACA,MACA,SACA,OACA,MACA,OACA,MACA,SACA,QACA,KACA,OACA,OACA,OACA,MACA,QACA,OACA,OACA,QACA,QACA,OACA,OACA,MACA,KACA,MACA,OACA,KACA,QACA,MACA,KACA,OACA,OACA,OACA,QACA,QACA,QACA,MACA,OACA,MACA,OACA,OACA,QACA,MACA,MACA,SAELD,EAAYD,EAASC,YAAcD,EAASC,gBAChDD,EAAWnB,EAAOmB,WAAanB,EAAOmB,eAC1CnB,EAASxwC,EAAawwC,SAAWxwC,EAAawwC,aAClDxwC,eAAiBA,iBACpB,IAAIA,eACJ,SAAWA,GACP,GAAIwwC,IACJ,SAAWA,GACP,GAAImB,IACJ,SAAWA,GACP,GAAIwE,IACJ,SAAWA,GAQP,QAASO,GAAUzC,GACf,MAAKA,GAEEA,EAAM/tC,cAFb,OAQJ,QAASywC,GAAM1C,GACX,MAAKA,GAEEA,EAAMv0C,QAAQ,YAAa,MAFlC,OAQJ,QAASk3C,GAAmB3C,GACxB,MAAKA,GAEDA,EAAMt0C,MAAM,qBACLs0C,EAAM9vC,OAAO,EAAG8vC,EAAM71C,OAAS,GACnC61C,EAJP,OAUJ,QAAS4C,GAAiB5C,GACtB,MAAKA,GAEEA,EAAMv0C,QAAQ,MAAO,KAF5B,OAQJ,QAASo3C,GAAW7C,GAChB,MAAKA,IAELA,EAAQA,EAAMv0C,QAAQ,kBAAmB,SAASiuB,OAClDsmB,EAAQA,EAAMv0C,QAAQ,OAAQ,OAC9Bu0C,EAAQA,EAAMv0C,QAAQ,YAAa,OACnCu0C,EAAQA,EAAMv0C,QAAQ,KAAM,MAL5B,OAYJ,QAASq3C,GAAW9C,GAChB,MAAKA,IAELA,EAAQA,EAAMv0C,QAAQ,eAAgB,OACtCu0C,EAAQA,EAAMv0C,QAAQ,KAAM,MAH5B,OAUJ,QAASs3C,GAAM/C,GACX,MAAKA,IAELA,EAAQA,EAAMv0C,QAAQ,mBAAoB,OAC1Cu0C,EAAQA,EAAMv0C,QAAQ,aAAc,OAHpC,OAUJ,QAASu3C,GAAWhD,GAChB,MAAKA,IAELA,EAAQA,EAAMv0C,QAAQ,sBAAuB,SAC7Cu0C,EAAQA,EAAMv0C,QAAQ,MAAO,KAC7Bu0C,EAAQA,EAAMv0C,QAAQ,KAAM,MAJ5B,OAWJ,QAASw3C,GAAMjD,GACX,MAAKA,GAEEA,EAAMv0C,QAAQ,wBAAyB,QAF9C,OAQJ,QAASy3C,GAAYlD,GACjB,MAAKA,GAEEA,EAAMv0C,QAAQ,MAAO,KAF5B,OAQJ,QAAS03C,GAAYnD,GACjB,MAAKA,GAEEA,EAAMv0C,QAAQ,MAAO,KAF5B,OAQJ,QAAS23C,GAAWpD,GAChB,MAAKA,GAEEA,EAAMv0C,QAAQ,KAAM,KAF3B,OAQJ,QAAS43C,GAAWrD,GAChB,MAAKA,GAEEA,EAAMv0C,QAAQ,cAAe,OAFpC,OAQJ,QAAS63C,GAAWtD,GAChB,MAAKA,IAELA,EAAQA,EAAMv0C,QAAQ,YAAa,OACnCu0C,EAAQA,EAAMv0C,QAAQ,KAAM,MAH5B,OAUJ,QAAS83C,GAAMvD,GACX,MAAKA,GAEEA,EAAMv0C,QAAQ,OAAQ,MAF7B,OAQJ,QAAS+3C,GAAWxD,GAChB,MAAKA,GAEEA,EAAMv0C,QAAQ,KAAM,KAF3B,OAQJ,QAASg4C,GAAYzD,GACjB,MAAKA,GAEEA,EAAMv0C,QAAQ,MAAO,KAF5B,OAQJ,QAASi4C,GAAM1D,GACX,MAAKA,GAEEA,EAAMv0C,QAAQ,iBAAkB,MAFvC,OAQJ,QAASk4C,GAAW3D,GAChB,MAAKA,IAELA,EAAQA,EAAMv0C,QAAQ,KAAM,KAC5Bu0C,EAAQA,EAAMv0C,QAAQ,KAAM,OAH5B,OAUJ,QAASm4C,GAAM5D,GACX,MAAKA,GAEEA,EAAMv0C,QAAQ,iBAAkB,MAFvC,OAQJ,QAASo4C,GAAW7D,GAChB,MAAKA,GAEEA,EAAMv0C,QAAQ,IAAK,KAF1B,OAQJ,QAASq4C,GAAW9D,GAChB,MAAKA,GAEEA,EAAMxlB,OAAO,GAAKwlB,EAAM9vC,OAAO,EAAG8vC,EAAM71C,QAAQsB,QAAQ,WAAY,IAF3E,OAQJ,QAASs4C,GAAiB3xC,GACtB,GAAKA,EAAL,CAEA,GAAIrF,GAAIqF,EAAEH,aAaV,OAZAlF,GAAIA,EAAEtB,QAAQ,GAAI4G,QAAO,SAAU,KAAM,KACzCtF,EAAIA,EAAEtB,QAAQ,GAAI4G,QAAO,WAAY,KAAM,KAC3CtF,EAAIA,EAAEtB,QAAQ,GAAI4G,QAAO,IAAK,KAAM,MACpCtF,EAAIA,EAAEtB,QAAQ,GAAI4G,QAAO,IAAK,KAAM,KACpCtF,EAAIA,EAAEtB,QAAQ,GAAI4G,QAAO,SAAU,KAAM,KACzCtF,EAAIA,EAAEtB,QAAQ,GAAI4G,QAAO,SAAU,KAAM,KACzCtF,EAAIA,EAAEtB,QAAQ,GAAI4G,QAAO,IAAK,KAAM,KACpCtF,EAAIA,EAAEtB,QAAQ,GAAI4G,QAAO,UAAW,KAAM,KAC1CtF,EAAIA,EAAEtB,QAAQ,GAAI4G,QAAO,IAAK,KAAM,MACpCtF,EAAIA,EAAEtB,QAAQ,GAAI4G,QAAO,SAAU,KAAM,KACzCtF,EAAIA,EAAEtB,QAAQ,GAAI4G,QAAO,OAAQ,KAAM,KACvCtF,EAAIA,EAAEtB,QAAQ,GAAI4G,QAAO,QAAS,KAAM,MAjO5C6vC,EAAGO,UAAYA,EASfP,EAAGQ,MAAQA,EAWXR,EAAGS,mBAAqBA,EASxBT,EAAGU,iBAAmBA,EAatBV,EAAGW,WAAaA,EAWhBX,EAAGY,WAAaA,EAWhBZ,EAAGa,MAAQA,EAYXb,EAAGc,WAAaA,EAShBd,EAAGe,MAAQA,EASXf,EAAGgB,YAAcA,EASjBhB,EAAGiB,YAAcA,EASjBjB,EAAGkB,WAAaA,EAShBlB,EAAGmB,WAAaA,EAWhBnB,EAAGoB,WAAaA,EAShBpB,EAAGqB,MAAQA,EASXrB,EAAGsB,WAAaA,EAShBtB,EAAGuB,YAAcA,EASjBvB,EAAGwB,MAAQA,EAWXxB,EAAGyB,WAAaA,EAShBzB,EAAG0B,MAAQA,EASX1B,EAAG2B,WAAaA,EAShB3B,EAAG4B,WAAaA,EAsBhB5B,EAAG6B,iBAAmBA,GACvB7B,EAAKxE,EAASwE,KAAOxE,EAASwE,SAClCxE,EAAWnB,EAAOmB,WAAanB,EAAOmB,eAC1CnB,EAASxwC,EAAawwC,SAAWxwC,EAAawwC,aAClDxwC,eAAiBA;AClmCpB,QAASi4C,KAAIC,EAAMC,EAAMC,GACrB,GAAI5uC,IACA6E,EAAG6pC,EACH7xC,EAAG8xC,EACHh3C,EAAGi3C,EACHC,KAAM,SAAUC,GACZx6C,KAAKuQ,EAAIvQ,KAAKuQ,EAAIiqC,GAEtBC,KAAM,SAAUD,GACZx6C,KAAKuI,EAAIvI,KAAKuI,EAAIiyC,GAEtBE,KAAM,SAAUF,GACZx6C,KAAKqD,EAAIrD,KAAKqD,EAAIm3C,GAEtB3wC,SAAU,WACN,MAAO,OAAS7J,KAAKuQ,EAAI,IAAMvQ,KAAKuI,EAAI,MAAQvI,KAAKqD,EAAI,MAE7Ds3C,MAAO,SAAUC,EAAMC,EAAMC,GACzB,GAAIpvC,GAAM,GAAIyuC,KAAIn6C,KAAKuQ,EAAGvQ,KAAKuI,EAAGvI,KAAKqD,EAIvC,OAHAqI,GAAI6uC,KAAKK,GACTlvC,EAAI+uC,KAAKI,GACTnvC,EAAIgvC,KAAKI,GACFpvC,GAIf,OAAOA,GAvCX,GAAIxJ,cAAeA,gBAKnBA,cAAa0L,GAAK1L,aAAa0L,OAK/B1L,aAAagC,MAAQhC,aAAagC,UAgClC,SAAWkc,GACPA,EAAE26B,GAAG9wC,WAAa,WACd,MAAOjK,MAAK,GAAGiK,aAEpB+wC,QAEH,SAAW56B,GACPA,EAAE26B,GAAGlrC,IAAM,SAAU3P,EAAUuU,GAG3B,MAAOzU,MAAKi7C,KAAK,WAChB/4C,aAAa0L,GAAGiC,IAAI7P,KAAME,EAAUuU,MAIzC2L,EAAE26B,GAAGtkC,MAAQ,SAAUvW,GACnB,MAAOF,MAAKi7C,KAAK,WACb/4C,aAAa0L,GAAG6I,MAAMzW,SAI9Bg7C,OAAOD,GAAGG,UAAY,WAClB96B,EAAE,SAAS+6B,IAAI,aAAc,UAAUA,IAAI,YAAa,IAAIA,IAAI,UAAW,eAAeA,IAAI,cAAe,OAAOF,KAAK,WACrH,GAAI1d,GAAInd,EAAEpgB,MACNgH,EAASu2B,EAAEv2B,QACXA,GAAOo0C,SAAS,kBAEhBp0C,EAASA,EAAOA,SAGhBu2B,EAAE96B,KAAK,sDAEX,IAAI44C,GAAKr0C,EAAOkK,OAEhB,KADQqsB,EAAErsB,QACHqsB,EAAErsB,QAAUmqC,GAAI,CACnB,GAAIC,GAAQ/d,EAAEge,UACd,IAAID,EAAQ,IACR,KACJ/d,GAAE4d,IAAI,YAAcG,EAAQ,EAAK,MAC/B,WACI,KAAO/d,EAAErsB,QAAUmqC,GAAI,CACnB,GAAIC,GAAQ/d,EAAEge,UACd,IAAY,EAARD,EACA,KACJ/d,GAAE4d,IAAI,YAAcG,EAAQ,GAAM,WAIjD7pC,OAAO0pC,IAAI,aAAc,IAAIK,UAIpCR,OAAOD,GAAGQ,SAAW,WAAc,MAAOj1C,UAAS8Z,EAAEpgB,MAAMm7C,IAAI,aAAav5C,QAAQ,KAAM,OAE3Fo5C,QAEH,SAAW56B,GACPA,EAAE26B,GAAGU,oBAAsB,SAAUC,EAAazwC,GAC9C,MAAOjL,MAAKi7C,KAAK,WACb,GAAIU,GAAQv7B,EAAEpgB,KACd27C,GAAMxlC,SAAS,SAAU7E,GACrB,GAAInQ,GAAMmQ,EAAEsqC,MAAQtqC,EAAEsqC,MAAQtqC,EAAEuqC,OAChC,IAAW,IAAP16C,EAAW,CACX,GAAI26C,GAAO7wC,EAAQmV,EAAEs7B,EAAazwC,GAASmV,EAAEs7B,EAC7CV,QAAOh7C,MAAM+7C,OACbzqC,EAAEiG,iBACFjG,EAAEgG,kBACEwkC,EAAK,GAAGplC,gBAAkBolC,EAAK,GAAGplC,eAAexW,UACjD47C,EAAK,GAAGplC,eAAexW,SAAS47C,EAAK,IAEzCA,EAAKE,QAAQhsC,cAM7BoQ,EAAE26B,GAAGkB,aAAe,SAAU/7C,GAC1B,MAAOF,MAAKi7C,KAAK,WACb,GAAIU,GAAQv7B,EAAEpgB,KACd27C,GAAMxlC,SAAS,SAAU7E,GACrB,GAAInQ,GAAMmQ,EAAEsqC,MAAQtqC,EAAEsqC,MAAQtqC,EAAEuqC,OACrB,KAAP16C,IACA65C,OAAOh7C,MAAM+7C,OACbzqC,EAAEiG,iBACErX,GAAUA,UAM9BkgB,EAAE26B,GAAGmB,oBAAsB,SAAUC,EAAYj8C,GAC7C,MAAOF,MAAKi7C,KAAK,WACb,GAAI3wC,GAAMtK,KACN27C,EAAQv7B,EAAEpgB,MACVo8C,EAAU9xC,EAAItF,KAClB22C,GAAMU,QAAQ,SAAU/qC,GACpBoG,aAAapN,EAAIgyC,kBACjBhyC,EAAIgyC,iBAAmB/7C,WAAW,WAC9B67C,EAAU9xC,EAAItF,MACd9E,EAASoK,EAAKA,EAAItF,QACnBm3C,KAGPR,EAAMI,KAAK,SAAUzqC,GACb8qC,GAAW9xC,EAAItF,QACfo3C,EAAU9xC,EAAItF,MACd9E,EAASoK,EAAKA,EAAItF,cAKnCg2C,QAEH,SAAW56B,GACPA,EAAE26B,GAAGwB,qBAAuB,SAAU31C,EAAY41C,EAAOC,GACrD,GAAI95B,GAAOvC,EAAEpgB,KAEb,OAAO,IAAIwC,OAAML,QAAQ,SAAU8P,EAAUC,GACzC,GAAI9Q,GAAMwF,EAAa,IAAM41C,EAAQ,cACjC9wC,EAAMiX,EAAKw4B,IAAI,aAAc/5C,EAE7Bq7C,IACAA,EAAoB/wC,GAExBA,EAAI8wC,MAAMA,EAAQ,IAAIt+B,UAAUzK,KAAK,WACjCkP,EAAKw4B,IAAI,iBAAkB,IAC3BlpC,EAASvG,IAEb,WACIiX,EAAKw4B,IAAI,iBAAkB,IAC3BjpC,EAAMxG,SAInBsvC,QAEH,SAAW56B,GACPA,EAAE26B,GAAG2B,eAAiB,WAClB,MAAO,IAAIl6C,OAAML,QAAQ,SAAU8P,EAAUC,GACzC,GAAIxG,GAAM1L,KAAKke,UAAUzK,KAAK,WAC1BxB,EAASvG,IAEb,WACIwG,EAAMxG,SAInBsvC,QAEH,SAAW56B,GACPA,EAAE26B,GAAG4B,WAAa,SAAUC,EAAkB5K,GAC1C,GAAI5mC,GAAWgV,EAAEw8B,GAAkBtvC,IAAI,EAIvC,OAHIlC,KACAA,EAAWA,EAASnB,YAEjBjK,KAAKi7C,KAAK,WACb,GAAIU,GAAQv7B,EAAEpgB,KACVoL,IACAA,EAASK,OAAO,KAAMumC,GAAQv+B,KAAK,SAAUnJ,GACzCqxC,EAAMz+B,OAAO5S,EAAIyI,SAAS,UAK3CioC,QAEH,SAAW56B,GACPA,EAAE26B,GAAG8B,eAAiB,SAAUD,EAAkBE,EAAaC,GAC3D,GAAI3xC,GAAWgV,EAAEw8B,GAAkBtvC,IAAI,EAIvC,OAHIlC,KACAA,EAAWA,EAASnB,YAEjBjK,KAAKi7C,KAAK,WACb,GAAIU,GAAQv7B,EAAEpgB,KACVoL,IACA0xC,EAAYx7C,QAAQ,SAAU6D,EAAS0Y,GACnCzS,EAASK,OAAO,KAAMtG,GAASsO,KAAK,SAAUnJ,GAC1C,GAAI0yC,GAAe1yC,EAAIyI,SAAS,EAChC4oC,GAAMz+B,OAAO8/B,GACTD,GACAA,EAAa53C,EAAS63C,WAM/ChC,QAEH,SAAW56B,GACPA,EAAE26B,GAAGkC,aAAe,SAAUC,EAAQC,GAClC,GAAIC,GAAYrnC,QAAQnI,GAAGyvC,eAAeC,gBAAgBt4C,MACtDu4C,GAAa,CAIjB,QAHIH,IAAcrnC,QAAQnI,GAAGyvC,eAAeG,qBAAqBC,SAAWL,IAAcrnC,QAAQnI,GAAGyvC,eAAeG,qBAAqBE,sBACrIH,GAAa,GAEVv9C,KAAKi7C,KAAK,WACD76B,EAAEpgB,KACVu9C,GACAv9C,KAAK+Q,aAAaL,WAAa1Q,KAAKyQ,YAAcysC,EAASA,EAAS,GAEpEl9C,KAAK+Q,aAAaF,UAAY7Q,KAAK4Q,WAAassC,EAASA,EAAS,OAI/ElC,QAEH,SAAW56B,GACPA,EAAE26B,GAAG4C,mBAAqB,SAAUT,EAAQC,GACxC,GAAIC,GAAYrnC,QAAQnI,GAAGyvC,eAAeC,gBAAgBt4C,MACtDu4C,GAAa,CAIjB,QAHIH,IAAcrnC,QAAQnI,GAAGyvC,eAAeG,qBAAqBC,SAAWL,IAAcrnC,QAAQnI,GAAGyvC,eAAeG,qBAAqBE,sBACrIH,GAAa,GAEVv9C,KAAKi7C,KAAK,WACTsC,EACAv9C,KAAK+Q,aAAaA,aAAaL,WAAa1Q,KAAKyQ,YAAcysC,EAASA,EAAS,GAEjFl9C,KAAK+Q,aAAaA,aAAaF,UAAY7Q,KAAK4Q,WAAassC,EAASA,EAAS,OAI5FlC,QAEH,SAAW56B,GACPA,EAAE26B,GAAG6C,eAAiB,SAAU19C,GAC5B,GAAIwL,KA6BJ,OA5BA1L,MAAKi7C,KAAK,WACN,GACIt4B,IADQvC,EAAEpgB,MACHA,MACPke,EAAU,GAAI1b,OAAML,QAAQ,SAAU8P,EAAUC,GAChD,QAASC,GAAQb,GACbqR,EAAKnM,oBAAoB,QAASrE,GAClCwQ,EAAKnM,oBAAoB,OAAQqnC,GACjC3rC,GAAQxC,QAAS,qBAAsBpF,IAAKgH,EAAEyF,gBAGlD,QAAS8mC,KACLl7B,EAAKnM,oBAAoB,QAASrE,GAClCwQ,EAAKnM,oBAAoB,OAAQqnC,GACjC5rC,EAAS0Q,GACLziB,GACAA,EAASyiB,GAGjBA,EAAKtT,iBAAiB,QAAS8C,GAC/BwQ,EAAKtT,iBAAiB,OAAQwuC,GAAU,GAEpCl7B,EAAKrQ,aAAe,GACpBurC,KAGRnyC,GAAIvI,KAAK+a,KAGNxS,GAGX0U,EAAE26B,GAAG+C,WAAa,SAAU59C,GACxB,GAAIsD,GAAWxD,KAAK49C,gBACpB,OAAI19C,OACAsC,OAAML,QAAQsB,KAAKD,GAAUiQ,KAAK,SAAU/H,GACxCxL,EAASwL,KAGNlJ,MAAML,QAAQsB,KAAKD,IAIlC4c,EAAE26B,GAAGrhC,gBAAkB,SAAUxZ,EAAUyZ,GACvC,GAAInW,MACA4vB,GAAY,CAEhBpzB,MAAKi7C,KAAK,WACN,GAAI8C,GAAiB/9C,KAEjB2O,EAAO,GAAInM,OAAML,QAAQ,SAAU8P,EAAUC,GAC7C,GAAI2H,GAAoB,SAAU3K,GAC1BA,EAAM4K,aAAeikC,GACrBhkC,KAGJA,EAAQ,WACRrC,aAAakC,YACbmkC,EAAevnC,oBAAoB,gBAAiBqD,GAAmB,GACvE5H,IAGJ8rC,GAAe1uC,iBAAiB,gBAAiBwK,GAAmB,GACpED,WAAarZ,WAAWwZ,EAAOJ,GAAW,MAE9CnW,GAASL,KAAKwL,IAGlB,IAAIqvC,GAAU,KAAM9rC,EAAQ,KACxB3P,EAAgB,GAAIC,OAAML,QAAQ,SAAUtB,EAAGyQ,GAC/C0sC,EAAUn9C,EACVqR,EAAQZ,IAGRtO,EAAIR,MAAML,QAAQsB,KAAKD,EAc3B,OAbAR,GAAEyQ,KAAK,WACH,MAAK2f,IAQLpwB,EAAE0S,aACFxD,OARIkhB,GAAY,EACRlzB,GACAA,QAEJ89C,OAKL9rC,GAEI3P,GAGX6d,EAAE26B,GAAGkD,eAAiB,SAAU/9C,GAC5B,GAAIsD,KAqBJ,OApBAxD,MAAKi7C,KAAK,WACN,GAAI9sC,GAAOnO,KACP2O,EAAO,GAAInM,OAAML,QAAQ,SAAU8P,EAAUC,GAC7C,QAASgsC,GAAahvC,GACdA,EAAM4K,aAAeikC,iBACrB5vC,EAAKqI,oBAAoB,eAAgB0nC,GACzCjsC,KAIR9D,EAAKkB,iBAAiB,eAAgB6uC,IAE1C16C,GAASL,KAAKwL,KAGlBnM,MAAML,QAAQsB,KAAKD,GAAUiQ,KAAK,WAC1BvT,GACAA,MAGDF,MAGXogB,EAAE26B,GAAGoD,oBAAsB,SAAU5hC,GAEjC,MAAOvc,MAAKi7C,KAAK,WACb,GAAI9sC,GAAOnO,IACXogB,GAAEjS,GAAM8vC,eAAe,WACnB79B,EAAEjS,GAAMsJ,YAAY8E,KAGxB6D,EAAEjS,GAAMqJ,SAAS+E,OAG1By+B;CC3YH,WACI,YAEA,IAAIoD,GAAU,IACV5vC,QAAOuH,SAAWvH,OAAOuH,QAAQnI,IAAMY,OAAOuH,QAAQnI,GAAGyvC,gBAAkB7uC,OAAOuH,QAAQnI,GAAGyvC,eAAeC,kBAC5Gc,EAAU5vC,OAAOuH,QAAQnI,GAAGyvC,eAAeC,gBAE/C,IAAI1oC,GAAMpS,MAAMoG,WAEZy1C,EAA2B,SAAU/zC,GACrC,MAAO9H,OAAMoL,GAAGuF,UAAUmrC,SAASh0C,IAGnCi0C,EAA4B,SAAUj0C,GACtC,MAAO9H,OAAMoL,GAAGuF,UAAU8L,UAAU3U,GAGxC9H,OAAMsjB,UAAUlB,OAAO,mBACnBjQ,gBAAiB,SAAUxP,GAGvB,IAFA,GAAI6E,GAAU7E,EAAQsF,WAEfT,GAAS,CACZ,GAAIA,EAAQ+K,aACR,MAAO/K,GAAQC,UAEnBD,GAAUA,EAAQS,aAI1B+zC,qBAAsBh8C,MAAMoZ,MAAMC,IAAIrZ,MAAMoZ,MAAMgJ,OAM9C,SAA8Bzf,EAASsP,GACnC,GAAIA,GAAUA,MACV3G,EAAY9N,IA6BhB,IA5BAA,KAAKmF,QAAUA,GAAWK,SAAS4W,cAAc,OACjDpc,KAAKmF,QAAQ8E,WAAajK,KAC1BA,KAAKmF,QAAQ4P,cAAe,EAC5B/U,KAAKmF,QAAQyF,UAAU+I,IAAI,iBAC3B3T,KAAKmF,QAAQyF,UAAU+I,IAAI,uBAC3B3T,KAAKmP,aAAe,GAAIjN,cAAa0L,GAAGuL,aACxCnZ,KAAKw8C,MAAQ/nC,EAAQ+nC,OAAS,EAC9Bx8C,KAAKy+C,eAAiBhqC,EAAQgqC,iBAAkB,EAChDz+C,KAAK0+C,kCAAoCjqC,EAAQiqC,oCAAqC,EACtF1+C,KAAK2+C,cACL3+C,KAAK4+C,MAAQ,EAETnqC,EAAQuK,qBACRhf,KAAK2+C,WAAW1/B,UAAY/c,aAAagC,MAAMyH,cAAcxG,EAASsP,EAAQuK,qBAE7Ehf,KAAK2+C,WAAW1/B,YACjBjf,KAAK2+C,WAAW1/B,UAAYs/B,GAE5B9pC,EAAQoqC,oBACR7+C,KAAK2+C,WAAWL,SAAWp8C,aAAagC,MAAMyH,cAAcxG,EAASsP,EAAQoqC,oBAE5E7+C,KAAK2+C,WAAWL,WACjBt+C,KAAK2+C,WAAWL,SAAWD,GAC/Br+C,KAAK8+C,KAAOrqC,EAAQqqC,KAChBV,IACAp+C,KAAK++C,eAAiBX,EAAQp5C,OAElChF,KAAK+O,OAA4B9M,SAAnBwS,EAAQ1F,OAAuB0F,EAAQ1F,QAAS,EAC1D/O,KAAK+O,OAAQ,CACbvJ,SAAS4Q,KAAK4oC,QAAUh/C,KAAKi/C,cAAc/wC,KAAKlO,MAChDwF,SAAS4Q,KAAK8oC,WAAal/C,KAAKm/C,iBAAiBjxC,KAAKlO,MACtDwF,SAAS4Q,KAAKgpC,cAAgBp/C,KAAKq/C,oBAAoBnxC,KAAKlO,MAE5DkC,aAAa0L,GAAGC,YAAc3L,aAAa0L,GAAGC,gBAC9C3L,aAAa0L,GAAGC,YAAYC,UAAY9N,KAExCA,KAAKmP,aAAaC,SAASwF,EAAK,iBAAkB5U,KAAKs/C,gBAAgBpxC,KAAKlO,OAC5EA,KAAKmP,aAAaC,SAASwF,EAAK,YAAa5U,KAAKu/C,WAAWrxC,KAAKlO,MAElE,IAAIw/C,GAA0B,IAC1Bt9C,cAAa0L,GAAG6xC,wBAA0BjxC,OAAOuH,SAAWvH,OAAOuH,QAAQnI,IAAMY,OAAOuH,QAAQnI,GAAG8xC,MAAQlxC,OAAOuH,QAAQnI,GAAG8xC,KAAKC,0BAClIH,EAA0BhxC,OAAOuH,QAAQnI,GAAG8xC,KAAKC,wBAAwBC,qBAGzEJ,GAA2Bt9C,aAAa0L,GAAG6xC,wBAC3Cz/C,KAAKmP,aAAaC,SAASowC,EAAyB,gBAAiB,SAAUzvC,GACvEvN,MAAMoG,WAAWi3C,YACjB/xC,EAAUgyC,OACV/vC,EAAI+F,SAAU,SAOtBrB,GAAQsrC,kBACR//C,KAAKggD,sBAEThgD,KAAKigD,UAAaC,aAGtBlgD,MAAKmP,aAAaC,SAASZ,OAAQ,SAAU,SAAUrO,GAC/C2N,EAAUqyC,eACVC,qBAAqBtyC,EAAUqyC,eAEnCryC,EAAUqyC,cAAgBE,sBAAsB,WAC5CvyC,EAAUqyC,cAAgB,KAC1BryC,EAAUwyC,SAASngD,SAQvB2+C,KAAM,GAEN35C,QAAS,KACTo7C,uBAAwB/9C,MAAML,QAAQS,KACtCm8C,eAAgB,EAGhBhxC,aACIT,IAAK,WACD,MAAOtN,MAAKwgD,YAAcxgD,KAAKwgD,YAAYv2C,WAAa,OAKhEu2C,aACIlzC,IAAK,WACD,MAAOtN,MAAKygD,cAAgBzgD,KAAKmF,QAAQu7C,mBAIjD/3C,SACI2E,IAAK,WACD,MAAItN,MAAK+O,OACEvM,MAAMoG,WAAWD,QAEjB3I,KAAKigD,WAIxB5pC,QAAS,WACLrW,KAAK4+C,SAGTtoC,WAAY,WACRtW,KAAK4+C,SAIT+B,mBAAoB,WAChB,GAAIx7C,GAAUK,SAAS4W,cAAc,MAKrC,OAJAjX,GAAQ2X,aAAa,MAAOtO,OAAOsR,iBAAiB9f,KAAKmF,QAAS,MAAM4a,WAIjE5a,GAIXwR,QAAS,WACD3W,KAAK+kB,YAGT/kB,KAAK+kB,WAAY,EACjB/kB,KAAK4gD,yBACDp+C,MAAMiM,UAAUiX,gBAChBljB,MAAMiM,UAAUiX,eAAe1lB,KAAKmF,SAExCnF,KAAKmP,aAAawH,YAItBkqC,qBAAsB,SAAU9wC,GAC5B,GAAIjC,GAAY9N,KACZ8gD,EAAchzC,EAAUC,YACxB0f,EAAU,WACV1d,EAAI+F,SAAU,EACV/F,EAAIwH,gBACJxH,EAAIwH,kBAERgE,EAAQ,WACR,MAAIzN,GAAU+xC,WACV/xC,EAAUgyC,OACVryB,KACO,GAHX,OAOJ,KAAIqzB,EAAYC,SAmBZ,MAAOxlC,IAlBP,IAAI7P,GAAMo1C,EAAYC,UACtB,OAAIv+C,OAAML,QAAQ0W,GAAGnN,OACjBA,GAAI7I,KAAK,SAAUk+C,GACf,MAAKA,GAIExlC,KAHHkS,KACO,KAKV/hB,EAIE6P,KAHHkS,KACO,IAWvBuyB,oBAAqB,WACjB,GAAIlyC,GAAY9N,IAChBA,MAAK+/C,iBAAmB79C,aAAa0L,GAAG0H,yBAAyBtV,KAAM,SAAU+P,GAC7EjC,EAAU+yC,qBAAqB9wC,MAIvC6wC,uBAAwB,WAChB5gD,KAAK+/C,mBACL//C,KAAK+/C,mBACL//C,KAAK+/C,iBAAmB,OAMhCiB,sBAAuB,SAAUC,GAC7B,MAAIjhD,MAAK+N,aAAe/N,KAAK+N,YAAYqR,qBAC9Bpf,KAAK+N,YAAYqR,qBAAqB6hC,GAE1CjhD,KAAKwgD,aAKhBrB,iBAAkB,SAAUh/C,GACpBH,KAAK4+C,MAAQ,GAGA,cAAbz+C,EAAKgB,KACLnB,KAAK8/C,QAMbb,cAAe,SAAU9+C,GACjBH,KAAK4+C,MAAQ,IAGC,SAAbz+C,EAAKgB,KAAkBhB,EAAK+gD,QAAyB,gBAAb/gD,EAAKgB,MAC9CnB,KAAK8/C,QAQbT,oBAAqB,SAAUl/C,GACP,IAAhBA,EAAK8W,OACLrC,EAAIkrC,OACmB,IAAhB3/C,EAAK8W,QACZrC,EAAIusC,WAIZtsC,SAAU,SAAU9L,EAAUq4C,EAAcC,EAAaC,EAAQC,GAC7D,GAAI3sC,GAAM5U,IACV,IAAIA,KAAK+O,OACL,MAAOvM,OAAMoG,WAAWiM,SAAS9L,EAAUq4C,EAE3C,IAAIrxC,IACAsxC,YAAaA,EACb7rC,QACIzM,SAAUA,EACV4V,MAAOyiC,EACPI,gBAAkBD,EAClB9rC,WAAY,SAAUyI,GAClBle,KAAKyhD,YAAcvjC,IAO/B,OAHAtJ,GAAI0qC,gBAAgBvvC,GACpBA,EAAIyF,OAAOisC,YAAc1xC,EAAIyF,OAAOisC,aAAej/C,MAAML,QAAQM,OACjEmS,EAAIqrC,SAASj2C,SAAY2U,MAAOyiC,EAAcr4C,SAAUA,GACjDgH,EAAIyF,OAAOisC,YAAY5+C,KAAK,WAK/B,MAJIy+C,IACA1sC,EAAIqrC,SAASC,UAAU3pC,OAAO3B,EAAIqrC,SAASC,UAAU5/C,OAAS,EAAG,GAErEsU,EAAI2qC,WAAWxvC,GACRA,EAAIyF,OAAOisC,eAK9BC,aAAc,WACN1hD,KAAK+O,OACLvM,MAAMoG,WAAWD,QAAQE,cAEzB7I,KAAKigD,SAASC,aACdlgD,KAAKigD,SAASj2C,QAAU,OAIhC23C,cAAe,WAIX,IAAK,GAHD7zC,GAAY9N,KACZ4hD,EAAQ9zC,EAAU3I,QAAQ4N,SAErB3P,EAAIw+C,EAAMthD,OAAO,EAAI8C,GAAK,EAAIA,IAAK,CACxC,GAAI0F,GAAO84C,EAAMx+C,EACb0F,GAAK8B,UAAUC,SAAS,iBACxBiD,EAAU3I,QAAQ08C,YAAY/4C,GAC9BA,EAAKmB,WAAW0M,aAK5B29B,MAAO,WACHt0C,KAAK0hD,eACL1hD,KAAK2hD,gBACL3hD,KAAKygD,aAAe,KACpBzgD,KAAKmF,QAAQyX,UAAY,IAI7BklC,KAAM,SAAUxyC,EAAKmF,GACjB,MAAOzU,MAAK6U,SAASvF,EAAKmF,IAG9BstC,KAAM,SAAUzyC,EAAKmF,GAGjB,MAFAA,GAAUA,MACVA,EAAQ+sC,iBAAkB,EACnBxhD,KAAK6U,SAASvF,EAAKmF,IAG9BorC,WACIvyC,IAAK,WACD,MAAItN,MAAK+O,OACE6F,EAAIirC,UAEJ7/C,KAAKigD,SAASC,UAAU5/C,OAAS,IAIpD0hD,mBAAoB,WAChB,GAAIl0C,GAAY9N,IAChB,IAAI8N,EAAUiB,OAAQ,CAClB,GAAIkzC,GAAyC,GAA7Bn0C,EAAUo0C,iBAA4B1/C,MAAMoG,WAAWD,QAAQqB,QAAQ2U,OAASnc,MAAMoG,WAAWD,QAAQqB,QAAQ2U,MAAM6iC,eACvI,IAAIS,EAAW,CACX,GAAIE,GAAer0C,EAAU3I,QAAQ4N,SAASjF,EAAU3I,QAAQ4N,SAASzS,OAAS,EAClF,IAAI6hD,EAGA,MAFA3/C,OAAMoG,WAAWD,QAAQE,UAAU0N,OAAO/T,MAAMoG,WAAWD,QAAQE,UAAUvI,OAAS,EAAG,GAElFwN,EAAUs0C,UAAUt0C,EAAUC,YAAY5I,SAAStC,KAAK,WAC3DiL,EAAUu0C,kBAAkBF,EAAal4C,WAAW9E,SAChDg9C,EAAal4C,YAAck4C,EAAal4C,WAAWq4C,aACnDH,EAAal4C,WAAWq4C,mBAQhDxC,KAAM,SAAUyC,GACZ,GAAIz0C,GAAY9N,IAEhB,IAAI8N,EAAUiB,OAGV,MAAOvM,OAAMoG,WAAWk3C,KAAKyC,EAG7B,IAAIz0C,EAAUmyC,SAASC,UAAU5/C,OAAQ,CACrC,GAAIkiD,GAAY10C,EAAUmyC,SAASC,UAAU5/C,OAAS,EAClD6hD,EAAer0C,EAAUmyC,SAASC,UAAUsC,EAEhD,OAAO10C,GAAU+G,SAASstC,EAAap5C,SAAUo5C,EAAaxjC,OAAO,GAAM,KAKvF2gC,gBAAiB,SAAUn/C,GACvB,GAAI2N,GAAY9N,KACZ8I,EAAO9I,KAAKwgD,YACZiC,EAActiD,EAAKqV,OAAOzM,SAC1B25C,EAAWviD,EAAKqV,OAAOmJ,KAE3Bxe,GAAKqV,OAAOmJ,MAAQxe,EAAKqV,OAAOmJ,SAChC,IAAIgkC,GAA2C,GAA7B70C,EAAUo0C,iBAA2B/hD,EAAKqV,OAAOgsC,iBAAmBrhD,EAAKqV,OAAOmJ,MAAM6iC,eAExG,IAAI1zC,EAAUiB,QAAUjG,GAAQA,EAAKmB,YAAcnB,EAAKmB,WAAWyU,iBAAmB5V,EAAKmB,WAAWyU,gBAAgBC,OAAS7V,EAAKmB,WAAWyU,gBAAgBC,MAAM6iC,gBAAiB,CAClL,GAAI74C,GAAUnG,MAAMoG,WAAWD,QAAQE,UAAUrG,MAAMoG,WAAWD,QAAQE,UAAUvI,OAAS,EAC7F,IAAImiD,GAAe95C,EAAQI,UAAY25C,GAAY/5C,EAAQgW,MAAO,CAC9D,GAAIjT,GAAMoC,EAAUk0C,oBACpB,IAAIx/C,MAAML,QAAQ0W,GAAGnN,GAQjB,MAPAlJ,OAAMoG,WAAWD,QAAQqB,QAAUrB,MACnCxI,GAAKqV,OAAOC,WAAW/J,EAAI7I,KAAK,WAC5B,GAAIG,GAAI,GAAIR,OAAML,QAAQ,SAAUtB,KAGpC,OAFAV,GAAKqV,OAAOC,WAAWzS,GACvBA,EAAE0S,SACK1S,MAOvB,GAAIhD,KAAK4+C,MAAQ,EAAG,CAChB,GAAI57C,GAAI,GAAIR,OAAML,QAAQ,SAAUtB,KAGpC,OAFAV,GAAKqV,OAAOC,WAAWzS,OACvBA,GAAE0S,SAGD,GAAI5M,GAAQA,EAAKmB,aAAe04C,GAAe75C,EAAKmB,WAAW82C,SAAU,CAC1E,GAAI6B,GAAmB,KACnB5/C,EAAI,GAAIR,OAAML,QAAQ,SAAUtB,GAChC+hD,EAAmB/hD,GAevB,OAbAZ,cAAa,WACTuC,MAAML,QAAQM,KAAKqG,EAAKmB,WAAW82C,YAAYl+C,KAAK,SAAU6I,GACrDA,GAIDoC,EAAU+0C,gBAAgBF,GAC1BC,KAJA5/C,EAAE0S,iBAQdvV,GAAKqV,OAAOC,WAAWzS,GAK3B,IAAI2/C,GAAgBxiD,EAAKqV,OAAOmJ,MAAMmkC,qBAAtC,CAQA,GAAIh1C,EAAUiB,SAAW4zC,GAAengD,MAAMoG,WAAWD,QAAQqB,QAAQ2U,OAASnc,MAAMoG,WAAWD,QAAQqB,QAAQ2U,MAAM6iC,gBAAiB,CACtI1zC,EAAU6zC,eAEV,KAAK,GADDzB,GAAY19C,MAAMoG,WAAWD,QAAQE,UAChCzF,EAAI88C,EAAU5/C,OAAS,EAAI8C,GAAK,EAAIA,IACrC88C,EAAU98C,GAAGub,OAASuhC,EAAU98C,GAAGub,MAAM6iC,iBACzCtB,EAAU3pC,OAAOnT,EAAG,GAKhC0K,EAAU+0C,sBAjBN,IAAI/5C,EAAKmB,WAAW84C,cAEhB,WADA5iD,GAAKqV,OAAOC,WAAWjT,MAAML,QAAQS,GAAGkG,EAAKmB,WAAW84C,cAAcvhD,MAAMsH,EAAKmB,eAmB7F44C,gBAAiB,SAAUF,GACvB,GAAI70C,GAAY9N,KACZ8I,EAAO9I,KAAKwgD,WAChB,IAAImC,EAMA,YAJI75C,EAAKmB,WAAW+4C,gBADhBl6C,EAAKmB,WAAW84C,cACkBvgD,MAAML,QAAQS,GAAGkG,EAAKmB,WAAW84C,iBAEjCvgD,MAAML,QAAQM,OAIxD,IAAIwgD,GAAW,WACNN,IACD75C,EAAKuK,MAAMmJ,QAAU,OACrB1T,EAAKuK,MAAMoJ,WAAa,SACxB3T,EAAKuK,MAAME,QAAU,IAG7B,IAAIzK,GAAQA,EAAKmB,aAAenB,EAAKmB,WAAW+4C,gBAAiB,CAC7D,GAAIl6C,EAAKmB,WAAWq0C,SAAU,CAC1B,GAAI4E,GAAiBp6C,EAAKmB,WAAWq0C,UACrC,IAAI4E,EAAgB,CAChB,GAAIx3C,GAAMlJ,MAAML,QAAQS,GAAGsgD,EAC3Bp6C,GAAKmB,WAAW+4C,gBAAkBt3C,EAAI7I,KAAK,WACvC,MAAIiG,GAAKmB,WAAW40C,kBACTr8C,MAAML,QAAQS,GAAGkG,EAAKmB,WAAW40C,qBAD5C,SAGDh8C,KAAKogD,OAGJn6C,GAAKmB,WAAW+4C,gBADhBl6C,EAAKmB,WAAW40C,kBACkBr8C,MAAML,QAAQS,GAAGkG,EAAKmB,WAAW40C,qBAAqBh8C,KAAKogD,GAE3DzgD,MAAML,QAAQS,GAAGkL,EAAU6wC,WAAWL,SAASxwC,EAAUkzC,uBAAsB,KAAQn+C,KAAKogD,OAKlIn6C,GAAKmB,WAAW+4C,gBADhBl6C,EAAKmB,WAAW40C,kBACkBr8C,MAAML,QAAQS,GAAGkG,EAAKmB,WAAW40C,qBAAqBh8C,KAAKogD,GAE3DzgD,MAAML,QAAQS,GAAGkL,EAAU6wC,WAAWL,SAASxwC,EAAUkzC,uBAAsB,KAAQn+C,KAAKogD,EAItI,IAAIE,GAAcr6C,EAAKuI,iBAAiB,mBACxC,IAAI8xC,GAAeA,EAAY7iD,OAC3B,IAAK,GAAI8C,GAAI,EAAIA,EAAI+/C,EAAY7iD,OAAQ8C,IAAK,CAC1C,GAAI+K,GAAOg1C,EAAY//C,GAAG6G,UACtBkE,GAAKmwC,UACLnwC,EAAKmwC,WAIbp8C,aAAa0L,GAAGC,YAAYukC,UAC5BlwC,aAAa0L,GAAGC,YAAYukC,SAAS7gC,SAIjD6wC,UAAW,SAAUgB,EAAoBjjD,GACrC,GAAI2N,GAAY9N,IAChBG,GAAOA,KACP,IACIkjD,IADgBv1C,EAAU3I,QACbi+C,GAAsBpjD,KAAKwgD,YACxC6C,IACAnhD,aAAa0L,GAAGgJ,SAASysC,EAE7B,IAAIC,GAAsBD,GAAcA,EAAWp5C,YAAco5C,EAAWp5C,WAAW+4C,gBAAmBK,EAAWp5C,WAAW+4C,gBAAkBxgD,MAAML,QAAQM,MAiBhK,OAhBAqL,GAAUnI,cAAc,eAAiBmD,KAAMu6C,IAE3CA,GAAcA,EAAWp5C,aACzBo5C,EAAWp5C,WAAW8T,cAAc8G,OACpCw+B,EAAWp5C,WAAWtE,cAAc,WAAa49C,OAAQ,SAErDF,EAAWp5C,WAAWyW,gBACtB2iC,EAAWp5C,WAAWyW,mBAIzB5S,EAAUiB,SAAWjB,EAAU2wC,gBAAkB4E,GAAcA,EAAWp5C,YAAco5C,EAAWp5C,WAAWyU,kBAAoBve,EAAKkhD,aACxIvzC,EAAUmyC,SAASC,UAAU/8C,KAAKkgD,EAAWp5C,WAAWyU,iBAG5D5Q,EAAU2yC,aAAe,KAClB6C,EAAmBzgD,KAAK,WAC3B,GAAIwgD,EAAY,CACZA,EAAWhwC,MAAME,QAAU,IAC3B8vC,EAAWhwC,MAAMmJ,QAAU,OAKvB6mC,EAAWp5C,aACXo5C,EAAWp5C,WAAWu5C,UAAY,KAClCH,EAAWp5C,WAAWw5C,UAAY,KAC9BJ,EAAWp5C,WAAWkF,cACtBk0C,EAAWp5C,WAAWkF,aAAawH,UAGnC0sC,EAAWp5C,WAAWy5C,QACtBL,EAAWp5C,WAAWy5C,UAI1BlhD,MAAMiM,UAAUiX,gBAChBljB,MAAMiM,UAAUiX,eAAe29B,EAInC,KACIA,EAAWt5C,cAAc83C,YAAYwB,GAEzC,MAAOjvC,GACHgE,QAAQiM,IAAI,yCAQ5Bk7B,WAAY,SAAUp/C,GAClB,GAAI2N,GAAY9N,IAGhBG,GAAKqV,OAAOmJ,MAAQxe,EAAKqV,OAAOmJ,SAChC,IAAIglC,GAAgB71C,EAAU3I,QAC1By+C,EAAU5jD,KAAK+N,YACfs1C,EAAarjD,KAAKwgD,YAClBmC,EAA2C,GAA7B70C,EAAUo0C,iBAA2B/hD,EAAKqV,OAAOgsC,iBAAoBrhD,EAAKqV,OAAOmJ,OAASxe,EAAKqV,OAAOmJ,MAAM6iC,eAS9H,IAPIxhD,KAAKugD,yBACLvgD,KAAKugD,uBAAuB7qC,SAExBxT,aAAa0L,GAAGC,YAAYukC,UAC5BlwC,aAAa0L,GAAGC,YAAYukC,SAAS3gC,QAGzCmyC,GAAWA,EAAQJ,WAAarjD,EAAKqV,OAAOmJ,MAAMmkC,qBAAsB,CACxE,GAAIrjC,GAAsB3R,EAAUs0C,UAAUiB,EAAYljD,EAK1D,OAJAH,MAAKugD,uBAAyB9gC,EAC9Btf,EAAKqV,OAAOC,WAAWgK,QACnBvd,aAAa0L,GAAGC,YAAYukC,UAC5BlwC,aAAa0L,GAAGC,YAAYukC,SAAS3gC,QAGxC,GAAIkxC,EAAa,EACb70C,EAAUiB,SAAWjB,EAAU2wC,gBAAkB4E,GAAcA,EAAWp5C,YAAco5C,EAAWp5C,WAAWyU,kBAAoBve,EAAKkhD,aACxIvzC,EAAUmyC,SAASC,UAAU/8C,KAAKkgD,EAAWp5C,WAAWyU,gBAG5D,IAAIe,GAAsBjd,MAAML,QAAQM,WAGxC,IAAIgd,GAAsB3R,EAAUs0C,UAAUiB,EAAYljD,EAG9D,IAAI2N,EAAUiB,SAAW4zC,EAErB,IAAK,GADDzC,GAAY19C,MAAMoG,WAAWD,QAAQE,UAChCzF,EAAI88C,EAAU5/C,OAAS,EAAI8C,GAAK,EAAIA,IACrC88C,EAAU98C,GAAGub,OAASuhC,EAAU98C,GAAGub,MAAM6iC,iBACzCtB,EAAU3pC,OAAOnT,EAAG,EAWhCjD,GAAKqV,OAAOmJ,MAAMmkC,sBACd3tC,GAAIjT,aAAagC,MAAMqF,OACvB+vB,KAAM,GAAI7vB,MAKd,EAAA,GAAIwb,EACW,IAAIziB,OAAML,QAAQ,SAAUtB,GAAKokB,EAAmBpkB,IAanEiN,EAAU+1C,mBAAqB1jD,EAAKqV,MAEpC,IAAIsuC,GAAqB5hD,aAAa0L,GAAG6P,MAAMW,eAAeulC,EAAexjD,EAAKqV,OAAOzM,SAAU5I,EAAKqV,OAAOmJ,OAE3GM,UAAWnR,EAAU6wC,WAAW1/B,UAMhCT,mBAAqB1Q,EAAUi2C,iBAE/BtkC,oBAAqBA,EAAoB5c,KAAK,aAAiB,cAE/Dgc,OAAQ,SAAU1Z,EAASsP,GACvB,GAAKtP,EAAL,CACA,GAAIwI,GAAUxI,EAAQ8E,UACtB0D,GAAQG,UAAYA,EACpBH,EAAQxI,QAAQ6+C,SAAU,EACtBrB,IACAh1C,EAAQ61C,UAAYI,EAChBA,IACAA,EAAQH,UAAY91C,IAG5BA,EAAQgW,eAAiBhW,EAAQgW,eAAe9gB,KAAK,WACjDoiB,QAIR5F,SAAU,SAAUla,EAASsP,GACrBtU,EAAKqV,OAAOmJ,OAASxe,EAAKqV,OAAOmJ,MAAMslC,yBACnCn2C,EAAUiB,OACVvM,MAAMoG,WAAWD,QAAQE,aAEzBiF,EAAUmyC,SAASC,cAG3BpyC,EAAUu0C,kBAAkBl9C,IAGhCwa,QAAS,SAAUxa,EAASsP,GACxB3G,EAAUnI,cAAc,oBAAsBmD,KAAM3D,EAAQ8E,aACxD/H,aAAa0L,GAAGC,YAAYukC,UAC5BlwC,aAAa0L,GAAGC,YAAYukC,SAAS3gC,UAE9C5O,KAAK,WACJiL,EAAUyyC,uBAAyBt+C,QAGvCjC,MAAKugD,uBAAyBuD,EAG9B3jD,EAAKqV,OAAOC,WAAWjT,MAAML,QAAQsB,MAAMgc,EAAqBqkC,MAKpExD,SAAU,SAAUngD,GAChB,GAAI2N,GAAY9N,IAChB,IAAIA,KAAK+N,aAAe/N,KAAK+N,YAAY5I,QAAS,CAC9C,GAAI2I,GAAY9N,KACZ2N,EAAU3N,KAAK+N,YACf5I,EAAUwI,EAAQxI,OAGtBi7C,sBAAqBtyC,EAAUo2C,eAC/Bp2C,EAAUo2C,cAAgB7D,sBAAsB,WAE5C,IAAK,GADD8D,GAAK/F,EAAUA,EAAQp5C,MAAQ,KAC1B5B,EAAI,EAAGC,EAAIyK,EAAU3I,QAAQ4N,SAASzS,OAAY+C,EAAJD,EAAOA,IAAK,CAC/D,GAAIuK,GAAUG,EAAU3I,QAAQ4N,SAAS3P,GAAG6G,UAC5C,IAAI0D,EACA,GAAIA,EAAQwQ,cACRxQ,EAAQwQ,cAAchZ,EAASg/C,EAAIr2C,EAAUixC,oBAE5C,CACGpxC,EAAQ6W,cACR7W,EAAQ6W,aAAahE,KAAK7S,EAASxI,EAASg/C,EAAIr2C,EAAUixC,eAE9D,IAAIoE,GAAch+C,EAAQkM,iBAAiB,mBAC3C,IAAI8xC,GAAeA,EAAY7iD,OAC3B,IAAK,GAAI8C,GAAI,EAAIA,EAAI+/C,EAAY7iD,OAAQ8C,IAAK,CAC1C,GAAI+K,GAAOg1C,EAAY//C,GAAG6G,UACtBkE,GAAKqW,cACLrW,EAAKqW,aAAarW,EAAKhJ,QAASg/C,EAAIr2C,EAAUixC,qBAS9E/+C,KAAK++C,eAAiBX,EAAUA,EAAQp5C,MAAQ,MAGpDo/C,YAAa,WACTxvC,EAAIkrC,QAKRuC,kBAAmB,SAAUl9C,GACzB,GAAIgJ,GAAOnO,KACP6/C,EAAY1xC,EAAK0xC,UAEjBL,EAA0B,IAE1Bt9C,cAAa0L,GAAG6xC,wBAA0BjxC,OAAOuH,SAAWvH,OAAOuH,QAAQnI,IAAMY,OAAOuH,QAAQnI,GAAG8xC,MAAQlxC,OAAOuH,QAAQnI,GAAG8xC,KAAKC,0BAClIH,EAA0BhxC,OAAOuH,QAAQnI,GAAG8xC,KAAKC,wBAAwBC,qBAEzEzxC,EAAKY,QAAUywC,GAA2Bt9C,aAAa0L,GAAG6xC,yBAItDD,EAAwB6E,4BAHvBxE,EAGqDrxC,OAAOuH,QAAQnI,GAAG8xC,KAAK4E,4BAA4BC,QAFnD/1C,OAAOuH,QAAQnI,GAAG8xC,KAAK4E,4BAA4BE,UAKjH,IAAIC,GAAct/C,EAAQkM,iBAAiB,4DAG3C,IAAIozC,GAAeA,EAAYnkD,OAAS,EAMpC,IAAK,GALDokD,IAAW,EAKNthD,EAAI,EAAGC,EAAIohD,EAAYnkD,OAAY+C,EAAJD,EAAQA,IAAK,CACjD,GAAIuhD,GAAMF,EAAYrhD,EAClBy8C,KAAc6E,GACdC,EAAI/5C,UAAU4a,OAAO,YACrBm/B,EAAIhzC,UAAW,IAEfgzC,EAAI/5C,UAAU+I,IAAI,YAClBgxC,EAAIhzC,UAAW,GAGnBgzC,EAAI10C,QAAU,SAAUF,GACpB,GAAI5B,EAAKY,OACL6F,EAAIkrC,WAEH,CACD,GAAIhyC,GAAY5L,aAAa0L,GAAG+G,gBAAgB5E,EAAIgH,cACpDjJ,GAAUgyC,aAOnCt9C,MAAMiM,UAAUqN,cAGvB5Z,aAAa0L,GAAGoV,eAChB9gB,aAAa0L,GAAGoV,cAAcyF,SAAS,gBAAiBvmB,aAAa0L,GAAG4wC,sBACpE53C,YAAa,UACb7F,KACI6jD,oBACI18B,UAAW,qBACXpgB,SAAU,uBACVsZ,SAAS,GAEbyjC,mBACI38B,UAAW,oBACXpgB,SAAU,sBACVsZ,SAAS;AC9yB7B,GAAIlf,eACJ,SAAWA,GACP,GAAI0L,IACJ,SAAWA,GACP,GAAIuF,IACJ,SAAWA,GAwGP,QAAS2xC,GAAOrwC,GACZ,MAAIA,IAA6B,gBAAXA,IACT87B,SAAU97B,GAEZA,MAQf,QAASswC,GAAQlzC,EAAU4C,GACvBA,EAAUqwC,EAAOrwC,EACjB,IAAItU,IACA2H,SAAU,UACV00C,MAAOwI,EAA+B/iD,SAAlBwS,EAAQ+nC,MAAsB/nC,EAAQ+nC,MAAQ,EAAyBv6C,SAAtBwS,EAAQwwC,UAA0BxwC,EAAQwwC,UAAY,GAAI,EAAwBhjD,SAArBwS,EAAQywC,SAAyBzwC,EAAQywC,SAAW,KACtL3U,SAAU97B,EAAQ87B,UAAY,IAC9B4U,OAAQ1wC,EAAQ2wC,QAAU,cAC1B79C,GAAI,EAER,OAAO/E,OAAMoL,GAAGy3C,kBAAkBxzC,EAAU1R,GAShD,QAASq7C,GAAO3pC,EAAU4C,GAEtB,MADAA,GAAUqwC,EAAOrwC,GACVjS,MAAMoL,GAAGy3C,kBAAkBxzC,GAC9B/J,SAAU,UACV00C,MAAOwI,EAA+B/iD,SAAlBwS,EAAQ+nC,MAAsB/nC,EAAQ+nC,MAAQ,EAAyBv6C,SAAtBwS,EAAQwwC,UAA0BxwC,EAAQwwC,UAAY,GAAI,EAAwBhjD,SAArBwS,EAAQywC,SAAyBzwC,EAAQywC,SAAW,KACtL3U,SAAU97B,EAAQ87B,UAAY,IAC9B4U,OAAQ1wC,EAAQ2wC,QAAU,cAC1B79C,GAAI,IAIZ,QAASy9C,GAAaM,EAAcC,EAAYC,EAAaC,GACzD,MAAO,UAAUriD,GAEb,IAAK,GADDsiD,GAAMJ,EACD3gD,EAAI,EAAOvB,EAAJuB,EAAOA,IACnB4gD,GAAcC,EACdE,GAAOH,CAKX,OAHIE,KACAC,EAAMl+C,KAAKm+C,IAAID,EAAKD,IAEjBC,GASf,QAASE,GAAS/zC,EAAU4C,GACxBA,EAAUqwC,EAAOrwC,EACjB,IAAItU,IACA2H,SAAU,UACV00C,MAAOwI,EAA+B/iD,SAAlBwS,EAAQ+nC,MAAsB/nC,EAAQ+nC,MAAQ,EAAyBv6C,SAAtBwS,EAAQwwC,UAA0BxwC,EAAQwwC,UAAY,GAAI,EAAwBhjD,SAArBwS,EAAQywC,SAAyBzwC,EAAQywC,SAAW,KACtL3U,SAAU97B,EAAQ87B,UAAY,IAC9B4U,OAAQ1wC,EAAQ2wC,QAAU,UAC1B79C,GAAI,EAER,OAAO/E,OAAMoL,GAAGy3C,kBAAkBxzC,EAAU1R,GAShD,QAAS8e,GAAUpN,EAAU4C,GACzBA,EAAUqwC,EAAOrwC,EACjB,IAAIoxC,GAAUb,EAA+B/iD,SAAlBwS,EAAQ+nC,MAAsB/nC,EAAQ+nC,MAAQ,EAAyBv6C,SAAtBwS,EAAQwwC,UAA0BxwC,EAAQwwC,UAAY,IAAK,EAAwBhjD,SAArBwS,EAAQywC,SAAyBzwC,EAAQywC,SAAW,KAC1LY,GACAC,SAAU,yBACVj+C,SAAUk+C,EAAYC,UAAUC,QAChC1J,MAAOqJ,EACPtV,SAAU97B,EAAQ87B,UAAY,IAC9B4U,OAAQ1wC,EAAQ2wC,QAAU,kCAE1Be,EAAW3jD,MAAMoL,GAAGw4C,iBAAiBv0C,EAAUi0C,GAC/C3lD,GACA2H,SAAU,UACV00C,MAAOqJ,EACPtV,SAAU97B,EAAQ87B,UAAY,IAC9B4U,OAAQ1wC,EAAQ2wC,QAAU,WAC1B79C,GAAI,GAEJ8+C,EAAW7jD,MAAMoL,GAAGy3C,kBAAkBxzC,EAAU1R,EACpD,OAAOqC,OAAML,QAAQsB,MAAM0iD,EAAUE,IAGzC,QAASC,GAAUnhD,EAASohD,EAAcC,EAAM/xC,GAE5CA,EAAUqwC,EAAOrwC,EACjB,IAAI87B,GAAW97B,EAAQ87B,UAAYiW,EAAO,IAAM,IAE5CX,GADQpxC,EAAQ+nC,OAAS,EACfwI,EAA+B/iD,SAAlBwS,EAAQ+nC,MAAsB/nC,EAAQ+nC,MAAQ,EAAyBv6C,SAAtBwS,EAAQwwC,UAA0BxwC,EAAQwwC,UAAY,GAAI,EAAwBhjD,SAArBwS,EAAQywC,SAAyBzwC,EAAQywC,SAAW,MACzLE,EAASljD,EAAa0L,GAAGuF,UAAUszC,QAAQC,UAC3CF,KACApB,EAASljD,EAAa0L,GAAGuF,UAAUszC,QAAQE,YAC/C,IAAIb,IACAC,SAAUQ,EACVz+C,SAAUk+C,EAAYC,UAAUC,QAChC1J,MAAOqJ,EACPtV,SAAUA,EACV4U,OAAQ1wC,EAAQ2wC,QAAUA,GAE1Be,EAAW3jD,MAAMoL,GAAGw4C,iBAAiBjhD,EAAS2gD,GAC9Cc,GACA9+C,SAAU,UACV00C,MAAOqJ,EACPtV,SAAUA,EAAW,EACrB4U,OAAQC,EACR99C,KAAM,EACNC,GAAI,EAEHi/C,KACDI,EAAiBt/C,KAAO,EACxBs/C,EAAiBr/C,GAAK,EAClBq/C,EAAiBpK,MAAQjM,EAAW,IACpCqW,EAAiBpK,MAAQjM,EAAW,GAE5C,IAAI8V,GAAW7jD,MAAMoL,GAAGy3C,kBAAkBlgD,EAASyhD,EACnD,OAAOpkD,OAAML,QAAQsB,MAAM0iD,EAAUE,IAQzC,QAASQ,GAAgBh1C,EAAU4C,GAC/B,MAAO6xC,GAAUz0C,EAAU,gCAAgC,EAAM4C,GASrE,QAASqyC,GAAaj1C,EAAU4C,GAC5B,MAAO6xC,GAAUz0C,EAAU,6BAA6B,EAAM4C,GASlE,QAASsyC,GAAcl1C,EAAU4C,GAC7B,MAAO6xC,GAAUz0C,EAAU,8BAA8B,EAAM4C,GASnE,QAASuyC,GAAen1C,EAAU4C,GAC9B,MAAO6xC,GAAUz0C,EAAU,+BAA+B,EAAM4C,GASpE,QAASwyC,GAAcp1C,EAAU4C,GAC7B,MAAO6xC,GAAUz0C,EAAU,8BAA8B,EAAO4C,GASpE,QAASyyC,GAAWr1C,EAAU4C,GAC1B,MAAO6xC,GAAUz0C,EAAU,2BAA2B,EAAO4C,GASjE,QAAS0yC,GAAYt1C,EAAU4C,GAC3B,MAAO6xC,GAAUz0C,EAAU,4BAA4B,EAAO4C,GASlE,QAAS2yC,GAAav1C,EAAU4C,GAC5B,MAAO6xC,GAAUz0C,EAAU,6BAA6B,EAAO4C,GASnE,QAAS4yC,GAAYx1C,EAAU4C,GAE3BA,EAAUqwC,EAAOrwC,EACjB,IAAIoxC,GAAUb,EAA+B/iD,SAAlBwS,EAAQ+nC,MAAsB/nC,EAAQ+nC,MAAQ,EAAyBv6C,SAAtBwS,EAAQwwC,UAA0BxwC,EAAQwwC,UAAY,GAAI,EAAwBhjD,SAArBwS,EAAQywC,SAAyBzwC,EAAQywC,SAAW,KACzLY,GACAC,SAAU,2BACVj+C,SAAUk+C,EAAYC,UAAUC,QAChC1J,MAAOqJ,EACPtV,SAAU97B,EAAQ87B,UAAY,IAC9B4U,OAAQ,WAERgB,EAAW3jD,MAAMoL,GAAGw4C,iBAAiBv0C,EAAUi0C,GAC/Cc,GACA9+C,SAAU,UACV00C,MAAOqJ,EACPtV,SAAU97B,EAAQ87B,UAAY,IAC9B4U,OAAQ,SACR79C,KAAM,EACNC,GAAI,GAEJ8+C,EAAW7jD,MAAMoL,GAAGy3C,kBAAkBxzC,EAAU+0C,EACpD,OAAOpkD,OAAML,QAAQsB,MAAM0iD,EAAUE,IASzC,QAASiB,GAAaz1C,EAAU4C,GAE5BA,EAAUqwC,EAAOrwC,EACjB,IAAIoxC,GAAUb,EAA+B/iD,SAAlBwS,EAAQ+nC,MAAsB/nC,EAAQ+nC,MAAQ,EAAyBv6C,SAAtBwS,EAAQwwC,UAA0BxwC,EAAQwwC,UAAY,GAAI,EAAwBhjD,SAArBwS,EAAQywC,SAAyBzwC,EAAQywC,SAAW,KACzLiB,EAAW3jD,MAAMoL,GAAGw4C,iBAAiBv0C,GACrCk0C,SAAU,4BACVj+C,SAAUk+C,EAAYC,UAAUC,QAChC1J,MAAOqJ,EACPtV,SAAU97B,EAAQ87B,UAAY,IAC9B4U,OAAQjjD,EAAa0L,GAAGuF,UAAUszC,QAAQE,cAE1CN,EAAW7jD,MAAMoL,GAAGy3C,kBAAkBxzC,GACtC/J,SAAU,UACV00C,MAAOqJ,EACPtV,SAAU97B,EAAQ87B,UAAY,IAC9B4U,OAAQ,WACR79C,KAAM,EACNC,GAAI,GAER,OAAO/E,OAAML,QAAQsB,MAAM0iD,EAAUE,IASzC,QAASkB,GAAS11C,EAAU4C,GAExBA,EAAUqwC,EAAOrwC,EACjB,IAAI8xC,GAAe,uBACf9xC,GAAQ+yC,aACRjB,GAAgB,cAEpB,IAAIV,GAAUb,EAA+B/iD,SAAlBwS,EAAQ+nC,MAAsB/nC,EAAQ+nC,MAAQ,EAAyBv6C,SAAtBwS,EAAQwwC,UAA0BxwC,EAAQwwC,UAAY,GAAI,EAAwBhjD,SAArBwS,EAAQywC,SAAyBzwC,EAAQywC,SAAW,KACzLuC,EAAMhzC,EAAQ87B,UAAY,IAC1B4V,EAAW3jD,MAAMoL,GAAGw4C,iBAAiBv0C,GACrCk0C,SAAUQ,EACVz+C,SAAUk+C,EAAYC,UAAUC,QAChC1J,MAAOqJ,EACPtV,SAAUkX,EACVtC,OAAQ1wC,EAAQ2wC,QAAUljD,EAAa0L,GAAGuF,UAAUszC,QAAQC,aAE5DL,EAAW7jD,MAAMoL,GAAGy3C,kBAAkBxzC,GACtC/J,SAAU,UACV00C,MAAOqJ,EACPtV,SAAUkX,EACVtC,OAAQ1wC,EAAQ2wC,QAAUljD,EAAa0L,GAAGuF,UAAUszC,QAAQiB,YAC5DpgD,KAAM,EACNC,GAAI,GAER,OAAO/E,OAAML,QAAQsB,MAAM0iD,EAAUE,IASzC,QAASsB,GAAW91C,EAAU4C,GAE1BA,EAAUqwC,EAAOrwC,EACjB,IAAI8xC,GAAe,yBACf9xC,GAAQ+yC,aACRjB,GAAgB,cAEpB,IAAIkB,GAAMhzC,EAAQ87B,UAAY,IAC1BsV,EAAUb,EAA+B/iD,SAAlBwS,EAAQ+nC,MAAsB/nC,EAAQ+nC,MAAQ,GAA0Bv6C,SAAtBwS,EAAQwwC,UAA0BxwC,EAAQwwC,UAAY,GAAI,EAAwBhjD,SAArBwS,EAAQywC,SAAyBzwC,EAAQywC,SAAW,KAC1LiB,EAAW3jD,MAAMoL,GAAGw4C,iBAAiBv0C,GACrCk0C,SAAUQ,EACVz+C,SAAUk+C,EAAYC,UAAUC,QAChC1J,MAAOqJ,EACPtV,SAAUkX,EACVtC,OAAQ1wC,EAAQ2wC,QAAUljD,EAAa0L,GAAGuF,UAAUszC,QAAQC,aAE5DL,EAAW7jD,MAAMoL,GAAGy3C,kBAAkBxzC,GACtC/J,SAAU,UACV00C,MAAOqJ,EACPtV,SAAUkX,EACVtC,OAAQjjD,EAAa0L,GAAGuF,UAAUszC,QAAQiB,YAC1CpgD,KAAM,EACNC,GAAI,GAER,OAAO/E,OAAML,QAAQsB,MAAM0iD,EAAUE,IASzC,QAASuB,GAAc/1C,EAAU4C,GAE7BA,EAAUqwC,EAAOrwC,EACjB,IAAIoxC,GAAUb,EAA+B/iD,SAAlBwS,EAAQ+nC,MAAsB/nC,EAAQ+nC,MAAQ,EAAyBv6C,SAAtBwS,EAAQwwC,UAA0BxwC,EAAQwwC,UAAY,GAAI,EAAwBhjD,SAArBwS,EAAQywC,SAAyBzwC,EAAQywC,SAAW,KACzLuC,EAAMhzC,EAAQ87B,UAAY,IAC1B4V,EAAW3jD,MAAMoL,GAAGw4C,iBAAiBv0C,GACrCk0C,SAAU,6BACVj+C,SAAUk+C,EAAYC,UAAUC,QAChC1J,MAAOqJ,EACPtV,SAAUkX,EACVtC,OAAQ1wC,EAAQ2wC,QAAU,YAE1BiB,EAAW7jD,MAAMoL,GAAGy3C,kBAAkBxzC,GACtC/J,SAAU,UACV00C,MAAOqJ,EACPtV,SAAUkX,EACVtC,OAAQ,UACR79C,KAAM,EACNC,GAAI,GAER,OAAO/E,OAAML,QAAQsB,MAAM0iD,EAAUE,IASzC,QAASwB,GAAYh2C,EAAU4C,GAE3BA,EAAUqwC,EAAOrwC,EACjB,IAAI8xC,GAAe,0BACf9xC,GAAQ+yC,aACRjB,GAAgB,cAEpB,IAAIkB,GAAMhzC,EAAQ87B,UAAY,IAC1BsV,EAAUb,EAA+B/iD,SAAlBwS,EAAQ+nC,MAAsB/nC,EAAQ+nC,MAAQ,EAAyBv6C,SAAtBwS,EAAQwwC,UAA0BxwC,EAAQwwC,UAAY,GAAI,EAAwBhjD,SAArBwS,EAAQywC,SAAyBzwC,EAAQywC,SAAW,KACzLiB,EAAW3jD,MAAMoL,GAAGw4C,iBAAiBv0C,GACrCk0C,SAAUQ,EACVz+C,SAAUk+C,EAAYC,UAAUC,QAChC1J,MAAOqJ,EACPtV,SAAUkX,EACVtC,OAAQ1wC,EAAQ2wC,QAAUljD,EAAa0L,GAAGuF,UAAUszC,QAAQE,cAE5DN,EAAW7jD,MAAMoL,GAAGy3C,kBAAkBxzC,GACtC/J,SAAU,UACV00C,MAAOqJ,EACPtV,SAAUkX,EACVtC,OAAQ1wC,EAAQ2wC,QAAUljD,EAAa0L,GAAGuF,UAAUszC,QAAQqB,aAC5DxgD,KAAM,EACNC,GAAI,GAER,OAAO/E,OAAML,QAAQsB,MAAM0iD,EAAUE,IASzC,QAAS0B,GAAUl2C,EAAU4C,GAEzBA,EAAUqwC,EAAOrwC,EACjB,IAAI8xC,GAAe,wBACf9xC,GAAQ+yC,aACRjB,GAAgB,cAEpB,IAAIkB,GAAMhzC,EAAQ87B,UAAY,IAC1BsV,EAAUb,EAA+B/iD,SAAlBwS,EAAQ+nC,MAAsB/nC,EAAQ+nC,MAAQ,EAAyBv6C,SAAtBwS,EAAQwwC,UAA0BxwC,EAAQwwC,UAAY,GAAI,EAAwBhjD,SAArBwS,EAAQywC,SAAyBzwC,EAAQywC,SAAW,KACzLiB,EAAW3jD,MAAMoL,GAAGw4C,iBAAiBv0C,GACrCk0C,SAAUQ,EACVz+C,SAAUk+C,EAAYC,UAAUC,QAChC1J,MAAOqJ,EACPtV,SAAUkX,EACVtC,OAAQ1wC,EAAQ2wC,QAAUljD,EAAa0L,GAAGuF,UAAUszC,QAAQE,cAE5DN,EAAW7jD,MAAMoL,GAAGy3C,kBAAkBxzC,GACtC/J,SAAU,UACV00C,MAAOqJ,EACPtV,SAAUkX,EACVtC,OAAQjjD,EAAa0L,GAAGuF,UAAUszC,QAAQqB,aAC1CxgD,KAAM,EACNC,GAAI,GAER,OAAO/E,OAAML,QAAQsB,MAAM0iD,EAAUE,IAjhBzClzC,EAAUszC,SAINC,WAAY,2CAIZsB,YAAa,2CAIbC,YAAa,2CAIbP,YAAa,2CAIbQ,WAAY,2CAIZC,WAAY,2CAIZC,WAAY,2CAIZC,WAAY,4CAIZ1B,YAAa,2CAIb2B,aAAc,2CAIdC,aAAc,2CAIdT,aAAc,2CAIdU,YAAa,2CAIbC,YAAa,2CAIbC,YAAa,2CAIbC,YAAa,2CAIbC,cAAe,2CAIfC,eAAgB,2CAIhBC,eAAgB,2CAIhBC,eAAgB,2CAIhBC,cAAe,2CAIfC,cAAe,2CAIfC,cAAe,2CAIfC,cAAe,4CAEnB,IAAInD,GAAcxjD,MAAMiM,UAAU26C,2BAA8BnD,WAAaC,QAAS,aAwBtF/yC,GAAU4xC,QAAUA,EAiBpB5xC,EAAUqoC,OAASA,EA+BnBroC,EAAUyyC,SAAWA,EA4BrBzyC,EAAU8L,UAAYA,EA4CtB9L,EAAU0zC,gBAAkBA,EAU5B1zC,EAAU2zC,aAAeA,EAUzB3zC,EAAU4zC,cAAgBA,EAU1B5zC,EAAU6zC,eAAiBA,EAU3B7zC,EAAU8zC,cAAgBA,EAU1B9zC,EAAU+zC,WAAaA,EAUvB/zC,EAAUg0C,YAAcA,EAUxBh0C,EAAUi0C,aAAeA,EA8BzBj0C,EAAUk0C,YAAcA,EA4BxBl0C,EAAUm0C,aAAeA,EAiCzBn0C,EAAUo0C,SAAWA,EAiCrBp0C,EAAUw0C,WAAaA,EA6BvBx0C,EAAUy0C,cAAgBA,EAiC1Bz0C,EAAU00C,YAAcA,EAiCxB10C,EAAU40C,UAAYA,GACvB50C,EAAYvF,EAAGuF,YAAcvF,EAAGuF,gBACpCvF,EAAK1L,EAAa0L,KAAO1L,EAAa0L,SAC1C1L,eAAiBA;CCniBpB,WACI,YACA,IAAImnD,IACAC,WACIC,UAAW,2JACXC,IAAK,gSAETC,kBACIF,UAAW,4RACXC,IAAK,qWAETE,OACIH,UAAW,8FACXC,IAAK,kMAIbhnD,OAAMsjB,UAAUlB,OAAO,mBACnB+kC,cAAennD,MAAMoZ,MAAMC,IAAIrZ,MAAMoZ,MAAMgJ,OAAO,SAAczf,EAASsP,GACrEzU,KAAKmF,QAAUA,GAAWK,SAAS4W,cAAc,OACjD3H,EAAUA,MACVzU,KAAKmF,QAAQ8E,WAAajK,KAC1BA,KAAK4pD,UACD7lB,OAAS8lB,MAAO,IAAKC,OAAQ,KAC7B1E,QAAUyE,MAAOE,KAAKC,QAASF,OAAQC,KAAKE,SAGhDjqD,KAAKmF,QAAQyF,UAAU+I,IAAI,qBAC3B3T,KAAKmF,QAAQyF,UAAU+I,IAAI,kBAC3BnR,MAAMoL,GAAG0N,WAAWtb,KAAMyU,KAE1BsW,MACIzd,IAAK,WACD,MAAOtN,MAAKkqD,OAEhB38C,IAAK,SAAUnM,GACXpB,KAAKkqD,MAAQ9oD,EACbpB,KAAKyL,WAIbA,OAAQ,WACJ,GAAI0C,GAAOnO,IACXA,MAAKmF,QAAQyF,UAAU+I,IAAI,qBAAuBxF,EAAK4c,KACvD,IAAIo/B,IAAiB,CAkBrB,IAjBKh8C,EAAKi8C,iBACNj8C,EAAKi8C,eAAiB5kD,SAAS4W,cAAc,OAC7CjO,EAAKi8C,eAAez/C,UAAY,4BAChCzI,aAAagC,MAAMgG,WAAWiE,EAAKhJ,QAASgJ,EAAKi8C,gBACjDD,GAAiB,GAGhBh8C,EAAKk8C,YACNl8C,EAAKk8C,UAAY7kD,SAAS4W,cAAc,OACxCjO,EAAKk8C,UAAU1/C,UAAY,uBAC3BwD,EAAKhJ,QAAQoF,YAAY4D,EAAKk8C,YAG9BF,GACAh8C,EAAKhJ,QAAQoF,YAAY4D,EAAKi8C,iBAG7Bj8C,EAAKi8C,eAAgB,CAGtB,IAFAj8C,EAAKi8C,eAAiB5kD,SAAS4W,cAAc,OAC7CjO,EAAKi8C,eAAez/C,UAAY,4BACzBwD,EAAKhJ,QAAQ4N,SAASzS,OAAS,GAClC6N,EAAKi8C,eAAe7/C,YAAY4D,EAAKhJ,QAAQ4N,SAAS,GAE1D5E,GAAKhJ,QAAQoF,YAAY4D,EAAKi8C,gBAGlCj8C,EAAKm8C,YAAcjB,EAAmBrpD,KAAK+qB,MACvC5c,EAAKm8C,cACLn8C,EAAKk8C,UAAUztC,UAAYzO,EAAKm8C,YAAYd,IAC5Cr7C,EAAKo8C,KAAOC,KAAKr8C,EAAKk8C,UAAU/7C,cAAc,QAC9CH,EAAKs8C,OAASt8C,EAAKo8C,KAAKn8C,OAAO,QAC/BD,EAAKu8C,OACDb,MAAO17C,EAAKs8C,OAAO5tC,KAAK,KACxBitC,OAAQ37C,EAAKm8C,YAAYf,WAEzBp7C,EAAKgB,cACLhB,EAAKgB,aAAawH,UACtBxI,EAAKgB,aAAe,GAAIjN,cAAa0L,GAAGuL,aACxChL,EAAKgB,aAAaC,SAASjB,EAAKhJ,QAAS,cAAe,SAAU4K,GAAO5B,EAAKw8C,QAAQ56C,KACtF5B,EAAKgB,aAAaC,SAASjB,EAAKhJ,QAAS,YAAa,SAAU4K,GAAO5B,EAAKy8C,MAAM76C,KAClF5B,EAAKgB,aAAaC,SAASjB,EAAKhJ,QAAS,eAAgB,SAAU4K,GAAO5B,EAAKy8C,MAAM76C,OAI7F46C,QAAS,SAAU56C,GACf/P,KAAKmF,QAAQyF,UAAU+I,IAAI,WAC3B3T,KAAKyqD,OAAO5lC,OAAOs4B,SAAUxqC,KAAQ3S,KAAK0qD,MAAMZ,QAAU9pD,KAAK4pD,SAAS7lB,MAAM+lB,OAAQ9pD,KAAK4pD,SAASxE,OAAO0E,SAG/Gc,MAAO,SAAU76C,GACb/P,KAAKmF,QAAQyF,UAAU4a,OAAO,WAC9BxlB,KAAKyqD,OAAO5lC,OAAOs4B,SAAUxqC,KAAQ3S,KAAK0qD,MAAMb,OAAS7pD,KAAK4pD,SAAS7lB,MAAM8lB,MAAO7pD,KAAK4pD,SAASxE,OAAOyE,QAG7GlzC,QAAS,WACD3W,KAAKmP,cAAcnP,KAAKmP,aAAawH,UACzCnU,MAAMiM,UAAUiX,eAAe1lB,KAAKmF,SACpCnF,KAAKmF,QAAU,QAG7B3C,MAAMiM,UAAUqN,WAChBtZ,MAAMiM,UAAUo8C,sBAAsB;CCxGxC,WACI,YACAroD,OAAMsjB,UAAUlB,OAAO,mBACnBkmC,UAAWtoD,MAAMoZ,MAAMC,IAAIrZ,MAAMoZ,MAAMgJ,OAAO,SAAczf,EAASsP,GACjEzU,KAAKmF,QAAUA,GAAWK,SAAS4W,cAAc,OACjD3H,EAAUA,MACVzU,KAAKmF,QAAQ8E,WAAajK,KAC1BA,KAAKmF,QAAQyF,UAAU+I,IAAI,iBAC3B3T,KAAKmF,QAAQyF,UAAU+I,IAAI,mBAC3B3T,KAAKmF,QAAQyF,UAAU+I,IAAI,kBAC3BnR,MAAMoL,GAAG0N,WAAWtb,KAAMyU,GAC1BzU,KAAKyL,WAELs/C,cACIz9C,IAAK,WACD,MAAOtN,MAAKgrD,eAEhBz9C,IAAK,SAAUnM,GACXpB,KAAKgrD,cAAgB5pD,IAI7BqK,OAAQ,WACJ,GAAI0C,GAAOnO,IACXmO,GAAK88C,UAAY/oD,aAAagC,MAAMqF,MACpC,IAAI6M,GAAO5Q,SAAS4W,cAAc,OAClChG,GAAKzL,UAAY,wBACjByL,EAAK/C,MAAMnC,MAAQ,OACnBkF,EAAK/C,MAAMlC,OAAS,OACpBjP,aAAagC,MAAMgG,WAAWiE,EAAKhJ,QAASiR,GAC5CjI,EAAKhJ,QAAQyX,UAAY,YAAczO,EAAK88C,UAAY,0HAE1B98C,EAAK88C,UAAY,qOAE0F98C,EAAK88C,UAAY,2BAG1J,IAAI5sC,GAAYlQ,EAAKhJ,QAAQmJ,cAAc,aAC3CH,GAAKq7C,IAAMr7C,EAAKhJ,QAAQmJ,cAAc,OACtCH,EAAKkQ,UAAYA,EACjBlQ,EAAK0e,QAAUzW,EACfjI,EAAK+8C,WAAa/8C,EAAKhJ,QAAQmJ,cAAc,UAC7CH,EAAKg9C,YAAcX,KAAKr8C,EAAK+8C,YAC7B7sC,EAAU9T,YAAY6L,IAG1Bg1C,OAAQ,SAAUrP,EAAMxL,EAAU6U,GAC9B,GAAIj3C,GAAOnO,IAGX,OADAmO,GAAKg9C,YAAYtmC,OACZ0rB,GAKLpiC,EAAKg9C,YAAYhO,SAAUkO,aAActP,GAAQxL,EAAU6U,GAAU2E,KAAKuB,aAC1En9C,GAAKxI,cAAc,aALfwI,GAAK+8C,WAAWpuC,aAAa,eAAgBi/B,IAQrDv3B,aAAc,WACNxkB,KAAKqe,YACLre,KAAKqe,UAAUvB,aAAa,QAAS,QACrC9c,KAAKqe,UAAUvB,aAAa,SAAU,UAI9CnG,QAAS,WACLnU,MAAMiM,UAAUiX,eAAe1lB,KAAKmF,SACpCnF,KAAKmF,QAAU,QAGvB3C,MAAMiM,UAAUqN,WAChBtZ,MAAMiM,UAAUo8C,sBAAsB;AC5E9C,GAAI3oD,cAAeA,gBACnBA,cAAa0L,GAAK1L,aAAa0L,OAE/B,WACI,YAEA1L,cAAa0L,GAAG29C,kBAAoB/oD,MAAMoZ,MAAMgJ,OAMhD,SAAUzf,EAASsP,GACfA,EAAUA,MACVzU,KAAK8C,SACL9C,KAAKmF,QAAUA,EACfnF,KAAKwrD,iBAAmB,KACxBxrD,KAAKyrD,WAAa,EAClBzrD,KAAK0rD,aAAc,EACnB1rD,KAAK2rD,iBAAmBl3C,EAAQm3C,iBAAmB,KACnD5rD,KAAK6rD,WAAap3C,EAAQq3C,YAAa,EACvC9rD,KAAK+rD,aAAet3C,EAAQu3C,aAAe,GAC3ChsD,KAAKisD,cAAgBx3C,EAAQy3C,WAAaz3C,EAAQ9J,WAAa8J,EAAQw3C,cACvEjsD,KAAKmsD,aAAejqD,aAAagC,MAAMiH,YAAYsJ,EAAQrJ,UAAYqJ,EAAQ03C,cAC/EnsD,KAAKosD,YAAc33C,EAAQ2Y,SAAW3Y,EAAQ23C,YAC9CpsD,KAAKqsD,cAAgB53C,EAAQ43C,cAC7BrsD,KAAKssD,gBAAkBtsD,KAAKusD,UAAUr+C,KAAKlO,MAEvCmF,IACAA,EAAQwF,UAAYxF,EAAQwF,UAAY,oDAU5CgM,QAAU,WACN,GAAIxI,GAAOnO,IACXkC,cAAa0L,GAAGgJ,SAASzI,EAAKhJ,SAC9B3C,MAAMiM,UAAUiX,eAAevX,EAAKhJ,SACpCgJ,EAAKq+C,0BACLr+C,EAAKw9C,iBAAmB,KACxBx9C,EAAKhJ,QAAU,KACfgJ,EAAKq9C,iBAAmB,KACxBr9C,EAAKs+C,KAAO,KACZt+C,EAAKrL,UAGTwxC,MAAO,WACH,GAAInmC,GAAOnO,IACXwC,OAAMiM,UAAUiX,eAAevX,EAAKhJ,SACpCgJ,EAAKhJ,QAAQyX,UAAY,IAQ7BkvC,WACIx+C,IAAK,WACD,MAAOtN,MAAK6rD,YAEhBt+C,IAAK,SAAUnM,GACXpB,KAAK6rD,WAAazqD,EAClBpB,KAAK0sD,wBASbC,WACIr/C,IAAK,WACD,MAAOtN,MAAKyrD,YAEhBl+C,IAAK,SAAUnM,GACXpB,KAAKyrD,WAAarqD,IAS1BwrD,YACIt/C,IAAK,WACD,MAAOtN,MAAK0rD,aAEhBn+C,IAAK,SAAUnM,GACXpB,KAAK0rD,YAActqD,IAS3B4qD,aACI1+C,IAAK,WACD,MAAOtN,MAAK+rD,cAEhBx+C,IAAK,SAAUnM,GACXpB,KAAK+rD,aAAe3qD,EACpBpB,KAAK0sD,wBASbd,iBACIt+C,IAAK,WACD,MAAOtN,MAAK2rD,kBAEhBp+C,IAAK,SAAUnM,GACXpB,KAAKwsD,0BACLxsD,KAAK2rD,iBAAmBvqD,EACxBpB,KAAK6sD,0BAKbN,UAAW,WACP,GAAIp+C,GAAOnO,IACPmO,GAAKy9C,iBAAmBz9C,EAAKq9C,mBACzBr9C,EAAK2+C,gBACL1M,qBAAqBjyC,EAAK2+C,gBAG9B3+C,EAAK2+C,eAAiBzM,sBAAsB,WACxClyC,EAAK4+C,qBAKjBP,wBAAyB,WACrBxsD,KAAKwrD,iBAAmB,KACxBxrD,KAAKgtD,eACDhtD,KAAK4rD,iBACL5rD,KAAK4rD,gBAAgBp1C,oBAAoB,SAAUxW,KAAKssD,kBAIhEO,sBAAuB,WACnB,GAAI1+C,GAAOnO,IACPmO,GAAKy9C,kBACL5rD,KAAK4rD,gBAAgBv8C,iBAAiB,SAAUrP,KAAKssD,iBAE7B,YAApBn+C,EAAK69C,YACiB,WAAlB79C,EAAK29C,UACL39C,EAAKq9C,iBAAmB,WAAcr9C,EAAK8+C,cAAc9+C,EAAK++C,aACrC,QAAlB/+C,EAAK29C,YACZ39C,EAAKq9C,iBAAmB,WAAcr9C,EAAKg/C,WAAWh/C,EAAK++C,cAGzC,WAAlB/+C,EAAK29C,UACL39C,EAAKq9C,iBAAmB,WAAcr9C,EAAK8+C,cAAc9+C,EAAKi/C,aACrC,QAAlBj/C,EAAK29C,YACZ39C,EAAKq9C,iBAAmB,WAAcr9C,EAAKg/C,WAAWh/C,EAAKi/C,gBAS3EV,oBAAqB,WACjB1sD,KAAKwsD,0BACLxsD,KAAK6sD,wBACL7sD,KAAKgtD,gBAGTE,WAAY,SAAUT,EAAMb,EAAiBe,GACzC,GAAIU,GAAczB,EAAgBp7C,aAAem8C,CACjD,OAAIF,GAAKx7C,GAAK26C,EAAgB/6C,UAAYw8C,GAAeZ,EAAKx7C,GAAK26C,EAAgB/6C,UAAY+6C,EAAgBp7C,aAAe68C,GACnH,EAEPZ,EAAKx7C,EAAIw7C,EAAKt7C,QAAUy6C,EAAgB/6C,UAAYw8C,GAAeZ,EAAKx7C,EAAIw7C,EAAKt7C,QAAUy6C,EAAgB/6C,UAAY+6C,EAAgBp7C,aAAe68C,GAC/I,EAEPZ,EAAKx7C,GAAK26C,EAAgB/6C,UAAYw8C,GAAeZ,EAAKx7C,EAAIw7C,EAAKt7C,QAAUy6C,EAAgB/6C,UAAY+6C,EAAgBp7C,aAAe68C,GACjI,GAEJ,GAGXD,WAAY,SAAUX,EAAMb,EAAiBe,GACzC,GAAIU,GAAczB,EAAgBt7C,aAAeq8C,GAAa,EAC9D,OAAIF,GAAKz7C,GAAK46C,EAAgBl7C,WAAa28C,GAAeZ,EAAKz7C,GAAK46C,EAAgBl7C,WAAak7C,EAAgBt7C,YAAc+8C,GACpH,EAEPZ,EAAKz7C,EAAIy7C,EAAKv7C,OAAS06C,EAAgBl7C,WAAa28C,GAAeZ,EAAKz7C,EAAIy7C,EAAKv7C,OAAS06C,EAAgBl7C,WAAak7C,EAAgBt7C,YAAc+8C,GAC9I,EAEPZ,EAAKz7C,GAAK46C,EAAgBl7C,WAAa28C,GAAeZ,EAAKz7C,EAAIy7C,EAAKv7C,OAAS06C,EAAgBl7C,WAAak7C,EAAgBt7C,YAAc+8C,GACjI,GAEJ,GAMXL,aAAc,WACV,GAAI7+C,GAAOnO,IACNmO,GAAKhJ,UAGVgJ,EAAKs+C,KAAO,KACZt+C,EAAKrL,MAAMxB,QAAQ,SAAU2B,GACzBA,EAAKwpD,KAAO,SAOpBjoC,aAAc,WACV,GAAIrW,GAAOnO,IACNmO,GAAKhJ,SAEVgJ,EAAKu+C,uBAGTO,cAAe,SAAU1xC,EAAOoxC,EAAWW,GACvC,GAAIn/C,GAAOnO,IACX,IAAKmO,EAAKhJ,QAAV,CAYA,GAVAwnD,EAAYA,GAAa,GAEpBx+C,EAAKs+C,MAAQt+C,EAAKrL,OAASqL,EAAKrL,MAAMxC,OACvC6N,EAAKs+C,KAAOvqD,aAAa0L,GAAGsC,WAAW/B,EAAKhJ,QAASgJ,EAAKy9C,kBAE1Dz9C,EAAKs+C,KAAOt+C,EAAKs+C,OAAUz7C,EAAG,EAAGC,EAAG,EAAGC,MAAO,EAAGC,OAAQ,GACzDhD,EAAKs+C,KAAKv7C,MAAQ/C,EAAKhJ,QAAQmL,YAC/BnC,EAAKs+C,KAAKt7C,OAAShD,EAAKhJ,QAAQqL,cAGhC+K,EAAMpN,EAAKs+C,KAAMt+C,EAAKy9C,gBAAiBe,GAAY,CACnD,GAAIW,EACA,OAAO,CAEXn/C,GAAKo/C,qBACDp/C,EAAKq/C,iBACLr/C,EAAKq/C,sBAEFr/C,GAAKy+C,YAAcD,EAAY,GAAKx+C,EAAKrL,OAASqL,EAAKrL,MAAMxC,QAAU6N,EAAKrL,MAAM,GAAG8M,UAC5FzB,EAAKrL,MAAMxB,QAAQ,SAAU2B,GACzBA,EAAKwqD,SAII,IAAbd,GAAkBx+C,EAAKw+C,UAAY,GACnC1sD,aAAa,WACTkO,EAAK8+C,cAAc1xC,EAAOpN,EAAKw+C,eAK3CQ,WAAY,SAAU5xC,EAAOoxC,GACzB,GAAIx+C,GAAOnO,IACX,IAAKmO,EAAKhJ,QAAV,CAEAwnD,EAAYA,GAAa,CACzB,IAAIe,IAAc,CAYdv/C,GAAK8+C,cAAc1xC,EAAOoxC,GAAW,IACrCx+C,EAAKrL,MAAMxB,QAAQ,SAAU2B,GACpBA,EAAKwpD,OACNxpD,EAAKwpD,KAAOvqD,aAAa0L,GAAGsC,WAAWjN,EAAKkC,QAASgJ,EAAKy9C,kBAE9D8B,GAA4BzqD,EAAK2M,UAE5B3M,EAAK2M,UAAY2L,EAAMtY,EAAKwpD,KAAMt+C,EAAKy9C,gBAAiBe,GACzD1pD,EAAKwI,SACExI,EAAK2M,UAAYzB,EAAKy+C,YAAcD,EAAY,IAAMpxC,EAAMtY,EAAKwpD,KAAMt+C,EAAKy9C,gBAAiBe,IACpG1pD,EAAKwqD,UAGbt/C,EAAKu/C,YAAcA,GAEZf,EAAY,GAAKx+C,EAAKrL,MAAMxC,SAAW6N,EAAKrL,MAAM,GAAG8M,UAAYzB,EAAKrL,MAAMqL,EAAKrL,MAAMxC,OAAS,GAAGsP,WAC1GzB,EAAKrL,MAAMxB,QAAQ,SAAU2B,GACpBA,EAAKwpD,OACNxpD,EAAKwpD,KAAOvqD,aAAa0L,GAAGsC,WAAWjN,EAAKkC,QAASgJ,EAAKy9C,kBAE1Dz9C,EAAKy+C,aAAerxC,EAAMtY,EAAKwpD,KAAMt+C,EAAKy9C,gBAAiBe,IAC3D1pD,EAAKwqD,UAMA,GAAbd,GAAkBx+C,EAAKw+C,UAAY,GACnC1sD,aAAa,WACTkO,EAAKg/C,WAAW5xC,EAAOpN,EAAKw+C,eAYxCgB,aAAc,SAAU7qD,EAAO8qD,GAC3B,GAAIz/C,GAAOnO,IACX8C,GAAQA,MACR8qD,EAAgBA,KAChB,IAEIxB,IAFWtpD,EAAMxC,OAEHstD,EAAcxB,aAAej+C,EAAKi+C,YAC1B,iBAAfA,KACPA,EAAclqD,aAAagC,MAAMyH,cAAcwC,EAAKhJ,QAASinD,GACjE,IAAIhhD,GAAWlJ,aAAagC,MAAMiH,YAAYyiD,EAAcxiD,WAAa+C,EAAKg+C,aAC1ExhD,EAAYijD,EAAc3B,eAAiB99C,EAAK89C,cAChD4B,EAAaD,EAAcC,YAAc1/C,EAAK0/C,WAC9CxB,EAAgBuB,EAAcvB,eAAiBl+C,EAAKk+C,cACpDhuC,EAAYlQ,EAAKhJ,QACjB2oD,EAAkB3/C,EAAKrL,KAE3BA,GAAMxB,QAAQ,SAAUysD,GACpB,GAAI9qD,GAAO,GAAIf,cAAa0L,GAAGogD,cAAc7/C,EAAM,MAC/CtI,KAAMkoD,EACN3iD,SAAUA,EACVT,UAAWA,EACXyhD,YAAaA,EACbyB,WAAYA,EACZxB,cAAeA,GAEnByB,GAAgB3qD,KAAKF,GACrBob,EAAU9T,YAAYtH,EAAKkC,YAgB3ByoD,EAAcK,cAAgBjuD,KAAK8rD,YACnC39C,EAAKo/C,sBAQbR,eAAgB,WACZ,GAAI5+C,GAAOnO,IACPmO,GAAKhJ,SAAWgJ,EAAKq9C,kBACrBr9C,EAAKq9C,oBAMb+B,mBAAoB,WAChB,GAAIp/C,GAAOnO,IACNmO,GAAKhJ,UAGVgJ,EAAKrL,MAAMxB,QAAQ,SAAU2B,GACpBA,EAAK2M,UAEN3M,EAAKwI,WAIb0C,EAAKu/C,aAAc,MAI3BxrD,aAAa0L,GAAGogD,cAAgBxrD,MAAMoZ,MAAMgJ,OAK5C,SAAUspC,EAAU/oD,EAASsP,GACzBA,EAAUA,KACV,IAAIxR,GAAOjD,IACXiD,GAAKirD,SAAWA,EAChBjrD,EAAKkC,QAAUA,GAAWK,SAAS4W,cAAc,OACjDnZ,EAAKkC,QAAQwF,UAAY1H,EAAKkC,QAAQwF,UAAY,IAAM8J,EAAQ9J,UAAY,8CAC5E1H,EAAKkC,QAAQ8E,WAAahH,EAE1BA,EAAKmpD,YAAc33C,EAAQ23C,YAC3BnpD,EAAKkrD,gBAAkB3rD,MAAML,QAAQS,GAAG6R,EAAQ5O,MAEhD5C,EAAKkpD,aAAe13C,EAAQrJ,SAC5BnI,EAAK2M,UAAW,EAChB3M,EAAKopD,cAAgB53C,EAAQ43C,cACzB53C,EAAQo5C,YACRp5C,EAAQo5C,WAAW7tD,QAOvB2W,QAAS,WACL,GAAI1T,GAAOjD,IACXiD,GAAKirD,SAAW,KAChBjrD,EAAKkC,QAAU,KACflC,EAAKmpD,YAAc,KACnBnpD,EAAKmrD,SAAW,KAChBnrD,EAAKkrD,gBAAkB,KACvBlrD,EAAKkpD,aAAe,KACpBlpD,EAAKopD,cAAgB,MAMzB5gD,OAAQ,SAAU4iD,GACd,GAAIlgD,GAAOnO,IAEX,OAAImO,GAAKhJ,SAAWgJ,EAAKg+C,eAAiBh+C,EAAKyB,UAE3CzB,EAAKyB,UAAW,EACTzB,EAAKmgD,kBAGT9rD,MAAML,QAAQM,KAAK0L,EAAKi8C,iBAMnCqD,MAAO,WACH,GAAIt/C,GAAOnO,IACPmO,GAAKhJ,SAAWgJ,EAAKyB,WACrB1N,aAAa0L,GAAGgJ,SAASzI,EAAKhJ,SAC9BgJ,EAAKhJ,QAAQyF,UAAU4a,OAAO,UAC9BrX,EAAKhJ,QAAQyX,UAAY,GACzBzO,EAAKyB,UAAW,IAIxB2+C,mBAAoB,SAAU3+C,GAC1B,GAAIzB,GAAOnO,IACX,IAAKmO,EAAKhJ,QAgCV,MA7BAgJ,GAAKhJ,QAAQoF,YAAYqF,GAErBzB,EAAKi+C,cAC0B,gBAApBj+C,GAAKi+C,cACZj+C,EAAKi+C,YAAclqD,aAAagC,MAAMyH,cAAcwC,EAAKhJ,QAASgJ,EAAKi+C,cAEvEj+C,EAAKi+C,aACLlqD,aAAa0L,GAAGiC,IAAI1B,EAAKhJ,QAAS,SAAU4K,GACxC5B,EAAKi+C,YAAYj+C,MAKzBA,EAAKk+C,cACLl+C,EAAKk+C,cAAcl+C,EAAKigD,SAAUx+C,GAE7BzB,EAAK+/C,SAAS7B,eACnBl+C,EAAK+/C,SAAS7B,cAAcl+C,EAAKigD,SAAUx+C,GAG/C3P,aAAa,WACLkO,EAAKhJ,UACLgJ,EAAKhJ,QAAQyF,UAAU4a,OAAO,YAC9BrX,EAAKhJ,QAAQyF,UAAU+I,IAAI,aAInCxF,EAAKyB,UAAW,EAChBzB,EAAKi8C,eAAiBx6C,EACfA,GAGX0+C,eAAgB,WACZ,GAAIngD,GAAOnO,IAEX,OAAImO,GAAKhJ,SAAWgJ,EAAKg+C,aACdh+C,EAAKggD,gBAAgBtrD,KAAK,SAAUgD,GAEvC,MADAsI,GAAKigD,SAAWvoD,EACTsI,EAAKg+C,aAAa1gD,OAAO5F,GAAMhD,KAAK,SAAU+M,GACjDzB,EAAKogD,mBAAmB3+C,OAK7BpN,MAAML,QAAQM;CCvgBjC,WAEC,YAsBAD,OAAMsjB,UAAUlB,OAAO,mBACtB4pC,YAAahsD,MAAMoZ,MAAMgJ,OAQf,SAAqBzf,EAASsP,GAC7B,GAAIg6C,GAAOzuD,IACXyU,GAAUA,MACVg6C,EAAKtpD,QAAUA,EAEfspD,EAAKtpD,QAAQwF,UAAY8jD,EAAKtpD,QAAQwF,UAAY,gDAClD8jD,EAAKtpD,QAAQ8E,WAAawkD,EAQ1BA,EAAKP,SAAW,GAAIhsD,cAAa0L,GAAG29C,kBAAkBkD,EAAKtpD,SAC1D2mD,UAAWr3C,EAAQq3C,UACnBG,cAAex3C,EAAQw3C,cACvBE,aAAc13C,EAAQ03C,aACtBC,YAAa33C,EAAQ23C,cAItBqC,EAAKC,QAAUj6C,EAAQi6C,QAOvBD,EAAKE,eACJ1wC,OAAQxJ,EAAQwJ,QAAU,OAC1B2wC,eAAiBn6C,EAAsB,eAAIA,EAAQm6C,eAAiB3sD,OACpE4sD,YAAcp6C,EAAmB,YAAIA,EAAQo6C,YAAc5sD,OAC3D6sD,UAAYr6C,EAAiB,UAAIA,EAAQq6C,UAAY,GACrDC,UAAYt6C,EAAiB,UAAIA,EAAQs6C,UAAY9sD,OACrD+sD,WAAav6C,EAAkB,WAAIA,EAAQu6C,WAAa/sD,QAQzDwsD,EAAKQ,WAAax6C,EAAQw6C,aAAc,CAExC,IAAIjoD,GAAS9E,aAAagC,MAAM6G,gBAAgB0jD,EAAKtpD,QACjD6B,IAAUA,EAAO+W,cACpB/W,EAAO+W,cAAcC,MAAMC,OAAOc,OAAO,WACpC0vC,EAAKQ,YACRR,EAAKxwC,WAICjX,GAAUA,EAAO0c,cACzB1c,EAAO0c,aAAa7gB,KAAK,WACxBmE,EAAOid,cAAcphB,KAAK,WACrB4rD,EAAKQ,YACRR,EAAKxwC,eAeT2tC,iBACCt+C,IAAK,WACJ,MAAOtN,MAAKkuD,SAAStC,iBAEtBr+C,IAAK,SAAUnM,GACdpB,KAAKkuD,SAAStC,gBAAkBxqD,IASlC6tD,YACC3hD,IAAK,WACJ,MAAOtN,MAAKkvD,aAEb3hD,IAAK,SAAUnM,GACdpB,KAAKkvD,YAAc9tD,IASrBstD,SACCphD,IAAK,WACJ,MAAOtN,MAAKmvD,aAEb5hD,IAAK,SAAUnM,GACdpB,KAAKmvD,YAAc/tD,IASrB0qD,WACCx+C,IAAK,WACJ,MAAOtN,MAAKkuD,SAASpC,WAEtBv+C,IAAK,SAAUnM,GACdpB,KAAKkuD,SAASpC,UAAY1qD,IAS5BgrD,aACC9+C,IAAK,WACJ,MAAOtN,MAAKkuD,SAAS9B,aAEtB7+C,IAAK,SAAUnM,GACdpB,KAAKkuD,SAAS9B,YAAchrD,IAS9B+qD,cACC7+C,IAAK,WACJ,MAAOtN,MAAKkuD,SAAS/B,cAEtB5+C,IAAK,SAAUnM,GACdpB,KAAKkuD,SAAS/B,aAAe/qD,IAS/B6qD,eACC3+C,IAAK,WACJ,MAAOtN,MAAKkuD,SAASjC,eAEtB1+C,IAAK,SAAUnM,GACdpB,KAAKkuD,SAASjC,cAAgB7qD,IAShC0B,OACCwK,IAAK,aAGLC,IAAK,SAAUnM,GACnBA,GAAOA,EAAId,QACLN,KAAK2tD,aAAavsD,KASrBusD,aAAc,SAAU7qD,EAAO8qD,GACxB,GAAK5tD,KAAKmF,QAAV,CAGN,GAAI6B,GAAS9E,aAAagC,MAAMwG,wBAAwB,kBAAmB1K,KAAKmF,UAE3EnF,KAAKkuD,SAASpC,WAAa9kD,GAAUA,EAAO8kD,YAChD9rD,KAAKkuD,SAASpC,UAAY9kD,EAAO8kD,WAGlC9rD,KAAKkuD,SAASP,aAAa7qD,EAAO8qD,KAMnCL,mBAAoB,WACdvtD,KAAKkuD,UAEJluD,KAAKkuD,SAASX,sBAGrB6B,aAAc,SAAU9kD,EAAK+kD,GAC5B,GAAIh8C,GAAQ/I,EAAI+I,KACZg8C,IAAUh8C,EAAMC,WAAUD,EAAMC,SAAW,KAC1C+7C,GAAUh8C,EAAMmJ,UAASnJ,EAAMmJ,QAAU,IAC1CnJ,EAAMnC,QAAOmC,EAAMnC,MAAQ,IAC3BmC,EAAMlC,SAAQkC,EAAMlC,OAAS,IAC7BkC,EAAMi8C,WAAUj8C,EAAMi8C,SAAW,IACjCj8C,EAAMk8C,YAAWl8C,EAAMk8C,UAAY,IACnCl8C,EAAMm8C,OAAMn8C,EAAMm8C,KAAO,IACzBn8C,EAAMo8C,MAAKp8C,EAAMo8C,IAAM,KAG5BC,aAAc,WACb,GAAIvhD,GAAOnO,IACXmO,GAAK+/C,SAAS5Z,SAMfqb,YAAa,WACZ,GAAIxhD,GAAOnO,IAGX,IADAmO,EAAKihD,aAAajhD,EAAKhJ,SAAS,GAC5BgJ,EAAKhJ,QAAQ4N,SAASzS,OACzB,IAAK,GAAI8C,GAAI,EAAGC,EAAI8K,EAAKhJ,QAAQ4N,SAASzS,OAAY+C,EAAJD,EAAOA,IACxD+K,EAAKihD,aAAajhD,EAAKhJ,QAAQ4N,SAAS3P,IAAI,IAK/CwsD,KAAM,SAAUC,EAAQ7+C,EAAGC,EAAGZ,EAAGE,GAChC,GAAIs/C,EAAOvvD,OAAS0Q,EAAIX,EACvB,IAAK,GAAIjN,GAAIysD,EAAOvvD,OAAa0Q,EAAIX,EAARjN,EAAYA,IACxCysD,EAAO1sD,QAIT,KAAK,GAAIC,GAAI4N,EAAQA,EAAIX,EAARjN,EAAYA,IAAK,CACjC,GAAI0sD,GAAMD,EAAOzsD,EACjB,IAAI0sD,EAAIxvD,OAAS2Q,EAAIV,EACpB,IAAK,GAAI5L,GAAImrD,EAAIxvD,OAAa2Q,EAAIV,EAAR5L,EAAYA,IACrCmrD,EAAI3sD,MAAK,EAIX,KAAK,GAAIwB,GAAIsM,EAAQA,EAAIV,EAAR5L,EAAYA,IAC5BmrD,EAAInrD,IAAK,IAKZorD,IAAK,SAAUF,EAAQ7+C,EAAGC,EAAGZ,EAAGE,EAAGy/C,EAAMC,GAExC,GAAIA,GAAQ1/C,EAAI0/C,GAAc,IAANh/C,EACvB,OAAO,CACR,IAAI++C,GAAQ3/C,EAAI2/C,GAAc,IAANh/C,EACvB,OAAO,CAGR,IAAIg/C,GAASh/C,EAAIX,EAAK2/C,EACrB,OAAO,CACR,IAAIC,GAASh/C,EAAIV,EAAK0/C,EACrB,OAAO,CAER,KAAK,GAAI7sD,GAAI4N,EAAQA,EAAIX,EAARjN,EAAYA,IAAK,CACjC,GAAI0sD,GAAMD,EAAOzsD,EACjB,IAAI0sD,EACH,IAAK,GAAInrD,GAAIsM,EAAQA,EAAIV,EAAR5L,EAAYA,IAC5B,GAAImrD,EAAInrD,MAAO,EACd,OAAO,EAKX,OAAO,GAGRurD,SAAU,SAAUL,EAAQx/C,EAAGE,EAAG0/C,EAAME,GAEvC,IAAK,GADDhiD,GAAOnO,KACFoD,EAAI,EAAQ+sD,EAAWF,EAAO,EAAtB7sD,EAA0BA,IAAK,CAC/C,GAAI0sD,GAAMD,EAAOzsD,EACjB,KAAI0sD,EAQH,OAAS9+C,EAAG5N,EAAG6N,EAAG,EAPlB,KAAK,GAAItM,GAAI,EAAQsrD,EAAJtrD,EAAWA,IAC3B,GAAImrD,EAAInrD,MAAO,GAAQwJ,EAAK4hD,IAAIF,EAAQzsD,EAAGuB,EAAG0L,EAAGE,EAAGtO,OAAWguD,GAC9D,OAASj/C,EAAG5N,EAAG6N,EAAGtM,GAStB,MAAO1C,SAGRmuD,cAAe,WAId,IAAK,GAHDjiD,GAAOnO,KACP0L,KAEKtI,EAAI,EAAGC,EAAI8K,EAAKhJ,QAAQ4N,SAASzS,OAAY+C,EAAJD,EAAQA,IAAK,CAC9D,GAAIH,GAAOkL,EAAKhJ,QAAQ4N,SAAS3P,GAC7B4Z,EAAKxO,OAAOsR,iBAAiB7c,EACf,SAAd+Z,EAAGR,SAAsC,UAAjBQ,EAAGP,YAC9B/Q,EAAIvI,KAAKF,GAIX,MAAOyI,IAMR2kD,iBACCC,KAAM,aAGNC,eAAgB,WACf,GAAIpiD,GAAOnO,IACXmO,GAAK+/C,SAASlC,YAAc,aAC5B79C,EAAKhJ,QAAQkO,MAAMC,SAAW,WAC9BnF,EAAKhJ,QAAQkO,MAAMmJ,QAAU,OAC7BrO,EAAKhJ,QAAQkO,MAAMm9C,SAAW,cAC9BriD,EAAKhJ,QAAQkO,MAAMo9C,aAAe,aAG9BtiD,EAAKhJ,QAAQkO,MAAMnC,QACtB/C,EAAKhJ,QAAQkO,MAAMnC,MAAQ,IAE5B/C,EAAKhJ,QAAQkO,MAAMlC,OAAS,GAG3BhD,EAAKhJ,QAAQkO,MAAMlC,OADhBhD,EAAKhJ,QAAQqL,aACYrC,EAAKhJ,QAAQqL,aAAe,KAE5B,EAE7B,IAAIkgD,GAAkBlpD,KAAKoC,MAAMuE,EAAKhJ,QAAQqL,cAAgBrC,EAAKtI,KAAKmpD,WAAa7gD,EAAKtI,KAAKipD,WAC/F,IAAI4B,EAAiB,CACpB,GAAIC,GAAexiD,EAAKiiD,gBACpBQ,EAAUppD,KAAKqpD,KAAKF,EAAarwD,OAASowD,EAC9CviD,GAAKhJ,QAAQkO,MAAMi8C,UAAanhD,EAAKtI,KAAKkpD,UAAY5gD,EAAKtI,KAAKipD,WAAa8B,EAAW,OAI1FE,aAAc,WACV,GAAI3iD,GAAOnO,IACLmO,GAAK+/C,SAASlC,YAAc,WACrC79C,EAAKhJ,QAAQkO,MAAMC,SAAW,WAC9BnF,EAAKhJ,QAAQkO,MAAMmJ,QAAU,OAC7BrO,EAAKhJ,QAAQkO,MAAMm9C,SAAW,WAC9BriD,EAAKhJ,QAAQkO,MAAMo9C,aAAe,aAElCtiD,EAAKhJ,QAAQkO,MAAMnC,MAAQ,GAE1B/C,EAAKhJ,QAAQkO,MAAMnC,MADhB/C,EAAKhJ,QAAQmL,YACWnC,EAAKhJ,QAAQmL,YAAc,KAE3B,GAExBnC,EAAKhJ,QAAQkO,MAAMlC,SACtBhD,EAAKhJ,QAAQkO,MAAMlC,OAAS,KAG9B4/C,MAAO,WACN,GAAI5iD,GAAOnO,IACXmO,GAAK+/C,SAASlC,YAAc,aAC5B79C,EAAKhJ,QAAQkO,MAAMC,SAAW,WAC9BnF,EAAKhJ,QAAQkO,MAAMlC,OAAS,EAC5B,IAAI6/C,GAAc7iD,EAAKhJ,QAAQqL,YAC/B,IAAKwgD,EAAL,CAGA,GAAIC,GAAQ9iD,EAAKtI,KAAKkpD,UAClBmC,EAAQ/iD,EAAKtI,KAAKipD,UAClBqC,EAAW,EACXC,EAAY,EACZC,EAAY,EAEZjnD,EAAS+D,EAAKiiD,eAClBhmD,GAAO9I,QAAQ,SAAUgJ,GACE,YAAtBA,EAAI+I,MAAMC,WACbhJ,EAAI+I,MAAMC,SAAW,WACtB,IAAIg+C,GAAOhnD,EAAIkG,YACX6gD,GAAYC,EAAON,IACtBG,IACAC,EAAYA,EAAYF,EAAQD,EAChCI,EAAY,GAGT/mD,EAAI+I,MAAMm8C,MAAQ4B,EAAY,OACjC9mD,EAAI+I,MAAMm8C,KAAO4B,EAAY,MAC1B9mD,EAAI+I,MAAMo8C,KAAO4B,EAAY,OAChC/mD,EAAI+I,MAAMo8C,IAAM4B,EAAY,MAE7BA,GAAaC,IAGdF,GAAwBH,EACpB9iD,EAAKhJ,QAAQkO,MAAMnC,OAASkgD,EAAY,OAC3CjjD,EAAKhJ,QAAQkO,MAAMnC,MAAQkgD,EAAY,QAGzC7T,WAAY,WACX,GAAIpvC,GAAOnO,IACXmO,GAAK+/C,SAASlC,YAAc,aAC5B79C,EAAKhJ,QAAQkO,MAAMC,SAAW,WAC9BnF,EAAKhJ,QAAQkO,MAAMlC,OAAS,EAC5B,IAAI6/C,GAAc7iD,EAAKhJ,QAAQqL,YAC/B,IAAKwgD,EAAL,CAGA,GAAIN,GAAkBlpD,KAAKoC,MAAMonD,GAAe7iD,EAAKtI,KAAKmpD,WAAa7gD,EAAKtI,KAAKipD,WAC1D,IAAnB4B,IACHA,EAAkB,EAEnB,IAAIO,GAAQ9iD,EAAKtI,KAAKkpD,UAClBwC,EAAQpjD,EAAKtI,KAAKmpD,WAClBkC,EAAQ/iD,EAAKtI,KAAKipD,UAElB0C,EAAS,EACTC,EAAS,CAETtjD,GAAKtI,KAAK+oD,iBACb8B,EAAkBviD,EAAKtI,KAAK+oD,eAC5B2C,GAAUP,GAAgBN,EAAkB,GAAKQ,GAAUR,GAAoB,EAC/EO,EAAS9iD,EAAKtI,KAAKkpD,UAAYwC,EAAQpjD,EAAKtI,KAAKmpD,YAAe,EAChEwC,EAASP,EAAQ9iD,EAAKtI,KAAKkpD,UAC3B0C,EAASF,EAAQpjD,EAAKtI,KAAKmpD,WAG5B,IAAI0C,QACAtnD,EAAS+D,EAAKiiD,eAClBhmD,GAAO9I,QAAQ,SAAUgJ,GACxBA,EAAI+I,MAAMC,SAAW,UACrB,IAAIq+C,GAAOrnD,EAAIsnD,YAAcJ,EACzBF,EAAOhnD,EAAIunD,aAAeJ,EAC1BK,EAAcH,EAAOV,GAAU,EAC/Bc,EAAWT,EAAOC,GAAU,EAE5BS,EAAM7jD,EAAK+hD,SAASwB,EAAiBI,EAAYC,EAASrB,EAAiBviD,EAAKhJ,QAAQ4N,SAASzS,OAChG0xD,KACJA,GAAQhhD,EAAG,EAAGC,EAAG,IAClB9C,EAAKyhD,KAAK8B,EAAiBM,EAAIhhD,EAAGghD,EAAI/gD,EAAG6gD,EAAYC,EAErD,IAAIvC,GAAOwC,EAAIhhD,GAAKigD,EAAQC,GACxBzB,EAAMuC,EAAI/gD,GAAKsgD,EAAQL,GACvB7gD,EAAKyhD,EAAab,GAAUa,EAAa,GAAKZ,EAC9C3gD,EAAKwhD,EAAUR,GAAUQ,EAAU,GAAKb,CAC5C5mD,GAAI+I,MAAMm8C,KAAOA,EAAO,KACxBllD,EAAI+I,MAAMo8C,IAAMA,EAAM,KACtBnlD,EAAI+I,MAAMnC,MAAQb,EAAI,KACtB/F,EAAI+I,MAAMlC,OAASZ,EAAI,MAGxB,IAAI0hD,GAAeP,EAAgBpxD,QAAU2wD,EAAQC,EACrD/iD,GAAKhJ,QAAQkO,MAAMnC,MAAQ+gD,EAAe,OAG3CC,SAAU,SAAUC,GACnB,GAAIhkD,GAAOnO,IACXmO,GAAK+/C,SAASlC,YAAc,WAC5B79C,EAAKhJ,QAAQkO,MAAMnC,MAAQ,GAC3B/C,EAAKhJ,QAAQkO,MAAMC,SAAW,UAE9B,IAAI8+C,GAAcjkD,EAAKhJ,QAAQmL,WAC/B,IAAK8hD,EAAL,CAGA,GAAIC,GAAgB7qD,KAAKoC,MAAMwoD,GAAejkD,EAAKtI,KAAKkpD,UAAY5gD,EAAKtI,KAAKipD,WACzD,IAAjBuD,IACHA,EAAgB,EAEjB,IAAIpB,GAAQ9iD,EAAKtI,KAAKkpD,UAClBwC,EAAQpjD,EAAKtI,KAAKmpD,WAClBkC,EAAQ/iD,EAAKtI,KAAKipD,UAElB0C,EAAS,EACTC,EAAS,CAETtjD,GAAKtI,KAAKgpD,cACbwD,EAAgBlkD,EAAKtI,KAAKgpD,YAC1BoC,GAAUmB,GAAgBC,EAAgB,GAAKnB,GAAUmB,GAAkB,EAC3Ed,EAASpjD,EAAKtI,KAAKmpD,WAAaiC,EAAQ9iD,EAAKtI,KAAKkpD,WAAc,EAChEyC,EAASP,EAAQ9iD,EAAKtI,KAAKkpD,UAC3B0C,EAASF,EAAQpjD,EAAKtI,KAAKmpD,WAG5B,IAAI0C,QACAtnD,EAAS+D,EAAKiiD,eAClBhmD,GAAO9I,QAAQ,SAAUgJ,GACxBA,EAAI+I,MAAMC,SAAW,UAErB,IAAIq+C,GAAOrnD,EAAIsnD,YAAcJ,EACzBF,EAAOhnD,EAAIunD,aAAeJ,EAC1BK,EAAcH,EAAOV,GAAU,EAC/Bc,EAAWT,EAAOC,GAAU,EAE5BS,EAAM7jD,EAAK+hD,SAASwB,EAAiBK,EAASD,EAAYO,EAAelkD,EAAKhJ,QAAQ4N,SAASzS,OAInG6N,GAAKyhD,KAAK8B,EAAiBM,EAAIhhD,EAAGghD,EAAI/gD,EAAG8gD,EAASD,EAElD,IAAItC,GAAOwC,EAAI/gD,GAAKggD,EAAQC,GACxBzB,EAAMuC,EAAIhhD,GAAKugD,EAAQL,EAC3B5mD,GAAI+I,MAAMm8C,KAAOA,EAAO,KACxBllD,EAAI+I,MAAMo8C,IAAMA,EAAM,KACtBnlD,EAAI+I,MAAMnC,MAAS4gD,EAAab,GAAUa,EAAa,GAAKZ,EAAU,KACtE5mD,EAAI+I,MAAMlC,OAAU4gD,EAAUR,GAAUQ,EAAU,GAAKb,EAAU,MAIlE,IAAIoB,GAAgBZ,EAAgBpxD,QAAUixD,EAAQL,EACtD/iD,GAAKhJ,QAAQkO,MAAMlC,OAASmhD,EAAgB,QAO9Cr0C,OAAQ,WACJ,GAAI9P,GAAOnO,IACX,IAAKmO,EAAKhJ,QAAV,CAEH,GAAIotD,GAAYpkD,EAAKtI,IAGrB,IAFAsI,EAAKtI,KAAOsI,EAAKqkD,YAEbrkD,EAAKtI,KAAM,CASd,GALAsI,EAAKtI,KAAKipD,UAAoC7sD,QAAvBkM,EAAKtI,KAAKipD,UAAyB3gD,EAAKtI,KAAKipD,UAA6C7sD,QAAhCkM,EAAKwgD,cAAcG,UAAyB3gD,EAAKwgD,cAAcG,UAAY,GAC5J3gD,EAAKtI,KAAKkpD,UAAY5gD,EAAKtI,KAAKkpD,WAAa5gD,EAAKwgD,cAAcI,WAAa,EAC7E5gD,EAAKtI,KAAKmpD,WAAa7gD,EAAKtI,KAAKmpD,YAAc7gD,EAAKwgD,cAAcK,YAAc,IAG3E7gD,EAAKtI,KAAKkpD,YAAc5gD,EAAKtI,KAAKmpD,aAC/B7gD,EAAKhJ,SAAWgJ,EAAKhJ,QAAQkF,YAAc8D,EAAKhJ,QAAQ4N,SAASzS,OAAS,EAAG,CACnF,GAAI8J,GAAS+D,EAAKiiD,eAClB,IAAIhmD,GAAUA,EAAO9J,OAAQ,CAC5B,GAAIo8B,GAAatyB,EAAO,GACpBiG,EAAIqsB,EAAWpsB,YACfC,EAAImsB,EAAWlsB,aACfnN,EAAI+G,EAAO9J,MACX+C,GAAI,KAAIA,EAAI,GAChB,KAAK,GAAID,GAAI,EAAGC,EAAI+G,EAAO9J,OAAY+C,EAAJD,EAAQA,IAAK,CAC/C,GAAIH,GAAOmH,EAAOhH,IACT,GAALiN,GAAUpN,EAAKqN,YAAcD,KAChCA,EAAIpN,EAAKqN,cAED,GAALC,GAAUtN,EAAKuN,aAAeD,KACjCA,EAAItN,EAAKuN,cAGXrC,EAAKtI,KAAKkpD,UAAY1+C,EACtBlC,EAAKtI,KAAKmpD,WAAaz+C,GAK1B,GAAIkiD,IAAiBF,GAAapkD,EAAKtI,KAAKoY,SAAWs0C,EAAUt0C,MACjE,IAAI9P,EAAKtI,KAAKoY,OAAQ,CACrB,GAAIy0C,GAAavkD,EAAKkiD,gBAAgBliD,EAAKtI,KAAKoY,OAAO7V,cACnDsqD,KACCD,GACHtkD,EAAKwkD,eAEND,EAAWxkD,KAAKC,GAAMskD,GACtBtkD,EAAKtI,KAAK+sD,SAAU,GAGtBzkD,EAAK+/C,SAASnB,oBAIhB4F,aAAc,WACb,GAAIxkD,GAAOnO,IACXmO,GAAKwhD,cACLxhD,EAAK+/C,SAAS1pC,gBAMfA,aAAc,SAAUrf,EAASi4C,EAAWyV,GACxC,GAAI1kD,GAAOnO,IACNmO,GAAKhJ,SAEbgJ,EAAK8P,UAMNu0C,UAAW,WACV,GAAIrkD,GAAOnO,KACP8yD,EAAiB7wD,MACrB,IAAIkM,EAAKghD,YACR,IAAK,GAAIpjD,KAAQoC,GAAKghD,YAAa,CAClC,GAAIlxC,GAAS9P,EAAKghD,YAAYpjD,EAC9B,IAAIoC,EAAKghD,YAAY/qD,eAAe2H,GACnC,GAAIkS,EAAOtD,MAAO,CACjB,GAAIG,GAAKtM,OAAOuM,WAAWkD,EAAOtD,MAC9BG,GAAGI,UACN43C,EAAiB70C,OAEP60C,KACXA,EAAiB70C,OAGT60C,KACTA,EAAiB70C,GASpB,MAJK60C,KACJA,EAAiB3kD,EAAKwgD,eAGhBhgC,KAAK4P,MAAM5P,KAAKC,UAAUkkC,KAMlCn8C,QAAS,WACR3W,KAAKmF,QAAU,KACfnF,KAAKkuD,SAASv3C,UACVnU,MAAMiM,UAAUiX,gBACnBljB,MAAMiM,UAAUiX,eAAe1lB,KAAKmF,cAK9CjD,aAAa0L,GAAGoV,eACnB9gB,aAAa0L,GAAGoV,cAAcyF,SAAS,WAAYvmB,aAAa0L,GAAG4gD,aAClE5nD,YAAa,YAAa,aAAc,UAAW,cAAe,eAAgB,gBAAiB;ACtqBtG,GAAI1E,cAAeA,gBACnBA,cAAa0L,GAAK1L,aAAa0L,OAG/B1L,aAAa0L,GAAGmlD,YAAc7wD,aAAa0L,GAAGmlD,gBAG9C,SAAWC,EAAIC,GACX,YAEAD,GAAGE,kBAAoB1wD,MAAMoZ,MAAMC,IAAIrZ,MAAMoZ,MAAMgJ,OAkBnD,SAAUnQ,GACNzU,KAAKmzD,YAAc,KACnBnzD,KAAK4O,KAAO,KACZ5O,KAAKozD,kBAAoB,EACzBpzD,KAAKqzD,QAAU,GAAI7wD,OAAM8I,QAAQuD,KACjC7O,KAAKqzD,QAAQC,cAAgBtzD,KAAK8e,KAAK5Q,KAAKlO,MAC5CA,KAAKqzD,QAAQE,eAAiBvzD,KAAK8e,KAAK5Q,KAAKlO,MAC7CA,KAAKqzD,QAAQG,cAAgBxzD,KAAK8e,KAAK5Q,KAAKlO,MAC5CA,KAAKwB,MAAMiT,KAMXjT,MAAO,SAAUiT,GACbA,EAAUA,MAENA,EAAQg/C,QACRzzD,KAAKyzD,MAAQh/C,EAAQg/C,OAErBh/C,EAAQ2+C,oBAAmBpzD,KAAKozD,kBAAoB3+C,EAAQ2+C,mBAC5D3+C,EAAQ2d,SAAQpyB,KAAKoyB,OAAS3d,EAAQ2d,QACtC3d,EAAQi/C,YACJj/C,EAAQi/C,WAAa1zD,KAAK0zD,YAC1B1zD,KAAK0zD,UAAYj/C,EAAQi/C,WAE7Bj/C,EAAUA,EAAQi/C,UAAUj/C,IAE5BA,EAAQk/C,mBAAkB3zD,KAAK2zD,iBAAmBl/C,EAAQk/C,kBAC1Dl/C,EAAQm/C,gBAAe5zD,KAAK4zD,cAAgBn/C,EAAQm/C,eACpDn/C,EAAQo/C,cAAa7zD,KAAK6zD,YAAcp/C,EAAQo/C,aAChDp/C,EAAQq/C,eAAc9zD,KAAK8zD,aAAer/C,EAAQq/C,cAClDr/C,EAAQs/C,WAAU/zD,KAAK+zD,SAAWt/C,EAAQs/C,UAC1Ct/C,EAAQu/C,oBAAmBh0D,KAAKg0D,kBAAoBv/C,EAAQu/C,mBAC5Dv/C,EAAQ3R,QAAO9C,KAAK8C,MAAQ2R,EAAQ3R,QAS5C2wD,OACInmD,IAAK,WACD,MAAOtN,MAAKi0D,QAEhB1mD,IAAK,SAAUnM,GACXpB,KAAKi0D,OAAS7yD,IAStBgyD,mBACI9lD,IAAK,WACD,MAAOtN,MAAKk0D,oBAEhB3mD,IAAK,SAAUnM,GACXpB,KAAKk0D,mBAAqB9yD,IASlCsyD,WACIpmD,IAAK,WACD,MAAOtN,MAAKm0D,YAEhB5mD,IAAK,SAAUnM,GACPA,GAAOpB,KAAKm0D,aACZn0D,KAAKm0D,WAAa/yD,EAClBpB,KAAKwB,OAAQkyD,UAAWtyD,IACxBpB,KAAK8e,QAEJ1d,IACDpB,KAAK4zD,cAAgB,KACrB5zD,KAAK8zD,aAAe,KACpB9zD,KAAK6zD,YAAc,QAU/BE,UACIzmD,IAAK,WACD,MAAOtN,MAAKo0D,WAEhB7mD,IAAK,SAAUnM,GACPpB,KAAKo0D,WACLp0D,KAAKq0D,SAGTr0D,KAAKo0D,UAAYhzD,IASzB+xD,aACI7lD,IAAK,WACD,MAAOtN,MAAKs0D,cAEhB/mD,IAAK,SAAUnM,GACXpB,KAAKs0D,aAAelzD,IAS5BgxB,QACI9kB,IAAK,WACD,MAAOtN,MAAKu0D,SAEhBhnD,IAAK,SAAUnM,GACPpB,KAAKu0D,SACLv0D,KAAKq0D,SAGTr0D,KAAKu0D,QAAUnzD,EACXA,GACApB,KAAK8e,SAUjBhc,OACIwK,IAAK,WACD,MAAOtN,MAAKw0D,QAEhBjnD,IAAK,SAAUnM,GACPpB,KAAKw0D,QACLx0D,KAAKq0D,SAETr0D,KAAKw0D,OAASpzD,EACVA,EACApB,KAAK8e,QAGL9e,KAAK4O,KAAO,KACZ5O,KAAKmzD,YAAc,KACnBnzD,KAAKy0D,aAAe,KACpBz0D,KAAKq0D,YAKjBK,aAAc,SAAUzxD,GACpB,GAAIkL,GAAOnO,KACP0L,EAAM,SAAUzI,GAAQ,OAAO,EAKnC,IAHIjD,KAAKoyB,SACL1mB,EAAM,SAAUzI,GAAQ,MAAOkL,GAAKikB,OAAOnvB,KAE3CjD,KAAKqzD,QAAQ/yD,OAWb,IAAK,GAVDq0D,GAAY,SAAU15C,EAAG25C,GACzB,MAAO,UAAU3xD,GACb,GAAImJ,GAAM6O,EAAEhY,EACZ,OAAKmJ,GAGEwoD,EAAU3xD,IAFN,IAMVG,EAAI,EAAIA,EAAIpD,KAAKqzD,QAAQ/yD,OAAS8C,IAAK,CAC5C,GAAIgvB,GAASpyB,KAAKqzD,QAAQwB,MAAMzxD,EAChCsI,GAAMipD,EAAUjpD,EAAK0mB,GAI7B,MAAO1mB,IAGXirC,QAAS,WACL32C,KAAK8e,QAMTA,KAAM,SAAUg2C,GACZ,GAAI3mD,GAAOnO,IAEX,IADAA,KAAKq0D,SACDr0D,KAAK8C,MAAO,CAGZ,GAFA9C,KAAK4O,KAAO,GAAIpM,OAAM8I,QAAQuD,KAAK7O,KAAK8C,OAEpC9C,KAAKoyB,QAAUpyB,KAAKqzD,QAAQ/yD,OAAQ,CACpC,GAAIy0D,GAAiB/0D,KAAK00D,cAC1B10D,MAAKy0D,aAAez0D,KAAK4O,KAAKomD,eAAeD,OAG7C/0D,MAAKy0D,aAAez0D,KAAK4O,IAG7B,IAAI5O,KAAK6zD,aAAe7zD,KAAK8zD,cAAgB9zD,KAAK4zD,cAAe,CAC7D5zD,KAAKmzD,YAAcnzD,KAAKy0D,aAAaQ,cAAcj1D,KAAK6zD,YAAY3lD,KAAKlO,MAAOA,KAAK8zD,aAAa5lD,KAAKlO,MAAOA,KAAK4zD,cAAc1lD,KAAKlO,MAEtI,IAAIk1D,GAAI/mD,EAAKglD,YAAYgC,MACzB,KAAK,GAAIrlD,KAAKolD,GAAEE,YAAa,CACzBh9C,QAAQiM,IAAIvU,EACZ,IAAIulD,GAAMlnD,EAAKglD,YAAYmC,kBAAkBF,YAAYtlD,EACrDulD,IAAyBpzD,SAAlBozD,EAAIE,YACXF,EAAIxvD,KAAK2vD,WAAaH,EAAIE,gBAGlCv1D,MAAKmzD,YAAc,IAGlB2B,IACD90D,KAAK+e,WAQjB4uC,aAAc,SAAU7qD,GACpB9C,KAAKq0D,SACLr0D,KAAKw0D,OAAS1xD,EACd9C,KAAK8e,MAAK,IAMdC,OAAQ,WACJ,IAAK/e,KAAKmzD,aAAenzD,KAAKy0D,eAAiBz0D,KAAK+zD,SAChD,GAAI/zD,KAAKmzD,aAAenzD,KAAKmzD,YAAY7yD,QAAUN,KAAKozD,kBAAmB,CACvEpzD,KAAK+zD,SAAS0B,eAAiBz1D,KAAKmzD,YAAYrkD,WAChD9O,KAAK+zD,SAAS2B,gBAAkB11D,KAAKmzD,YAAYgC,OAAOrmD,WAEpD9O,KAAKg0D,oBACLh0D,KAAKg0D,kBAAkByB,eAAiBz1D,KAAKmzD,YAAYgC,OAAOrmD,WAEpE,IAAI6mD,GAAU31D,KAAK41D,oBACfD,KACAA,EAAQE,QAAS,OAGpB,IAAI71D,KAAKy0D,eAAiBz0D,KAAKy0D,aAAan0D,QAAUN,KAAKozD,oBAAsBpzD,KAAKmzD,aAAc,CACrGnzD,KAAK+zD,SAAS0B,eAAiBz1D,KAAKy0D,aAAa3lD,WACjD9O,KAAK+zD,SAAS2B,gBAAkB,IAChC,IAAIC,GAAU31D,KAAK41D,oBACfD,KACAA,EAAQE,QAAS,OAWpB,CACG71D,KAAKmzD,cACLnzD,KAAK+zD,SAAS0B,eAAiBz1D,KAAKmzD,YAAYrkD,YACpD9O,KAAK+zD,SAAS2B,gBAAkB,KAC5B11D,KAAKg0D,oBACLh0D,KAAKg0D,kBAAkByB,eAAiB,KAE5C,IAAIE,GAAU31D,KAAK41D,oBACfD,KACAA,EAAQE,QAAS,KAUjCD,mBAAoB,WAEhB,IADA,GAAI5uD,GAAShH,KAAK+zD,SAAS5uD,QAAQ4E,cAC5B/C,GAAQ,CACX,GAAIA,EAAO4D,UAAUC,SAAS,oBAC1B,MAAO7D,GAAOiD,UAClBjD,GAASA,EAAO+C,gBAOxBsqD,OAAQ,WACAr0D,KAAK+zD,WACL/zD,KAAK+zD,SAAS0B,eAAiB,KAC/Bz1D,KAAK+zD,SAAS2B,gBAAkB,KAC5B11D,KAAKg0D,oBACLh0D,KAAKg0D,kBAAkByB,eAAiB,UAGpDjzD,MAAMoL,GAAGuX,eAEbjjB,aAAa0L,GAAGkoD,kBAAoBtzD,MAAMoZ,MAAMC,IAAIrZ,MAAMoZ,MAAMgJ,OAoBhE,SAAczf,EAASsP,GACnBzU,KAAKmF,QAAUA,GAAWK,SAAS4W,cAAc,OACjD3H,EAAUA,MACVzU,KAAKmF,QAAQ8E,WAAajK,KAC1BA,KAAKmF,QAAQyF,UAAU+I,IAAI,kBAC3BnR,MAAMoL,GAAG0N,WAAWtb,KAAMyU,GAC1BzU,KAAK+1D,aAAathD,KAWlBuhD,cACI1oD,IAAK,WACD,MAAOtN,MAAKi2D,gBASpBlC,UACIzmD,IAAK,WACD,MAAOtN,MAAKo0D,YASpB8B,mBACI5oD,IAAK,WACD,MAAOtN,MAAKm2D,qBASpBC,aACI9oD,IAAK,WACD,MAAOtN,MAAKq2D,eAIpBN,aAAc,SAAUthD,GACpB,GAAI6hD,GAAsB9wD,SAAS4W,cAAc,MACjDk6C,GAAoBjjD,MAAMnC,MAAQ,OAClColD,EAAoBjjD,MAAMlC,OAAS,MAEnC,IAAIolD,GAAsB/wD,SAAS4W,cAAc,MACjDm6C,GAAoBljD,MAAMnC,MAAQ,OAClCqlD,EAAoBljD,MAAMlC,OAAS,OACnColD,EAAoB5rD,UAAY,cAEhC,IAAI6rD,GAA+BhxD,SAAS4W,cAAc,MAC1Do6C,GAA6BnjD,MAAMnC,MAAQ,OAC3CslD,EAA6BnjD,MAAMlC,OAAS,OAC5CqlD,EAA6B7rD,UAAY,gBAEzC2rD,EAAoB/rD,YAAYgsD,GAChCD,EAAoB/rD,YAAYisD,GAChCx2D,KAAKmF,QAAQoF,YAAY+rD,GAEzBt2D,KAAKo0D,UAAY,GAAI5xD,OAAMoL,GAAGmc,SAASwsC,EAAqB9hD,EAAQs/C,UACpE/zD,KAAKm2D,mBAAqB,GAAI3zD,OAAMoL,GAAGmc,SAASysC,EAA8B/hD,EAAQyhD,mBAEtFl2D,KAAKi2D,cAAgB,GAAIzzD,OAAMoL,GAAG0c,aAAagsC,EAAqB7hD,EAAQgiD,aAE5E,IAAIC,GAAcjiD,EAAQ5O,QAC1B6wD,GAAY3C,SAAW/zD,KAAKo0D,UAC5BsC,EAAY1C,kBAAoBh0D,KAAKm2D,mBACrCn2D,KAAKq2D,aAAe,GAAIrD,GAAGE,kBAAkBwD,IAMjD//C,QAAS,WACLnU,MAAMiM,UAAUiX,eAAe1lB,KAAKmF,YAExC3C,MAAMoL,GAAGuX,cAAe3iB,MAAMiM,UAAUo8C,sBAAsB,aACnE3oD,aAAa0L,GAAGmlD,YAAa7wD,aAAa0L,GAAGmlD,YAAY4D,UAExDz0D,aAAa0L,GAAGoV,eAChB9gB,aAAa0L,GAAGoV,cAAcyF,SAAS,wBAAyBvmB,aAAa0L,GAAGkoD,mBAC5ElvD,cACAuhB,UACI4rC,SAAYvxD,MAAMoL,GAAGmc,SACrBmsC,kBAAqB1zD,MAAMoL,GAAGmc,SAC9BisC,aAAgBxzD,MAAMoL,GAAG0c,cAE7BvpB,KACI61D,mBAAuB1uC,UAAW,oBAAqBpgB,SAAU,iCAAkCsZ,SAAS,GAC5Gy1C,WAAe3uC,UAAW,YAAapgB,SAAU,yBAA0BsZ,SAAS,GACpF01C,OAAW5uC,UAAW,QAASpgB,SAAU,qBAAsBsZ,SAAS,GACxE21C,OAAW7uC,UAAW,QAASpgB,SAAU,qBAAsBsZ,SAAS,MAiBpFlf,aAAa0L,GAAGmlD,YAAY4D,SAAWz0D,aAAa0L,GAAGmlD,YAAY4D,aAEnE,SAAW3D,EAAIC,GACX,YAOA/wD,cAAa0L,GAAGmlD,YAAY4D,SAASK,WAAax0D,MAAMiM,UAAUC,2BAA2B,SAAU+F,GAgCnG,MA/BAA,GAAUA,MACVA,EAAQk/C,iBAAmBl/C,EAAQk/C,kBAAoB,IAEvDl/C,EAAQm/C,cAAgBn/C,EAAQm/C,eAAiB,SAAUpE,EAAMyH,GAC7D,MAAOzH,GAAKhpC,cAAcqK,WAAW,GAAKomC,EAAMzwC,cAAcqK,WAAW,IAG7Epc,EAAQo/C,YAAcp/C,EAAQo/C,aAAe,SAAUqD,GACnD,IAAKA,EACD,MAAOl3D,MAAK2zD,gBAEhB,IAAIvyD,GAAMc,aAAagC,MAAMwC,aAAawwD,EAAUl3D,KAAKyzD,MACzD,KAAKryD,EACD,MAAOpB,MAAK2zD,gBAEhB,IAAIxyD,GAAMC,EAAI,GAAGolB,aACjB,OAAOrlB,IAGXsT,EAAQq/C,aAAer/C,EAAQq/C,cAAgB,SAAUoD,GACrD,GAAI91D,GAAM,GACN81D,KACA91D,EAAMc,aAAagC,MAAMwC,aAAawwD,EAAUl3D,KAAKyzD,QACpDryD,IACDA,EAAMpB,KAAK2zD,iBAEf,IAAIxyD,GAAMC,EAAI,GAAGolB,aACjB,QACIsG,MAAO3rB,IAGRsT,IAQXvS,aAAa0L,GAAGmlD,YAAY4D,SAASQ,QAAU30D,MAAMiM,UAAUC,2BAA2B,SAAU+F,GAqChG,MApCAA,GAAQk/C,iBAAmBl/C,EAAQk/C,kBAAoB,IAEvDl/C,EAAQm/C,cAAgBn/C,EAAQm/C,eAAiB,SAAUjsD,EAAGC,GAC1D,MAAID,GAAIC,EACG,EACHA,EAAJD,EACO,GAEJ,GAGX8M,EAAQo/C,YAAcp/C,EAAQo/C,aAAe,SAAUqD,GACnD,IAAKA,EACD,MAAOl3D,MAAK2zD,gBAEhB,IAAIvyD,GAAMc,aAAagC,MAAMwC,aAAawwD,EAAUl3D,KAAKyzD,MACzD,KAAKryD,EACD,MAAOpB,MAAK2zD,gBAEhB,IAAIxyD,GAAMC,EAAIyI,WAAW2c,aACzB,OAAOrlB,IAGXsT,EAAQq/C,aAAer/C,EAAQq/C,cAAgB,SAAUoD,GACrD,GAAI91D,GAAM,GACN81D,KACA91D,EAAMc,aAAagC,MAAMwC,aAAawwD,EAAUl3D,KAAKyzD,QACpDryD,IACDA,EAAMpB,KAAK2zD,iBAEf,IAAIxyD,GAAMC,CACV,QACI0rB,MAAO3rB,IAIRsT,IAQXvS,aAAa0L,GAAGmlD,YAAY4D,SAASS,OAAS50D,MAAMiM,UAAUC,2BAA2B,SAAU+F,GAsC/F,MArCAA,GAAQk/C,iBAAmBl/C,EAAQk/C,kBAAoB,IAEvDl/C,EAAQm/C,cAAgBn/C,EAAQm/C,eAAiB,SAAUjsD,EAAGC,GAC1D,MAAID,GAAIC,EACG,EACHA,EAAJD,EACO,GAEJ,GAGX8M,EAAQo/C,YAAcp/C,EAAQo/C,aAAe,SAAUqD,GACnD,IAAKA,EACD,MAAOl3D,MAAK2zD,gBAEhB,IAAIvyD,GAAMc,aAAagC,MAAMwC,aAAawwD,EAAUl3D,KAAKyzD,MACzD,KAAKryD,EACD,MAAOpB,MAAK2zD,gBAEhB,IAAIxyD,GAAM,GAAIsI,MAAK,GAAIA,MAAK,GAAIA,MAAKrI,GAAKi2D,SAAS,EAAG,IAAIC,SAAS,EAAG,EAAG,EAAG,GAC5E,OAAOn2D,GAAIs4B,eAGfhlB,EAAQq/C,aAAer/C,EAAQq/C,cAAgB,SAAUoD,GACrD,GAAI91D,GAAM,GACN81D,KACA91D,EAAMc,aAAagC,MAAMwC,aAAawwD,EAAUl3D,KAAKyzD,QACpDryD,IACDA,EAAMpB,KAAK2zD,iBAEf,IAAIxyD,GAAM,GAAIsI,MAAK,GAAIA,MAAK,GAAIA,MAAKrI,GAAKi2D,SAAS,EAAG,IAAIC,SAAS,EAAG,EAAG,EAAG,GAC5E,QACIxqC,MAAO3rB,EAAIgvC,cAActmC,WACzByvB,KAAMn4B,IAIPsT,IAQXvS,aAAa0L,GAAGmlD,YAAY4D,SAASY,QAAU/0D,MAAMiM,UAAUC,2BAA2B,SAAU+F,GAsChG,MArCAA,GAAQk/C,iBAAmBl/C,EAAQk/C,kBAAoB,IAEvDl/C,EAAQm/C,cAAgBn/C,EAAQm/C,eAAiB,SAAUjsD,EAAGC,GAC1D,MAAID,GAAIC,EACG,EACHA,EAAJD,EACO,GAEJ,GAGX8M,EAAQo/C,YAAcp/C,EAAQo/C,aAAe,SAAUqD,GACnD,IAAKA,EACD,MAAOl3D,MAAK2zD,gBAEhB,IAAIvyD,GAAMc,aAAagC,MAAMwC,aAAawwD,EAAUl3D,KAAKyzD,MACzD,KAAKryD,EACD,MAAOpB,MAAK2zD,gBAEhB,IAAIxyD,GAAM,GAAIsI,MAAK,GAAIA,MAAK,GAAIA,MAAKrI,GAAKyuC,QAAQ,IAAIynB,SAAS,EAAG,EAAG,EAAG,GACxE,OAAOn2D,GAAIs4B,eAGfhlB,EAAQq/C,aAAer/C,EAAQq/C,cAAgB,SAAUoD,GACrD,GAAI91D,GAAM,GACN81D,KACA91D,EAAMc,aAAagC,MAAMwC,aAAawwD,EAAUl3D,KAAKyzD,QACpDryD,IACDA,EAAMpB,KAAK2zD,iBAEf,IAAIxyD,GAAM,GAAIsI,MAAK,GAAIA,MAAK,GAAIA,MAAKrI,GAAKyuC,QAAQ,IAAIynB,SAAS,EAAG,EAAG,EAAG,GACxE,QACIxqC,MAAO5qB,aAAagC,MAAM8E,KAAK7H,EAAI8uC,WAAa,GAAK,IAAM9uC,EAAIgvC,cAActmC,WAC7EyvB,KAAMn4B,IAIPsT,IAQXvS,aAAa0L,GAAGmlD,YAAY4D,SAASa,MAAQh1D,MAAMiM,UAAUC,2BAA2B,SAAU+F,GAsC9F,MArCAA,GAAQk/C,iBAAmBl/C,EAAQk/C,kBAAoB,IAEvDl/C,EAAQm/C,cAAgBn/C,EAAQm/C,eAAiB,SAAUjsD,EAAGC,GAC1D,MAAID,GAAIC,EACG,EACHA,EAAJD,EACO,GAEJ,GAGX8M,EAAQo/C,YAAcp/C,EAAQo/C,aAAe,SAAUqD,GACnD,IAAKA,EACD,MAAOl3D,MAAK2zD,gBAEhB,IAAIvyD,GAAMc,aAAagC,MAAMwC,aAAawwD,EAAUl3D,KAAKyzD,MACzD,KAAKryD,EACD,MAAOpB,MAAK2zD,gBAEhB,IAAIxyD,GAAM,GAAIsI,MAAK,GAAIA,MAAKrI,GAAKk2D,SAAS,EAAG,EAAG,EAAG,GACnD,OAAOn2D,GAAIs4B,eAGfhlB,EAAQq/C,aAAer/C,EAAQq/C,cAAgB,SAAUoD,GACrD,GAAI91D,GAAM,GACN81D,KACA91D,EAAMc,aAAagC,MAAMwC,aAAawwD,EAAUl3D,KAAKyzD,QACpDryD,IACDA,EAAMpB,KAAK2zD,iBAEf,IAAIxyD,GAAM,GAAIsI,MAAK,GAAIA,MAAKrI,GAAKk2D,SAAS,EAAG,EAAG,EAAG,GACnD,QACIxqC,MAAO5qB,aAAagC,MAAM8E,KAAK7H,EAAI8uC,WAAa,GAAK,IAAM/tC,aAAagC,MAAM8E,KAAK7H,EAAI+uC,WAAa,IAAM/uC,EAAIgvC,cAActmC,WAC5HyvB,KAAMn4B,IAIPsT,KAGZvS,aAAa0L,GAAGmlD,YAAa7wD,aAAa0L,GAAGmlD,YAAY4D;CCptB5D,WACI,YACAn0D,OAAMsjB,UAAUlB,OAAO,mBACnB6yC,YAAaj1D,MAAMoZ,MAAMC,IAAIrZ,MAAMoZ,MAAMgJ,OAAO,SAAczf,EAASsP,GACnEzU,KAAKmF,QAAUA,GAAWK,SAAS4W,cAAc,OACjD3H,EAAUA,MACVzU,KAAKmF,QAAQ8E,WAAajK,KAC1BA,KAAKmF,QAAQkO,MAAMmJ,QAAU,OAC7Bxc,KAAKmF,QAAQyF,UAAU+I,IAAI,mBAC3B3T,KAAKmF,QAAQyF,UAAU+I,IAAI,kBAC3B3T,KAAKmF,QAAQyF,UAAU+I,IAAI,mBAC3BnR,MAAMoL,GAAG0N,WAAWtb,KAAMyU,GAC1BzU,KAAKyL,WAELisD,WACIpqD,IAAK,WACD,MAAOtN,MAAK23D,YAEhBpqD,IAAK,SAAUnM,GACXpB,KAAK23D,WAAav2D,IAI1Bw2D,cACItqD,IAAK,WACD,MAAOtN,MAAK63D,eAEhBtqD,IAAK,SAAUnM,GACXpB,KAAK63D,cAAgBz2D,IAI7B02D,iBACIxqD,IAAK,WACD,MAAOtN,MAAK+3D,kBAAoB,GAEpCxqD,IAAK,SAAUnM,GACXpB,KAAK+3D,iBAAmB32D,IAIhC42D,YACI1qD,IAAK,WACD,MAAOtN,MAAKi4D,aAEhB1qD,IAAK,SAAUnM,GACXpB,KAAKi4D,YAAc72D,IAI3B82D,eACI5qD,IAAK,WACD,MAAOtN,MAAKm4D,gBAEhB5qD,IAAK,SAAUnM,GACXpB,KAAKm4D,eAAiB/2D,IAI9Bg3D,kBACI9qD,IAAK,WACD,MAAOtN,MAAKq4D,mBAAqB,GAErC9qD,IAAK,SAAUnM,GACXpB,KAAKq4D,kBAAoBj3D,IAIjCk3D,OACIhrD,IAAK,WACD,MAAOtN,MAAKu4D,QAEhBhrD,IAAK,SAAUnM,GACXpB,KAAKu4D,OAASn3D,IAItBo3D,SACIlrD,IAAK,WACD,MAAOtN,MAAKy4D,UAEhBlrD,IAAK,SAAUnM,GACXpB,KAAKy4D,SAAWr3D,IAIxB+I,QACImD,IAAK,WACD,MAAOtN,MAAK04D,SAEhBnrD,IAAK,SAAUnM,GACXpB,KAAK04D,QAAUt3D,IAIvBqK,OAAQ,WACJ,GAAI0C,GAAOnO,IACNmO,GAAKwqD,WACNxqD,EAAKwqD,SAAWnzD,SAAS4W,cAAc,SACvCjO,EAAKhJ,QAAQoF,YAAY4D,EAAKwqD,WAElCxqD,EAAKqW,gBAGTR,WAAY,WACRhkB,KAAKwkB,gBAGTA,aAAc,WACV,GAAIrW,GAAOnO,IAENmO,GAAKyqD,aACNzqD,EAAKyqD,WAAa12D,aAAagC,MAAM6G,gBAAgBoD,EAAKhJ,UAEzDgJ,EAAKkQ,YACNlQ,EAAKkQ,UAAYlQ,EAAKhJ,QAAQ4E,eAE9BoE,EAAKkQ,WAAalQ,EAAKhE,SACH,UAAhBgE,EAAKqqD,QACLrqD,EAAK0qD,4BAEL1qD,EAAK2qD,6BAKjBA,yBAA0B,WACtB,GAAI3qD,GAAOnO,KAEPuc,EAAYpO,EAAKhE,MACjBgE,GAAK4qD,SACLx8C,EAAYpO,EAAK4qD,OAAS,IAAMx8C,EAGpC,IAAI8B,GAAYlQ,EAAKyqD,WAAWzzD,OAChC,IAAIgJ,EAAKupD,UAAW,CAChB,GAAIsB,IAAY7qD,EAAKkQ,UAAU/N,YAAcnC,EAAKupD,WAAc,GAAK,EACjEuB,GAAU9qD,EAAKkQ,UAAU/N,YAAc0oD,GAAY,GAAK7qD,EAAK2pD,gBAAkB,GACnF,IAAI3pD,EAAKmqD,MAAO,CACZ,GAAIY,GAAWD,EAAQ9qD,EAAKmqD,OAAU,CACtCnqD,GAAKwqD,SAAS/7C,UAAYL,EAAY,YAAc08C,EAAQ,cAAgBC,EAAU,UAEtF/qD,GAAKwqD,SAAS/7C,UAAYL,EAAY,YAAc08C,EAAQ,YAE7D,IAAI9qD,EAAKmqD,MAAO,CACnB,CAAA,GAAIzmD,GAAW1D,EAAKkQ,UAAUhN,iBAAiBlD,EAAKhE,QAChDwnD,EAAO9/C,EAAS,GAAGvB,WACZuB,GAAS,GAAGrB,aAEvB,GAAImhD,EAAO,EAAG,CACV,GAAIuH,GAAWvH,EAAOxjD,EAAKmqD,OAAU,CACrC,IAAInqD,EAAKgrD,IAAK,CACV,GAAIlJ,GAAQ5xC,EAAU7N,aAAerC,EAAKgrD,IAAM,KAAQ,CACpDD,GAAUjJ,IACViJ,EAAUjJ,GAGlB9hD,EAAKwqD,SAAS/7C,UAAYL,EAAY,YAAc28C,EAAU,WAGlE9gD,SAAQi6B,KAAK,0DAIrBwmB,0BAA2B,WACvB,GAAI1qD,GAAOnO,KAEPuc,EAAYpO,EAAKhE,MAKrB,IAJIgE,EAAK4qD,SACLx8C,EAAYpO,EAAK4qD,OAAS,IAAMx8C,GAGhCpO,EAAK6pD,WAAY,CACjB,GAAIgB,IAAY7qD,EAAKkQ,UAAU7N,aAAerC,EAAK6pD,YAAe,GAAK,EACnEoB,GAAUjrD,EAAKkQ,UAAU7N,aAAewoD,GAAY,GAAK7qD,EAAKiqD,iBAC9DiB,EAAWD,EAAQjrD,EAAKmqD,OAAU,CACtCnqD,GAAKwqD,SAAS/7C,UAAYL,EAAY,YAAc88C,EAAU,cAAgBD,EAAQ,UACnF,CACH,GAAIvnD,GAAW1D,EAAKkQ,UAAUhN,iBAAiBlD,EAAKhE,QAEhDmnD,GADOz/C,EAAS,GAAGvB,YACZuB,EAAS,GAAGrB,aAEvB,IAAI8gD,EAAO,EAAG,CACV,GAAI+H,GAAW/H,EAAOnjD,EAAKmqD,OAAU,CACrC,IAAInqD,EAAKgrD,IAAK,CACV,GAAInJ,GAAQ7hD,EAAKkQ,UAAU/N,YAAcnC,EAAKgrD,IAAM,KAAQ,CACxDE,GAAUrJ,IACVqJ,EAAUrJ,GAGlB7hD,EAAKwqD,SAAS/7C,UAAYL,EAAY,WAAa88C,EAAU,SAKzE1iD,QAAS,WACL,GAAIxI,GAAOnO,IACXmO,GAAKyqD,WAAa,KAClBzqD,EAAKkQ,UAAY,KACjBlQ,EAAKwqD,SAAS5uD,cAAc83C,YAAY1zC,EAAKwqD,UAC7Cn2D,MAAMiM,UAAUiX,eAAe1lB,KAAKmF,SACpCnF,KAAKmF,QAAU,QAG7B3C,MAAMiM,UAAUqN,WAChBtZ,MAAMiM,UAAUo8C,sBAAsB;CC9MxC,WACI,YACAroD,OAAMsjB,UAAUlB,OAAO,mBACnB00C,YAAa92D,MAAMoZ,MAAMC,IAAIrZ,MAAMoZ,MAAMgJ,OAAO,SAAczf,EAASsP,GACnEzU,KAAKmF,QAAUA,GAAWK,SAAS4W,cAAc,OACjD3H,EAAUA,MACVzU,KAAKmF,QAAQ8E,WAAajK,KAC1BA,KAAKmF,QAAQkO,MAAMmJ,QAAU,OAC7Bxc,KAAKmF,QAAQyF,UAAU+I,IAAI,mBAC3B3T,KAAKmF,QAAQyF,UAAU+I,IAAI,mBAC3B3T,KAAKmF,QAAQyF,UAAU+I,IAAI,kBAC3BnR,MAAMoL,GAAG0N,WAAWtb,KAAMyU,KAE1B8kD,QACIjsD,IAAK,WACD,MAAOtN,MAAKw5D,SAEhBjsD,IAAK,SAAUnM,GACXpB,KAAKw5D,QAAUp4D,IAIvB+I,QACImD,IAAK,WACD,MAAOtN,MAAK04D,SAEhBnrD,IAAK,SAAUnM,GACXpB,KAAK04D,QAAUt3D,IAIvBq4D,eAAgB,SAAU1tD,EAAM4S,GAC5B,GAAIxQ,GAAOnO,IACX,IAAImO,EAAKorD,OACL,IAAK,GAAIzpD,KAAK3B,GAAKorD,OACfprD,EAAKurD,WAAW5pD,EAAG3B,EAAKorD,OAAOzpD,KAK3C4pD,WAAY,SAAU3tD,EAAM4S,GACxB,GAAIxQ,GAAOnO,IACX,IAAKmO,EAAKhJ,QAAV,CAGA,GAAIgF,GAASgE,EAAKhE,QAAUgE,EAAKhJ,QAAQ4E,cACrCsvD,EAAUlvD,EAAOmG,YACjB4oD,EAAU/uD,EAAOqG,aACjBmpD,GAAW,CACXh7C,GAAMi7C,MACND,EAAWA,GAAYN,EAAU16C,EAAMi7C,KACvCj7C,EAAMk7C,MACNF,EAAWA,GAAYN,EAAU16C,EAAMk7C,KACvCl7C,EAAMm7C,MACNH,EAAWA,GAAYT,EAAUv6C,EAAMm7C,KACvCn7C,EAAMo7C,MACNJ,EAAWA,GAAYT,EAAUv6C,EAAMo7C,KAEvCJ,GACAh7C,EAAMmrC,QAAS,EACf3/C,EAAOS,UAAU+I,IAAI,SAAW5H,KAEhC4S,EAAMmrC,QAAS,EACf3/C,EAAOS,UAAU4a,OAAO,SAAWzZ,MAI3CiY,WAAY,WACR,GAAI7V,GAAOnO,IACXmO,GAAKsrD,kBAGTj1C,aAAc,WACV,GAAIrW,GAAOnO,IACXmO,GAAKsrD,kBAGT9iD,QAAS,WACLnU,MAAMiM,UAAUiX,eAAe1lB,KAAKmF,SACpCnF,KAAKmF,QAAU,QAG7B3C,MAAMiM,UAAUqN,WAChBtZ,MAAMiM,UAAUo8C,sBAAsB","file":"winjscontrib-custom.js","sourcesContent":["/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n(function (_global) {\n    //polyfill setimmediate\n    if (!this.setImmediate) {\n        this.setImmediate = function (callback) {\n            var args = [];\n            for (var _i = 1; _i < arguments.length; _i++) {\n                args[_i - 1] = arguments[_i];\n            }\n            setTimeout(callback, 0);\n            return 0;\n        };\n    }\n    //Windows 10 doesn't have it anymore, polyfill for backward compat\n    if (!this.toStaticHTML) {\n        this.toStaticHTML = function (text) {\n            return text;\n        };\n    }\n    var msapp = _global.MSApp;\n    if (msapp && !msapp.execUnsafeLocalFunction) {\n        msapp.execUnsafeLocalFunction = function (c) { c(); };\n    }\n})(this);\nif (!Object.map) {\n    Object.map = function (obj, mapping) {\n        var mapped = {};\n        if (typeof obj !== 'object') {\n            return mapped;\n        }\n        if (typeof mapping !== 'function') {\n            // We could just return obj but that wouldn't be\n            // consistent with the rest of the interface which always returns\n            // a new object.\n            mapping = function (key, val) {\n                return [key, val];\n            };\n        }\n        Object.keys(obj).forEach(function (key) {\n            var transmuted = mapping.apply(obj, [key, obj[key]]);\n            if (transmuted && transmuted.length) {\n                mapped[transmuted[0] || key] = transmuted[1];\n            }\n        });\n        return mapped;\n    };\n}\nif (!String.prototype.format) {\n    String.prototype.format = function () {\n        var args = arguments;\n        return this.replace(/{(\\d+)}/g, function (match, number) {\n            return typeof args[number] !== 'undefined' ? args[number] : match;\n        });\n    };\n}\nif (!String.prototype.padLeft) {\n    String.prototype.padLeft = function padLeft(length, leadingChar) {\n        if (leadingChar === undefined) {\n            leadingChar = \"0\";\n        }\n        return this.length < length ? (leadingChar + this).padLeft(length, leadingChar) : this;\n    };\n}\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Promise;\n    (function (Promise) {\n        /**\n         * apply callback for each item in the array in waterfall\n         * @function WinJSContrib.Promise.waterfall\n         * @param {Array} dataArray items to process with async tasks\n         * @param {function} promiseCallback function applyed to each item (could return a promise for item callback completion)\n         * @returns {WinJS.Promise}\n         */\n        function waterfall(dataArray, promiseCallback) {\n            var resultPromise = WinJS.Promise.wrap();\n            var results = [];\n            if (!dataArray) {\n                return WinJS.Promise.wrap([]);\n            }\n            var dataPromise = WinJS.Promise.as(dataArray);\n            return dataPromise.then(function (items) {\n                var queueP = function (p, item) {\n                    return p.then(function (r) {\n                        return WinJS.Promise.as(promiseCallback(item)).then(function (r) {\n                            results.push(r);\n                        });\n                    });\n                };\n                for (var i = 0, l = items.length; i < l; i++) {\n                    var item = items[i];\n                    if (!item && items.getItem) {\n                        item = items.getItem(i);\n                    }\n                    resultPromise = queueP(resultPromise, item);\n                }\n                return resultPromise.then(function (r) {\n                    return results;\n                });\n            });\n        }\n        Promise.waterfall = waterfall;\n        function promises(dataArray, promiseCallback) {\n            if (!dataArray) {\n                return WinJS.Promise.wrap([]);\n            }\n            var dataPromise = WinJS.Promise.as(dataArray);\n            return dataPromise.then(function (items) {\n                var promises = [];\n                for (var i = 0, l = items.length; i < l; i++) {\n                    var item = items[i];\n                    if (!item && items.getItem) {\n                        item = items.getItem(i);\n                    }\n                    promises.push(WinJS.Promise.as(promiseCallback(item)));\n                }\n                return promises;\n            });\n        }\n        /**\n         * apply callback for each item in the array in parallel (equivalent to WinJS.Promise.join)\n         * @function WinJSContrib.Promise.parallel\n         * @param {Array} dataArray items to process with async tasks\n         * @param {function} promiseCallback function applyed to each item (could return a promise for item callback completion)\n         * @returns {WinJS.Promise}\n         */\n        function parallel(dataArray, promiseCallback) {\n            if (!dataArray) {\n                return WinJS.Promise.wrap([]);\n            }\n            var dataPromise = WinJS.Promise.as(dataArray);\n            return dataPromise.then(function (items) {\n                var promises = [];\n                for (var i = 0, l = items.length; i < l; i++) {\n                    var item = items[i];\n                    if (!item && items.getItem) {\n                        item = items.getItem(i);\n                    }\n                    promises.push(WinJS.Promise.as(promiseCallback(item)));\n                }\n                return WinJS.Promise.join(promises);\n            });\n        }\n        Promise.parallel = parallel;\n        /**\n         * apply callback for each item in the array in batch of X parallel items\n         * @function WinJSContrib.Promise.batch\n         * @param {Array} dataArray items to process with async tasks\n         * @param {number} batchSize number of items to batch\n         * @param {function} promiseCallback function applyed to each item (could return a promise for item callback completion)\n         * @returns {WinJS.Promise}\n         */\n        function batch(dataArray, batchSize, promiseCallback) {\n            if (!dataArray) {\n                return WinJS.Promise.wrap([]);\n            }\n            var dataPromise = WinJS.Promise.as(dataArray);\n            return dataPromise.then(function (items) {\n                var resultPromise = WinJS.Promise.wrap();\n                var batcheditems = [];\n                var results = [];\n                var hasErrors = false;\n                var queueBatch = function (p, items) {\n                    //var batchresults = [];\n                    return p.then(function (r) {\n                        return WinJS.Promise.join(items.map(function (item) { return WinJS.Promise.as(promiseCallback(item)); })).then(function (results) {\n                            results = results.concat(results);\n                        }, function (errors) {\n                            results = results.concat(errors);\n                            hasErrors = true;\n                        });\n                    });\n                };\n                for (var i = 0, l = items.length; i < l; i++) {\n                    var item = items[i];\n                    if (!item && items.getItem) {\n                        item = items.getItem(i);\n                    }\n                    batcheditems.push(item);\n                    if (i > 0 && i % batchSize === 0) {\n                        resultPromise = queueBatch(resultPromise, batcheditems);\n                        batcheditems = [];\n                    }\n                }\n                if (batcheditems.length) {\n                    resultPromise = queueBatch(resultPromise, batcheditems);\n                }\n                return resultPromise.then(function () {\n                    if (hasErrors)\n                        return WinJS.Promise.wrapError(results);\n                    return results;\n                });\n            });\n        }\n        Promise.batch = batch;\n    })(Promise = WinJSContrib.Promise || (WinJSContrib.Promise = {}));\n})(WinJSContrib || (WinJSContrib = {}));\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Utils;\n    (function (Utils) {\n        /**\n         * extend an object with properties from subsequent objects\n         * @function WinJSContrib.Utils.extend\n         * @returns {Object} composite object\n         */\n        function extend() {\n            for (var i = 1; i < arguments.length; i++)\n                for (var key in arguments[i])\n                    if (arguments[i].hasOwnProperty(key))\n                        arguments[0][key] = arguments[i][key];\n            return arguments[0];\n        }\n        Utils.extend = extend;\n        /** indicate if string starts with featured characters\n         * @function WinJSContrib.Utils.startsWith\n         * @param {string} str string to search within\n         * @param {string} strToMatch match string\n         * @returns {boolean} true if string starts with strToMatch\n         */\n        function startsWith(str, strToMatch) {\n            if (!strToMatch) {\n                return false;\n            }\n            var match = (str.match(\"^\" + strToMatch) == strToMatch);\n            return match;\n        }\n        Utils.startsWith = startsWith;\n        if (!String.prototype.startsWith) {\n            String.prototype.startsWith = function (str) {\n                return WinJSContrib.Utils.startsWith(this, str);\n            };\n        }\n        function asyncForEach(array, callback, batchsize) {\n            if (batchsize === void 0) { batchsize = 1; }\n            var i = 0;\n            while (i < array.length) {\n                setImmediate(function () {\n                    for (var j = 0; j < batchsize && i < array.length; j++) {\n                        i++;\n                        callback(array[i]);\n                    }\n                });\n            }\n        }\n        Utils.asyncForEach = asyncForEach;\n        /** indicate if string ends with featured characters\n         * @function WinJSContrib.Utils.endsWith\n         * @param {string} str string to search within\n         * @param {string} strToMatch match string\n         * @returns {boolean} true if string starts with strToMatch\n         */\n        function endsWith(str, strToMatch) {\n            if (!strToMatch) {\n                return false;\n            }\n            return (str.match(strToMatch + \"$\") == strToMatch);\n        }\n        Utils.endsWith = endsWith;\n        if (!String.prototype.endsWith) {\n            String.prototype.endsWith = function (str) {\n                return WinJSContrib.Utils.endsWith(this, str);\n            };\n        }\n        /**\n         * generate a string formatted as a query string from object properties\n         * @function WinJSContrib.Utils.queryStringFrom\n         * @param {Object} obj object to format\n         * @returns {string}\n         */\n        function queryStringFrom(obj) {\n            var str = [];\n            for (var p in obj)\n                if (obj.hasOwnProperty(p)) {\n                    var key = encodeURIComponent(p);\n                    var rawValue = obj[p];\n                    var value = WinJSContrib.Utils.hasValue(rawValue) ? encodeURIComponent(rawValue) : \"\";\n                    str.push(key + \"=\" + value);\n                }\n            return str.join(\"&\");\n        }\n        Utils.queryStringFrom = queryStringFrom;\n        /**\n         * trigger an event on a DOM node\n         * @function WinJSContrib.Utils.triggerEvent\n         * @param {HTMLElement} element receiving the event\n         * @param {string} eventName name of the event\n         * @param {boolean} bubbles indicate if event should bubble\n         * @param {boolean} cancellable indicate if event can be cancelled\n         */\n        function triggerEvent(element, eventName, bubbles, cancellable) {\n            var eventToTrigger = document.createEvent(\"Event\");\n            eventToTrigger.initEvent(eventName, bubbles, cancellable);\n            element.dispatchEvent(eventToTrigger);\n        }\n        Utils.triggerEvent = triggerEvent;\n        /**\n         * @function WinJSContrib.Utils.triggerCustomEvent\n         * @param {HTMLElement} element receiving the event\n         * @param {string} eventName name of the event\n         * @param {boolean} bubbles indicate if event should bubble\n         * @param {boolean} cancellable indicate if event can be cancelled\n         */\n        function triggerCustomEvent(element, eventName, bubbles, cancellable, data) {\n            var eventToTrigger = document.createEvent(\"CustomEvent\");\n            eventToTrigger.initCustomEvent(eventName, bubbles, cancellable, data);\n            element.dispatchEvent(eventToTrigger);\n        }\n        Utils.triggerCustomEvent = triggerCustomEvent;\n        /*\n        Core object properties features\n        */\n        //return object value based on property name. Property name is a string containing the name of the property, \n        //or the name of the property with an indexer, ex: myproperty[2] (to get item in a array)\n        function getobject(obj, prop) {\n            if (!obj)\n                return;\n            if (prop === 'this')\n                return obj;\n            var baseValue = obj[prop];\n            if (typeof baseValue !== \"undefined\")\n                return baseValue;\n            var idx = prop.indexOf('[');\n            if (idx < 0)\n                return;\n            var end = prop.indexOf(']', idx);\n            if (end < 0)\n                return;\n            var val = prop.substr(idx + 1, end - idx);\n            val = parseInt(val);\n            return obj[val];\n        }\n        //set object property value based on property name. Property name is a string containing the name of the property, \n        //or the name of the property with an indexer, ex: myproperty[2] (to get item in a array)\n        function setobject(obj, prop, data) {\n            if (!obj)\n                return;\n            if (WinJSContrib.Utils.hasValue(prop)) {\n                if (obj.setProperty) {\n                    obj.setProperty(prop, data);\n                    return;\n                }\n                obj[prop] = data;\n                return;\n            }\n            if (typeof prop === \"string\") {\n                var idx = prop.indexOf('[');\n                if (idx < 0)\n                    return;\n                var end = prop.indexOf(']', idx);\n                if (end < 0)\n                    return;\n                var val = prop.substr(idx + 1, end - idx);\n                var intval = parseInt(val);\n                obj[intval] = data;\n            }\n        }\n        /** Read property value on an object based on expression\n        * @function WinJSContrib.Utils.readProperty\n        * @param {Object} source the object containing data\n        * @param {Object} properties property descriptor. could be a string in js notation ex: 'myProp.myChildProp,\n        * or an array of strings ['myProp', 'myChildProp']. String notation can contain indexers\n        * @returns {Object} property value\n        */\n        function readProperty(source, properties) {\n            if (typeof properties == 'string' && source[properties])\n                return source[properties];\n            if (!properties || !properties.length)\n                return source;\n            var prop = WinJSContrib.Utils.getProperty(source, properties);\n            if (prop) {\n                return prop.propValue;\n            }\n        }\n        Utils.readProperty = readProperty;\n        var PropertyDescriptor = (function () {\n            function PropertyDescriptor(parent, parentDescriptor, keyProp) {\n                this.parent = parent;\n                this.parentDescriptor = parentDescriptor;\n                this.keyProp = keyProp;\n            }\n            PropertyDescriptor.prototype.ensureParent = function () {\n                if (parent) {\n                    return parent;\n                }\n                else {\n                    if (this.parentDescriptor) {\n                        this.parentDescriptor.ensureParent();\n                        if (!this.parentDescriptor.parent[this.parentDescriptor.keyProp]) {\n                            this.parentDescriptor.parent[this.parentDescriptor.keyProp] = {};\n                            this.parent = this.parentDescriptor.parent[this.parentDescriptor.keyProp];\n                        }\n                    }\n                }\n            };\n            Object.defineProperty(PropertyDescriptor.prototype, \"propValue\", {\n                get: function () {\n                    return getobject(this.parent, this.keyProp);\n                },\n                set: function (val) {\n                    this.ensureParent();\n                    setobject(this.parent, this.keyProp, val);\n                },\n                enumerable: true,\n                configurable: true\n            });\n            return PropertyDescriptor;\n        })();\n        Utils.PropertyDescriptor = PropertyDescriptor;\n        /**\n         * return a propery descriptor for an object based on expression\n         * @function WinJSContrib.Utils.getProperty\n         * @param {Object} source the object containing data\n         * @param {string[]} properties property descriptor. could be a string in js notation ex: 'myProp.myChildProp,\n         * or an array of strings ['myProp', 'myChildProp']. String notation can contain indexers\n         * @returns {Object} property descriptor\n         */\n        function getProperty(source, properties) {\n            if (typeof properties == 'string') {\n                properties = properties.split('.');\n            }\n            if (!properties || !properties.length) {\n                properties = ['this'];\n            }\n            var parent = source;\n            var previousDescriptor = null;\n            for (var i = 0; i < properties.length; i++) {\n                var descriptor = new PropertyDescriptor(parent, previousDescriptor, properties[i]);\n                previousDescriptor = descriptor;\n                if (i == properties.length - 1) {\n                    return descriptor;\n                }\n                parent = getobject(parent, properties[i]);\n            }\n            return;\n        }\n        Utils.getProperty = getProperty;\n        /**\n         * Write property value on an object based on expression\n         * @function WinJSContrib.Utils.writeProperty\n         * @param {Object} source the object containing data\n         * @param {string[]} properties property descriptor. could be a string in js notation ex: 'myProp.myChildProp,\n         * or an array of strings ['myProp', 'myChildProp']. String notation can contain indexers\n         * @param {Object} data data to feed to the property\n         */\n        function writeProperty(source, properties, data) {\n            var prop = WinJSContrib.Utils.getProperty(source, properties);\n            if (prop) {\n                prop.propValue = data;\n            }\n        }\n        Utils.writeProperty = writeProperty;\n        /** generate a random value between two numbers\n         * @function WinJSContrib.Utils.randomFromInterval\n         * @param {number} from lower limit\n         * @param {number} to upper limit\n         * @returns {number}\n         */\n        function randomFromInterval(from, to) {\n            return (Math.random() * (to - from + 1) + from) << 0;\n        }\n        Utils.randomFromInterval = randomFromInterval;\n        /**\n         * function to use as a callback for Array.sort when you want the array to be sorted alphabetically\n         * @function WinJSContrib.Utils.alphabeticSort\n         * @param {string} a\n         * @param {string} b\n         * @returns {number}\n         */\n        function alphabeticSort(a, b) {\n            if (a > b)\n                return 1;\n            if (a < b)\n                return -1;\n            return 0;\n        }\n        Utils.alphabeticSort = alphabeticSort;\n        /**\n         * generate an array with only distinct elements\n         * @function WinJSContrib.Utils.distinctArray\n         * @param {Array} array\n         * @param {string} path to array's item property used for checking items\n         * @param {boolean} ignorecase indicate if comparison should ignore case when using string\n         * @returns {Array}\n         */\n        function distinctArray(array, property, ignorecase) {\n            if (array === null || array.length === 0)\n                return array;\n            if (typeof ignorecase == \"undefined\")\n                ignorecase = false;\n            var sMatchedItems = \"\";\n            var foundCounter = 0;\n            var newArray = [];\n            var sFind;\n            var i;\n            if (ignorecase) {\n                for (i = 0; i < array.length; i++) {\n                    if (property) {\n                        var data = WinJSContrib.Utils.readProperty(array[i], property.split('.'));\n                        sFind = data;\n                        if (!data)\n                            sFind = data;\n                        if (data && data.toLowerCase)\n                            sFind = data.toLowerCase();\n                    }\n                    else {\n                        sFind = array[i];\n                    }\n                    if (sMatchedItems.indexOf(\"|\" + sFind + \"|\") < 0) {\n                        sMatchedItems += \"|\" + sFind + \"|\";\n                        newArray[foundCounter++] = array[i];\n                    }\n                }\n            }\n            else {\n                for (i = 0; i < array.length; i++) {\n                    if (property) {\n                        sFind = WinJSContrib.Utils.readProperty(array[i], property.split('.'));\n                    }\n                    else {\n                        sFind = array[i];\n                    }\n                    if (sMatchedItems.indexOf(\"|\" + sFind + \"|\") < 0) {\n                        sMatchedItems += \"|\" + sFind + \"|\";\n                        newArray[foundCounter++] = array[i];\n                    }\n                }\n            }\n            return newArray;\n        }\n        Utils.distinctArray = distinctArray;\n        /**\n         * get distinct values from an array of items\n         * @function WinJSContrib.Utils.getDistinctPropertyValues\n         * @param {Array} array items array\n         * @param {string} property property path for values\n         * @param {boolean} ignorecase ignore case for comparisons\n         */\n        function getDistinctPropertyValues(array, property, ignorecase) {\n            return Utils.distinctArray(array, property, ignorecase).map(function (item) {\n                return WinJSContrib.Utils.readProperty(item, property.split('.'));\n            });\n        }\n        Utils.getDistinctPropertyValues = getDistinctPropertyValues;\n        /**\n         * Remove all accented characters from a string and replace them with their non-accented counterpart for ex: replace \"é\" with \"e\"\n         * @function WinJSContrib.Utils.removeAccents\n         * @param {string} s\n         * @returns {string}\n         */\n        function removeAccents(s) {\n            var r = s.toLowerCase();\n            r = r.replace(new RegExp(\"[àáâãäå]\", 'g'), \"a\");\n            r = r.replace(new RegExp(\"æ\", 'g'), \"ae\");\n            r = r.replace(new RegExp(\"ç\", 'g'), \"c\");\n            r = r.replace(new RegExp(\"[èéêë]\", 'g'), \"e\");\n            r = r.replace(new RegExp(\"[ìíîï]\", 'g'), \"i\");\n            r = r.replace(new RegExp(\"ñ\", 'g'), \"n\");\n            r = r.replace(new RegExp(\"[òóôõö]\", 'g'), \"o\");\n            r = r.replace(new RegExp(\"œ\", 'g'), \"oe\");\n            r = r.replace(new RegExp(\"[ùúûü]\", 'g'), \"u\");\n            r = r.replace(new RegExp(\"[ýÿ]\", 'g'), \"y\");\n            return r;\n        }\n        Utils.removeAccents = removeAccents;\n        /**\n         * remove a page from navigation history\n         * @function WinJSContrib.Utils.removePageFromHistory\n         * @param {string} pageLocation page url\n         */\n        function removePageFromHistory(pageLoc) {\n            var history = [];\n            if (WinJS.Navigation.history && WinJS.Navigation.history.backStack && WinJS.Navigation.history.backStack.length) {\n                WinJS.Navigation.history.backStack.forEach(function (page) {\n                    if (page.location !== pageLoc) {\n                        history.push(page);\n                    }\n                });\n            }\n            WinJS.Navigation.history.backStack = history;\n        }\n        Utils.removePageFromHistory = removePageFromHistory;\n        /**\n         * format a number on 2 digits\n         * @function WinJSContrib.Utils.pad2\n         * @param {number} number\n         */\n        function pad2(number) {\n            return (number < 10 ? '0' : '') + number;\n        }\n        Utils.pad2 = pad2;\n        /**\n         * truncate a string and add ellipse if text if greater than certain size\n         * @function WinJSContrib.Utils.ellipsisizeString\n         * @param {string} text text to truncate\n         * @param {number} maxSize maximum size for text\n         * @param {boolean} useWordBoundary indicate if truncate should happen on the closest word boundary (like space)\n         */\n        function ellipsisizeString(text, maxSize, useWordBoundary) {\n            if (!text) {\n                return '';\n            }\n            var toLong = text.length > maxSize, text_ = toLong ? text.substr(0, maxSize - 1) : text;\n            text_ = useWordBoundary && toLong ? text_.substr(0, text_.lastIndexOf(' ')) : text_;\n            return toLong ? text_ + '...' : text_;\n        }\n        Utils.ellipsisizeString = ellipsisizeString;\n        /**\n         * generate a new Guid\n         * @function WinJSContrib.Utils.guid\n         * @returns {string}\n         */\n        function guid() {\n            var d = new Date().getTime();\n            var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n                var r = (d + Math.random() * 16) % 16 | 0;\n                d = Math.floor(d / 16);\n                return (c == 'x' ? r : (r & 0x7 | 0x8)).toString(16);\n            });\n            return uuid;\n        }\n        Utils.guid = guid;\n        /**\n         * inherit property from parent WinJS controls\n         * @function WinJSContrib.Utils.inherit\n         * @param {HTMLElement} element\n         * @param {string} property property name\n         */\n        function inherit(element, property) {\n            if (element && element.parentElement) {\n                var current = element.parentElement;\n                while (current) {\n                    if (current.winControl) {\n                        if (current.winControl[property] !== undefined) {\n                            return current.winControl[property];\n                        }\n                    }\n                    current = current.parentElement;\n                }\n            }\n        }\n        Utils.inherit = inherit;\n        /**\n         * move DOM childrens form one node to the other\n         * @function WinJSContrib.Utils.moveChilds\n         * @param {HTMLElement} source source node containing elements to move\n         * @param {HTMLElement} target target node for moved elements\n         */\n        function moveChilds(source, target) {\n            if (!source || !target)\n                return;\n            var childs = [];\n            for (var i = 0; i < source.childNodes.length; i++) {\n                childs.push(source.childNodes[i]);\n            }\n            childs.forEach(function (elt) {\n                target.appendChild(elt);\n            });\n        }\n        Utils.moveChilds = moveChilds;\n        /**\n         * get parent control identifyed by a property attached on DOM element\n         * @function WinJSContrib.Utils.getParent\n         * @param {string} property property attached to control's DOM element, for ex: msParentSelectorScope\n         * @param {HTMLElement} element DOM element to scan\n         * @returns {Object} WinJS control\n         */\n        function getParent(property, element) {\n            if (!element)\n                return;\n            var current = element.parentNode;\n            while (current) {\n                if (current[property] && current.winControl) {\n                    return current.winControl;\n                }\n                current = current.parentNode;\n            }\n        }\n        Utils.getParent = getParent;\n        /**\n         * get parent control identifyed by a css class\n         * @function WinJSContrib.Utils.getParentControlByClass\n         * @param {string} className css class name\n         * @param {HTMLElement} element DOM element to scan\n         * @returns {Object} WinJS control\n         */\n        function getParentControlByClass(className, element) {\n            if (!element)\n                return;\n            var current = element.parentNode;\n            while (current) {\n                if (current.classList && current.classList.contains(className) && current.winControl) {\n                    return current.winControl;\n                }\n                current = current.parentNode;\n            }\n        }\n        Utils.getParentControlByClass = getParentControlByClass;\n        /**\n         * get parent page control (work only with WinJSContrib.UI.PageControlNavigator\n         * @function WinJSContrib.Utils.getParentPage\n         * @param {HTMLElement} element DOM element to scan\n         * @returns {Object} WinJS control\n         */\n        function getParentPage(element) {\n            return WinJSContrib.Utils.getParent('mcnPage', element);\n        }\n        Utils.getParentPage = getParentPage;\n        /**\n         * get parent scope control (based on msParentSelectorScope)\n         * @function WinJSContrib.Utils.getScopeControl\n         * @param {HTMLElement} element DOM element to scan\n         * @returns {Object} WinJS control\n         */\n        function getScopeControl(element) {\n            var current = element.parentNode;\n            while (current) {\n                if (current.msParentSelectorScope) {\n                    var scope = current.parentNode;\n                    if (scope) {\n                        var scopeControl = scope.winControl;\n                        if (scopeControl) {\n                            return scopeControl;\n                        }\n                    }\n                }\n                current = current.parentNode;\n            }\n        }\n        Utils.getScopeControl = getScopeControl;\n        /**\n         * get WinJS.Binding.Template like control from a path, a control, a function or a DOM element\n         * @function WinJSContrib.Utils.getTemplate\n         * @param {Object} template template input\n         * @returns {Object} WinJS.Binding.Template or template-like object (object with a render function)\n         */\n        function getTemplate(template) {\n            if (template) {\n                var templatetype = typeof template;\n                if (templatetype == 'string') {\n                    return new WinJS.Binding.Template(null, { href: template });\n                }\n                if (templatetype == 'function') {\n                    return {\n                        render: function (data, elt) {\n                            var res = template(data, elt);\n                            return WinJS.Promise.as(res);\n                        }\n                    };\n                }\n                else if (template.winControl) {\n                    return template.winControl;\n                }\n                else if (template.render) {\n                    return template;\n                }\n            }\n        }\n        Utils.getTemplate = getTemplate;\n        /**\n         * get a function from an expression, for example 'page:myAction' will return the myAction function from the parent page.\n         * The returned function will be bound to it's owner. This function relies on {link WinJSContrib.Utils.resolveValue}, see this for details about how data are crawled\n         * @function WinJSContrib.Utils.resolveMethod\n         * @param {HTMLElement} element DOM element to look\n         * @param {string} text expression like 'page:something' or 'ctrl:something' or 'something'\n         * @returns {function}\n         */\n        function resolveMethod(element, text) {\n            var res = WinJSContrib.Utils.resolveValue(element, text);\n            if (res && typeof res == 'function')\n                return res;\n            return undefined;\n        }\n        Utils.resolveMethod = resolveMethod;\n        function readValue(element, text) {\n            var res = WinJSContrib.Utils.resolveValue(element, text);\n            if (res) {\n                if (typeof res == 'function')\n                    return res(element);\n                else\n                    return res;\n            }\n            return undefined;\n        }\n        Utils.readValue = readValue;\n        /**\n         * Utility functions used by WinJSContrib.Utils.resolveValue and WinJSContrib.Utils.applyValue\n         * @namespace WinJSContrib.Utils.ValueParsers\n         */\n        Utils.ValueParsers = {\n            /**\n             * Get value from current page in parent navigator\n             * @function WinJSContrib.Utils.ValueParsers.navpage\n             */\n            \"navpage\": function (element, text, context) {\n                var control = (context && context.data) ? context.data.navpage : null;\n                if (!control) {\n                    if (WinJSContrib.Utils.getParentPage) {\n                        control = WinJSContrib.Utils.getParentPage(element);\n                        if (context && context.data)\n                            context.data.navpage = control;\n                    }\n                    if (!control && WinJSContrib.UI.Application.navigator) {\n                        control = WinJSContrib.UI.Application.navigator.pageControl;\n                        if (context && context.data)\n                            context.data.navpage = control;\n                    }\n                }\n                if (!control)\n                    return;\n                if (context)\n                    context.parentControl = control;\n                var method = WinJSContrib.Utils.readProperty(control, text);\n                if (method && typeof method === 'function')\n                    return method.bind(control);\n                else\n                    return method;\n            },\n            /**\n             * Get value from parent element with 'pagecontrol' class\n             * @function WinJSContrib.Utils.ValueParsers.page\n             */\n            \"page\": function (element, text, context) {\n                var control = (context && context.data) ? context.data.page : null;\n                if (!control) {\n                    control = WinJSContrib.Utils.getParentControlByClass('pagecontrol', element);\n                    if (context && context.data)\n                        context.data.page = control;\n                }\n                if (!control)\n                    return;\n                if (context)\n                    context.parentControl = control;\n                var method = WinJSContrib.Utils.readProperty(control, text);\n                if (method && typeof method === 'function')\n                    return method.bind(control);\n                else\n                    return method;\n            },\n            /**\n             * Get value from parent scope\n             * @function WinJSContrib.Utils.ValueParsers.ctrl\n             */\n            \"ctrl\": function (element, text, context) {\n                var control = (context && context.data) ? context.data.scope : null;\n                if (!control) {\n                    control = WinJSContrib.Utils.getScopeControl(element);\n                    if (context && context.data)\n                        context.data.scope = control;\n                }\n                if (!control)\n                    return;\n                if (context)\n                    context.parentControl = control;\n                var method = WinJSContrib.Utils.readProperty(control, text);\n                if (method && typeof method === 'function')\n                    return method.bind(control);\n                else\n                    return method;\n            },\n            /**\n             * select a node from DOM\n             * @function WinJSContrib.Utils.ValueParsers.select\n             */\n            \"select\": function (element, text, context) {\n                var control = (context && context.data) ? context.data.scope : null;\n                if (!control) {\n                    control = WinJSContrib.Utils.getScopeControl(element);\n                    if (context && context.data)\n                        context.data.scope = control;\n                }\n                var element = null;\n                var items = text.split('|');\n                var selector = items[0];\n                if (control) {\n                    element = control.element.querySelector(selector);\n                }\n                if (!element)\n                    element = document.querySelector(selector);\n                if (items.length == 1) {\n                    return element;\n                }\n                else if (items.length > 1) {\n                    var val = readProperty(element, text.substr(items[0].length + 1));\n                    return val;\n                }\n            },\n            /**\n             * get an object formatted as JSON\n             * @function WinJSContrib.Utils.ValueParsers.obj\n             */\n            \"obj\": function (element, text, context) {\n                return WinJS.UI.optionsParser(text, window, {\n                    select: WinJS.Utilities.markSupportedForProcessing(function (text) {\n                        var parent = WinJSContrib.Utils.getScopeControl(element);\n                        if (parent) {\n                            return parent.element.querySelector(text);\n                        }\n                        else {\n                            return document.querySelector(text);\n                        }\n                    })\n                });\n            },\n            /**\n             * mark a promise for resolution (if used in applyValue, the promise will get resolved and the promise's result will be affected)\n             * @function WinJSContrib.Utils.ValueParsers.prom\n             */\n            \"prom\": function (element, text, context) {\n                var res = resolveValue(element, text, context);\n                if (res.then) {\n                    res = res.then(null, null);\n                    res.mcnMustResolve = true;\n                }\n                return res;\n            },\n            /**\n             * wrap result in WinJS.Binding.List().dataSource\n             * usefull for ListViews\n             * @function WinJSContrib.Utils.ValueParsers.list\n             */\n            \"list\": function (element, text, context) {\n                var res = resolveValue(element, text, context);\n                if (res) {\n                    if (res.then) {\n                        var p = res.then(function (data) {\n                            return new WinJS.Binding.List(data).dataSource;\n                        });\n                        p.mcnMustResolve = true;\n                        return p;\n                    }\n                    return new WinJS.Binding.List(res).dataSource;\n                }\n            },\n            /**\n             * get value from global scope\n             * @function WinJSContrib.Utils.ValueParsers.global\n             */\n            \"global\": function (element, text, context) {\n                return WinJSContrib.Utils.readProperty(window, text);\n            },\n            /**\n             * get a template from uri\n             * @function WinJSContrib.Utils.ValueParsers.templ\n             */\n            \"templ\": function (element, text, context) {\n                return WinJSContrib.Templates.get(text);\n            },\n            /**\n             * return element property\n             * @function WinJSContrib.Utils.ValueParsers.element\n             */\n            \"element\": function (element, text, context) {\n                var res = resolveValue(element, text, context);\n                if (res)\n                    return res.element;\n            },\n            \"event\": function (element, text, context) {\n                var res = resolveValue(element, text, context);\n                var parentControl = null;\n                if (!res || !context || !context.name) {\n                    return;\n                }\n                if (context)\n                    parentControl = context.parentControl;\n                if (res && typeof res === 'function') {\n                    if (parentControl && parentControl.eventTracker) {\n                        parentControl.eventTracker.addEvent(context.control, context.name, res);\n                    }\n                    else {\n                        context.control.addEventListener(context.name, res);\n                    }\n                }\n            }\n        };\n        /**\n         * resolve value from an expression. This helper will crawl the DOM up, and provide the property or function from parent page or control.\n         * @function WinJSContrib.Utils.resolveValue\n         * @param {HTMLElement} element DOM element to look\n         * @param {string} text expression like 'page:something' or 'ctrl:something' or 'something'\n         * @returns {Object}\n         */\n        function resolveValue(element, text, context) {\n            var methodName, control, method;\n            var items = text.split(':');\n            if (items.length > 1) {\n                var name = items[0];\n                var val = text.substr(name.length + 1);\n                var parser = Utils.ValueParsers[name];\n                if (parser) {\n                    return parser(element, val, context);\n                }\n            }\n            return text; //WinJSContrib.Utils.readProperty(window, text);\n        }\n        Utils.resolveValue = resolveValue;\n        /**\n         * call resolve value and apply result to a target object\n         * @function WinJSContrib.Utils.applyValue\n         * @param {HTMLElement} element DOM element to look\n         * @param {string} text expression like 'page:something' or 'ctrl:something' or 'something'\n         * @param {string} target target object\n         * @param {string} targetPath path to dest property\n         */\n        function applyValue(element, text, target, targetPath, context) {\n            var tmp = WinJSContrib.Utils.resolveValue(element, text, context);\n            if (tmp && tmp.then && tmp.mcnMustResolve) {\n                tmp.then(function (data) {\n                    WinJSContrib.Utils.writeProperty(target, targetPath, data);\n                });\n            }\n            else {\n                WinJSContrib.Utils.writeProperty(target, targetPath, tmp);\n            }\n        }\n        Utils.applyValue = applyValue;\n        /**\n         * Checks in a safe way if an object has a value, which could be 'false', '0' or '\"\"'\n         * @function WinJSContrib.Utils.hasValue\n         * @param {Object} item The object to check.\n         * @returns {Boolean} Whether the object has a value or not.\n         */\n        function hasValue(item) {\n            return typeof item !== \"undefined\" && item !== null;\n        }\n        Utils.hasValue = hasValue;\n        /**\n         * format error from an xhr call\n         * @function WinJSContrib.Utils.formatXHRError\n         */\n        function formatXHRError(xhr) {\n            return \"{0} - {1}: {2}\".format(xhr.status, xhr.statusText, xhr.responseText);\n        }\n        Utils.formatXHRError = formatXHRError;\n        /**\n         * Unwraps the real error from a WinJS.Promise.join operation, which by design returns an array with 'undefined' for all cells,\n         * excepts the one corresponding to the promise that really faulted.\n         * @function WinJSContrib.Utils.unwrapJoinError\n         * @param {function} errorCallback The callback to use to handle the error.\n         * @returns {Function} The result of the callback being fired with the real error.\n         */\n        function unwrapJoinError(errorCallback) {\n            return function (errorArray) {\n                var unwrappedError = null;\n                for (var i = 0; i < errorArray.length; i++) {\n                    var tentativeError = errorArray[i];\n                    if (typeof tentativeError !== \"undefined\") {\n                        unwrappedError = tentativeError;\n                        break;\n                    }\n                }\n                return errorCallback(unwrappedError);\n            };\n        }\n        Utils.unwrapJoinError = unwrapJoinError;\n        /**\n         * inject properties from source object to target object\n         * @function WinJSContrib.Utils.inject\n         */\n        function inject(target, source) {\n            if (source) {\n                for (var k in source) {\n                    target[k] = source[k];\n                }\n            }\n        }\n        Utils.inject = inject;\n    })(Utils = WinJSContrib.Utils || (WinJSContrib.Utils = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n/**\n * @namespace WinJSContrib.Templates\n */\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Templates;\n    (function (Templates) {\n        var cache = {};\n        /**\n         * get a template from it's path\n         * @function get\n         * @memberof WinJSContrib.Templates\n         * @param {string} uri path to template file\n         * @returns {WinJS.Binding.Template} template object\n         */\n        function get(uri) {\n            var template = cache[uri];\n            if (cache[uri])\n                return template;\n            return new WinJS.Binding.Template(null, { href: uri });\n        }\n        Templates.get = get;\n        /**\n         * get a template and turn it to a rendering function that takes an item promise, and return a DOM element\n         * @function WinJSContrib.Templates.interactive\n         * @param {string} uri path to template file\n         * @param {Object} args definition of interactive elements\n         * @returns {function} rendering function that takes an item promise, and return a DOM element\n         */\n        function interactive(uri, args) {\n            var template = WinJSContrib.Templates.get(uri);\n            if (template) {\n                return WinJSContrib.Templates.makeInteractive(template, args);\n            }\n            else {\n                throw { message: 'template not found for ' + uri };\n            }\n        }\n        Templates.interactive = interactive;\n        /**\n         * generate a rendering function that takes an item promise, and return a DOM element\n         * @function WinJSContrib.Templates.get\n         * @param {WinJS.Binding.Template} template template object\n         * @param {Object} args definition of interactive elements\n         * @returns {function} rendering function that takes an item promise, and return a DOM element\n         */\n        function makeInteractive(template, args) {\n            return function (itemPromise) {\n                return itemPromise.then(function (item) {\n                    return template.render(item).then(function (rendered) {\n                        if (args.tap) {\n                            for (var n in args.tap) {\n                                var elt = rendered.querySelector(n);\n                                WinJSContrib.UI.tap(elt, function (arg) {\n                                    args.tap[n](arg, item);\n                                });\n                            }\n                        }\n                        if (args.click) {\n                            for (var n in args.click) {\n                                var elt = rendered.querySelector(n);\n                                elt.onclick = function (arg) {\n                                    args.click[n](arg, item);\n                                };\n                            }\n                        }\n                        return rendered;\n                    });\n                });\n            };\n        }\n        Templates.makeInteractive = makeInteractive;\n    })(Templates = WinJSContrib.Templates || (WinJSContrib.Templates = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var UI;\n    (function (UI) {\n        UI.Application = {};\n        /**\n         * indicate if fragment should not look for resources when building control\n         * @field WinJSContrib.UI.disableAutoResources\n         * @type {boolean}\n         */\n        UI.disableAutoResources = false;\n        /**\n         * Calculate offset of element relative to parent element. If parent parameter is null, offset is relative to document\n         * @function WinJSContrib.UI.offsetFrom\n         * @param {HTMLElement} element element to evaluate\n         * @param {HTMLElement} parent reference of offset\n         */\n        function offsetFrom(element, parent) {\n            var xPosition = 0;\n            var yPosition = 0;\n            var w = element.clientWidth;\n            var h = element.clientHeight;\n            while (element && element != parent) {\n                xPosition += (element.offsetLeft - element.scrollLeft + element.clientLeft);\n                yPosition += (element.offsetTop - element.scrollTop + element.clientTop);\n                element = element.offsetParent;\n            }\n            return { x: xPosition, y: yPosition, width: w, height: h };\n        }\n        UI.offsetFrom = offsetFrom;\n        var EventTracker = (function () {\n            /**\n             * @class WinJSContrib.UI.EventTracker\n             * @classdesc object to register and release events from addEventListener or bind\n             */\n            function EventTracker() {\n                this.events = [];\n            }\n            /**\n             * register an event from an object\n             * @function WinJSContrib.UI.EventTracker.prototype.addEvent\n             * @param {Object} e object containing addEventListener\n             * @param {string} eventName name of the event\n             * @param {function} handler\n             * @param {boolean} capture\n             * @returns {function} function to call for unregistering the event\n             */\n            EventTracker.prototype.addEvent = function (e, eventName, handler, capture) {\n                var tracker = this;\n                e.addEventListener(eventName, handler, capture);\n                var unregister = function () {\n                    try {\n                        e.removeEventListener(eventName, handler);\n                        var idx = tracker.events.indexOf(unregister);\n                        if (idx >= 0) {\n                            tracker.events.splice(idx, 1);\n                        }\n                    }\n                    catch (exception) {\n                        console.error('unexpected error while releasing callback ' + exception.message);\n                    }\n                };\n                this.events.push(unregister);\n                return unregister;\n            };\n            /**\n             * register binding event\n             * @function WinJSContrib.UI.EventTracker.prototype.addBinding\n             * @param {Object} e object containing bind method\n             * @param {string} eventName name of the binding event\n             * @param {function} handler\n             */\n            EventTracker.prototype.addBinding = function (e, eventName, handler) {\n                e.bind(eventName, handler);\n                var unregister = function () {\n                    e.unbind(eventName, handler);\n                };\n                this.events.push(unregister);\n                return unregister;\n            };\n            /**\n             * release all registered events\n             * @function WinJSContrib.UI.EventTracker.prototype.dispose\n             */\n            EventTracker.prototype.dispose = function () {\n                for (var i = 0; i < this.events.length; i++) {\n                    this.events[i]();\n                }\n                this.events = [];\n            };\n            return EventTracker;\n        })();\n        UI.EventTracker = EventTracker;\n        /**\n         * open all appbars\n         * @function WinJSContrib.UI.appbarsOpen\n         */\n        function appbarsOpen() {\n            var res = document.querySelectorAll('div[data-win-control=\"WinJS.UI.AppBar\"],div[data-win-control=\"WinJS.UI.NavBar\"]');\n            if (res && res.length) {\n                for (var i = 0; i < res.length; i++) {\n                    var e = res[i];\n                    if (e.winControl) {\n                        e.winControl.show();\n                    }\n                }\n            }\n        }\n        UI.appbarsOpen = appbarsOpen;\n        /**\n         * close all appbars\n         * @function WinJSContrib.UI.appbarsClose\n         */\n        function appbarsClose() {\n            var res = document.querySelectorAll('div[data-win-control=\"WinJS.UI.AppBar\"],div[data-win-control=\"WinJS.UI.NavBar\"]');\n            if (res && res.length) {\n                for (var i = 0; i < res.length; i++) {\n                    var e = res[i];\n                    if (e.winControl) {\n                        e.winControl.hide();\n                    }\n                }\n            }\n        }\n        UI.appbarsClose = appbarsClose;\n        /**\n         * disable all appbars\n         * @function WinJSContrib.UI.appbarsDisable\n         */\n        function appbarsDisable() {\n            var res = document.querySelectorAll('div[data-win-control=\"WinJS.UI.AppBar\"],div[data-win-control=\"WinJS.UI.NavBar\"]');\n            if (res && res.length) {\n                for (var i = 0; i < res.length; i++) {\n                    var e = res[i];\n                    if (e.winControl) {\n                        e.winControl.disabled = true;\n                    }\n                }\n            }\n        }\n        UI.appbarsDisable = appbarsDisable;\n        /**\n         * enable all appbars\n         * @function WinJSContrib.UI.appbarsEnable\n         */\n        function appbarsEnable() {\n            var elements = document.querySelectorAll('div[data-win-control=\"WinJS.UI.AppBar\"],div[data-win-control=\"WinJS.UI.NavBar\"]');\n            if (elements && elements.length) {\n                for (var i = 0, l = elements.length; i < l; i++) {\n                    var el = elements[i];\n                    if (el.winControl) {\n                        el.winControl.disabled = false;\n                    }\n                }\n            }\n        }\n        UI.appbarsEnable = appbarsEnable;\n        /**\n         * build a promise around element \"load\" event (work for all element with src property like images, iframes, ...)\n         * @function WinJSContrib.UI.elementLoaded\n         * @param {HTMLElement} element\n         * @param {string} url url used to feed \"src\" on element\n         * @returns {WinJS.Promise}\n         */\n        function elementLoaded(elt, url) {\n            return new WinJS.Promise(function (complete, error) {\n                function onerror(e) {\n                    elt.onload = undefined;\n                    elt.onerror = undefined;\n                    elt.onreadystatechange = undefined;\n                    error('element not loaded');\n                }\n                function onload(e) {\n                    elt.onload = undefined;\n                    elt.onerror = undefined;\n                    elt.onreadystatechange = undefined;\n                    complete({\n                        element: elt,\n                        url: url\n                    });\n                }\n                elt.onerror = onerror;\n                elt.onload = onload;\n                elt.onreadystatechange = onload;\n                if (elt.naturalWidth > 0) {\n                    onload(undefined);\n                }\n                elt.src = url;\n            });\n        }\n        UI.elementLoaded = elementLoaded;\n        /**\n         * Create a promise for getting an image object from url\n         * @function WinJSContrib.UI.loadImage\n         * @param {string} imgUrl url for the picture\n         * @returns {WinJS.Promise}\n         */\n        function loadImage(imgUrl) {\n            return new WinJS.Promise(function (complete, error) {\n                var image = new Image();\n                function onerror(e) {\n                    image.onload = undefined;\n                    image.onerror = undefined;\n                    error({ message: 'image not loaded : ' + imgUrl, path: imgUrl });\n                }\n                function onload(e) {\n                    image.onload = undefined;\n                    image.onerror = undefined;\n                    complete({\n                        element: image,\n                        url: imgUrl\n                    });\n                }\n                image.onerror = onerror;\n                image.onload = onload;\n                if (image.naturalWidth > 0) {\n                    onload(undefined);\n                }\n                image.src = imgUrl;\n            });\n        }\n        UI.loadImage = loadImage;\n        /**\n         * List all elements found after provided element\n         * @function WinJSContrib.UI.listElementsAfterMe\n         * @param {HTMLElement} elt target element\n         * @returns {Array} list of sibling elements\n         */\n        function listElementsAfterMe(elt) {\n            var res = [];\n            var passed = false;\n            if (elt.parentElement) {\n                var parent = elt.parentElement;\n                for (var i = 0; i < parent.children.length; i++) {\n                    if (parent.children[i] === elt) {\n                        passed = true;\n                    }\n                    else if (passed) {\n                        res.push(parent.children[i]);\n                    }\n                }\n            }\n            return res;\n        }\n        UI.listElementsAfterMe = listElementsAfterMe;\n        /**\n         * create an animation for removing an element from a list\n         * @function WinJSContrib.UI.removeElementAnimation\n         * @param {HTMLElement} element that will be removed\n         * @returns {WinJS.Promise}\n         */\n        function removeElementAnimation(elt) {\n            return new WinJS.Promise(function (complete, error) {\n                var remainings = WinJSContrib.UI.listElementsAfterMe(elt);\n                var anim = WinJS.UI.Animation.createDeleteFromListAnimation([\n                    elt\n                ], remainings);\n                elt.style.position = \"fixed\";\n                elt.style.opacity = '0';\n                anim.execute().done(function () {\n                    complete(elt);\n                });\n            });\n        }\n        UI.removeElementAnimation = removeElementAnimation;\n        function bindAction(el, element, control) {\n            el.classList.add('page-action');\n            var actionName = el.dataset.pageAction || el.getAttribute('tap');\n            var action = control[actionName];\n            if (action && typeof action === 'function') {\n                WinJSContrib.UI.tap(el, function (eltarg) {\n                    var p = WinJS.Promise.wrap();\n                    var actionArgs = eltarg.dataset.pageActionArgs || el.getAttribute('tap-args');\n                    if (actionArgs && typeof actionArgs == 'string') {\n                        var tmp = WinJSContrib.Utils.readValue(eltarg, actionArgs);\n                        p = WinJS.Promise.as(tmp).then(function (val) {\n                            if (typeof val === 'string') {\n                                try {\n                                    val = WinJS.UI.optionsParser(val, window);\n                                }\n                                catch (exception) {\n                                    return;\n                                }\n                            }\n                            return val;\n                        });\n                        if (tmp) {\n                            actionArgs = tmp;\n                        }\n                        else {\n                        }\n                    }\n                    return p.then(function () {\n                        return control[actionName].bind(control)({ elt: eltarg, args: actionArgs });\n                    });\n                });\n            }\n        }\n        /**\n         * setup declarative binding to parent control function. It looks for \"data-page-action\" attributes,\n         * and try to find a matching method on the supplyed control.\n         * You could add arguments with a \"page-action-args\" attribute. The argument can be an object or a function\n         * @function WinJSContrib.UI.bindPageActions\n         * @param {HTMLElement} element root node crawled for page actions\n         * @param {Object} control control owning functions to call\n         */\n        function bindPageActions(element, control) {\n            var elements = element.querySelectorAll('*[data-page-action], *[tap]');\n            if (elements && elements.length) {\n                for (var i = 0, l = elements.length; i < l; i++) {\n                    var el = elements[i];\n                    bindAction(el, element, control);\n                }\n            }\n        }\n        UI.bindPageActions = bindPageActions;\n        function bindLink(el, element) {\n            el.classList.add('page-link');\n            var applink = el.getAttribute('applink');\n            var target = el.dataset.pageLink || el.getAttribute('linkto');\n            if (target && target.indexOf('/') < 0) {\n                var tmp = WinJSContrib.Utils.readProperty(window, target);\n                if (tmp) {\n                    target = tmp;\n                }\n            }\n            if (target) {\n                var options = el.dataset.pageActionOptions || el.getAttribute('tap-options');\n                if (options) {\n                    try {\n                        options = WinJS.UI.optionsParser(options, window);\n                    }\n                    catch (exception) {\n                        return;\n                    }\n                }\n                WinJSContrib.UI.tap(el, function (eltarg) {\n                    var p = WinJS.Promise.wrap();\n                    var actionArgs = eltarg.dataset.pageActionArgs || el.getAttribute('linkto-args');\n                    if (actionArgs && typeof actionArgs == 'string') {\n                        var tmp = WinJSContrib.Utils.readValue(eltarg, actionArgs);\n                        p = WinJS.Promise.as(tmp).then(function (val) {\n                            if (typeof val === 'string') {\n                                try {\n                                    val = WinJS.UI.optionsParser(val, window);\n                                }\n                                catch (exception) {\n                                }\n                            }\n                            return val;\n                        });\n                    }\n                    return p.then(function (actionArgs) {\n                        if (!applink && WinJSContrib.UI.parentNavigator && WinJSContrib.UI.parentNavigator(eltarg)) {\n                            var nav = WinJSContrib.UI.parentNavigator(eltarg);\n                            return nav.navigate(target, actionArgs);\n                        }\n                        else {\n                            return WinJS.Navigation.navigate(target, actionArgs);\n                        }\n                    });\n                }, options);\n            }\n        }\n        /**\n         * setup declarative binding to page link. It looks for \"data-page-link\" attributes.\n         * If any the content of the attribute point toward a page. clicking that element will navigate to that page.\n         * You could add arguments with a \"page-action-args\" attribute. The argument can be an object or a function\n         * @function WinJSContrib.UI.bindPageLinks\n         * @param {HTMLElement} element root node crawled for page actions\n         */\n        function bindPageLinks(element) {\n            var elements = element.querySelectorAll('*[data-page-link], *[linkto]');\n            if (elements && elements.length) {\n                for (var i = 0, l = elements.length; i < l; i++) {\n                    var el = elements[i];\n                    bindLink(el, element);\n                }\n            }\n        }\n        UI.bindPageLinks = bindPageLinks;\n        function parentNavigator(element) {\n            var current = element.parentNode;\n            while (current) {\n                if (current.mcnNavigator) {\n                    return current.winControl;\n                }\n                current = current.parentNode;\n            }\n        }\n        UI.parentNavigator = parentNavigator;\n        function bindMember(el, element, control) {\n            el.classList.add('page-member');\n            var memberName = el.dataset.pageMember || el.getAttribute('member');\n            if (!memberName)\n                memberName = el.id;\n            if (memberName && !control[memberName]) {\n                control[memberName] = el;\n                if (el.winControl) {\n                    control[memberName] = el.winControl;\n                }\n            }\n        }\n        /**\n         * Add this element or control as member to the control. It looks for \"data-page-member\" attributes. If attribute is empty, it tooks the element id as member name.\n         * @function WinJSContrib.UI.bindMembers\n         * @param {HTMLElement} element root node crawled for page actions\n         * @param {Object} control control owning functions to call\n         */\n        function bindMembers(element, control) {\n            var elements = element.querySelectorAll('*[data-page-member], *[member]');\n            if (elements && elements.length) {\n                for (var i = 0, l = elements.length; i < l; i++) {\n                    var el = elements[i];\n                    bindMember(el, element, control);\n                }\n            }\n        }\n        UI.bindMembers = bindMembers;\n        /**\n         * setup declarative binding to parent control function and to navigation links. It internally invoke both {@link WinJSContrib.UI.bindPageActions} and {@link WinJSContrib.UI.bindPageLinks}\n         * @function WinJSContrib.UI.bindActions\n         * @param {HTMLElement} element root node crawled for page actions\n         * @param {Object} control control owning functions to call\n         */\n        function bindActions(element, control) {\n            WinJSContrib.UI.bindPageActions(element, control);\n            WinJSContrib.UI.bindPageLinks(element);\n        }\n        UI.bindActions = bindActions;\n        /**\n         * Trigger events on media queries. This class is usefull as a component for other controls to change some properties based on media queries\n         * @class WinJSContrib.UI.MediaTrigger\n         * @param {Object} items object containing one property for each query\n         * @param {Object} linkedControl control linked to media trigger\n         */\n        var MediaTrigger = (function () {\n            function MediaTrigger(items, linkedControl) {\n                var ctrl = this;\n                ctrl.queries = [];\n                ctrl.linkedControl = linkedControl;\n                for (var name in items) {\n                    var e = items[name];\n                    if (e.query) {\n                        ctrl.registerMediaEvent(name, e.query, e);\n                    }\n                }\n            }\n            /**\n             * @function WinJSContrib.UI.MediaTrigger.prototype.dispose\n             * release media trigger\n             */\n            MediaTrigger.prototype.dispose = function () {\n                var ctrl = this;\n                ctrl.linkedControl = null;\n                this.queries.forEach(function (q) {\n                    q.dispose();\n                });\n            };\n            /**\n             * register an event from a media query\n             * @function WinJSContrib.UI.MediaTrigger.prototype.registerMediaEvent\n             * @param {string} name event name\n             * @param {string} query media query\n             * @param {Object} data data associated with this query\n             */\n            MediaTrigger.prototype.registerMediaEvent = function (name, query, data) {\n                var ctrl = this;\n                var mq = window.matchMedia(query);\n                var internalQuery = {\n                    name: name,\n                    query: query,\n                    data: data,\n                    mq: mq,\n                    dispose: null\n                };\n                var f = function (arg) {\n                    if (arg.matches) {\n                        ctrl._mediaEvent(arg, internalQuery);\n                    }\n                };\n                mq.addListener(f);\n                internalQuery.dispose = function () {\n                    mq.removeListener(f);\n                };\n                ctrl.queries.push(internalQuery);\n            };\n            MediaTrigger.prototype._mediaEvent = function (arg, query) {\n                var ctrl = this;\n                if (ctrl.linkedControl) {\n                    WinJS.UI.setOptions(ctrl.linkedControl, query.data);\n                }\n                ctrl.dispatchEvent('media', query);\n            };\n            /**\n             * @function WinJSContrib.UI.MediaTrigger.prototype.check\n             * Check all registered queries\n             */\n            MediaTrigger.prototype.check = function () {\n                var ctrl = this;\n                ctrl.queries.forEach(function (q) {\n                    var mq = window.matchMedia(q.query);\n                    if (mq.matches) {\n                        ctrl._mediaEvent({ matches: true }, q);\n                    }\n                });\n            };\n            /**\n             * Adds an event listener to the control.\n             * @function WinJSContrib.UI.MediaTrigger.prototype.addEventListener\n             * @param type The type (name) of the event.\n             * @param listener The listener to invoke when the event gets raised.\n             * @param useCapture If true, initiates capture, otherwise false.\n            **/\n            MediaTrigger.prototype.addEventListener = function (type, listener, useCapture) {\n            };\n            /**\n             * Raises an event of the specified type and with the specified additional properties.\n             * @function WinJSContrib.UI.MediaTrigger.prototype.dispatchEvent\n             * @param type The type (name) of the event.\n             * @param eventProperties The set of additional properties to be attached to the event object when the event is raised.\n             * @returns true if preventDefault was called on the event.\n            **/\n            MediaTrigger.prototype.dispatchEvent = function (type, eventProperties) {\n                return false;\n            };\n            /**\n             * Removes an event listener from the control.\n             * @function WinJSContrib.UI.MediaTrigger.prototype.removeEventListener\n             * @param type The type (name) of the event.\n             * @param listener The listener to remove.\n             * @param useCapture true if capture is to be initiated, otherwise false.\n            **/\n            MediaTrigger.prototype.removeEventListener = function (type, listener, useCapture) { };\n            return MediaTrigger;\n        })();\n        UI.MediaTrigger = MediaTrigger;\n        WinJS.Class.mix(WinJSContrib.UI.MediaTrigger, WinJS.Utilities.eventMixin);\n        /**\n         * register navigation related events like hardware backbuttons. This method keeps track of previously registered navigation handlers\n         *  and disable them until the latests is closed, enablinh multi-level navigation.\n         * @function WinJSContrib.UI.registerNavigationEvents\n         * @param {Object} control control taking ownership of navigation handlers\n         * @param {function} callback callback to invoke when \"back\" is requested\n         * @returns {function} function to call for releasing navigation handlers\n         */\n        var registeredNavigationStack = [];\n        function registerNavigationEvents(control, callback) {\n            var locked = [];\n            var registration = { control: control, callback: callback };\n            registeredNavigationStack.push(registration);\n            //control.navLocks = control.navLocks || [];\n            //control.navLocks.isActive = true;\n            var backhandler = function (arg) {\n                var idx = registeredNavigationStack.indexOf(registration);\n                if (idx === registeredNavigationStack.length - 1) {\n                    registration.callback.bind(registration.control)(arg);\n                    idx--;\n                    while (idx >= 0 && !arg.handled) {\n                        var tmp = registeredNavigationStack[idx];\n                        tmp.callback.bind(tmp.control)(arg);\n                        idx--;\n                    }\n                }\n                //if (!control.navLocks || control.navLocks.length === 0) {\n                //    callback.bind(control)(arg);\n                //}\n            };\n            //var navcontrols = document.querySelectorAll('.mcn-navigation-ctrl');\n            //for (var i = 0; i < navcontrols.length; i++) {\n            //    var navigationCtrl = (<any>navcontrols[i]).winControl;\n            //    if (navigationCtrl && navigationCtrl != control) {\n            //        navigationCtrl.navLocks = navigationCtrl.navLocks || [];\n            //        if (navigationCtrl.navLocks.isActive && (!navigationCtrl.navLocks.length || navigationCtrl.navLocks.indexOf(control) < 0)) {\n            //            navigationCtrl.navLocks.push(control);\n            //            locked.push(navigationCtrl);\n            //        }\n            //    }\n            //}\n            function cancelNavigation(args) {\n                //this.eventTracker.addEvent(nav, 'beforenavigate', this._beforeNavigate.bind(this));\n                var p = new WinJS.Promise(function (c) { });\n                args.detail.setPromise(p);\n                //setImmediate(function () {\n                p.cancel();\n                //});\n            }\n            WinJS.Navigation.addEventListener('beforenavigate', cancelNavigation);\n            if (window.Windows && window.Windows.Phone)\n                window.Windows.Phone.UI.Input.HardwareButtons.addEventListener(\"backpressed\", backhandler);\n            else\n                document.addEventListener(\"backbutton\", backhandler);\n            var keypress = function (args) {\n                if (args.key === \"Esc\" || args.key === \"Backspace\") {\n                    backhandler(args);\n                }\n            };\n            document.body.addEventListener('keypress', keypress);\n            if (WinJSContrib.UI.Application && WinJSContrib.UI.Application.navigator)\n                WinJSContrib.UI.Application.navigator.addLock();\n            return function () {\n                if (WinJSContrib.UI.Application && WinJSContrib.UI.Application.navigator)\n                    WinJSContrib.UI.Application.navigator.removeLock();\n                //control.navLocks.isActive = false;\n                //locked.forEach(function (navigationCtrl) {\n                //    var idx = navigationCtrl.navLocks.indexOf(control);\n                //    if (idx >= 0)\n                //        navigationCtrl.navLocks.splice(idx, 1);\n                //});\n                var idx = registeredNavigationStack.indexOf(registration);\n                registeredNavigationStack.splice(idx, 1);\n                document.body.removeEventListener('keypress', keypress);\n                WinJS.Navigation.removeEventListener('beforenavigate', cancelNavigation);\n                if (window.Windows && window.Windows.Phone)\n                    window.Windows.Phone.UI.Input.HardwareButtons.removeEventListener(\"backpressed\", backhandler);\n                else\n                    document.removeEventListener(\"backbutton\", backhandler);\n            };\n        }\n        UI.registerNavigationEvents = registerNavigationEvents;\n        /**\n         * remove tap behavior\n         * @function WinJSContrib.UI.untap\n         * @param {HtmlElement} element element to clean\n         */\n        function untap(element) {\n            if (!element)\n                return;\n            if (element.mcnTapTracking) {\n                element.mcnTapTracking.dispose();\n                element.mcnTapTracking = null;\n            }\n        }\n        UI.untap = untap;\n        /**\n         * remove tap behavior from all childs\n         * @function WinJSContrib.UI.untapAll\n         * @param {HtmlElement} element element to clean\n         */\n        function untapAll(element) {\n            if (!element)\n                return;\n            var taps = element.querySelectorAll('.tap');\n            for (var i = 0, l = taps.length; i < l; i++) {\n                untap(taps[i]);\n            }\n        }\n        UI.untapAll = untapAll;\n        UI.defaultTapBehavior = {\n            animDown: WinJS.UI.Animation.pointerDown,\n            animUp: WinJS.UI.Animation.pointerUp,\n            disableAnimation: false,\n            awaitAnim: false,\n            errorDelay: 3000\n        };\n        /**\n         * add tap behavior to an element, tap manages quirks like click delay, visual feedback, etc\n         * @function WinJSContrib.UI.tap\n         * @param {HtmlElement} element element to make \"tappable\"\n         * @param {function} callback callback function invoked on tap\n         * @param {Object} options tap options\n         */\n        function tap(element, callback, options) {\n            if (!element)\n                return;\n            var ptDown = function (event) {\n                var elt = event.currentTarget || event.target;\n                var tracking = elt.mcnTapTracking;\n                if (tracking && (event.button === undefined || event.button === 0 || (tracking.allowRickClickTap && event.button === 2))) {\n                    if (tracking.lock) {\n                        if (event.pointerId && event.currentTarget.setPointerCapture)\n                            event.currentTarget.setPointerCapture(event.pointerId);\n                        event.stopPropagation();\n                        event.preventDefault();\n                    }\n                    WinJS.Utilities.addClass(elt, 'tapped');\n                    WinJS.Utilities.removeClass(elt, 'tap-error');\n                    clearTimeout(tracking.pendingErrorTimeout);\n                    if (event.changedTouches) {\n                        tracking.pointerdown = { x: event.changedTouches[0].clientX, y: event.changedTouches[0].clientY };\n                    }\n                    else {\n                        tracking.pointerdown = { x: event.clientX, y: event.clientY };\n                    }\n                    tracking.animDown(event.currentTarget);\n                    if (tracking.tapOnDown) {\n                        tracking.callback(elt, event);\n                    }\n                }\n            };\n            var ptOut = function (event) {\n                var elt = event.currentTarget || event.target;\n                var tracking = elt.mcnTapTracking;\n                if (tracking && tracking.pointerdown) {\n                    WinJS.Utilities.removeClass(elt, 'tapped');\n                    if (event.pointerId && elt.releasePointerCapture) {\n                        try {\n                            elt.releasePointerCapture(event.pointerId);\n                        }\n                        catch (exception) {\n                            console.error(exception);\n                        }\n                    }\n                    if (!tracking.disableAnimation)\n                        tracking.animUp(event.currentTarget);\n                }\n            };\n            var ptUp = function (event) {\n                var elt = event.currentTarget || event.target;\n                var tracking = elt.mcnTapTracking;\n                if (tracking && (event.button === undefined || event.button === 0 || (tracking.allowRickClickTap && event.button === 2))) {\n                    if (elt.releasePointerCapture) {\n                        try {\n                            elt.releasePointerCapture(event.pointerId);\n                        }\n                        catch (exception) {\n                            console.error(exception);\n                        }\n                    }\n                    if (tracking && !tracking.tapOnDown) {\n                        event.stopPropagation();\n                        var resolveTap = function () {\n                            if (tracking && tracking.pointerdown) {\n                                if (event.changedTouches) {\n                                    var dX = Math.abs(tracking.pointerdown.x - event.changedTouches[0].clientX);\n                                    var dY = Math.abs(tracking.pointerdown.y - event.changedTouches[0].clientY);\n                                }\n                                else {\n                                    var dX = Math.abs(tracking.pointerdown.x - event.clientX);\n                                    var dY = Math.abs(tracking.pointerdown.y - event.clientY);\n                                }\n                                if (tracking.callback && dX < 15 && dY < 15) {\n                                    event.stopImmediatePropagation();\n                                    event.stopPropagation();\n                                    event.preventDefault();\n                                    var res = tracking.callback(elt, event);\n                                    if (WinJS.Promise.is(res)) {\n                                        elt.disabled = true;\n                                        WinJS.Utilities.addClass(elt, 'tap-working');\n                                        res.then(function () {\n                                            elt.disabled = false;\n                                            WinJS.Utilities.removeClass(elt, 'tap-working');\n                                        }, function (err) {\n                                            elt.disabled = false;\n                                            WinJS.Utilities.removeClass(elt, 'tap-working');\n                                            console.error(err);\n                                            WinJS.Utilities.addClass(elt, 'tap-error');\n                                            if (tracking.errorDelay) {\n                                                tracking.pendingErrorTimeout = setTimeout(function () {\n                                                    tracking.pendingErrorTimeout = null;\n                                                    WinJS.Utilities.removeClass(elt, 'tap-error');\n                                                }, tracking.errorDelay);\n                                            }\n                                        });\n                                    }\n                                }\n                                if (tracking && tracking.pointerdown)\n                                    tracking.pointerdown = undefined;\n                            }\n                        };\n                        if (tracking.awaitAnim) {\n                            tracking.animUp(elt).done(resolveTap);\n                        }\n                        else {\n                            tracking.animUp(elt);\n                            resolveTap();\n                        }\n                    }\n                    WinJS.Utilities.removeClass(elt, 'tapped');\n                }\n            };\n            if (!options) {\n                var attroptions = element.getAttribute('tap-options');\n                if (attroptions) {\n                    try {\n                        options = WinJS.UI.optionsParser(attroptions, window);\n                    }\n                    catch (exception) {\n                        return;\n                    }\n                }\n            }\n            var opt = options || {};\n            if (element.mcnTapTracking) {\n                element.mcnTapTracking.dispose();\n            }\n            WinJS.Utilities.addClass(element, 'tap');\n            element.mcnTapTracking = element.mcnTapTracking || {};\n            element.mcnTapTracking.eventTracker = new WinJSContrib.UI.EventTracker();\n            element.mcnTapTracking.disableAnimation = opt.disableAnimation || UI.defaultTapBehavior.disableAnimation;\n            if (element.mcnTapTracking.disableAnimation) {\n                element.mcnTapTracking.animDown = function () { return WinJS.Promise.wrap(); };\n                element.mcnTapTracking.animUp = function () { return WinJS.Promise.wrap(); };\n            }\n            else {\n                element.mcnTapTracking.animDown = opt.animDown || UI.defaultTapBehavior.animDown;\n                element.mcnTapTracking.animUp = opt.animUp || UI.defaultTapBehavior.animUp;\n            }\n            element.mcnTapTracking.element = element;\n            element.mcnTapTracking.callback = callback;\n            element.mcnTapTracking.lock = opt.lock;\n            element.mcnTapTracking.awaitAnim = opt.awaitAnim || UI.defaultTapBehavior.awaitAnim;\n            element.mcnTapTracking.errorDelay = opt.errorDelay || UI.defaultTapBehavior.errorDelay;\n            element.mcnTapTracking.tapOnDown = opt.tapOnDown;\n            element.mcnTapTracking.pointerModel = 'none';\n            element.mcnTapTracking.dispose = function () {\n                WinJS.Utilities.removeClass(element, 'tap');\n                this.eventTracker.dispose();\n                element.mcnTapTracking = null;\n                element = null;\n            };\n            if (element.onpointerdown !== undefined) {\n                element.mcnTapTracking.pointerModel = 'pointers';\n                element.mcnTapTracking.eventTracker.addEvent(element, 'pointerdown', ptDown);\n                element.mcnTapTracking.eventTracker.addEvent(element, 'pointerout', ptOut);\n                element.mcnTapTracking.eventTracker.addEvent(element, 'pointerup', ptUp);\n            }\n            else if (window.Touch && !opt.noWebkitTouch) {\n                element.mcnTapTracking.pointerModel = 'touch';\n                element.mcnTapTracking.eventTracker.addEvent(element, 'touchstart', function (arg) {\n                    element.mcnTapTracking.cancelMouse = true;\n                    ptDown(arg);\n                });\n                element.mcnTapTracking.eventTracker.addEvent(element, 'touchcancel', function (arg) {\n                    setTimeout(function () {\n                        element.mcnTapTracking.cancelMouse = false;\n                    }, 1000);\n                    ptOut(arg);\n                });\n                element.mcnTapTracking.eventTracker.addEvent(element, 'touchend', function (arg) {\n                    setTimeout(function () {\n                        element.mcnTapTracking.cancelMouse = false;\n                    }, 1000);\n                    ptUp(arg);\n                });\n                element.mcnTapTracking.eventTracker.addEvent(element, 'mousedown', function (arg) {\n                    if (!element.mcnTapTracking.cancelMouse)\n                        ptDown(arg);\n                });\n                element.mcnTapTracking.eventTracker.addEvent(element, 'mouseleave', function (arg) {\n                    ptOut(arg);\n                });\n                element.mcnTapTracking.eventTracker.addEvent(element, 'mouseup', function (arg) {\n                    if (!element.mcnTapTracking.cancelMouse)\n                        ptUp(arg);\n                    else\n                        ptOut(arg);\n                });\n            }\n            else {\n                element.mcnTapTracking.pointerModel = 'mouse';\n                element.mcnTapTracking.eventTracker.addEvent(element, 'mousedown', ptDown);\n                element.mcnTapTracking.eventTracker.addEvent(element, 'mouseleave', ptOut);\n                element.mcnTapTracking.eventTracker.addEvent(element, 'mouseup', ptUp);\n            }\n        }\n        UI.tap = tap;\n        /**\n         * return a promise completed after css transition on the element is ended\n         * @function WinJSContrib.UI.afterTransition\n         * @param {HtmlElement} element element to watch\n         * @param {number} timeout timeout\n         */\n        function afterTransition(element, timeout) {\n            var timeOutRef = null;\n            return new WinJS.Promise(function (complete, error) {\n                var onaftertransition = function (event) {\n                    if (event.srcElement === element) {\n                        close();\n                    }\n                };\n                var close = function () {\n                    clearTimeout(timeOutRef);\n                    element.removeEventListener(\"transitionend\", onaftertransition, false);\n                    complete();\n                };\n                element.addEventListener(\"transitionend\", onaftertransition, false);\n                timeOutRef = setTimeout(close, timeout || 1000);\n            });\n        }\n        UI.afterTransition = afterTransition;\n        /**\n         * Utility class for building DOM elements through code with a fluent API\n         * @class WinJSContrib.UI.FluentDOM\n         * @param {string} nodeType type of DOM node (ex: 'DIV')\n         * @param className css classes\n         * @param parentElt parent DOM element\n         * @param {WinJSContrib.UI.FluentDOM} parent parent FluentDOM\n         * @example\n         * var elt = new WinJSContrib.UI.FluentDOM('DIV', 'item-content')\n         *    .text(item.title)\n         *    .display('none')\n         *    .element;\n         */\n        var FluentDOM = (function () {\n            function FluentDOM(nodeType, className, parentElt, parent) {\n                this.element = document.createElement(nodeType);\n                if (className)\n                    this.element.className = className;\n                if (parentElt)\n                    parentElt.appendChild(this.element);\n                this.parent = parent;\n                this.childs = [];\n                if (parent) {\n                    parent.childs.push(this);\n                }\n            }\n            FluentDOM.for = function (element) {\n                var res = new FluentDOM(null);\n                res.element = element;\n                return res;\n            };\n            FluentDOM.fragment = function () {\n                var res = new FluentDOM(null);\n                res.element = document.createDocumentFragment();\n                return res;\n            };\n            Object.defineProperty(FluentDOM.prototype, \"control\", {\n                get: function () {\n                    return this.element.winControl;\n                },\n                enumerable: true,\n                configurable: true\n            });\n            /**\n             * Add a css class\n             * @function WinJSContrib.UI.FluentDOM.prototype.addClass\n             * @param classname css class\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.addClass = function (classname) {\n                this.element.classList.add(classname);\n                return this;\n            };\n            /**\n             * set className\n             * @function WinJSContrib.UI.FluentDOM.prototype.className\n             * @param classname css classes\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.className = function (classname) {\n                this.element.className = classname;\n                return this;\n            };\n            /**\n             * set opacity\n             * @function WinJSContrib.UI.FluentDOM.prototype.opacity\n             * @param opacity opacity\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.opacity = function (opacity) {\n                this.element.style.opacity = opacity;\n                return this;\n            };\n            /**\n             * set display\n             * @function WinJSContrib.UI.FluentDOM.prototype.display\n             * @param display display\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.display = function (display) {\n                this.element.style.display = display;\n                return this;\n            };\n            /**\n             * set display 'none'\n             * @function WinJSContrib.UI.FluentDOM.prototype.hide\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.hide = function () {\n                this.element.style.display = 'none';\n                return this;\n            };\n            /**\n             * set visibility\n             * @function WinJSContrib.UI.FluentDOM.prototype.visibility\n             * @param visibility visibility\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.visibility = function (visibility) {\n                this.element.style.visibility = visibility;\n                return this;\n            };\n            /**\n             * set textContent\n             * @function WinJSContrib.UI.FluentDOM.prototype.text\n             * @param text text\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.text = function (text) {\n                this.element.textContent = text;\n                return this;\n            };\n            /**\n             * set innerHTML\n             * @function WinJSContrib.UI.FluentDOM.prototype.html\n             * @param text text\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.html = function (text) {\n                this.element.innerHTML = text;\n                return this;\n            };\n            /**\n             * set attribute\n             * @function WinJSContrib.UI.FluentDOM.prototype.attr\n             * @param name attribute name\n             * @param val attribute value\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.attr = function (name, val) {\n                this.element.setAttribute(name, val);\n                return this;\n            };\n            /**\n             * set style property\n             * @function WinJSContrib.UI.FluentDOM.prototype.style\n             * @param name attribute name\n             * @param val attribute value\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.style = function (name, val) {\n                this.element.style[name] = val;\n                return this;\n            };\n            /**\n             * set style property\n             * @function WinJSContrib.UI.FluentDOM.prototype.style\n             * @param name attribute name\n             * @param val attribute value\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.styles = function (obj) {\n                var st = this.element.style;\n                var keys = Object.keys(obj);\n                keys.forEach(function (k) {\n                    st[k] = obj[k];\n                });\n                return this;\n            };\n            /**\n             * append element to another DOM element\n             * @function WinJSContrib.UI.FluentDOM.prototype.appendTo\n             * @param elt parent element\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.appendTo = function (elt) {\n                elt.appendChild(this.element);\n                return this;\n            };\n            /**\n             * add tap behavior\n             * @function WinJSContrib.UI.FluentDOM.prototype.tap\n             * @param callback tap callback\n             * @param options tap options\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.tap = function (callback, options) {\n                WinJSContrib.UI.tap(this.element, callback, options);\n                return this;\n            };\n            /**\n             * create a child FluentDOM and append it to current\n             * @function WinJSContrib.UI.FluentDOM.prototype.append\n             * @param nodeType child node type\n             * @param className css classes\n             * @param callback callback receiving the new FluentDOM as an argument\n             * @returns {WinJSContrib.UI.FluentDOM} current instance (for method chaining)\n             */\n            FluentDOM.prototype.append = function (nodeType, className, callback) {\n                var child = new FluentDOM(nodeType, className, this.element, this);\n                if (callback) {\n                    callback(child);\n                }\n                return this;\n            };\n            /**\n             * create a child FluentDOM and append it to current\n             * @function WinJSContrib.UI.FluentDOM.prototype.createChild\n             * @param nodeType child node type\n             * @param className css classes\n             * @returns {WinJSContrib.UI.FluentDOM} child FluentDOM\n             */\n            FluentDOM.prototype.createChild = function (nodeType, className) {\n                var child = new FluentDOM(nodeType, className, this.element, this);\n                return child;\n            };\n            /**\n             * create a WinJS control\n             * @function WinJSContrib.UI.FluentDOM.prototype.ctrl\n             * @param ctrl constructor or full name of the control\n             * @param options control options\n             * @returns {WinJSContrib.UI.FluentDOM}\n             */\n            FluentDOM.prototype.ctrl = function (ctrl, options) {\n                var ctor = ctrl;\n                if (typeof ctrl === 'string')\n                    ctor = WinJSContrib.Utils.readProperty(window, ctrl);\n                if (ctor) {\n                    new ctor(this.element, options);\n                }\n                return this;\n            };\n            return FluentDOM;\n        })();\n        UI.FluentDOM = FluentDOM;\n    })(UI = WinJSContrib.UI || (WinJSContrib.UI = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\nvar __global = this;\nvar profiler = __global.msWriteProfilerMark || function () { };\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var UI;\n    (function (UI) {\n        var Pages;\n        (function (Pages) {\n            /**\n             * List of mixins to apply to each fragment managed by WinJS Contrib (through navigator or by calling explicitely {@link WinJSContrib.UI.Pages.fragmentMixin}).\n             * @field WinJSContrib.UI.Pages.defaultFragmentMixins\n             * @type {Array}\n             */\n            Pages.defaultFragmentMixins = [{\n                    $: function (selector) {\n                        return $(selector, this.element || this._element);\n                    },\n                    q: function (selector) {\n                        if (!this.element)\n                            return;\n                        return this.element.querySelector(selector);\n                    },\n                    qAll: function (selector) {\n                        if (!this.element)\n                            return;\n                        var res = this.element.querySelectorAll(selector);\n                        if (res && !res.forEach) {\n                            res = [].slice.call(res);\n                        }\n                        return res;\n                    },\n                },\n                {\n                    dispose: function () {\n                        if (this._promises) {\n                            this.cancelPromises();\n                            this._promises = null;\n                        }\n                    },\n                    promises: {\n                        configurable: true,\n                        get: function () {\n                            if (!this._promises)\n                                this._promises = [];\n                            return this._promises;\n                        }\n                    },\n                    addPromise: function (prom) {\n                        this.promises.push(prom);\n                        return prom;\n                    },\n                    cancelPromises: function () {\n                        var page = this;\n                        if (page.promises) {\n                            for (var i = 0; i < page.promises.length; i++) {\n                                if (page.promises[i]) {\n                                    page.promises[i].cancel();\n                                }\n                            }\n                            page.promises = [];\n                        }\n                    }\n                },\n                {\n                    dispose: function () {\n                        if (this._eventTracker) {\n                            this._eventTracker.dispose();\n                            this._eventTracker = null;\n                        }\n                    },\n                    eventTracker: {\n                        configurable: true,\n                        get: function () {\n                            if (!this._eventTracker)\n                                this._eventTracker = new WinJSContrib.UI.EventTracker();\n                            return this._eventTracker;\n                        }\n                    }\n                }];\n            function broadcast(ctrl, element, eventName, args, before, after) {\n                var promises = [];\n                if (before)\n                    promises.push(WinJS.Promise.as(before.apply(ctrl, args)));\n                var query = element.querySelectorAll(\".mcn-layout-ctrl\");\n                if (query && query.length) {\n                    var index = 0;\n                    var length = query.length;\n                    while (index < length) {\n                        var childctrl = query[index];\n                        if (childctrl) {\n                            var event = childctrl.winControl[eventName];\n                            if (event) {\n                                if (childctrl.winControl.pageLifeCycle) {\n                                    promises.push(childctrl.winControl.pageLifeCycle.steps.layout.promise);\n                                }\n                                else {\n                                    promises.push(WinJS.Promise.as(event.apply(childctrl.winControl, args)));\n                                }\n                            }\n                        }\n                        // Skip descendants\n                        if (childctrl && childctrl.winControl && childctrl.winControl.pageLifeCycle) {\n                            index += childctrl.querySelectorAll(\".mcn-fragment, .mcn-layout-ctrl\").length + 1;\n                            childctrl.winControl.__checkLayout();\n                        }\n                        else {\n                            index += 1;\n                        }\n                    }\n                    //if (after)\n                    //    promises.push(WinJS.Promise.as(after.apply(ctrl, args)));\n                    return WinJS.Promise.join(promises).then(function () {\n                        if (after)\n                            return WinJS.Promise.as(after.apply(ctrl, args));\n                    });\n                }\n                else {\n                    if (after)\n                        return WinJS.Promise.as(after.apply(ctrl, args));\n                    return WinJS.Promise.wrap();\n                }\n            }\n            /**\n             * render a html fragment with winjs contrib pipeline and properties, and add WinJS Contrib page events.\n             * @function WinJSContrib.UI.Pages.renderFragment\n             * @param {HTMLElement} container element that will contain the fragment\n             * @param {string} location url for the fragment\n             * @param {Object} args arguments to the fragment\n             * @param {Object} options rendering options\n             */\n            function renderFragment(container, location, args, options) {\n                var fragmentCompleted;\n                var fragmentError;\n                options = options || {};\n                var element = document.createElement(\"div\");\n                element.setAttribute(\"dir\", __global.getComputedStyle(element, null).direction);\n                element.style.opacity = '0';\n                container.appendChild(element);\n                var fragmentPromise = new WinJS.Promise(function (c, e) { fragmentCompleted = c; fragmentError = e; });\n                var parented = options.parented ? WinJS.Promise.as(options.parented) : null;\n                var layoutCtrls = [];\n                var pageConstructor = WinJS.UI.Pages.get(location);\n                function preparePageControl(elementCtrl) {\n                    if (options.getFragmentElement) {\n                        options.getFragmentElement(elementCtrl);\n                    }\n                    if (args && args.injectToPage) {\n                        WinJSContrib.Utils.inject(elementCtrl, args.injectToPage);\n                    }\n                    elementCtrl.navigationState = { location: location, state: args };\n                    if (options.oncreate) {\n                        options.oncreate(elementCtrl.element, args);\n                    }\n                    if (options.oninit) {\n                        elementCtrl.pageLifeCycle.steps.init.attach(function () {\n                            return options.oninit(elementCtrl.element, args);\n                        });\n                    }\n                    if (elementCtrl.enterPageAnimation || options.enterPage) {\n                        if (elementCtrl.enterPageAnimation)\n                            elementCtrl._enterAnimation = elementCtrl.enterPageAnimation;\n                        else\n                            elementCtrl._enterAnimation = options.enterPage;\n                        elementCtrl.enterPageAnimation = function () {\n                            var page = this;\n                            var elts = null;\n                            element.style.opacity = '';\n                            if (page && page.getAnimationElements) {\n                                elts = page.getAnimationElements(false);\n                            }\n                            else {\n                                elts = page.element;\n                            }\n                            if (elts)\n                                return page._enterAnimation(elts);\n                        };\n                    }\n                    if (options.onrender) {\n                        elementCtrl.pageLifeCycle.steps.process.attach(function () {\n                            options.onrender(elementCtrl.element, args);\n                        });\n                    }\n                    if (!WinJSContrib.UI.disableAutoResources) {\n                        elementCtrl.pageLifeCycle.steps.process.attach(function () {\n                            return WinJS.Resources.processAll(element);\n                        });\n                    }\n                    if (options.closeOldPagePromise) {\n                        elementCtrl.pageLifeCycle.steps.ready.attach(function () {\n                            return options.closeOldPagePromise;\n                        });\n                    }\n                    elementCtrl.pageLifeCycle.steps.ready.attach(function () {\n                        if (options.onready)\n                            options.onready(elementCtrl.element, args);\n                        if (elementCtrl.enterPageAnimation) {\n                            return WinJS.Promise.as(elementCtrl.enterPageAnimation(element, options));\n                        }\n                        else {\n                            elementCtrl.element.style.opacity = '';\n                        }\n                    });\n                    elementCtrl.pageLifeCycle.steps.ready.promise.then(fragmentCompleted, fragmentError);\n                }\n                var elementCtrl = new pageConstructor(element, args, preparePageControl, parented);\n                return fragmentPromise;\n            }\n            Pages.renderFragment = renderFragment;\n            var PageLifeCycleStep = (function () {\n                function PageLifeCycleStep(page, stepName, parent) {\n                    var _this = this;\n                    this.queue = [];\n                    this.isDone = false;\n                    this.stepName = stepName;\n                    //this.created = new Date();\n                    this.promise = new WinJS.Promise(function (c, e) {\n                        _this._resolvePromise = c;\n                        _this._rejectPromise = e;\n                    });\n                    page.promises.push(this.promise);\n                    //if their is a parent page fragment, we attach step to synchronize page construction\n                    if (parent && parent.pageLifeCycle) {\n                        parent.pageLifeCycle.steps[stepName].attach(function () {\n                            return _this.promise;\n                        });\n                    }\n                }\n                PageLifeCycleStep.prototype.attach = function (callback) {\n                    if (this.queue && !this.isDone) {\n                        this.queue.push(callback);\n                        return this.promise;\n                    }\n                    else {\n                        return WinJS.Promise.as(callback());\n                    }\n                };\n                PageLifeCycleStep.prototype.resolve = function (arg) {\n                    var step = this;\n                    this.isDone = true;\n                    function closeStep() {\n                        //step.resolved = new Date();\n                        step._resolvePromise(arg);\n                        //console.log('resolved ' + step.stepName + '(' + (<any>step.resolved - <any>step.created) + 'ms)');\n                        return step.promise;\n                    }\n                    if (this.queue && this.queue.length) {\n                        var promises = [];\n                        this.queue.forEach(function (q) {\n                            promises.push(new WinJS.Promise(function (c, e) {\n                                try {\n                                    WinJS.Promise.as(q()).then(function (res) {\n                                        c(res);\n                                    }, e);\n                                }\n                                catch (exception) {\n                                    e(exception);\n                                }\n                            }));\n                        });\n                        this.queue = null;\n                        return WinJS.Promise.join(promises).then(function () {\n                            return closeStep();\n                        }, this.reject.bind(this));\n                    }\n                    else {\n                        this.queue = null;\n                        return closeStep();\n                    }\n                };\n                PageLifeCycleStep.prototype.reject = function (arg) {\n                    this.isDone = true;\n                    this.queue = null;\n                    this._rejectPromise(arg);\n                    return WinJS.Promise.wrapError(this.promise);\n                };\n                return PageLifeCycleStep;\n            })();\n            Pages.PageLifeCycleStep = PageLifeCycleStep;\n            (function (_Pages, _Global, _Base, _CorePages, _BaseUtils, _ElementUtilities, _WriteProfilerMark, Promise, Fragments, ControlProcessor) {\n                'use strict';\n                if (!_Global.document || !_CorePages)\n                    return;\n                var viewMap = _CorePages._viewMap || _CorePages.viewMap || {};\n                //this property allows defining mixins applyed to all pages\n                function abs(uri) {\n                    var a = _Global.document.createElement(\"a\");\n                    a.href = uri;\n                    return a.href;\n                }\n                function selfhost(uri) {\n                    return _Global.document.location.href.toLowerCase() === uri.toLowerCase();\n                }\n                var _mixinBase = {\n                    dispose: function () {\n                        /// <signature helpKeyword=\"WinJS.UI.Pages.dispose\">\n                        /// <summary locid=\"WinJS.UI.Pages.dispose\">\n                        /// Disposes this Page.\n                        /// </summary>\n                        /// </signature>\n                        if (this._disposed) {\n                            return;\n                        }\n                        this.pageLifeCycle.stop();\n                        this.pageLifeCycle = null;\n                        this._disposed = true;\n                        this.readyComplete.cancel();\n                        _ElementUtilities.disposeSubTree(this.element);\n                        this.element = null;\n                    },\n                    init: function () {\n                    },\n                    load: function (uri) {\n                        /// <signature helpKeyword=\"WinJS.UI.Pages._mixin.load\">\n                        /// <summary locid=\"WinJS.UI.Pages._mixin.load\">\n                        /// Creates a copy of the DOM elements from the specified URI.  In order for this override\n                        /// to be used, the page that contains the load override needs to be defined by calling\n                        /// WinJS.UI.Pages.define() before WinJS.UI.Pages.render() is called.\n                        /// </summary>\n                        /// <param name=\"uri\" locid=\"WinJS.UI.Pages._mixin.load_p:uri\">\n                        /// The URI from which to copy the DOM elements.\n                        /// </param>\n                        /// <returns type=\"WinJS.Promise\" locid=\"WinJS.UI.Pages._mixin.load_returnValue\">\n                        /// A promise whose fulfilled value is the set of unparented DOM elements, if asynchronous processing is necessary. If not, returns nothing.\n                        /// </returns>\n                        /// </signature>\n                        if (!this.selfhost) {\n                            return Fragments.renderCopy(abs(uri));\n                        }\n                    },\n                    process: function (element, options) {\n                        /// <signature helpKeyword=\"WinJS.UI.Pages._mixin.process\">\n                        /// <summary locid=\"WinJS.UI.Pages._mixin.process\">\n                        /// Processes the unparented DOM elements returned by load.\n                        /// </summary>\n                        /// <param name=\"element\" locid=\"WinJS.UI.Pages._mixin.process_p:element\">\n                        /// The DOM element that will contain all the content for the page.\n                        /// </param>\n                        /// <param name=\"options\" locid=\"WinJS.UI.Pages._mixin.process_p:options\">\n                        /// The options that are to be passed to the constructor of the page.\n                        /// </param>\n                        /// <returns type=\"WinJS.Promise\" locid=\"WinJS.UI.Pages._mixin.process_returnValue\">\n                        /// A promise that is fulfilled when processing is complete.\n                        /// </returns>\n                        /// </signature>\n                        return ControlProcessor.processAll(element);\n                    },\n                    processed: function (element, options) { },\n                    render: function (element, options, loadResult) {\n                        /// <signature helpKeyword=\"WinJS.UI.Pages._mixin.render\">\n                        /// <summary locid=\"WinJS.UI.Pages._mixin.render\">\n                        /// Renders the control, typically by adding the elements specified in the loadResult parameter to the specified element.\n                        /// </summary>\n                        /// <param name=\"element\" locid=\"WinJS.UI.Pages._mixin.render_p:element\">\n                        /// The DOM element that will contain all the content for the page.\n                        /// </param>\n                        /// <param name=\"options\" locid=\"WinJS.UI.Pages._mixin.render_p:options\">\n                        /// The options passed into the constructor of the page.\n                        /// </param>\n                        /// <param name=\"loadResult\" locid=\"WinJS.UI.Pages._mixin.render_p:loadResult\">\n                        /// The elements returned from the load method.\n                        /// </param>\n                        /// <returns type=\"WinJS.Promise\" locid=\"WinJS.UI.Pages._mixin.render_returnValue\">\n                        /// A promise that is fulfilled when rendering is complete, if asynchronous processing is necessary. If not, returns nothing.\n                        /// </returns>\n                        /// </signature>\n                        if (!this.selfhost) {\n                            element.appendChild(loadResult);\n                        }\n                        return element;\n                    },\n                    rendered: function (element, options) { },\n                    ready: function () { }\n                };\n                function injectMixin(base, mixin) {\n                    var d = base.prototype.dispose;\n                    base = _Base.Class.mix(base, mixin);\n                    //we want to allow this mixins to provide their own addition to \"dispose\"\n                    if (d && mixin.hasOwnProperty('dispose')) {\n                        base.prototype.dispose = function () {\n                            mixin.dispose.apply(this);\n                            d.apply(this);\n                        };\n                    }\n                    return base;\n                }\n                function mergeJavaScriptClass(baseCtor, classDef) {\n                    var keys = Object.keys(baseCtor.prototype);\n                    keys.forEach(function (k) {\n                        if (classDef.prototype[k] === undefined) {\n                            classDef.prototype[k] = baseCtor.prototype[k];\n                        }\n                    });\n                    return baseCtor;\n                }\n                function addMembers(ctor, members) {\n                    if (!members)\n                        return ctor;\n                    if (typeof members == 'function') {\n                        ctor.prototype._attachedConstructor = members;\n                        return mergeJavaScriptClass(ctor, members);\n                    }\n                    else if (typeof members == 'object') {\n                        return injectMixin(ctor, members);\n                    }\n                    return ctor;\n                }\n                function pageLifeCycle(that, uri, element, options, complete, parentedPromise) {\n                    if (element.style.display)\n                        that.pageLifeCycle.initialDisplay = element.style.display;\n                    element.style.display = 'none';\n                    var profilerMarkIdentifier = \" uri='\" + uri + \"'\" + _BaseUtils._getProfilerMarkIdentifier(that.element);\n                    _WriteProfilerMark(\"WinJS.UI.Pages:createPage\" + profilerMarkIdentifier + \",StartTM\");\n                    if (WinJSContrib.UI.WebComponents) {\n                        that.pageLifeCycle.observer = WinJSContrib.UI.WebComponents.watch(that.element);\n                    }\n                    var load = Promise.timeout().then(function Pages_load() {\n                        return that.load(uri);\n                    }).then(function (loadResult) {\n                        //if page is defined by Js classes, call class constructors \n                        if (that._attachedConstructor) {\n                            var realControl = new that._attachedConstructor(element, options);\n                            element.winControl = realControl;\n                            var keys = Object.keys(that);\n                            keys.forEach(function (k) {\n                                realControl[k] = that[k];\n                            });\n                            realControl.pageLifeCycle.page = realControl;\n                            that.pageControl = realControl;\n                            that.dismissed = true;\n                            that = realControl;\n                        }\n                        return loadResult;\n                    });\n                    var renderCalled = load.then(function Pages_init(loadResult) {\n                        return Promise.join({\n                            loadResult: loadResult,\n                            initResult: that.init(element, options)\n                        });\n                    }).then(function Pages_render(result) {\n                        return that.pageLifeCycle.steps.init.resolve().then(function () {\n                            return result;\n                        });\n                    }).then(function Pages_render(result) {\n                        return that.render(element, options, result.loadResult);\n                    }).then(function Pages_render(result) {\n                        return that.rendered(element, options);\n                    }).then(function (result) {\n                        return that.pageLifeCycle.steps.render.resolve();\n                    }).then(function Pages_processed() {\n                        if (WinJSContrib.UI.WebComponents) {\n                            //add delay to enable webcomponent processing\n                            return WinJS.Promise.timeout();\n                        }\n                    });\n                    that.elementReady = renderCalled.then(function () {\n                        return element;\n                    });\n                    that.renderComplete = renderCalled.then(function Pages_process() {\n                        return that.process(element, options);\n                    }).then(function (result) {\n                        return that.pageLifeCycle.steps.process.resolve();\n                    }).then(function Pages_processed() {\n                        WinJSContrib.UI.bindMembers(element, that);\n                        return that.processed(element, options);\n                    }).then(function () {\n                        return that;\n                    });\n                    var callComplete = function () {\n                        complete && complete(that);\n                        _WriteProfilerMark(\"WinJS.UI.Pages:createPage\" + profilerMarkIdentifier + \",StopTM\");\n                    };\n                    // promises guarantee order, so this will be called prior to ready path below\n                    //\n                    that.renderComplete.then(callComplete, callComplete);\n                    that.layoutComplete = that.renderComplete.then(function () {\n                        return parentedPromise;\n                    }).then(function () {\n                        element.style.display = that.pageLifeCycle.initialDisplay || '';\n                        var r = element.getBoundingClientRect(); //force element layout\n                        return broadcast(that, element, 'pageLayout', [element, options], null, that.pageLayout);\n                    }).then(function () {\n                        WinJSContrib.UI.bindActions(element, that);\n                    }).then(function (result) {\n                        return that.pageLifeCycle.steps.layout.resolve();\n                    }).then(function () {\n                        return that;\n                    });\n                    that.readyComplete = that.layoutComplete.then(function Pages_ready() {\n                        that.ready(element, options);\n                        that.pageLifeCycle.ended = new Date();\n                        that.pageLifeCycle.delta = that.pageLifeCycle.ended - that.pageLifeCycle.created;\n                        console.log('navigation to ' + uri + ' took ' + that.pageLifeCycle.delta + 'ms');\n                        //broadcast(that, element, 'pageReady', [element, options]);\n                    }).then(function (result) {\n                        return that.pageLifeCycle.steps.ready.resolve();\n                    }).then(function () {\n                        return that;\n                    }).then(null, function Pages_error(err) {\n                        if (that.error)\n                            return that.error(err);\n                        if (err && err._value && err._value.name === \"Canceled\")\n                            return;\n                        return WinJS.Promise.wrapError(err);\n                    });\n                    that.__checkLayout = function () {\n                        var page = this;\n                        var updateLayoutArgs = arguments;\n                        var p = null;\n                        if (page.updateLayout) {\n                            p = WinJS.Promise.as(page.updateLayout.apply(page, updateLayoutArgs));\n                        }\n                        else {\n                            p = WinJS.Promise.wrap();\n                        }\n                        return p.then(function () {\n                            return broadcast(page, page.element, 'updateLayout', updateLayoutArgs);\n                        });\n                    };\n                }\n                function getPageConstructor(uri, members) {\n                    /// <signature helpKeyword=\"WinJS.UI.Pages.define\">\n                    /// <summary locid=\"WinJS.UI.Pages.define\">\n                    /// Creates a new page control from the specified URI that contains the specified members.\n                    /// Multiple calls to this method for the same URI are allowed, and all members will be\n                    /// merged.\n                    /// </summary>\n                    /// <param name=\"uri\" locid=\"WinJS.UI.Pages.define_p:uri\">\n                    /// The URI for the content that defines the page.\n                    /// </param>\n                    /// <param name=\"members\" locid=\"WinJS.UI.Pages.define_p:members\">\n                    /// Additional members that the control will have.\n                    /// </param>\n                    /// <returns type=\"Function\" locid=\"WinJS.UI.Pages.define_returnValue\">\n                    /// A constructor function that creates the page.\n                    /// </returns>\n                    /// </signature>\n                    var refUri = abs(uri).toLowerCase();\n                    var base = viewMap[refUri];\n                    uri = abs(uri);\n                    if (!base) {\n                        base = _Base.Class.define(\n                        // This needs to follow the WinJS.UI.processAll \"async constructor\"\n                        // pattern to interop nicely in the \"Views.Control\" use case.\n                        //\n                        // This needs to follow the WinJS.UI.processAll \"async constructor\"\n                        // pattern to interop nicely in the \"Views.Control\" use case.\n                        //\n                        function PageControl_ctor(element, options, complete, parentedPromise) {\n                            var that = this;\n                            var parent = WinJSContrib.Utils.getScopeControl(element);\n                            _ElementUtilities.addClass(element, \"win-disposable\");\n                            _ElementUtilities.addClass(element, \"pagecontrol\");\n                            _ElementUtilities.addClass(element, \"mcn-layout-ctrl\");\n                            that.pageLifeCycle = {\n                                created: new Date(),\n                                location: uri,\n                                stop: function () {\n                                    that.readyComplete.cancel();\n                                    that.cancelPromises();\n                                    if (this.observer) {\n                                        this.observer.disconnect();\n                                        this.observer = null;\n                                    }\n                                },\n                                steps: {\n                                    init: new PageLifeCycleStep(that, 'init', null),\n                                    render: new PageLifeCycleStep(that, 'render', null),\n                                    process: new PageLifeCycleStep(that, 'process', parent),\n                                    layout: new PageLifeCycleStep(that, 'layout', parent),\n                                    ready: new PageLifeCycleStep(that, 'ready', parent)\n                                },\n                                initialDisplay: null\n                            };\n                            this._disposed = false;\n                            this.element = element = element || _Global.document.createElement(\"div\");\n                            element.msSourceLocation = uri;\n                            this.uri = uri;\n                            this.selfhost = selfhost(uri);\n                            element.winControl = this;\n                            that.parentedComplete = parentedPromise;\n                            pageLifeCycle(this, uri, element, options, complete, parentedPromise);\n                        }, _mixinBase);\n                        base = _Base.Class.mix(base, WinJS.UI.DOMEventMixin);\n                        //inject default behaviors to page constructor\n                        WinJSContrib.UI.Pages.defaultFragmentMixins.forEach(function (mixin) {\n                            injectMixin(base, mixin);\n                        });\n                        //WinJSContrib.UI.Pages.fragmentMixin(base);\n                        viewMap[refUri] = base;\n                    }\n                    base = addMembers(base, members);\n                    base.selfhost = selfhost(uri);\n                    return base;\n                }\n                function Pages_define(uri, members) {\n                    /// <signature helpKeyword=\"WinJS.UI.Pages.define\">\n                    /// <summary locid=\"WinJS.UI.Pages.define\">\n                    /// Creates a new page control from the specified URI that contains the specified members.\n                    /// Multiple calls to this method for the same URI are allowed, and all members will be\n                    /// merged.\n                    /// </summary>\n                    /// <param name=\"uri\" locid=\"WinJS.UI.Pages.define_p:uri\">\n                    /// The URI for the content that defines the page.\n                    /// </param>\n                    /// <param name=\"members\" locid=\"WinJS.UI.Pages.define_p:members\">\n                    /// Additional members that the control will have.\n                    /// </param>\n                    /// <returns type=\"Function\" locid=\"WinJS.UI.Pages.define_returnValue\">\n                    /// A constructor function that creates the page.\n                    /// </returns>\n                    /// </signature>\n                    var ctor = viewMap[uri];\n                    if (!ctor) {\n                        ctor = getPageConstructor(uri);\n                    }\n                    if (members) {\n                        ctor = addMembers(ctor, members);\n                    }\n                    if (ctor.selfhost) {\n                        WinJS.Utilities.ready(function () {\n                            render(abs(uri), _Global.document.body);\n                        }, true);\n                    }\n                    //in case we are on WinJS<4 we reference members on WinJS Core Pages\n                    if (!_CorePages.viewMap && !_CorePages._viewMap && typeof members !== 'function')\n                        _Pages._corePages.define(uri, members);\n                    return ctor;\n                }\n                function render(uri, element, options, parentedPromise) {\n                    var Ctor = _CorePages.get(uri);\n                    var control = new Ctor(element, options, null, parentedPromise);\n                    return control.renderComplete.then(null, function (err) {\n                        return Promise.wrapError({\n                            error: err,\n                            page: control\n                        });\n                    });\n                }\n                function get(uri) {\n                    var ctor = viewMap[uri];\n                    if (!ctor) {\n                        ctor = Pages_define(uri);\n                    }\n                    return ctor;\n                }\n                function remove(uri) {\n                    Fragments.clearCache(abs(uri));\n                    delete viewMap[uri.toLowerCase()];\n                }\n                _Pages._corePages = {\n                    get: _CorePages.get,\n                    render: _CorePages.render,\n                    define: _CorePages.define,\n                    _remove: _CorePages._remove,\n                    _viewMap: viewMap,\n                };\n                var pageOverride = {\n                    define: Pages_define,\n                    get: get,\n                    render: render,\n                    _remove: remove,\n                    _viewMap: viewMap\n                };\n                var source = WinJS.UI.Pages;\n                WinJS.Namespace._moduleDefine(_Pages, null, pageOverride);\n                source.get = pageOverride.get;\n                source.define = pageOverride.define;\n                source.render = pageOverride.render;\n                source._remove = pageOverride._remove;\n                //replaces HtmlControl, otherwise it does not use proper Page constructor\n                WinJS.UI.HtmlControl = WinJS.Class.define(function HtmlControl_ctor(element, options, complete) {\n                    /// <signature helpKeyword=\"WinJS.UI.HtmlControl.HtmlControl\">\n                    /// <summary locid=\"WinJS.UI.HtmlControl.constructor\">\n                    /// Initializes a new instance of HtmlControl to define a new page control.\n                    /// </summary>\n                    /// <param name=\"element\" locid=\"WinJS.UI.HtmlControl.constructor_p:element\">\n                    /// The element that hosts the HtmlControl.\n                    /// </param>\n                    /// <param name=\"options\" locid=\"WinJS.UI.HtmlControl.constructor_p:options\">\n                    /// The options for configuring the page. The uri option is required in order to specify the source\n                    /// document for the content of the page.\n                    /// </param>\n                    /// </signature>\n                    WinJS.UI.Pages.render(options.uri, element, options).\n                        then(complete, function () { complete(); });\n                });\n            })(WinJSContrib.UI.Pages, __global, WinJS, WinJS.UI.Pages, WinJS.Utilities, WinJS.Utilities, profiler, WinJS.Promise, WinJS.UI.Fragments, WinJS.UI);\n        })(Pages = UI.Pages || (UI.Pages = {}));\n    })(UI = WinJSContrib.UI || (WinJSContrib.UI = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\n//# sourceMappingURL=winjscontrib.core.js.map","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/*\r\nWARNING: this feature is experimental\r\nYou must add winjscontrib.core.js before this file\r\n*/\r\n\r\n/// <reference path=\"winjscontrib.core.js\" />\r\nvar WinJSContrib = WinJSContrib || {};\r\nWinJSContrib.UI = WinJSContrib.UI || {};\r\n\r\n/**\r\n * @namespace\r\n */\r\nWinJSContrib.UI.WebComponents = WinJSContrib.UI.WebComponents || {};\r\n\r\n(function (global) {\r\n\t'use strict';\r\n\tvar registered = {};\r\n\tWinJSContrib.UI.WebComponents.registered = registered;\r\n\tWinJSContrib.UI.WebComponents.polyfill = false;\r\n\r\n\tif (!global.document.registerElement && global.MutationObserver) {\r\n\t\tWinJSContrib.UI.WebComponents.polyfill = true;\r\n\t}\r\n\r\n\tfunction inspect(node) {\r\n\t\tvar customElement = null;\r\n\t\tvar ctrlName = node.nodeName;\r\n\t\tvar promises = [];\r\n\r\n\t\tif (node.nodeName !== '#text') {\r\n\t\t\tif (node.attributes) {\r\n\t\t\t\tvar ctrlName = node.getAttribute(\"is\");\r\n\t\t\t\tif (ctrlName) {\r\n\t\t\t\t\t//we uppercase because node names are uppercase\r\n\t\t\t\t\tcustomElement = registered[ctrlName.toUpperCase()];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!customElement && node.nodeName !== 'DIV' && node.nodeName !== 'SPAN') {\r\n\t\t\t\tcustomElement = registered[node.nodeName];\r\n\t\t\t}\r\n\r\n\t\t\tif (customElement && !node.mcnComponent) {\r\n\t\t\t\t//createElement(node, customElement);\r\n\t\t\t\tpromises.push(createElement(node, customElement));\r\n\t\t\t}\r\n\r\n\t\t\tif (node.msParentSelectorScope && node.winControl && node.winControl.pageLifeCycle && node.winControl.pageLifeCycle.observer) {\r\n\t\t\t\t//element is a fragment with its own mutation observer, no need to inspect childs\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t//if (node.nodeName === 'WIN-TEMPLATE') {\r\n\t\t\t//    return;\r\n\t\t\t//}\r\n\r\n\t\t\tfor (var i = 0, l = node.childNodes.length; i < l; i++) {\r\n\t\t\t\tpromises.push(inspect(node.childNodes[i]));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn WinJS.Promise.join(promises);\r\n\t}\r\n\r\n\t/**\r\n\t * inspect current DOM element and create webcomponents found on that element and on its child.\r\n\t * @function\r\n\t * @param {HTMLElement} element DOM element to inspect\r\n\t */\r\n\tWinJSContrib.UI.WebComponents.processAll = function (element) { };\r\n\tif (WinJSContrib.UI.WebComponents.polyfill) {\r\n\t\tWinJSContrib.UI.WebComponents.processAll = inspect;\r\n\t}\r\n\r\n\tfunction observeMutations(element) {\r\n\t\tvar observer = null;\r\n\t\tif (WinJSContrib.UI.WebComponents.polyfill) {\r\n\t\t\tobserver = new MutationObserver(function (mutations) {\r\n\t\t\t\t//console.time('check mutation');\r\n\t\t\t\tmutations.forEach(function (mutation) {\r\n\t\t\t\t\tif (mutation.addedNodes.length) {\r\n\t\t\t\t\t\tfor (var i = 0, l = mutation.addedNodes.length; i < l ; i++) {\r\n\t\t\t\t\t\t\tinspect(mutation.addedNodes[i]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t//console.timeEnd('check mutation');\r\n\t\t\t});\r\n\r\n\t\t\tobserver.observe(element, { childList: true, subtree: true });\r\n\t\t}\r\n\r\n\t\treturn observer;\r\n\t}\r\n\tWinJSContrib.UI.WebComponents.watch = observeMutations;\r\n\r\n\tfunction createElement(element, definition) {\r\n\t\tvar ctrl = element.winControl;\r\n\t\telement.mcnComponent = true;\r\n\t\tvar scope = WinJSContrib.Utils.getScopeControl(element);\r\n\t\tvar p = WinJS.Promise.wrap();\r\n\t\tvar process = function () {\r\n\t\t\tgetControlInstance(definition.ctor, element);\r\n\t\t}\r\n\r\n\t\tif (scope && scope.pageLifeCycle) {\r\n\t\t\t//if the component is owned by a page/fragment, we process the control according to page lifecycle\r\n\t\t\tp = scope.pageLifeCycle.steps.render.attach(process);\r\n\t\t} else {\r\n\t\t\tprocess();\r\n\t\t}\r\n\r\n\t\t//put a proxy on setAttribute to detect changes in attributes\r\n\t\tvar setAttribute = element.setAttribute;\r\n\t\telement.setAttribute = function (name, val) {\r\n\t\t\tif (element.winControl) {\r\n\t\t\t\tsetAttribute.call(this, name, val);\r\n\t\t\t\tvar definition = element.winControl.constructor.mcnWebComponent;\r\n\t\t\t\tif (definition) {\r\n\t\t\t\t\tvar map = definition[name.toUpperCase()];\r\n\t\t\t\t\tif (map) {\r\n\t\t\t\t\t\tvar ctx = { control: element.winControl, name: map.property, data: {} }\r\n\t\t\t\t\t\tdefinition.applyAttribute(name, this, ctx);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn p;\r\n\t}\r\n\r\n\tfunction getControlInstance(ctor, element) {\r\n\t\telement.mcnComponent = true;\r\n\t\tvar definition = ctor.mcnWebComponent;\r\n\t\t//console.time('building ' + definition.name);\r\n\t\tvar options = {};\r\n\t\tif (element.dataset.winOptions) {\r\n\t\t\toptions = getWinJSOptions(element);\r\n\t\t}\r\n\r\n\t\tif (definition && definition.optionsCallback) {\r\n\t\t\toptions = definition.optionsCallback(element, options, scope);\r\n\t\t}\r\n\r\n\t\tvar ctrl = new ctor(element, options);\r\n\t\telement.winControl = ctrl;\r\n\t\tif (definition) {\r\n\t\t\tdefinition.applyAll(element);\r\n\t\t}\r\n\t\t//console.timeEnd('building ' + definition.name);\t\t\r\n\t}\r\n\r\n\tfunction applyMapping(tagname, ctor, mapping) {\r\n\t\tif (typeof mapping == 'function')\r\n\t\t\treturn;\r\n\t\tmapping = mapping || {};\r\n\r\n\t\tctor.mcnWebComponent = {\r\n\t\t\tname: tagname,\r\n\t\t\tmap: mapping.map || {},\r\n\t\t\toptionsCallback: mapping.optionsCallback,\r\n\t\t\tapplyAll: function (element) {\r\n\t\t\t\tvar contextData = {};\r\n\t\t\t\tfor (var item in this.map) {\r\n\t\t\t\t\tvar attrcontext = { control: element.winControl, name: this.map[item].property, data: contextData };\r\n\t\t\t\t\tthis.applyAttribute(item, element, null, attrcontext);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tapplyAttribute: function (name, element, attrvalue, context) {\r\n\t\t\t\tvar map = this.map[name.toUpperCase()];\r\n\t\t\t\tif (map) {\r\n\t\t\t\t\tvar val = attrvalue || element.getAttribute(map.attribute);\r\n\t\t\t\t\tvar ctrl = element.winControl;\r\n\t\t\t\t\tif (val && ctrl) {\r\n\t\t\t\t\t\tif (!map.type || map.type === 'property') {\r\n\t\t\t\t\t\t\tif (map.resolve) {\r\n\t\t\t\t\t\t\t\tWinJSContrib.Utils.applyValue(element, val, ctrl, map.property, context);\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tWinJSContrib.Utils.writeProperty(ctrl, map.property, val);\r\n\t\t\t\t\t\t} else if (map.type === 'event') {\r\n\t\t\t\t\t\t\tWinJSContrib.Utils.resolveValue(element, val, context);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (mapping.properties) {\r\n\t\t\tmapping.properties.forEach(function (p) {\r\n\t\t\t\tif (p) {\r\n\t\t\t\t\tctor.mcnWebComponent.map[p.toUpperCase()] = { attribute: p, property: p, resolve: true, type: 'property' };\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (mapping.events) {\r\n\t\t\tmapping.events.forEach(function (p) {\r\n\t\t\t\tif (p) {\r\n\t\t\t\t\tctor.mcnWebComponent.map[p.toUpperCase()] = { attribute: p, property: p, resolve: true, type: 'event' };\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (mapping.controls) {\r\n\t\t\tfor (var ctKey in mapping.controls) {\r\n\t\t\t\tvar control = mapping.controls[ctKey];\r\n\t\t\t\tvar controlDefinition = control.mcnWebComponent;\r\n\t\t\t\tfor (var mapKey in controlDefinition.map) {\r\n\t\t\t\t\tvar key = ctKey + '.' + mapKey;\r\n\t\t\t\t\tvar controlmap = controlDefinition.map[mapKey];\r\n\t\t\t\t\tctor.mcnWebComponent.map[key.toUpperCase()] = {\r\n\t\t\t\t\t\tattribute: ctKey + '.' + controlmap.attribute,\r\n\t\t\t\t\t\tproperty: ctKey + '.' + controlmap.property,\r\n\t\t\t\t\t\tresolve: controlmap.resolve\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t* Register a control to be used as a webcomponent. If a tagname has already been registered, \r\n\t* the function will throw an error unless you specify the override flag\r\n\t* @function\r\n\t* @param {string} tagname name for DOM element for the component\r\n\t* @param {function} ctor constructor for the WinJS control\r\n\t* @param {Object} mapping definition for mapping between control and DOM element\r\n\t* @param {boolean} override indicate that you want to override an existing component definition\r\n\t* @example\r\n\t* WinJSContrib.UI.WebComponents.register('mcn-semanticlistviews', WinJSContrib.UI.SemanticListViews, {\r\n\t*\tproperties: ['nameOfProperty'],\r\n\t*   events : ['nameOfEvent'],\r\n\t*\tcontrols: {\r\n\t*\t\t\"listview\": WinJS.UI.ListView,\r\n\t*\t\t\"zoomedOutListview\": WinJS.UI.ListView,\r\n\t*\t\t\"semanticZoom\": WinJS.UI.SemanticZoom\r\n\t*\t},\r\n\t*\tmap: {\r\n\t*\t\t\"DEFAULTGROUPLIMIT\": { attribute: 'defaultGroupLimit', property: '_dataManager.defaultGroupLimit', resolve: true },\r\n\t*\t\t\"GROUPKIND\": { attribute: 'groupKind', property: '_dataManager.groupKind', resolve: true },\r\n\t*\t\t\"FIELD\": { attribute: 'field', property: '_dataManager.field', resolve: true },\r\n\t*\t\t\"ITEMS\": { attribute: 'items', property: '_dataManager.items', resolve: true },\r\n\t*\t}\r\n\t*});\r\n\t*/\r\n\tWinJSContrib.UI.WebComponents.register = function register(tagname, ctor, mapping, override) {\r\n\t\tvar existing = registered[tagname.toUpperCase()];\r\n\t\tif (existing && !override) {\r\n\t\t\tthrow 'component ' + tagname + ' already exists';\r\n\t\t}\r\n\r\n\t\tapplyMapping(tagname, ctor, mapping);\r\n\r\n\t\tif (WinJSContrib.UI.WebComponents.polyfill) {\r\n\t\t\tglobal.document.createElement(tagname);\r\n\t\t\t//we uppercase because node names are uppercase\r\n\t\t\tregistered[tagname.toUpperCase()] = { ctor: ctor };\r\n\t\t} else if (global.document.registerElement) {\r\n\t\t\t//register component with \"real\" webcomponent\r\n\t\t\tvar proto = Object.create(HTMLElement.prototype);\r\n\t\t\tproto.createdCallback = function () {\r\n\t\t\t}\r\n\r\n\t\t\tproto.attachedCallback = function () {\r\n\t\t\t\tvar element = this;\r\n\t\t\t\tvar scope = WinJSContrib.Utils.getScopeControl(element);\r\n\t\t\t\tvar process = function () {\r\n\t\t\t\t\tgetControlInstance(ctor, element);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (scope && scope.pageLifeCycle) {\r\n\t\t\t\t\t//if the component is owned by a page/fragment, we process the control according to page lifecycle\r\n\t\t\t\t    scope.pageLifeCycle.steps.render.attach(process);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tprocess();\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t};\r\n\r\n\t\t\tproto.attributeChangedCallback = function (attrName, oldValue, newValue) {\r\n\t\t\t\tvar element = this;\r\n\t\t\t\tif (element.winControl) {\r\n\t\t\t\t\tvar definition = element.winControl.constructor.mcnWebComponent;\r\n\t\t\t\t\tif (definition) {\r\n\t\t\t\t\t\tvar map = definition.map[attrName.toUpperCase()];\r\n\t\t\t\t\t\tif (map) {\r\n\t\t\t\t\t\t\tdefinition.applyAttribute(attrName, element, newValue, { control: element.winControl, name: map.property, data: {} });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t};\r\n\r\n\t\t\tglobal.document.registerElement(tagname, { prototype: proto });\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getWinJSOptions(elt) {\r\n\t\treturn WinJS.UI.optionsParser(elt.dataset.winOptions, window, {\r\n\t\t\tselect: WinJS.Utilities.markSupportedForProcessing(function (text) {\r\n\t\t\t\tvar parent = WinJSContrib.Utils.getScopeControl(elt);\r\n\t\t\t\tif (parent) {\r\n\t\t\t\t\treturn parent.element.querySelector(text);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\treturn document.querySelector(text);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t});\r\n\t}\r\n\r\n\r\n\r\n\tif (WinJS.Binding && WinJS.Binding.Template) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-template', WinJS.Binding.Template, {\r\n\t\t\tproperties: ['extractChild']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.AppBar) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-appbar', WinJS.UI.AppBar, {\r\n\t\t\tproperties: ['closedDisplayMode', 'disabled', 'hidden', 'layout', 'placement', 'sticky', 'commands', \r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.AutoSuggestBox) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-autosuggestbox', WinJS.UI.AutoSuggestBox, {\r\n\t\t\tproperties: ['chooseSuggestionOnEnter', 'disabled', 'onquerychanged', 'onquerysubmitted', \r\n\t\t\t\t'onresultsuggestionchosen', 'onsuggestionsrequested', 'placeholderText', 'queryText', \r\n\t\t\t\t'searchHistoryContext', 'searchHistoryDisabled'],\r\n\t\t\tevents: ['querychanged', 'querysubmitted', 'resultsuggestionchosen', 'suggestionsrequested']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.BackButton) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-backbutton', WinJS.UI.BackButton);\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ContentDialog) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-contentdialog', WinJS.UI.ContentDialog, {\r\n\t\t\tproperties: ['hidden', 'primaryCommandDisabled', 'primaryCommandText', 'secondaryCommandDisabled',\r\n\t\t\t\t'secondaryCommandText', 'title', 'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.DatePicker) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-datepicker', WinJS.UI.DatePicker, {\r\n\t\t\tproperties: ['calendar', 'datePattern', 'disabled', 'maxYear', 'minYear', \r\n\t\t\t\t'monthPattern', 'yearPattern', 'onchange', 'current'],\r\n\t\t\tevents: ['change']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.FlipView) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-flipview', WinJS.UI.FlipView, {\r\n\t\t\tproperties: ['currentPage', 'orientation', 'itemTemplate', 'itemDataSource', 'itemSpacing', 'ondatasourcecountchanged', 'onpagevisibilitychanged', 'onpageselected', 'onpagecompleted'],\r\n\t\t\tevents: ['datasourcecountchanged', 'pagevisibilitychanged', 'pageselected', 'pagecompleted']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Flyout) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-flyout', WinJS.UI.Flyout, {\r\n\t\t\tproperties: ['alignment', 'anchor', 'disabled', 'hidden', 'placement', \r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Hub) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-hub', WinJS.UI.Hub, {\r\n\t\t\tproperties: ['headerTemplate', 'indexOfFirstVisible', 'indexOfLastVisible', 'loadingState', \r\n\t\t\t\t'oncontentanimating', 'onheaderinvoked', 'onloadingstatechanged', \r\n\t\t\t\t'orientation', 'scrollPosition', 'sectionOnScreen', 'sections', 'zoomableView'],\r\n\t\t\tevents: ['contentanimating', 'headerinvoked', 'loadingstatechanged']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.HubSection) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-hubsection', WinJS.UI.HubSection, {\r\n\t\t\tproperties: ['contentElement', 'header', 'isHeaderStatic']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ItemContainer) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-itemcontainer', WinJS.UI.ItemContainer, {\r\n\t\t\tproperties: ['draggable', 'oninvoked', 'onselectionchanged', 'onselectionchanging', 'selected', 'selectionDisabled', \r\n\t\t\t\t'swipeBehavior', 'swipeOrientation', 'tapBehavior'],\r\n\t\t\tevents: ['invoked', 'selectionchanged', 'selectionchanging']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ListView) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-listview', WinJS.UI.ListView, {\r\n\t\t\tproperties: [\r\n\t\t\t\t'itemTemplate', 'itemDataSource', 'itemsDraggable', 'itemsReorderable',\r\n\t\t\t\t'oniteminvoked', 'groupHeaderTemplate', 'groupDataSource', 'swipeBehavior',\r\n\t\t\t\t'selectBehavior', 'tapBehavior', 'header', 'footer'\r\n\t\t\t],\r\n\t\t\tevents: ['iteminvoked']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Menu) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-menu', WinJS.UI.Menu, {\r\n\t\t\tproperties: ['alignment', 'anchor', 'commands', 'disabled', 'hidden', 'placement', \r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Pivot) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-pivot', WinJS.UI.Pivot, {\r\n\t\t\tproperties: ['items', 'locked', 'onitemanimationend', 'onitemanimationstart', 'onselectionchanged', \r\n\t\t\t\t'selectedIndex', 'selectedItem', 'title'],\r\n\t\t\tevents: ['itemanimationend', 'itemanimationstart', 'selectionchanged']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.PivotItem) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-pivotitem', WinJS.UI.PivotItem, {\r\n\t\t\tproperties: ['contentElement', 'header']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Rating) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-rating', WinJS.UI.Rating, {\r\n\t\t\tproperties: ['averageRating', 'disabled', 'enableClear', 'maxRating', \r\n\t\t\t\t'oncancel', 'onchange', 'onpreviewchange', 'tooltipStrings', 'userRating'],\r\n\t\t\tevents: ['cancel', 'change', 'previewchange']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Repeater) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-repeater', WinJS.UI.Repeater, {\r\n\t\t\tproperties: ['data', 'length', 'onitemchanged', 'onitemchanging', 'oniteminserted', 'oniteminserting', \r\n\t\t\t\t'onitemmoved', 'onitemmoving', 'onitemremoved', 'onitemremoving', 'onitemsloaded', \r\n\t\t\t\t'onitemsreloaded', 'onitemsreloading', 'template'],\r\n\t\t\tevents: ['itemchanged', 'itemchanging', 'iteminserted', 'iteminserting',\r\n\t\t\t\t'itemmoved', 'itemmoving', 'itemremoved', 'itemremoving', 'itemsloaded',\r\n\t\t\t\t'itemsreloaded', 'itemsreloading']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.SearchBox) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-searchbox', WinJS.UI.SearchBox, {\r\n\t\t\tproperties: ['chooseSuggestionOnEnter', 'disabled', 'focusOnKeyboardInput', 'onquerychanged', 'onquerysubmitted', \r\n\t\t\t\t'onresultsuggestionchosen', 'onsuggestionsrequested', 'placeholderText', 'queryText', \r\n\t\t\t\t'searchHistoryContext', 'searchHistoryDisabled'],\r\n\t\t\tevents: ['querychanged', 'querysubmitted', 'resultsuggestionchosen', 'suggestionsrequested']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.SemanticZoom) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-semanticzoom', WinJS.UI.SemanticZoom, {\r\n\t\t\tproperties: ['enableButton', 'locked', 'onzoomchanged', 'zoomedInItem', 'zoomedOut', 'zoomedOutItem', 'zoomFactor'],\r\n\t\t\tevents: ['zoomchanged']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.SplitView) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-splitview', WinJS.UI.SplitView, {\r\n\t\t\tproperties: ['contentElement', 'hiddenDisplayMode', 'paneElement', 'paneHidden', 'panePlacement', 'shownDisplayMode',\r\n\t\t\t\t'onafterhide', 'onaftershow', 'onbeforehide', 'onbeforeshow'],\r\n\t\t\tevents: ['afterhide', 'aftershow', 'beforehide', 'beforeshow']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.TimePicker) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-timepicker', WinJS.UI.TimePicker, {\r\n\t\t\tproperties: ['onchange', 'clock', 'current', 'disabled', 'hourPattern',\r\n\t\t\t\t'minuteIncrement', 'minutePattern', 'periodPattern'],\r\n\t\t\tevents: ['onchange']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ToggleSwitch) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-toggleswitch', WinJS.UI.ToggleSwitch, {\r\n\t\t\tproperties: ['onchange', 'checked', 'disabled', 'labelOff', 'labelOn', 'title'],\r\n\t\t\tevents: ['onchange']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ToolBar) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-toolbar', WinJS.UI.ToolBar);\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.Tooltip) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-tooltip', WinJS.UI.Tooltip, {\r\n\t\t\tproperties: ['contentElement', 'extraClass', 'infotip', 'innerHTML', 'onbeforeclose', \r\n\t\t\t\t'onbeforeopen', 'onclosed', 'onopened', 'placement'],\r\n\t\t\tevents: ['beforeclose', 'beforeopen', 'closed', 'opened']\r\n\t\t});\r\n\t}\r\n\r\n\tif (WinJS.UI && WinJS.UI.ViewBox) {\r\n\t\tWinJSContrib.UI.WebComponents.register('win-viewbox', WinJS.UI.ViewBox);\r\n\t}\r\n\r\n\r\n\t/*\r\n\t\t\t\tWinJS.UI.MenuCommand\r\n\t\t\t\tWinJS.UI.NavBar\r\n\t\t\t\tWinJS.UI.NavBarCommand\r\n\t\t\t\tWinJS.UI.NavBarContainer\r\n\t\t\t\tToolbar\r\n\t*/\r\n})(this);","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var WinRT;\n    (function (WinRT) {\n        /**\n         * read protocol arguments from application activation event arguments\n         * @function WinJSContrib.WinRT.readProtocol\n         * @param {Object} args WinJS application activation argument\n         * @returns {Object} protocol arguments\n         */\n        function readProtocol(args) {\n            if (args.detail.kind === Windows.ApplicationModel.Activation.ActivationKind.protocol && args.detail.uri) {\n                var navArgs = { action: undefined };\n                var protocolArgs = {};\n                var queryargs = args.detail.uri.query;\n                if (queryargs[0] == '?') {\n                    queryargs = queryargs.substr(1);\n                }\n                if (queryargs) {\n                    queryargs.split('&').forEach(function (item) {\n                        var arg = item.split('=');\n                        protocolArgs[arg[0]] = decodeURIComponent(arg[1]);\n                    });\n                }\n                navArgs.protocol = {\n                    action: args.detail.uri.host,\n                    args: protocolArgs\n                };\n                return navArgs;\n            }\n        }\n        WinRT.readProtocol = readProtocol;\n        ;\n        /**\n         * Indicate if a valid internet connection is available, even with constrained access\n         * @function WinJSContrib.WinRT.isConnected\n         * @returns {boolean}\n         */\n        function isConnected() {\n            var nlvl = Windows.Networking.Connectivity.NetworkConnectivityLevel;\n            var profile = Windows.Networking.Connectivity.NetworkInformation.getInternetConnectionProfile();\n            if (profile !== null) {\n                var level = profile.getNetworkConnectivityLevel();\n                return level === nlvl.constrainedInternetAccess || level === nlvl.internetAccess;\n            }\n            return false;\n        }\n        WinRT.isConnected = isConnected;\n        ;\n        /**\n         * Indicate if a valid internet connection is available\n         * @function WinJSContrib.WinRT.hasInternetAccess\n         * @returns {boolean}\n         */\n        function hasInternetAccess() {\n            var nlvl = Windows.Networking.Connectivity.NetworkConnectivityLevel;\n            var profile = Windows.Networking.Connectivity.NetworkInformation.getInternetConnectionProfile();\n            if (profile !== null) {\n                var level = profile.getNetworkConnectivityLevel();\n                return level === nlvl.internetAccess;\n            }\n            return false;\n        }\n        WinRT.hasInternetAccess = hasInternetAccess;\n        ;\n        /**\n         * trigger callback when internet connection status is changing\n         * @function WinJSContrib.WinRT.onInternetStatusChanged\n         * @param {function} callback callback for internet status change notification\n         * @returns {function} function to call for unregistering the callback\n         */\n        function onInternetStatusChanged(callback) {\n            var handler = function (arg) {\n                var e = arg;\n                callback(WinJSContrib.WinRT.hasInternetAccess());\n            };\n            var network = Windows.Networking.Connectivity.NetworkInformation;\n            network.addEventListener('networkstatuschanged', handler);\n            return function () {\n                network.removeEventListener('networkstatuschanged', handler);\n            };\n        }\n        WinRT.onInternetStatusChanged = onInternetStatusChanged;\n    })(WinRT = WinJSContrib.WinRT || (WinJSContrib.WinRT = {}));\n})(WinJSContrib || (WinJSContrib = {}));\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Alerts;\n    (function (Alerts) {\n        /**\n         * show system alert box\n         * @function WinJSContrib.Alerts.messageBox\n         * @param {Object} opt message options\n         * @returns {WinJS.Promise}\n         */\n        function messageBox(opt) {\n            var _global = window;\n            if (opt) {\n                if (_global.Windows) {\n                    var md = new Windows.UI.Popups.MessageDialog(opt.content);\n                    if (opt.title) {\n                        md.title = opt.title;\n                    }\n                    if (opt.commands && opt.commands.forEach) {\n                        opt.commands.forEach(function (command, index) {\n                            var cmd = new Windows.UI.Popups.UICommand();\n                            if (command.id)\n                                cmd.id = command.id;\n                            cmd.label = command.label;\n                            if (command.callback) {\n                                cmd.invoked = command.callback;\n                            }\n                            ((md.commands)).append(cmd);\n                            if (command.isDefault) {\n                                md.defaultCommandIndex = index;\n                            }\n                        });\n                    }\n                    return (md.showAsync());\n                }\n                else {\n                    return new WinJS.Promise(function (complete, error) {\n                        var title = \"\";\n                        if (opt.title) {\n                            title = opt.title;\n                        }\n                        var commands = [];\n                        if (opt.commands && opt.commands.forEach) {\n                            //if (opt.commands.length > 2) {\n                            //    return WinJS.Promise.wrapError(\"you must specify maximum 2 commands on Cordova platforms\");\n                            //}\n                            opt.commands.forEach(function (command, index) {\n                                commands.push(command.label);\n                            });\n                        }\n                        else\n                            commands = ['Ok'];\n                        if (_global.navigator && _global.navigator.notification && _global.navigator.notification.confirm) {\n                            _global.navigator.notification.confirm(opt.content, function (res) {\n                                if (opt.commands && opt.commands[res - 1] && opt.commands[res - 1].callback) {\n                                    var c = opt.commands[res - 1].callback();\n                                    if (c && c.then) {\n                                        c.then(function () {\n                                            complete(true);\n                                        });\n                                    }\n                                    else {\n                                        complete(true);\n                                    }\n                                }\n                                else if (res != 0)\n                                    complete(true);\n                                else\n                                    complete(false);\n                            }, title, commands // buttonLabels\n                            );\n                        }\n                        else {\n                            if (window.confirm(title))\n                                complete(true);\n                            else\n                                complete(false);\n                        }\n                    });\n                }\n            }\n            return WinJS.Promise.wrapError(\"you must specify commands as an array of objects with properties text and callback such as {text: '', callback: function(c){}}\");\n        }\n        Alerts.messageBox = messageBox;\n        ;\n        /**\n         * show system alert box\n         * @function WinJSContrib.Alerts.message\n         * @param {string} title title of the alert\n         * @param {string} content text for the alert\n         * @returns {WinJS.Promise}\n         */\n        function message(title, content) {\n            return WinJSContrib.Alerts.messageBox({ title: title, content: content });\n        }\n        Alerts.message = message;\n        /**\n         * show system alert box\n         * @function WinJSContrib.Alerts.confirm\n         * @param {string} title title of the alert\n         * @param {string} content text for the alert\n         * @param {string} yes text for yes\n         * @param {string} no text for no\n         * @returns {WinJS.Promise}\n         */\n        function confirm(title, content, yes, no) {\n            return new WinJS.Promise(function (complete, error) {\n                WinJSContrib.Alerts.messageBox({\n                    title: title,\n                    content: content,\n                    commands: [\n                        {\n                            label: yes,\n                            callback: function (e) {\n                                complete(true);\n                            },\n                            isDefault: true\n                        },\n                        {\n                            label: no,\n                            callback: function (e) {\n                                complete(false);\n                            }\n                        }\n                    ]\n                });\n            });\n        }\n        Alerts.confirm = confirm;\n        /**\n         * show system toast notification\n         * @function WinJSContrib.Alerts.toastNotification\n         * @param {Object} data toast options\n         */\n        function toastNotification(data) {\n            if (Windows) {\n                var notifications = Windows.UI.Notifications;\n                var template = data.template || (data.picture ? notifications.ToastTemplateType.toastImageAndText01 : notifications.ToastTemplateType.toastText01);\n                //var template = notifications.ToastTemplateType[data.template]; //toastImageAndText01;\n                var toastXml = notifications.ToastNotificationManager.getTemplateContent(template);\n                var toastTextElements = toastXml.getElementsByTagName(\"text\");\n                var toastImageElements = toastXml.getElementsByTagName(\"image\");\n                if (data.launch) {\n                    var toastElements = toastXml.getElementsByTagName(\"toast\");\n                    toastElements[0].setAttribute(\"launch\", JSON.stringify(data.launch));\n                }\n                toastTextElements[0].appendChild(toastXml.createTextNode(data.text));\n                if (data.text2 && toastTextElements.length > 1) {\n                    toastTextElements[1].appendChild(toastXml.createTextNode(data.text2));\n                }\n                if (data.text3 && toastTextElements.length > 1) {\n                    toastTextElements[2].appendChild(toastXml.createTextNode(data.text3));\n                }\n                if (data.picture) {\n                    toastImageElements[0].setAttribute(\"src\", data.picture); //\"ms-appx:///images/logo.png\"\n                }\n                var toast = new notifications.ToastNotification(toastXml);\n                var toastNotifier = notifications.ToastNotificationManager.createToastNotifier();\n                toastNotifier.show(toast);\n            }\n            else {\n                throw \"No notification plugin found\";\n            }\n        }\n        Alerts.toastNotification = toastNotification;\n        /**\n         * show system toast notification\n         * @function WinJSContrib.Alerts.toast\n         * @param {string} text text displayed in the toast\n         * @param {string} picture path to a picture to display in the toast\n         */\n        function toast(text, picture) {\n            WinJSContrib.Alerts.toastNotification({ text: text, picture: picture });\n        }\n        Alerts.toast = toast;\n    })(Alerts = WinJSContrib.Alerts || (WinJSContrib.Alerts = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\n//# sourceMappingURL=../../Sources/WinRT/winjscontrib.winrt.core.js.map","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib = WinJSContrib || {};\r\nWinJSContrib.UPnP = WinJSContrib.UPnP || {};\r\n\r\n(function (global) {\r\n\r\n    WinJSContrib.UPnP.deviceTypes = {\r\n        ContentDirectory1: 'urn:schemas-upnp-org:service:ContentDirectory:1',\r\n        ContentDirectory2: 'urn:schemas-upnp-org:service:ContentDirectory:2',\r\n        ContentDirectory3: 'urn:schemas-upnp-org:service:ContentDirectory:3',\r\n        ContentDirectory4: 'urn:schemas-upnp-org:service:ContentDirectory:4',\r\n        MediaRenderer1: 'urn:schemas-upnp-org:device:MediaRenderer:1',\r\n        MediaRenderer2: 'urn:schemas-upnp-org:device:MediaRenderer:2',\r\n        MediaRenderer3: 'urn:schemas-upnp-org:device:MediaRenderer:3',\r\n        MediaRenderer4: 'urn:schemas-upnp-org:device:MediaRenderer:4',\r\n        MediaServer1: 'urn:schemas-upnp-org:device:MediaServer:1',\r\n        MediaServer2: 'urn:schemas-upnp-org:device:MediaServer:2',\r\n        MediaServer3: 'urn:schemas-upnp-org:device:MediaServer:3',\r\n        MediaServer4: 'urn:schemas-upnp-org:device:MediaServer:4',\r\n        AVTransport1:'urn:schemas-upnp-org:service:AVTransport:1',\r\n        AVTransport2: 'urn:schemas-upnp-org:service:AVTransport:2',\r\n        ConnectionManager1: 'urn:schemas-upnp-org:service:ConnectionManager:1',\r\n        ConnectionManager2: 'urn:schemas-upnp-org:service:ConnectionManager:2',\r\n        ConnectionManager3: 'urn:schemas-upnp-org:service:ConnectionManager:3'\r\n    };\r\n\r\n    WinJSContrib.UPnP.devicesDiscovery = function devicesDiscovery(filter, callback, timeout) {\r\n        var hostName;\r\n        try {\r\n            hostName = new Windows.Networking.HostName(\"239.255.255.250\");\r\n        } catch (ex) {\r\n            error({ message: \"Invalid host name.\" });\r\n            return;\r\n        }\r\n\r\n        var devices = new WinJS.Binding.List();\r\n\r\n        var discovery = {\r\n            devices: devices,\r\n            hasError: null,\r\n            promise: null,\r\n        };\r\n\r\n        function exists(url) {\r\n            var matches = devices.filter(function (d) {\r\n                return (url == d.deviceDescriptionUrl);\r\n            });\r\n            return matches.length > 0;\r\n        }\r\n\r\n        function discover(filter) {\r\n            return new WinJS.Promise(function (complete, error) {\r\n                var clientSocket = new Windows.Networking.Sockets.DatagramSocket();\r\n\r\n                function onsuccess(err) {\r\n                    try {\r\n                        if (clientSocket)\r\n                            clientSocket.close();\r\n                    } catch (ex) {\r\n                    }\r\n                    complete(devices);\r\n                }\r\n\r\n                function onerror(err) {\r\n                    try {\r\n                        if (clientSocket)\r\n                            clientSocket.close();\r\n                    } catch (ex) {\r\n                    }\r\n                    error(err);\r\n                }\r\n\r\n                clientSocket.onmessagereceived = function (args) {\r\n                    var e = args;\r\n                    var reader = args.getDataReader();\r\n                    var count = reader.unconsumedBufferLength;\r\n                    var data = reader.readString(count);\r\n                    var completed = false;\r\n\r\n                    if (data) {\r\n                        var items = data.split('\\n');\r\n                        items.forEach(function (item) {\r\n                            if (!completed && item.toLowerCase().indexOf('location:') == 0) {\r\n                                var url = item.substr(9, item.length - 9);\r\n                                completed = true;\r\n                                if (!exists(url)) {\r\n                                    WinJS.xhr({ url: url }).then(function (r) {\r\n\r\n                                        var rawdevice = xmlToJson(r.responseXML);\r\n                                        var device = rawdevice.root.device;\r\n\r\n                                        device.deviceDescriptionUrl = url;\r\n                                        device.rootUrl = url.substr(0, url.indexOf('/', 8));\r\n                                        if (!exists(url)) {\r\n                                            devices.push(new WinJSContrib.UPnP.UPnPDevice(device));\r\n                                        }\r\n\r\n                                        if (callback)\r\n                                            callback(device, url);\r\n                                    }, function (err) {\r\n                                        console.error('calling device failed');\r\n                                        console.error(err);\r\n                                    });\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n\r\n                }\r\n\r\n                clientSocket.getOutputStreamAsync(hostName, \"1900\").then(function (outputStream) {\r\n                    var message = \"M-SEARCH * HTTP/1.1\\r\\n\" +\r\n                                        \"HOST: 239.255.255.250:1900\\r\\n\" +\r\n                                          \"ST:\" + (filter || \"upnp:rootdevice\") + \"\\r\\n\" +\r\n                                          \"MAN:\\\"ssdp:discover\\\"\\r\\n\" +\r\n                                          \"MX:3\\r\\n\\r\\n\";\r\n\r\n\r\n                    var writer = new Windows.Storage.Streams.DataWriter(outputStream);\r\n                    writer.unicodeEncoding = Windows.Storage.Streams.UnicodeEncoding.Utf8;\r\n                    writer.writeString(message);\r\n                    return writer.storeAsync();\r\n                }).then(function () {\r\n                    return WinJS.Promise.timeout(timeout || 20000);\r\n                }).then(onsuccess, onerror);\r\n            }).then(function (res) {\r\n                discovery.hasError = false;\r\n            }, function (err) {\r\n                discovery.hasError = true;\r\n                discovery.error = err;\r\n            });\r\n        }\r\n\r\n        var promises = [];\r\n\r\n        if (!filter || (typeof filter == 'string')) {\r\n            promises.push(discover(filter));\r\n        }\r\n        else if (filter && typeof filter != 'string' && filter.length) {\r\n            for (var i = 0 ; i < filter.length; i++) {\r\n                promises.push(discover(filter[i]));\r\n            }\r\n        }\r\n\r\n        discovery.promise = WinJS.Promise.join(promises);\r\n\r\n        return discovery;\r\n    }\r\n\r\n    function endsWith(text, search) {\r\n        return text.indexOf(search) == text.length - search.length;\r\n    }\r\n\r\n    WinJSContrib.UPnP.getContentType = function (url, extension) {\r\n        var lowerUrl = url.toLowerCase();\r\n\r\n        if (extension == \"mp3\" || endsWith(lowerUrl, \".mp3\"))\r\n            return \"audio/mp3\";\r\n\r\n        if (extension == \"mp4\" || endsWith(lowerUrl, \".mp4\"))\r\n            return \"video/mp4\";\r\n\r\n        if (extension == \"avi\" || endsWith(lowerUrl, \".avi\"))\r\n            return \"video/avi\";\r\n\r\n        if (extension == \"mkv\" || endsWith(lowerUrl, \".mkv\"))\r\n            return \"video/x-matroska\";\r\n    }\r\n\r\n    function xmlToJson(xml) {\r\n\r\n        // Create the return object\r\n        var obj = {};\r\n\r\n        if (xml.nodeType == 1) { // element\r\n            // do attributes\r\n            if (xml.attributes.length > 0) {\r\n                obj[\"@attributes\"] = {};\r\n                for (var j = 0; j < xml.attributes.length; j++) {\r\n                    var attribute = xml.attributes.item(j);\r\n\r\n                    obj[\"@attributes\"][attribute.nodeName] = attribute.nodeValue;\r\n                }\r\n            }\r\n        } else if (xml.nodeType == 3) { // text\r\n            obj = xml.nodeValue;\r\n        }\r\n\r\n        // do children\r\n        if (xml.hasChildNodes()) {\r\n            var properties = 0;\r\n            for (var i = 0; i < xml.childNodes.length; i++) {\r\n                var item = xml.childNodes.item(i);\r\n                var nodeName = item.nodeName;\r\n                if (typeof (obj[nodeName]) == \"undefined\") {\r\n                    var tmp = xmlToJson(item);\r\n                    var colonIdx = nodeName.indexOf(':');\r\n                    if (colonIdx > 0) {\r\n                        var clearNode = nodeName.substr(colonIdx + 1, nodeName.length - colonIdx - 1);\r\n\r\n                    }\r\n\r\n                    if (clearNode && !obj[clearNode]) {\r\n                        obj[clearNode] = tmp;\r\n                    } else {\r\n                        obj[nodeName] = tmp;\r\n                    }\r\n\r\n                    properties++;\r\n                } else {\r\n                    if (typeof (obj[nodeName].push) == \"undefined\") {\r\n                        var old = obj[nodeName];\r\n                        obj[nodeName] = [];\r\n                        obj[nodeName].push(old);\r\n                    }\r\n                    obj[nodeName].push(xmlToJson(item));\r\n                    properties++;\r\n                }\r\n            }\r\n\r\n            if (obj['#text'] && typeof obj['#text'] == 'string') {\r\n                obj['#text'] = obj['#text'].trim();\r\n            }\r\n            if (properties == 1 && obj['#text'] && typeof obj['#text'] == 'string') {\r\n                obj = obj['#text'];\r\n            }\r\n        }\r\n\r\n        for (var e in obj[\"@attributes\"]) {\r\n            if (!obj[e])\r\n                obj[e] = obj[\"@attributes\"][e];\r\n        }\r\n\r\n        return obj;\r\n    };\r\n\r\n    /**\r\n     * UPnP device\r\n     * @class\r\n     */\r\n    WinJSContrib.UPnP.UPnPDevice = function (deviceObj) {\r\n        for (var p in deviceObj) {\r\n            this[p] = deviceObj[p];\r\n        }\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getService = function (serviceType) {\r\n        var device = this;\r\n        var service = null;\r\n\r\n        if (typeof serviceType == 'string')\r\n            serviceType = [serviceType];\r\n\r\n        if (device.serviceList && device.serviceList.service) {\r\n            service = device.serviceList.service.filter(function (s) {\r\n                return serviceType.indexOf(s.serviceType) >= 0;\r\n            })[0];\r\n\r\n            if (!service && device.deviceList) {\r\n                device.deviceList.device.forEach(function (childdevice) {\r\n                    var childService = childdevice.serviceList.service.filter(function (s) {\r\n                        return serviceType.indexOf(s.serviceType) >= 0;\r\n                    })[0];\r\n\r\n                    if (childService)\r\n                        service = childService;\r\n                });\r\n            }\r\n        }\r\n\r\n        if (service) {\r\n            service.rootUrl = device.rootUrl;\r\n            service.url = device.rootUrl + service.controlURL;\r\n        }\r\n\r\n        return service;\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getAVTransport = function () {\r\n        var service = this.getService([WinJSContrib.UPnP.deviceTypes.AVTransport1, WinJSContrib.UPnP.deviceTypes.AVTransport2]);\r\n        if (service) {\r\n            return new WinJSContrib.UPnP.UPnPAVTransport(service);\r\n        }\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getContentDirectory = function () {\r\n        var service = this.getService([WinJSContrib.UPnP.deviceTypes.ContentDirectory1, WinJSContrib.UPnP.deviceTypes.ContentDirectory2, WinJSContrib.UPnP.deviceTypes.ContentDirectory3, WinJSContrib.UPnP.deviceTypes.ContentDirectory4]);\r\n        if (service) {\r\n            return new WinJSContrib.UPnP.UPnPContentDirectory(service);\r\n        }\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPDevice.prototype.getConnectionManager = function () {\r\n        var service = this.getService([WinJSContrib.UPnP.deviceTypes.ConnectionManager1, WinJSContrib.UPnP.deviceTypes.ConnectionManager2, WinJSContrib.UPnP.deviceTypes.ConnectionManager3]);\r\n        if (service) {\r\n            return new WinJSContrib.UPnP.UPnPConnectionManager(service);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Code largely from https://github.com/richtr/plug.play.js\r\n     */\r\n\r\n    WinJSContrib.UPnP.UPnPService = function (serviceObj, opts) {\r\n\r\n        this.options = opts || { debug: false };\r\n        this.svc = serviceObj;\r\n\r\n        // API stub\r\n        this.action = function () { };\r\n\r\n        //if (!this.svc || !(this.svc instanceof NetworkService)) {\r\n\r\n        //    this.debugLog('First argument provided in constructor MUST be a valid NetworkService object');\r\n\r\n        //    return this;\r\n        //}\r\n\r\n        //if (!this.svc.type || this.svc.type.indexOf('upnp:') !== 0) {\r\n\r\n        //    this.debugLog('First argument provided in constructor MUST be a _UPnP_ NetworkService object');\r\n\r\n        //    return this;\r\n\r\n        //}\r\n\r\n        //this.svcType = this.svc.type.replace('upnp:', '');\r\n        this.svcType = this.svc.serviceType;\r\n        this.svcUrl = this.svc.url;\r\n\r\n        var self = this;\r\n\r\n        // Full API\r\n        this.action = function (upnpAction, upnpParameters, callback) {\r\n\r\n            return new WinJS.Promise(function (promiseComplete, promiseError) {\r\n\r\n                // Handle .action( name, callback )\r\n                if (!callback && Object.prototype.toString.call(upnpParameters) == '[object Function]') {\r\n                    callback = upnpParameters;\r\n                    upnpParameters = {};\r\n                }\r\n\r\n                // Generate a callback stub if a Function has not been provided\r\n                if (!callback || Object.prototype.toString.call(callback) !== '[object Function]') {\r\n                    callback = function (e, response) { };\r\n                }\r\n\r\n                // Create a UPnP XML Request message\r\n                var svcMsg = self.createRequest(self.svcType, upnpAction, upnpParameters);\r\n\r\n                // Send the UPnP XML Request message to the current service\r\n                self.sendRequest(self.svcType, upnpAction, self.svcUrl, svcMsg, function (e, xmlResponse) {\r\n\r\n                    if (e !== null) {\r\n                        callback.apply(self, [e, null]);\r\n                        promiseError(e);\r\n                        return;\r\n                    }\r\n\r\n                    // Parse UPnP XML Response message\r\n                    self.handleResponse(upnpAction, xmlResponse.responseXML || \"\", upnpParameters, function (e, upnpResponse) {\r\n\r\n                        // Fire callback\r\n                        callback.apply(self, [e, upnpResponse]);\r\n\r\n                        // Fire promise\r\n                        if (e !== null) {\r\n                            promiseError(e);\r\n                        } else {\r\n                            promiseComplete(upnpResponse);\r\n                        }\r\n\r\n                    });\r\n\r\n                });\r\n            });\r\n        }\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.constructor = WinJSContrib.UPnP.UPnPService;\r\n\r\n    // UPnP XML MESSAGING TEMPLATES\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.requestTemplate = \"<?xml version=\\\"1.0\\\" encoding=\\\"utf-8\\\"?>\\n\" +\r\n     \"<s:Envelope s:encodingStyle=\\\"http://schemas.xmlsoap.org/soap/encoding/\\\" \" +\r\n       \"xmlns:s=\\\"http://schemas.xmlsoap.org/soap/envelope/\\\">\\n\" +\r\n       \"\\t<s:Body>\\n\" +\r\n         \"\\t\\t<u:{ACTION_NAME} xmlns:u=\\\"{ACTION_TYPE}\\\">\\n\" +\r\n           \"{ACTION_VARS}\" +\r\n         \"\\t\\t</u:{ACTION_NAME}>\\n\" +\r\n       \"\\t</s:Body>\\n\" +\r\n     \"</s:Envelope>\\n\";\r\n\r\n    // UPNP PRIMITIVE VARIABLE TYPE CHECKERS\r\n    // from http://upnp.org/specs/arch/UPnP-arch-DeviceArchitecture-v1.0.pdf\r\n    WinJSContrib.UPnP.UPnPService.prototype.types = {\r\n\r\n        \"i1\": function (val, allowedValues, toNative) {\r\n            var i8 = new Int8Array(1);\r\n            i8[0] = val;\r\n\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(i8[0], allowedValues);\r\n\r\n        },\r\n\r\n        \"i2\": function (val, allowedValues, toNative) {\r\n            var i16 = new Int16Array(1);\r\n            i16[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(i16[0], allowedValues);\r\n        },\r\n\r\n        \"i4\": function (val, allowedValues, toNative) {\r\n            var i32 = new Int32Array(1);\r\n            i32[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(i32[0], allowedValues);\r\n        },\r\n\r\n        \"ui1\": function (val, allowedValues, toNative) {\r\n            var ui8 = new Uint8Array(1);\r\n            ui8[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(ui8[0], allowedValues);\r\n        },\r\n\r\n        \"ui2\": function (val, allowedValues, toNative) {\r\n            var ui16 = new Uint16Array(1);\r\n            ui16[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(ui16[0], allowedValues);\r\n        },\r\n\r\n        \"ui4\": function (val, allowedValues, toNative) {\r\n            var ui32 = new Uint32Array(1);\r\n            ui32[0] = val;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(ui32[0], allowedValues);\r\n        },\r\n\r\n        \"int\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || isNaN(val)) {\r\n                val = 0;\r\n            } else if (typeof val !== 'number') {\r\n                if (val === true) {\r\n                    val = 1;\r\n                } else {\r\n                    val = parseInt(val + \"\", 10);\r\n                }\r\n            }\r\n            if (!toNative) {\r\n                val = expandExponential(val + \"\");\r\n            }\r\n            if (isNaN(val)) val = 0;\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n        },\r\n\r\n        \"r4\": function (val, allowedValues, toNative) {\r\n            var f32 = new Float32Array(1);\r\n            f32[0] = val;\r\n            if (!toNative) {\r\n                return f32[0] ? expandExponential(f32[0] + \"\") : \"0\";\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(f32[0], allowedValues);\r\n        },\r\n\r\n        \"r8\": function (val, allowedValues, toNative) {\r\n            var f64 = new Float64Array(1);\r\n            f64[0] = val;\r\n            if (!toNative) {\r\n                return f64[0] ? expandExponential(f64[0] + \"\") : \"0\";\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(f64[0], allowedValues);\r\n        },\r\n\r\n        \"number\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['r8'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"fixed_14_4\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['float'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"float\": function (val, allowedValues, toNative) {\r\n            var _float = parseFloat(val);\r\n            if (!toNative) {\r\n                return _float ? expandExponential(_float + \"\") : \"0\";\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(_float, allowedValues);\r\n        },\r\n\r\n        \"char\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            } else if (val === false || val === true || val == \"true\" || val == \"yes\" || val == \"false\" || val == \"no\") {\r\n                val = (val === true || val == \"true\" || val == \"yes\") ? \"1\" : \"0\";\r\n            } else {\r\n                val = val.toString();\r\n            }\r\n            if (val.length > 0) {\r\n                val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n                return val.charAt(0);\r\n            }\r\n            return val;\r\n        },\r\n\r\n        \"string\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            val = val + \"\";\r\n\r\n            val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n            return val;\r\n        },\r\n\r\n        \"xmlObj\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            val = val + \"\";\r\n\r\n            val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n            try {\r\n                var s = '';\r\n\r\n                var currentPos = val.indexOf('&');\r\n                while (currentPos > 0) {\r\n                    var idx = val.indexOf(';', currentPos);\r\n                    if (idx < 0 || (idx - currentPos) > 5) {\r\n                        val = val.substr(0, currentPos) + \"&amp;\" + val.substr(currentPos + 1, val.length - (currentPos + 1));\r\n                    }\r\n                    currentPos = val.indexOf('&', currentPos + 1);\r\n                }\r\n\r\n                var xml = parseXML(val);\r\n                return xmlToJson(xml);\r\n            } catch (exception) {\r\n                console.error(exception);\r\n                return val;\r\n            }\r\n        },\r\n\r\n        \"date\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"dateTime\": function (val, allowedValues, toNative) {\r\n            if (toNative) { // Parse to ECMA Date object\r\n                if (Object.prototype.toString.call(val) == '[object String]') {\r\n                    val = new Date(parseDate(val));\r\n                    if (isNaN(val)) val = \"\";\r\n                } else if (Object.prototype.toString.call(val) == '[object Date]') {\r\n                    val = val;\r\n                }\r\n            } else { // Parse to ISO-8601 string\r\n                if (Object.prototype.toString.call(val) == '[object String]') {\r\n                    val = val + \"\";\r\n                } else if (Object.prototype.toString.call(val) == '[object Date]') {\r\n                    if (val.toString() == \"Invalid Date\") { // opera specific functionality\r\n                        val = \"\";\r\n                    } else {\r\n                        val = val.toISOString();\r\n                    }\r\n                }\r\n            }\r\n            val = WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n            return val;\r\n        },\r\n\r\n        \"dateTime_tz\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"time\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"time_tz\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['dateTime'](val, allowedValues, toNative);\r\n        },\r\n\r\n        \"boolean\": function (val, allowedValues, toNative) {\r\n            if (val == 'false' || val == 'f' || val == 'no' || val == 'n' || val instanceof RegExp || val <= 0 || !val) {\r\n                if (toNative) {\r\n                    val = false;\r\n                } else {\r\n                    val = \"0\";\r\n                }\r\n            } else {\r\n                if (toNative) {\r\n                    val = true;\r\n                } else {\r\n                    val = \"1\";\r\n                }\r\n            }\r\n            return val;\r\n        },\r\n\r\n        \"bin_base64\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            if (val === true || val === false) {\r\n                val = val === true ? \"1\" : \"0\";\r\n            }\r\n            if (toNative) { // convert to string\r\n                val = atob(val + \"\");\r\n            } else { // convert to base64\r\n                val = btoa(val + \"\");\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n        },\r\n\r\n        \"bin_hex\": function (val, allowedValues, toNative) {\r\n            if (val === undefined || val === null || val === \"\" || (val + \"\") == \"NaN\" || val instanceof RegExp) {\r\n                val = \"\";\r\n            }\r\n            if (val === true || val === false) {\r\n                val = val === true ? \"1\" : \"0\";\r\n            }\r\n            if (toNative) { // convert to string\r\n                val = htoa(val + \"\");\r\n            } else { // convert to hex\r\n                val = atoh(val + \"\");\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues(val, allowedValues);\r\n        },\r\n\r\n        \"uri\": function (val, allowedValues, toNative) {\r\n            if (toNative) {\r\n                val = decodeURI(val + \"\");\r\n            }\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['string'](val, allowedValues); // No URI syntax checking\r\n        },\r\n\r\n        \"uuid\": function (val, allowedValues, toNative) {\r\n            return WinJSContrib.UPnP.UPnPService.prototype.types['string'](val, allowedValues); // No UUID syntax checking\r\n        }\r\n\r\n    };\r\n\r\n    // Override .types toString function\r\n    for (var type in WinJSContrib.UPnP.UPnPService.prototype.types) {\r\n        WinJSContrib.UPnP.UPnPService.prototype.types[type]._name = type;\r\n        WinJSContrib.UPnP.UPnPService.prototype.types[type][\"toString\"] = function () { return this._name; };\r\n    }\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.createRequest = function (upnpServiceType, upnpActionName, parameters) {\r\n\r\n        parameters = this.formatParameters(parameters);\r\n\r\n        this.debugLog('Creating UPnP XML Control Message for [' + upnpActionName + '] with parameters:');\r\n        this.debugLog(JSON ? JSON.stringify(parameters) : null);\r\n\r\n        // Build basic part of XML request\r\n        var svcMsg = this.requestTemplate.replace(/\\{ACTION_TYPE\\}/g, encodeXML(trim(upnpServiceType)));\r\n\r\n        svcMsg = svcMsg.replace(/\\{ACTION_NAME\\}/g, encodeXML(trim(upnpActionName)));\r\n\r\n        var svcInParams = parameters['request'],\r\n            svcInParams_xml = \"\";\r\n\r\n        if (svcInParams) {\r\n\r\n            // Generate XML parameters syntax\r\n            for (var svcParam in svcInParams) {\r\n\r\n                // Perform type checking sanitization\r\n                if (svcInParams[svcParam]['type'] !== undefined && svcInParams[svcParam]['type'] !== null) {\r\n\r\n                    // get the primitive sanitization function\r\n                    var typeCheck = this.types[svcInParams[svcParam]['type']];\r\n\r\n                    if (typeCheck) {\r\n                        svcInParams[svcParam]['value'] = typeCheck(svcInParams[svcParam]['value'], svcInParams[svcParam]['allowedValueList'], false);\r\n                    }\r\n\r\n                }\r\n\r\n                if (svcInParams[svcParam]['value'] === null || svcInParams[svcParam]['value'] === undefined) {\r\n\r\n                    svcInParams[svcParam]['value'] = \"\"; // pass through empty value\r\n\r\n                }\r\n\r\n                svcInParams_xml += \"\\t\\t\\t<\" + svcParam + \">\" + encodeXML(trim(svcInParams[svcParam]['value'] + \"\")) + \"</\" + svcParam + \">\\n\";\r\n\r\n            }\r\n\r\n        }\r\n\r\n        // Add ACTION_VARS, if any\r\n        svcMsg = svcMsg.replace(/\\{ACTION_VARS\\}/g, svcInParams_xml);\r\n\r\n        // DEBUG\r\n        this.debugLog('[REQUEST] (SOAPAction: ' + upnpServiceType + '#' + upnpActionName + ') ' + svcMsg);\r\n\r\n        return svcMsg;\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.sendRequest = function (upnpServiceType, upnpActionName, upnpEndpointURL, upnpRequestXML, onUPnPResponse) {\r\n\r\n        var soapaction = '\\\"' + upnpServiceType.replace(/[\\\"\\#]/g, '') + '#' + upnpActionName.replace(/[\\\"\\#]/g, '') + '\\\"'\r\n        var httpClient = new Windows.Web.Http.HttpClient();\r\n        var uri = new Windows.Foundation.Uri(upnpEndpointURL);\r\n        var request = new Windows.Web.Http.HttpRequestMessage(Windows.Web.Http.HttpMethod.post, uri);\r\n        request.headers.append('SOAPACTION', soapaction);\r\n        //request.headers.append('Content-Type', 'text/xml; charset=\"utf-8\";');        \r\n\r\n        request.content = new Windows.Web.Http.HttpStringContent(upnpRequestXML, Windows.Storage.Streams.UnicodeEncoding.utf8, \"text/xml\");\r\n\r\n        httpClient.sendRequestAsync(request).then(function (r) {\r\n            var content = r.content.readAsStringAsync().then(function (text) {\r\n                var xml = parseXML(text);\r\n                var r = {\r\n                    status: 200,\r\n                    responseText: text,\r\n                    responseXML: xml\r\n                };\r\n                onUPnPResponse.apply(this, [null, r]);\r\n            });\r\n\r\n        }, function (err) {\r\n            onUPnPResponse.apply(undefined, [new UPnPError('XmlHttpRequest failed'), null]);\r\n        });\r\n\r\n        return this;\r\n\r\n        try {\r\n\r\n            var xhr = new XMLHttpRequest();\r\n\r\n            xhr.open('POST', upnpEndpointURL);\r\n            xhr.setRequestHeader('Content-Type', 'text/xml; charset=\"utf-8\";');\r\n            xhr.setRequestHeader('action', soapaction);\r\n            xhr.setRequestHeader('zurgl', soapaction);\r\n            xhr.setRequestHeader('SOAPAction', soapaction);\r\n\r\n            xhr.onabort = xhr.onerror = function () {\r\n\r\n                onUPnPResponse.apply(undefined, [new UPnPError('XmlHttpRequest failed'), null]);\r\n\r\n                //xhrManager.release(xhr);\r\n\r\n            };\r\n\r\n            var self = this;\r\n\r\n            xhr.onreadystatechange = function () {\r\n\r\n                if (this.readyState < 4) return;\r\n\r\n                if (this.status !== 200) {\r\n\r\n                    onUPnPResponse.apply(undefined, [new UPnPError('XmlHttpRequest expected 200 OK. Received ' + this.status + ' response.'), null]);\r\n\r\n                    self.debugLog(\"[ERROR-RESPONSE] \" + this.responseText);\r\n\r\n                    //xhrManager.release(xhr);\r\n\r\n                    return;\r\n\r\n                }\r\n\r\n                self.debugLog(\"[SUCCESS-RESPONSE] \" + this.responseText);\r\n\r\n                onUPnPResponse.apply(this, [null, this]);\r\n\r\n                //xhrManager.release(xhr);\r\n\r\n            };\r\n\r\n            xhr.send(upnpRequestXML);\r\n\r\n        } catch (e) {\r\n\r\n            onUPnPResponse.apply(undefined, [new UPnPError(e), null]);\r\n\r\n        }\r\n\r\n        return this; // allow method chaining\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.handleResponse = function (upnpActionName, upnpResponseXML, parameters, onUPnPResolved) {\r\n\r\n        parameters = this.formatParameters(parameters);\r\n\r\n        var svcOutParams = parameters['response'];\r\n\r\n        var responseJSON = {};\r\n\r\n        // Process all XML response variables\r\n        var responseContainer = upnpResponseXML.getElementsByTagName ?\r\n                                  upnpResponseXML.getElementsByTagName(upnpActionName + \"Response\") : null;\r\n\r\n        // If we don't have any response variables, try again with the namespace attached (required for lib to work in Firefox)\r\n        if (responseContainer === null || responseContainer.length <= 0) {\r\n            responseContainer = upnpResponseXML.getElementsByTagName ?\r\n                                      upnpResponseXML.getElementsByTagName(\"u:\" + upnpActionName + \"Response\") : null;\r\n        }\r\n\r\n        if (responseContainer !== null && responseContainer.length > 0) {\r\n\r\n            var responseVars = responseContainer[0].childNodes;\r\n\r\n            if (responseVars && responseVars.length > 0) {\r\n\r\n                for (var i = 0, l = responseVars.length; i < l; i++) {\r\n\r\n                    var varName = responseVars[i].nodeName;\r\n                    var varVal = responseVars[i].firstChild ? trim(decodeXML(responseVars[i].firstChild.nodeValue + \"\")) : null;\r\n\r\n                    // Perform type checking sanitization if requested\r\n                    if (svcOutParams[varName] && svcOutParams[varName]['type'] !== undefined && svcOutParams[varName]['type'] !== null) {\r\n\r\n                        // get the primitive sanitization function\r\n                        var typeCheck = this.types[svcOutParams[varName]['type']];\r\n\r\n                        if (typeCheck) {\r\n                            varVal = typeCheck(varVal, svcOutParams[varName]['allowedValueList'] || null, true);\r\n                        }\r\n\r\n                    }\r\n\r\n                    responseJSON[varName] = (varVal !== undefined && varVal !== null) ? varVal : \"\";\r\n\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n\r\n        // Fire callback with the parsed action response data\r\n        onUPnPResolved.apply(undefined, [null, { data: responseJSON }]);\r\n\r\n        return this; // allow method chaining\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.formatParameter = function (parameter) {\r\n\r\n        var param = {};\r\n\r\n        if (parameter['type'] !== undefined || parameter['value'] !== undefined || parameter['allowedValueList'] !== undefined) {\r\n\r\n            param = parameter;\r\n\r\n            if (parameter['allowedValueList'] !== undefined && typeof parameter['allowedValueList'] !== 'array') {\r\n                parameter['allowedValueList'] = [];\r\n            }\r\n\r\n        } else {\r\n\r\n            param = { value: parameter };\r\n\r\n        }\r\n\r\n        // check type is valid, otherwise discard requested type\r\n        if (param['type'] !== undefined && param['type'] !== null) {\r\n\r\n            if (!this.types[(param['type'] + \"\")]) {\r\n\r\n                delete param['type'];\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return param;\r\n\r\n    };\r\n\r\n    // Normalize the input parameters argument\r\n    WinJSContrib.UPnP.UPnPService.prototype.formatParameters = function (parameters) {\r\n\r\n        if (parameters === undefined || parameters === null) {\r\n            parameters = {};\r\n        }\r\n\r\n        if (!parameters['request']) {\r\n            parameters['request'] = {};\r\n        }\r\n\r\n        if (!parameters['response']) {\r\n            parameters['response'] = {};\r\n        }\r\n\r\n        for (var param in parameters) {\r\n\r\n            if (param === 'request' || param === 'response') {\r\n\r\n                for (var processParam in parameters[param]) {\r\n\r\n                    parameters[param][processParam] = this.formatParameter(parameters[param][processParam]);\r\n\r\n                }\r\n\r\n            } else { // append as 'request' parameter and remove from root object\r\n\r\n                parameters['request'][param] = this.formatParameter(parameters[param]);\r\n\r\n                delete parameters[param];\r\n\r\n            }\r\n\r\n        }\r\n\r\n        return parameters;\r\n\r\n    };\r\n\r\n    // ALLOWED VALUE LIST CHECKER\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.checkAllowedValues = function (val, allowedValueList) {\r\n\r\n        // Check against allowedValues if provided\r\n        if (val && allowedValueList && Object.prototype.toString.call(allowedValueList) == '[object Array]') {\r\n\r\n            var matchFound = false;\r\n\r\n            for (var i = 0, l = allowedValueList.length; i < l; i++) {\r\n\r\n                if (val == allowedValueList[i]) {\r\n\r\n                    matchFound = true;\r\n                    break;\r\n\r\n                }\r\n            }\r\n\r\n            if (!matchFound) {\r\n                return \"\";\r\n            }\r\n        }\r\n\r\n        return val;\r\n\r\n    };\r\n\r\n    // UPnP DEBUGGER\r\n\r\n    WinJSContrib.UPnP.UPnPService.prototype.debugLog = function (msg, level) {\r\n        if ((this.options && this.options.debug)) {\r\n            console[level || 'log'](\"Plug.UPnP: \" + msg);\r\n        }\r\n    };\r\n\r\n    // UPnP ERROR OBJECT\r\n\r\n    var UPnPError = function (description) {\r\n        return {\r\n            'description': description\r\n        };\r\n    };\r\n\r\n    function parseXML(text) {\r\n        return (new DOMParser()).parseFromString(text, \"text/xml\");\r\n    }\r\n\r\n    // *** CUSTOM TYPE FUNCTIONS ***\r\n\r\n    // BASE64 FUNCTIONS\r\n    // (forked from https://github.com/dankogai/js-base64/blob/master/base64.js)\r\n\r\n    var b64chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\r\n\r\n    var b64tab = (function (bin) {\r\n        var t = {};\r\n        for (var i = 0, l = bin.length; i < l; i++) t[bin.charAt(i)] = i;\r\n        return t;\r\n    })(b64chars);\r\n\r\n    var cb_encode = function (ccc) {\r\n        var padlen = [0, 2, 1][ccc.length % 3],\r\n            ord = ccc.charCodeAt(0) << 16\r\n                | ((ccc.length > 1 ? ccc.charCodeAt(1) : 0) << 8)\r\n                | ((ccc.length > 2 ? ccc.charCodeAt(2) : 0)),\r\n            chars = [\r\n                b64chars.charAt(ord >>> 18),\r\n                b64chars.charAt((ord >>> 12) & 63),\r\n                padlen >= 2 ? '=' : b64chars.charAt((ord >>> 6) & 63),\r\n                padlen >= 1 ? '=' : b64chars.charAt(ord & 63)\r\n            ];\r\n        return chars.join('');\r\n    };\r\n\r\n    var cb_decode = function (cccc) {\r\n        var len = cccc.length,\r\n            padlen = len % 4,\r\n            n = (len > 0 ? b64tab[cccc.charAt(0)] << 18 : 0)\r\n              | (len > 1 ? b64tab[cccc.charAt(1)] << 12 : 0)\r\n              | (len > 2 ? b64tab[cccc.charAt(2)] << 6 : 0)\r\n              | (len > 3 ? b64tab[cccc.charAt(3)] : 0),\r\n            chars = [\r\n                String.fromCharCode(n >>> 16),\r\n                String.fromCharCode((n >>> 8) & 0xff),\r\n                String.fromCharCode(n & 0xff)\r\n            ];\r\n        chars.length -= [0, 0, 2, 1][padlen];\r\n        return chars.join('');\r\n    };\r\n\r\n    var btoa = global.btoa || function (b) {\r\n        return b.replace(/[\\s\\S]{1,3}/g, cb_encode);\r\n    };\r\n\r\n    var atob = global.atob || function (a) {\r\n        return a.replace(/[\\s\\S]{1,4}/g, cb_decode);\r\n    };\r\n\r\n    // HEX FUNCTIONS\r\n\r\n    var hexChars = '0123456789abcdef';\r\n\r\n    var hextab = (function (bin) {\r\n        var t = {};\r\n        for (var i = 0, l = bin.length; i < l; i++) t[i] = bin.charAt(i);\r\n        return t;\r\n    })(hexChars);\r\n\r\n    function toHex(n) {\r\n        var result = ''\r\n        var start = true;\r\n        for (var i = 32; i > 0;) {\r\n            i -= 4;\r\n            var digit = (n >> i) & 0xf;\r\n            if (!start || digit != 0) {\r\n                start = false;\r\n                result += hextab[digit];\r\n            }\r\n        }\r\n        return (result == '' ? '0' : result);\r\n    }\r\n\r\n    function pad(str, len, pad) {\r\n        var result = str;\r\n        for (var i = str.length; i < len; i++) {\r\n            result = pad + result;\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function ntos(n) {\r\n        n = n.toString(16);\r\n        if (n.length == 1) n = \"0\" + n;\r\n        n = \"%\" + n;\r\n        return unescape(n);\r\n    }\r\n\r\n    function htoa(str) {\r\n        str = str.toUpperCase().replace(new RegExp(\"s/[^0-9A-Z]//g\"));\r\n        var result = \"\";\r\n        var nextchar = \"\";\r\n        for (var i = 0; i < str.length; i++) {\r\n            nextchar += str.charAt(i);\r\n            if (nextchar.length == 2) {\r\n                result += ntos(parseInt(nextchar, 16));\r\n                nextchar = \"\";\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function atoh(str) {\r\n        var result = \"\";\r\n        for (var i = 0; i < str.length; i++) {\r\n            result += pad(toHex(str.charCodeAt(i) & 0xff), 2, '0');\r\n        }\r\n        return result;\r\n    }\r\n\r\n    // NUMBER FUNCTIONS\r\n\r\n    function expandExponential(str) {\r\n        return str.replace(/^([+-])?(\\d+).?(\\d*)[eE]([-+]?\\d+)$/, function (x, s, n, f, c) {\r\n            var l = +c < 0, i = n.length + +c, x = (l ? n : f).length,\r\n            c = ((c = Math.abs(c)) >= x ? c - x + l : 0),\r\n            z = (new Array(c + 1)).join(\"0\"), r = n + f;\r\n            return (s || \"\") + (l ? r = z + r : r += z).substr(0, i += l ? z.length : 0) + (i < r.length ? \".\" + r.substr(i) : \"\");\r\n        });\r\n    };\r\n\r\n    // STRING FUNCTIONS\r\n\r\n    var trim = function (str) {\r\n        if (String.prototype.trim) {\r\n            return str.trim();\r\n        } else {\r\n            return str.replace(/^\\s+|\\s+$/g, \"\");\r\n        }\r\n    };\r\n\r\n    var encodeXML = function (str) {\r\n        return str.replace(/\\&/g, '&amp;')\r\n                   .replace(/</g, '&lt;')\r\n                   .replace(/>/g, '&gt;')\r\n                   .replace(/'/g, '&#39;')\r\n                   .replace(/\"/g, '&quot;');\r\n    };\r\n\r\n    var decodeXML = function (str) {\r\n        return str.replace(/\\&quot;/g, '\"')\r\n                   .replace(/\\&\\#39;/g, '\\'')\r\n                   .replace(/\\&gt;/g, '>')\r\n                   .replace(/\\&lt;/g, '<')\r\n                   .replace(/\\&amp;/g, '&');\r\n    };\r\n\r\n    /**\r\n     * Date.parse with progressive enhancement for ISO 8601 <https://github.com/csnover/js-iso8601>\r\n     * © 2011 Colin Snover <http://zetafleet.com>\r\n     * Released under MIT license.\r\n     *\r\n     * 2012 - Modifications to accept times without dates - by Rich Tibbett\r\n     */\r\n\r\n    var parseDate = function (date) {\r\n        var timestamp, struct, minutesOffset = 0, numericKeys = [1, 4, 5, 6, 7, 10, 11];\r\n\r\n        if (typeof date !== 'string') date += \"\";\r\n\r\n        if ((struct = /^((\\d{4}|[+\\-]\\d{6})(?:-(\\d{2})(?:-(\\d{2}))?)?)?(?:[T\\s]?(\\d{2}):(\\d{2})(?::(\\d{2})(?:\\.(\\d{3}))?)?(?:(Z)|([+\\-])(\\d{4}))?)?$/.exec(date))) {\r\n\r\n            struct = struct.slice(1, struct.length);\r\n\r\n            // avoid NaN timestamps caused by “undefined” values being passed to Date.UTC\r\n            for (var i = 0, k; (k = numericKeys[i]) ; ++i) {\r\n                struct[k] = +struct[k] || 0;\r\n            }\r\n\r\n            // allow undefined days and months\r\n            struct[2] = (+struct[2] || 1) - 1;\r\n            struct[3] = +struct[3] || 1;\r\n\r\n            if (struct[8] !== 'Z' && struct[9] !== undefined) {\r\n                minutesOffset = ((struct[10] / 100) - ((struct[10] / 100) % 1)) * 60 + (struct[10] % 100);\r\n\r\n                if (struct[9] === '+') {\r\n                    minutesOffset = 0 - minutesOffset;\r\n                }\r\n            }\r\n\r\n            timestamp = Date.UTC(struct[1], struct[2], struct[3], struct[4], struct[5] + minutesOffset, struct[6], struct[7]);\r\n        }\r\n        else {\r\n            timestamp = Date.parse ? Date.parse(date) : NaN;\r\n        }\r\n\r\n        return timestamp;\r\n    };\r\n\r\n    var allowedContentDirectoryTypes = {\r\n        'urn:schemas-upnp-org:service:ContentDirectory:1': true,\r\n        'urn:schemas-upnp-org:service:ContentDirectory:2': true,\r\n        'urn:schemas-upnp-org:service:ContentDirectory:3': true,\r\n        'urn:schemas-upnp-org:service:ContentDirectory:4': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPContentDirectory = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedContentDirectoryTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Media Server Service\");\r\n            return;\r\n        }\r\n\r\n        // *** ContentDirectory:1 methods\r\n\r\n        this.getSystemUpdateId = function (callback) {\r\n\r\n            return this.action('GetSystemUpdateID', {\r\n                request: {},\r\n                response: {\r\n                    Id: {\r\n                        type: this.types.ui4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getSearchCapabilities = function (callback) {\r\n\r\n            return this.action('GetSearchCapabilities', {\r\n                request: {},\r\n                response: {\r\n                    SearchCaps: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getSortCapabilities = function (callback) {\r\n\r\n            return this.action('GetSortCapabilities', {\r\n                request: {},\r\n                response: {\r\n                    SortCaps: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.browse = function (objectId, browseFlag, filter, startingIndex, requestedCount, sortCriteria, callback) {\r\n\r\n            return this.action('Browse', {\r\n                request: {\r\n                    ObjectID: {\r\n                        value: objectId || '0',\r\n                        type: this.types.string\r\n                    },\r\n                    BrowseFlag: {\r\n                        value: browseFlag || 'BrowseDirectChildren',\r\n                        type: this.types.string\r\n                    },\r\n                    Filter: {\r\n                        value: filter || '*',\r\n                        type: this.types.string\r\n                    },\r\n                    StartingIndex: {\r\n                        value: startingIndex || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    RequestedCount: {\r\n                        value: requestedCount || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    SortCriteria: {\r\n                        value: sortCriteria,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    Result: {\r\n                        type: this.types.xmlObj\r\n                    },\r\n                    NumberReturned: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    TotalMatches: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    UpdateID: {\r\n                        type: this.types.ui4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.search = function (objectId, browseFlag, filter, startingIndex, requestedCount, sortCriteria, callback) {\r\n\r\n            return this.action('Search', {\r\n                request: {\r\n                    ObjectID: {\r\n                        value: objectId || '0',\r\n                        type: this.types.string\r\n                    },\r\n                    BrowseFlag: {\r\n                        value: browseFlag || 'BrowseDirectChildren',\r\n                        type: this.types.string\r\n                    },\r\n                    Filter: {\r\n                        value: filter || '*',\r\n                        type: this.types.string\r\n                    },\r\n                    StartingIndex: {\r\n                        value: startingIndex || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    RequestedCount: {\r\n                        value: requestedCount || '0',\r\n                        type: this.types.ui4\r\n                    },\r\n                    SortCriteria: {\r\n                        value: sortCriteria,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    Result: {\r\n                        type: this.types.xmlObj\r\n                    },\r\n                    NumberReturned: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    TotalMatches: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    UpdateID: {\r\n                        type: this.types.ui4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n\r\n        // *** ContentDirectory:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ContentDirectory:2') {\r\n\r\n            // TODO: GetFeatureList, GetSortExtensionCapabilities, MoveObject\r\n\r\n        }\r\n\r\n\r\n        // *** ContentDirectory:3 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ContentDirectory:3') {\r\n\r\n            // TODO\r\n\r\n        }\r\n\r\n        // *** ContentDirectory:4 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ContentDirectory:4') {\r\n            // TODO\r\n        }\r\n    };\r\n    WinJSContrib.UPnP.UPnPContentDirectory.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n    var allowedConnectionManagerTypes = {\r\n        'urn:schemas-upnp-org:service:ConnectionManager:1': true,\r\n        'urn:schemas-upnp-org:service:ConnectionManager:2': true,\r\n        'urn:schemas-upnp-org:service:ConnectionManager:3': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPConnectionManager = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedConnectionManagerTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Service\");\r\n            return;\r\n        }\r\n\r\n        // *** ConnectionManager:1 methods\r\n\r\n        this.getCurrentConnectionIDs = function (callback) {\r\n\r\n            return this.action('GetCurrentConnectionIDs', {\r\n                request: {},\r\n                response: {\r\n                    ConnectionIDs: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getCurrentConnectionInfo = function (connectionId, callback) {\r\n\r\n            return this.action('GetCurrentConnectionInfo', {\r\n                request: {\r\n                    ConnectionID: {\r\n                        value: connectionId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    RcsID: {\r\n                        type: this.types.i4\r\n                    },\r\n                    AVTransportID: {\r\n                        type: this.types.i4\r\n                    },\r\n                    ProtocolInfo: {\r\n                        type: this.types.string\r\n                    },\r\n                    PeerConnectionManager: {\r\n                        type: this.types.string\r\n                    },\r\n                    PeerConnectionID: {\r\n                        type: this.types.i4\r\n                    },\r\n                    Direction: {\r\n                        type: this.types.string\r\n                    },\r\n                    Status: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getProtocolInfo = function (callback) {\r\n\r\n            return this.action('GetProtocolInfo', {\r\n                request: {},\r\n                response: {\r\n                    Source: {\r\n                        type: this.types.string\r\n                    },\r\n                    Sink: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        // *** ConnectionManager:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:ConnectionManager:2') {\r\n            // TODO\r\n        }\r\n\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPConnectionManager.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n    var allowedAVTransportTypes = {\r\n        'urn:schemas-upnp-org:service:AVTransport:1': true,\r\n        'urn:schemas-upnp-org:service:AVTransport:2': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPAVTransport = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedAVTransportTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Media Renderer Service\");\r\n            return;\r\n        }\r\n\r\n        // *** AVTransport:1 methods\r\n\r\n        this.getDeviceCapabilities = function (instanceId, callback) {\r\n\r\n            return this.action('GetDeviceCapabilities', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    PlayMedia: {\r\n                        type: this.types.string\r\n                    },\r\n                    RecMedia: {\r\n                        type: this.types.string\r\n                    },\r\n                    RecQualityModes: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getMediaInfo = function (instanceId, callback) {\r\n\r\n            return this.action('GetMediaInfo', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    NrTracks: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    MediaDuration: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentURI: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentURIMetaData: {\r\n                        type: this.types.string\r\n                    },\r\n                    NextURI: {\r\n                        type: this.types.string\r\n                    },\r\n                    NextURIMetaData: {\r\n                        type: this.types.string\r\n                    },\r\n                    PlayMedium: {\r\n                        type: this.types.string\r\n                    },\r\n                    RecordMedium: {\r\n                        type: this.types.string\r\n                    },\r\n                    WriteStatus: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getPositionInfo = function (instanceId, callback) {\r\n\r\n            return this.action('GetPositionInfo', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    Track: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    TrackDuration: {\r\n                        type: this.types.string\r\n                    },\r\n                    TrackMetaData: {\r\n                        type: this.types.xmlObj\r\n                    },\r\n                    TrackURI: {\r\n                        type: this.types.string\r\n                    },\r\n                    RelTime: {\r\n                        type: this.types.string\r\n                    },\r\n                    AbsTime: {\r\n                        type: this.types.string\r\n                    },\r\n                    RelCount: {\r\n                        type: this.types.i4\r\n                    },\r\n                    AbsCount: {\r\n                        type: this.types.i4\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getTransportInfo = function (instanceId, callback) {\r\n\r\n            return this.action('GetTransportInfo', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentTransportState: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentTransportStatus: {\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentSpeed: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getTransportSettings = function (instanceId, callback) {\r\n\r\n            return this.action('GetTransportSettings', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    PlayMode: {\r\n                        type: this.types.ui4\r\n                    },\r\n                    RecQualityMode: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setAVTransportURI = function (instanceId, currentURI, currentURIMetaData, callback) {\r\n\r\n            return this.action('SetAVTransportURI', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    CurrentURI: {\r\n                        value: currentURI,\r\n                        type: this.types.string\r\n                    },\r\n                    CurrentURIMetaData: {\r\n                        value: currentURIMetaData,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.play = function (instanceId, speed, callback) {\r\n\r\n            return this.action('Play', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Speed: {\r\n                        value: speed || '1',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.pause = function (instanceId, callback) {\r\n\r\n            return this.action('Pause', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.stop = function (instanceId, callback) {\r\n\r\n            return this.action('Stop', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.next = function (instanceId, callback) {\r\n\r\n            return this.action('Next', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.previous = function (instanceId, callback) {\r\n\r\n            return this.action('Previous', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.seek = function (instanceId, unit, target, callback) {\r\n\r\n            return this.action('Seek', {\r\n                request: {\r\n                    InstanceID: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Unit: {\r\n                        value: unit,\r\n                        type: this.types.string\r\n                    },\r\n                    Target: {\r\n                        value: target,\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {}\r\n            }, callback);\r\n\r\n        };\r\n\r\n        // *** AVTransport:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:AVTransport:2') {\r\n\r\n            // TODO\r\n\r\n        }\r\n    };\r\n    WinJSContrib.UPnP.UPnPAVTransport.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n    var allowedRenderingControlTypes = {\r\n        'urn:schemas-upnp-org:service:RenderingControl:1': true,\r\n        'urn:schemas-upnp-org:service:RenderingControl:2': true,\r\n        'urn:schemas-upnp-org:service:RenderingControl:3': true\r\n    };\r\n\r\n    WinJSContrib.UPnP.UPnPRenderingControl = function (serviceObj, opts) {\r\n\r\n        WinJSContrib.UPnP.UPnPService.apply(this, [serviceObj, opts]);\r\n\r\n        this.upnpType = serviceObj.serviceType;\r\n        //if (serviceObj.type.indexOf('upnp:') === 0) {\r\n        //    this.upnpType = this.upnpType.replace('upnp:', '');\r\n        //}\r\n\r\n        if (!allowedRenderingControlTypes[this.upnpType]) {\r\n            console.error(\"Provided service is not a UPnP Media Renderer Service\");\r\n            return;\r\n        }\r\n\r\n        // *** RenderingControl:1 methods\r\n\r\n        this.listPresets = function (instanceId, callback) {\r\n\r\n            return this.action('ListPresets', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentPresetNameList: {\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.selectPreset = function (instanceId, presetName, callback) {\r\n\r\n            return this.action('SelectPreset', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    PresetName: {\r\n                        value: presetName || \"FactoryDefaults\",\r\n                        type: this.types.string\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBrightness = function (instanceId, callback) {\r\n\r\n            return this.action('GetBrightness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBrightness: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setBrightness = function (instanceId, desiredBrightness, callback) {\r\n\r\n            return this.action('SetBrightness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredBrightness: {\r\n                        value: desiredBrightness,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getContrast = function (instanceId, callback) {\r\n\r\n            return this.action('GetContrast', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentContrast: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setContrast = function (instanceId, desiredContrast, callback) {\r\n\r\n            return this.action('SetContrast', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredContrast: {\r\n                        value: desiredContrast,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getSharpness = function (instanceId, callback) {\r\n\r\n            return this.action('GetSharpness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentSharpness: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setSharpness = function (instanceId, desiredSharpness, callback) {\r\n\r\n            return this.action('SetSharpness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredSharpness: {\r\n                        value: desiredSharpness,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getRedVideoGain = function (instanceId, callback) {\r\n\r\n            return this.action('GetRedVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentRedVideoGain: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setRedVideoGain = function (instanceId, desiredRedVideoGain, callback) {\r\n\r\n            return this.action('SetRedVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredRedVideoGain: {\r\n                        value: desiredRedVideoGain,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getGreenVideoGain = function (instanceId, callback) {\r\n\r\n            return this.action('GetGreenVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentGreenVideoGain: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setGreenVideoGain = function (instanceId, desiredGreenVideoGain, callback) {\r\n\r\n            return this.action('SetGreenVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredGreenVideoGain: {\r\n                        value: desiredGreenVideoGain,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBlueVideoGain = function (instanceId, callback) {\r\n\r\n            return this.action('GetBlueVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBlueVideoGain: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setBlueVideoGain = function (instanceId, desiredBlueVideoGain, callback) {\r\n\r\n            return this.action('SetBlueVideoGain', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredBlueVideoGain: {\r\n                        value: desiredBlueVideoGain,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getRedVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetRedVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentRedVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setRedVideoBlackLevel = function (instanceId, desiredRedVideoBlackLevel, callback) {\r\n\r\n            return this.action('SetRedVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredRedVideoBlackLevel: {\r\n                        value: desiredRedVideoBlackLevel,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getGreenVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetGreenVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentGreenVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setGreenVideoBlackLevel = function (instanceId, desiredGreenVideoBlackLevel, callback) {\r\n\r\n            return this.action('SetGreenVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredGreenVideoBlackLevel: {\r\n                        value: desiredGreenVideoBlackLevel,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBlueVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetBlueVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBlueVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setBlueVideoBlackLevel = function (instanceId, desiredBlueVideoBlackLevel, callback) {\r\n\r\n            return this.action('SetBlueVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredBlueVideoBlackLevel: {\r\n                        value: desiredBlueVideoBlackLevel,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getBlueVideoBlackLevel = function (instanceId, callback) {\r\n\r\n            return this.action('GetBlueVideoBlackLevel', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentBlueVideoBlackLevel: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getColorTemperature = function (instanceId, callback) {\r\n\r\n            return this.action('GetColorTemperature', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentColorTemperature: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setColorTemperature = function (instanceId, desiredColorTemperature, callback) {\r\n\r\n            return this.action('SetColorTemperature', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredColorTemperature: {\r\n                        value: desiredColorTemperature,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getHorizontalKeystone = function (instanceId, callback) {\r\n\r\n            return this.action('GetHorizontalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentHorizontalKeystone: {\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setHorizontalKeystone = function (instanceId, desiredHorizontalKeystone, callback) {\r\n\r\n            return this.action('SetHorizontalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredHorizontalKeystone: {\r\n                        value: desiredHorizontalKeystone,\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVerticalKeystone = function (instanceId, callback) {\r\n\r\n            return this.action('GetVerticalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentVerticalKeystone: {\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setVerticalKeystone = function (instanceId, desiredVerticalKeystone, callback) {\r\n\r\n            return this.action('SetVerticalKeystone', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    DesiredVerticalKeystone: {\r\n                        value: desiredVerticalKeystone,\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getMute = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetMute', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentMute: {\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setMute = function (instanceId, channel, desiredMute, callback) {\r\n\r\n            return this.action('SetMute', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredMute: {\r\n                        value: desiredMute,\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVolume = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetVolume', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentVolume: {\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setVolume = function (instanceId, channel, desiredVolume, callback) {\r\n\r\n            return this.action('SetVolume', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredVolume: {\r\n                        value: desiredVolume,\r\n                        type: this.types.ui2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVolumeDB = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetVolumeDB', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentVolume: {\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setVolumeDB = function (instanceId, channel, desiredVolume, callback) {\r\n\r\n            return this.action('SetVolumeDB', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredVolume: {\r\n                        value: desiredVolume,\r\n                        type: this.types.i2\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getVolumeDBRange = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetVolumeDBRange', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    MinValue: {\r\n                        type: this.types.i2\r\n                    },\r\n                    MaxValue: {\r\n                        type: this.types.i2\r\n                    },\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.getLoudness = function (instanceId, channel, callback) {\r\n\r\n            return this.action('GetLoudness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    }\r\n                },\r\n                response: {\r\n                    CurrentLoudness: {\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        this.setLoudness = function (instanceId, channel, desiredLoudness, callback) {\r\n\r\n            return this.action('SetLoudness', {\r\n                request: {\r\n                    InstanceId: {\r\n                        value: instanceId,\r\n                        type: this.types.ui4\r\n                    },\r\n                    Channel: {\r\n                        value: channel || 'Master',\r\n                        type: this.types.string\r\n                    },\r\n                    DesiredLoudness: {\r\n                        value: desiredLoudness,\r\n                        type: this.types.boolean\r\n                    }\r\n                }\r\n            }, callback);\r\n\r\n        };\r\n\r\n        // *** RenderingControl:2 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:RenderingControl:2' ||\r\n              this.upnpType === 'urn:schemas-upnp-org:service:RenderingControl:3') {\r\n\r\n            this.getStateVariables = function (instanceId, stateVariableList, callback) {\r\n\r\n                return this.action('GetStateVariables', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        },\r\n                        StateVariableList: {\r\n                            value: stateVariableList,\r\n                            type: this.types.string\r\n                        }\r\n                    },\r\n                    response: {\r\n                        StateVariableValuePairs: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.setStateVariables = function (instanceId, renderingControlUDN, serviceType, serviceId, stateVariableValuePairs, callback) {\r\n\r\n                return this.action('SetStateVariables', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        },\r\n                        RenderingControlUDN: {\r\n                            value: renderingControlUDN,\r\n                            type: this.types.string\r\n                        },\r\n                        ServiceType: {\r\n                            value: serviceType,\r\n                            type: this.types.string\r\n                        },\r\n                        ServiceId: {\r\n                            value: serviceId,\r\n                            type: this.types.string\r\n                        },\r\n                        StateVariableValuePairs: {\r\n                            value: stateVariableValuePairs,\r\n                            type: this.types.string\r\n                        }\r\n                    },\r\n                    response: {\r\n                        StateVariableList: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n        }\r\n\r\n        // *** RenderingControl:3 methods\r\n\r\n        if (this.upnpType === 'urn:schemas-upnp-org:service:RenderingControl:3') {\r\n\r\n            this.getAllowedTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetAllowedTransforms', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        }\r\n                    },\r\n                    response: {\r\n                        CurrentAllowedTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetTransforms', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        }\r\n                    },\r\n                    response: {\r\n                        CurrentTransformValues: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.setTransforms = function (instanceId, desiredTransformValues, callback) {\r\n\r\n                return this.action('SetTransforms', {\r\n                    request: {\r\n                        InstanceId: {\r\n                            value: instanceId,\r\n                            type: this.types.ui4\r\n                        },\r\n                        DesiredTransformValues: {\r\n                            value: desiredTransformValues,\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getAllAvailableTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetAllAvailableTransforms', {\r\n                    response: {\r\n                        AllAllowedTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getAllowedDefaultTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetAllowedDefaultTransforms', {\r\n                    response: {\r\n                        AllowedDefaultTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.getDefaultTransforms = function (instanceId, callback) {\r\n\r\n                return this.action('GetDefaultTransforms', {\r\n                    response: {\r\n                        CurrentDefaultTransformSettings: {\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n            this.setDefaultTransforms = function (instanceId, desiredDefaultTransformSettings, callback) {\r\n\r\n                return this.action('SetDefaultTransforms', {\r\n                    request: {\r\n                        DesiredDefaultTransformSettings: {\r\n                            value: desiredDefaultTransformSettings,\r\n                            type: this.types.string\r\n                        }\r\n                    }\r\n                }, callback);\r\n\r\n            };\r\n\r\n        }\r\n\r\n    };\r\n    WinJSContrib.UPnP.UPnPRenderingControl.prototype = Object.create(WinJSContrib.UPnP.UPnPService.prototype);\r\n\r\n})(window);","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib;\r\n(function (WinJSContrib) {\r\n    'use strict';\r\n\r\n    /**\r\n     * Custom WinJS Bindings\r\n     * @namespace WinJSContrib.Bindings\r\n     */\r\n    (function (Bindings) {\r\n\r\n        /**\r\n         * path for default picture\r\n         */\r\n        WinJSContrib.Bindings.pictureUnavailable = '/images/unavailable.png';\r\n\r\n        /**\r\n         * Helper for reading arguments for an element\r\n         * @param {HTMLElement} element\r\n         * @param {string} argument name\r\n         */\r\n        WinJSContrib.Bindings.bindingArguments = function bindingArguments(elt, argname) {\r\n            var data;\r\n            if (WinJS.UI._optionsParser) {\r\n                var text = elt.getAttribute(\"data-win-bind-args\");\r\n                if (text) {\r\n                    data = WinJS.UI.optionsParser(text, window);\r\n                }\r\n            } else {\r\n                data = elt.dataset.winBindArgs;\r\n            }\r\n\r\n            if (data) {\r\n                if (argname) {\r\n                    return data[argname];\r\n                } else {\r\n                    return data;\r\n                }\r\n            }\r\n        };\r\n        var bindingArguments = WinJSContrib.Bindings.bindingArguments;\r\n\r\n        /**\r\n         * Binding function to remove HTML from data and add it to destination\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.removeHTML = WinJS.Binding.initializer(function (source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            var elt = document.createElement('DIV');\r\n            elt.innerHTML = data;\r\n            WinJS.Binding.oneTime({ value: elt.innerText }, ['value'], dest, [destProperty]);\r\n        });\r\n\r\n        /**\r\n         * Binding function to remove HTML from data and add it to destination with an ellipse after X characters. The number of characters is specified with \"ellipsisize\" argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.removeHTMLAndEllipsisize = WinJS.Binding.initializer(function (source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            var elt = document.createElement('DIV');\r\n            elt.innerHTML = data;\r\n            var textRes = elt.innerText;\r\n            var size = bindingArguments(dest, 'ellipsisize');\r\n\r\n            if (size)\r\n                textRes = toStaticHTML(WinJSContrib.Utils.ellipsisizeString(elt.innerText, size, true));\r\n            WinJS.Binding.oneTime({ value: textRes }, ['value'], dest, [destProperty]);\r\n        });\r\n\r\n        /**\r\n         * Binding function to remove HTML from data and add it to destination with an ellipse after X characters. The number of characters is specified with \"ellipsisize\" argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.staticHTML = WinJS.Binding.initializer(function (source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            dest[destProperty] = toStaticHTML(data);\r\n        });\r\n\r\n        /**\r\n         * Binding function to add a data-* attribute to the element. Use the destination name to specifiy attribute name\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         * @example\r\n         * //assuming object is { myproperty: 42 }\r\n         * <div data-win-bind=\"foo : myproperty WinJSContrib.Bindings.dataAttr\"></div>\r\n         * //will result to\r\n         * <div data-foo=\"42\" data-win-bind=\"foo : myproperty WinJSContrib.Bindings.dataAttr\"></div>\r\n         */\r\n        WinJSContrib.Bindings.dataAttr = WinJS.Binding.initializer(function dataAttrBinding(source, sourceProperty, dest, destProperty) {\r\n        \tvar data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n        \tdest.setAttribute('data-' + destProperty, data)\r\n        });\r\n\r\n        /**\r\n         * Binding function to add css class named after object property. You could format class by using a \"format\" argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.addClass = WinJS.Binding.initializer(function addClassBinding(source, sourceProperty, dest, destProperty) {\r\n            function setClass(newval, oldval) {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                var formatParameter = bindingArguments(dest, 'format');\r\n                if (formatParameter) {\r\n                    dest.classList.remove(formatParameter.format(oldval));\r\n                    dest.classList.add(formatParameter.format(data));\r\n                }\r\n                else {\r\n                    dest.classList.remove(oldval);\r\n                    dest.classList.add(data);\r\n                }\r\n            }\r\n\r\n            var bindingDesc = {};\r\n            bindingDesc[sourceProperty] = setClass;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * add css class based on a prefix defined with destProperty and the value from the source object\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.asClass = WinJS.Binding.initializer(function asClassBinding(source, sourceProperty, dest, destProperty) {\r\n            function setClass(newval, oldval) {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                dest.classList.remove(destProperty + '-' + oldval);\r\n                dest.classList.add(destProperty + '-' + data);\r\n            }\r\n            var bindingDesc = {};\r\n            bindingDesc[sourceProperty] = setClass;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * convert a url string for use as a background image url\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.toBgImage = WinJS.Binding.initializer(function toBgImageBinding(source, sourceProperty, dest, destProperty) {\r\n            function setImage() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data || !data.length) {\r\n                    dest.style.backgroundImage = '';\r\n                    return;\r\n                }\r\n                dest.style.backgroundImage = 'url(\"' + data + '\")';\r\n            }\r\n\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setImage;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n\r\n        WinJSContrib.Bindings.ToRealDate = WinJS.Binding.initializer(function ToRealDateBinding(source, sourceProperty, dest, destProperty) {\r\n            var date = new Date(source.date * 1000);\r\n            dest.innerHTML = date.toLocaleDateString();\r\n        });\r\n\r\n        function _setPic(dest, url) {\r\n            if (dest.nodeName.toLowerCase() == 'img') {\r\n                dest.src = url;\r\n            }\r\n            else {\r\n                dest.style.backgroundImage = 'url(\"' + url + '\")';\r\n            }\r\n            dest.classList.add('imageLoaded');\r\n        }\r\n\r\n        /**\r\n         * Asynchronously load a picture (using src for image tag and background-image for other elements) from url path, and add 'imageLoaded' css class once picture is ready. \r\n         * You could rely on '.imageLoaded' to add transitions for image loading\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.picture = WinJS.Binding.initializer(function toSmartBgImageBinding(source, sourceProperty, dest, destProperty) {\r\n            function setImage() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data || !data.length) {\r\n                    data = Bindings.pictureUnavailable;\r\n                }\r\n\r\n                dest.classList.remove('imageLoaded');\r\n                setTimeout(function () {\r\n                    WinJSContrib.UI.loadImage(data).done(function () {\r\n                        _setPic(dest, data);\r\n                    }, function () {\r\n                        _setPic(dest, Bindings.pictureUnavailable);\r\n                        WinJS.Utilities.addClass(dest, 'imageLoaded');\r\n                    });\r\n                }, 200);\r\n            }\r\n\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setImage;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n        WinJSContrib.Bindings.toSmartBgImage = WinJSContrib.Bindings.picture; //deprecated method name\r\n\r\n        /**\r\n         * show element if property is filled or true. The dest property can be used to choose what to use for showing/hiding object (opacity, visibility, or display)\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.showIf = WinJS.Binding.initializer(function hideUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.classList.remove('mcn-show');\r\n                    dest.classList.add('mcn-hide');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '0';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = 'hidden';\r\n                    } else {\r\n                        dest.style.display = 'none';\r\n                    }\r\n                } else {\r\n                    dest.classList.remove('mcn-hide');\r\n                    dest.classList.add('mcn-show');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = '';\r\n                    } else {\r\n                        dest.style.display = '';\r\n                    }\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * Alias for {@link WinJSContrib.Bindings.showIf}, just for semantic purpose\r\n         * @function\r\n         * @see WinJSContrib.Bindings.showIf\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.hideIfNot = WinJSContrib.Bindings.showIf;\r\n        WinJSContrib.Bindings.hideIfNotDefined = WinJSContrib.Bindings.showIf;//warning, deprecated\r\n\r\n        /**\r\n         * hide element if property is filled or true. The dest property can be used to choose what to use for showing/hiding object (opacity, visibility, or display)\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.hideIf = WinJS.Binding.initializer(function showUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.classList.remove('mcn-hide');\r\n                    dest.classList.add('mcn-show');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = '';\r\n                    } else {\r\n                        dest.style.display = '';\r\n                    }\r\n                } else {\r\n                    dest.classList.remove('mcn-show');\r\n                    dest.classList.add('mcn-hide');\r\n                    if (destProperty[0] === 'opacity' || destProperty[1] === 'opacity') {\r\n                        dest.style.opacity = '0';\r\n                    } else if (destProperty[0] === 'visibility' || destProperty[1] === 'visibility') {\r\n                        dest.style.visibility = 'hidden';\r\n                    } else {\r\n                        dest.style.display = 'none';\r\n                    }\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * Alias for {@link WinJSContrib.Bindings.hideIf}, just for semantic purpose\r\n         * @function\r\n         * @see WinJSContrib.Bindings.hideIf\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.showIfNot = WinJSContrib.Bindings.hideIf; //warning, deprecated\r\n\r\n        WinJSContrib.Bindings.showIfNotDefined = WinJSContrib.Bindings.hideIf; //warning, deprecated\r\n\r\n        /**\r\n         * enable element if property is filled or true\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.enableIf = WinJS.Binding.initializer(function disableUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.disabled = true;\r\n                } else {\r\n                    dest.disabled = false;\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n        WinJSContrib.Bindings.disableIfNot = WinJSContrib.Bindings.enableIf;\r\n\r\n        /**\r\n         * disable element if property is filled or true\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.disableIf = WinJS.Binding.initializer(function enableUndefined(source, sourceProperty, dest, destProperty) {\r\n            function setVisibility() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.disabled = false;\r\n                } else {\r\n                    dest.disabled = true;\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setVisibility;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n        WinJSContrib.Bindings.enableIfNot = WinJSContrib.Bindings.disableIf;\r\n\r\n        /**\r\n         * apply a percent number as width (in percent) on the element\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.toWidth = WinJS.Binding.initializer(function progressToWidth(source, sourceProperty, dest, destProperty) {\r\n            function setWidth() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                if (!data) {\r\n                    dest.style.width = '';\r\n                } else {\r\n                    dest.style.width = data + '%';\r\n                }\r\n            }\r\n            var bindingDesc = {\r\n            };\r\n            bindingDesc[sourceProperty] = setWidth;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /**\r\n         * truncate a string and add ellipse to the text if string is longer than a limit. The max size of text is determined by a 'ellipsisize' argument\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         * @example {@lang xml}\r\n         * <p data-win-bind=\"innerText : someLongText WinJSContrib.Bindings.ellipsisize\" data-win-bind-args='{ \"ellipsisize\" : 50}'></p>\r\n         */\r\n        WinJSContrib.Bindings.ellipsisize = WinJS.Binding.initializer(function toEllipsisizedBinding(source, sourceProperty, dest, destProperty) {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            var size = bindingArguments(dest, 'ellipsisize');\r\n            dest[destProperty] = toStaticHTML(WinJSContrib.Utils.ellipsisizeString(sourcedata, size, true));\r\n        });\r\n        WinJSContrib.Bindings.toEllipsisized = WinJSContrib.Bindings.ellipsisize; //deprecated name\r\n\r\n        WinJSContrib.Bindings.emptyIfNull = WinJS.Binding.initializer(function emptyIfNull(source, sourceProperty, dest, destProperty) {\r\n            var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (typeof data === \"undefined\" || data === null) {\r\n                dest[destProperty] = \"\";\r\n            } else {\r\n                dest[destProperty] = data;\r\n            }\r\n        });\r\n\r\n\r\n        /**\r\n         * Two way binding triggered by \"change\" event on inputs\r\n         * @function\r\n         * @param {Object} source object owning data\r\n         * @param {string[]} sourceProperty path to object data\r\n         * @param {HTMLElement} dest DOM element targeted by binding\r\n         * @param {string[]} destProperty path to DOM element property targeted by binding\r\n         */\r\n        WinJSContrib.Bindings.twoWayOnChange = WinJS.Binding.initializer(function twoWayOnChangeBinding(source, sourceProperty, dest, destProperty) {\r\n            function setVal() {\r\n                var data = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n                WinJSContrib.Utils.writeProperty(dest, destProperty, data || '');\r\n            }\r\n\r\n            function getVal() {\r\n                var val = WinJSContrib.Utils.getProperty(dest, destProperty);\r\n                WinJSContrib.Utils.writeProperty(source, sourceProperty, val.propValue);\r\n            }\r\n\r\n            dest.addEventListener('change', getVal, false);\r\n            if (!dest.winControl) {\r\n                dest.classList.add('win-disposable');\r\n                dest.winControl = {\r\n                    dispose: function () {\r\n                        dest.removeEventListener('change', getVal);\r\n                    }\r\n                };\r\n            }\r\n\r\n            var bindingDesc = {\r\n            };\r\n\r\n            bindingDesc[sourceProperty] = setVal;\r\n            return WinJS.Binding.bind(source, bindingDesc);\r\n        });\r\n\r\n        /** \r\n         * cleans up a binding list by returning its items as non-observable \r\n         * @function \r\n         * @param {Object[]} bindingList binding list to clean up \r\n         * @returns {Object[]} array containing the cleaned up items \r\n         */\r\n        Bindings.cleanUpBindingList = function (bindingList) {\r\n            var result = [];\r\n\r\n            bindingList.forEach(function (item) {\r\n                var unwrappedItem = WinJS.Binding.unwrap(item);\r\n                result.push(unwrappedItem);\r\n            });\r\n\r\n            return result;\r\n        };\r\n\r\n\r\n    })(WinJSContrib.Bindings || (WinJSContrib.Bindings = {}));\r\n    var Bindings = WinJSContrib.Bindings;\r\n})(WinJSContrib || (WinJSContrib = {}));\r\n","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/// <reference path=\"WinJSContrib.binding.utils.js\" />\r\n/// <reference path=\"moment.min.js\" />\r\n\r\nvar WinJSContrib;\r\nWinJSContrib.Utils = WinJSContrib.Utils || {};\r\nWinJSContrib.Bindings = WinJSContrib.Bindings || {};\r\n\r\n(function () {\r\n    'use strict';\r\n\r\n    /** \r\n     * format date using binding argument 'formatDate'\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.formatDate = WinJS.Utilities.markSupportedForProcessing(function formatDateBinding(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                var arg = WinJSContrib.Bindings.bindingArguments(dest, 'formatDate') || 'L';\r\n                dest.innerText = moment(sourcedata).format(arg);\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n    /** \r\n     * format date using calendar function\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.calendar = WinJS.Utilities.markSupportedForProcessing(function formatDateBinding(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                dest.innerText = moment(sourcedata).calendar();\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n    function daysSince(m, d, y) {\r\n        if (d == '' || m == '' || y == '') {\r\n            //alert(\"All fields must be entered\");\r\n            return;\r\n        }\r\n\r\n        if (isNaN(m) || isNaN(y) || isNaN(d)) {\r\n            //alert(\"Only numbers .\");\r\n            return;\r\n        }\r\n\r\n        var myDate = new Date();\r\n        var yourDate = new Date(y, m - 1, d);\r\n\r\n        var secondsInADay = 1000 * 60 * 60 * 24;\r\n        var diff = Math.floor((myDate.getTime() - yourDate.getTime()) / secondsInADay);\r\n        return diff;\r\n    }\r\n\r\n\r\n    /**\r\n     * display number of days since a date\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.daysSinceDate = WinJS.Utilities.markSupportedForProcessing(function daysSinceDateBinding(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                sourcedata = new Date(sourcedata);\r\n                var m = sourcedata.getMonth() + 1, d = sourcedata.getDate(), y = sourcedata.getFullYear();\r\n                var fromdate = daysSince(m, d, y);\r\n                dest.innerText = fromdate;\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n    /**\r\n     * apply moment.js humanize formatting on a date. Use 'humanizeFormat' and 'addSuffix' arguments to configure binding\r\n     * @function\r\n     * @param {Object} source object owning data\r\n     * @param {string[]} sourceProperty path to object data\r\n     * @param {HTMLElement} dest DOM element targeted by binding\r\n     * @param {string[]} destProperty path to DOM element property targeted by binding\r\n     */\r\n    WinJSContrib.Bindings.humanizeDate = WinJS.Utilities.markSupportedForProcessing(function humanizeDate(source, sourceProperty, dest, destProperty) {\r\n        function setDate() {\r\n            var sourcedata = WinJSContrib.Utils.readProperty(source, sourceProperty);\r\n            if (!sourcedata) {\r\n                dest.innerText = '';\r\n            } else {\r\n                var arg = WinJSContrib.Bindings.bindingArguments(dest, \"humanizeFormat\"),\r\n                    addSuffix = WinJSContrib.Bindings.bindingArguments(dest, \"addSuffix\");\r\n                dest.innerText = moment.duration(sourcedata, arg).humanize(addSuffix);\r\n            }\r\n        }\r\n\r\n        var bindingDesc = {\r\n        };\r\n        bindingDesc[sourceProperty] = setDate;\r\n        return WinJS.Binding.bind(source, bindingDesc);\r\n    });\r\n\r\n\r\n})();","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib = WinJSContrib || {};\r\n\r\n(function () {\r\n\r\n    function Messenger(receiver, sender) {\r\n        var messenger = this;\r\n        messenger.isWorker = receiver.document === undefined;\r\n        messenger._pendings = {};\r\n        messenger._receiver = receiver;\r\n        messenger._sender = sender || receiver;\r\n        messenger._bindedProcessEvent = messenger._processEvent.bind(messenger);\r\n\r\n        if (messenger._receiver)\r\n            messenger._receiver.addEventListener('message', messenger._bindedProcessEvent);\r\n    };\r\n\r\n    /**\r\n     * @classdesc\r\n     * Wrapper for messaging between main code and iframe or web worker. All returns are wrapped as WinJS.Promise to enable asynchronous scenarios     \r\n     * @class\r\n     * @param {DOMElement} receiver element that will receive messages\r\n     * @param {DOMElement} sender element that will send messages\r\n     */\r\n    WinJSContrib.Messenger = WinJS.Class.mix(Messenger, WinJS.Utilities.eventMixin);\r\n\r\n    /**\r\n     * default path for smart worker js file\r\n     */\r\n    WinJSContrib.Messenger.SmartWorkerPath = '/scripts/winjscontrib/winjscontrib.messenger.worker.js';\r\n\r\n    /**\r\n     * @classdesc\r\n     * Wrapper for {@link WinJSContrib.Messenger} when using it with a webworker\r\n     * @class\r\n     * @param {string} [path] path to web worker file\r\n     */\r\n    WinJSContrib.Messenger.SmartWorker = function (path) {\r\n        if (window.Worker) {\r\n            var w = new window.Worker(path || WinJSContrib.Messenger.SmartWorkerPath);\r\n            return new WinJSContrib.Messenger(w, w);\r\n        }\r\n\r\n        return new WinJSContrib.Messenger(null, null);\r\n    }\r\n\r\n\r\n    WinJSContrib.Messenger.prototype._send = function (obj) {\r\n        if (this.isWorker) {\r\n            this._sender.postMessage(JSON.stringify(obj));\r\n        }\r\n        else {\r\n            this._sender.postMessage(JSON.stringify(obj), '*');\r\n        }\r\n    };\r\n\r\n    /**\r\n     * import script files\r\n     * @param {Array} scriptPaths an array of string paths to js files\r\n     */\r\n    WinJSContrib.Messenger.prototype.importScripts = function (scriptPaths) {\r\n        if (!this._receiver)\r\n            return WinJS.Promise.wrap();\r\n\r\n        return this.start('_doImportScripts', scriptPaths);\r\n    }\r\n\r\n    WinJSContrib.Messenger.prototype._doImportScripts = function (scriptPaths) {\r\n        return new WinJS.Promise(function (c) {\r\n            if (typeof scriptPaths == 'string') {\r\n                importScripts(scriptPaths);\r\n            } else if (scriptPaths.length) {\r\n                for (var i = 0 ; i < scriptPaths.length ; i++) {\r\n                    importScripts(scriptPaths[i]);\r\n                }\r\n            }\r\n            c();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * run the callback in the web worker. The callback is serialized to string so you must pass all variable used inside the function as arguments\r\n     * @param {function} func function callback\r\n     * @param {...Object} args\r\n     * @returns {WinJS.Promise}\r\n     */\r\n    WinJSContrib.Messenger.prototype.execute = function (func) {\r\n        var messenger = this;\r\n        var args = [];\r\n        if (arguments.length > 1) {\r\n            for (var i = 1 ; i < arguments.length; i++) {\r\n                args.push(arguments[i]);\r\n            }\r\n        }\r\n\r\n        if (messenger._receiver) {\r\n            var f = 'var messengerFunction=' + func;\r\n\r\n            return this.start('_runFunction', { f: f, args: args });\r\n        }\r\n        else {\r\n            return WinJS.Promise.timeout(0).then(function () {\r\n                return func.apply(null, args);\r\n            });\r\n        }\r\n    }\r\n\r\n    WinJSContrib.Messenger.prototype._runFunction = function (functionArgs) {\r\n        var messenger = this;\r\n        return new WinJS.Promise(function (c, e) {\r\n            try {\r\n                eval(functionArgs.f);\r\n                var res = messengerFunction.apply(null, functionArgs.args);\r\n                c(res);\r\n            } catch (exception) {\r\n                e(exception);\r\n            }\r\n        });\r\n    }\r\n\r\n    WinJSContrib.Messenger.prototype.map = function (object, functions) {\r\n        var messenger = this;\r\n        functions.forEach(function (name) {\r\n            messenger[name] = function () {\r\n                var f = object[name];\r\n                return f.apply(object, arguments);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * start an operation within iframe or worker and get a promise for completion\r\n     * @param {string} eventName name of the event/function to call\r\n     * @param {Object} data event/function passed as argument\r\n     * @returns {WinJS.Promise}\r\n     */\r\n    WinJSContrib.Messenger.prototype.start = function (eventName, data, asArgs) {\r\n        var messenger = this;\r\n\r\n        if (!messenger._receiver)\r\n            return WinJS.Promise.wrapError('worker not supported');\r\n\r\n        var wrapper = {\r\n            id: WinJSContrib.Utils.guid(),\r\n            complete: null, error: null, progress: null, promise: null\r\n        }\r\n\r\n        var event = {\r\n            name: eventName,\r\n            id: wrapper.id,\r\n            type: 'run',\r\n            data: data,\r\n            asArgs: asArgs,\r\n            sender: 'WinJSContrib.WinJSContrib.Messenger'\r\n        };\r\n\r\n        wrapper.promise = new WinJS.Promise(function (c, e, p) {\r\n            wrapper.complete = c;\r\n            wrapper.error = e;\r\n            wrapper.progress = p;\r\n        }, function oncancel() {\r\n            console.warn('message canceled');\r\n            event.type = 'cancel';\r\n            messenger._send(event);\r\n        });\r\n\r\n        messenger._pendings[wrapper.id] = wrapper;\r\n        var cleanUp = function () {\r\n            delete messenger._pendings[wrapper.id];\r\n        }\r\n        wrapper.promise.done(cleanUp, cleanUp);\r\n        messenger._send(event);\r\n\r\n        return wrapper.promise;\r\n    };\r\n\r\n    WinJSContrib.Messenger.prototype._processEvent = function (arg) {\r\n        var messenger = this;\r\n       \r\n        var details = typeof (arg.data) == 'string' ? JSON.parse(arg.data) : arg.data;\r\n        var name = details.name;\r\n        var data = details.data;\r\n        var asArgs = details.asArgs;\r\n\r\n        if (details.id) {\r\n            var wrapper = messenger._pendings[details.id];\r\n            if (wrapper && wrapper[details.type]) {\r\n                wrapper[details.type](data);\r\n                return;\r\n            }\r\n\r\n            if (details.type === 'cancel') {\r\n                var current = messenger._pendings[details.id];\r\n                if (current) {\r\n                    current.promise.cancel();\r\n                    delete messenger._pendings[details.id];\r\n                }\r\n            }\r\n            else if (details.type==='run' && name && messenger[name]) {\r\n                try {\r\n                    var p = null;\r\n                    if (asArgs) {\r\n                        p = WinJS.Promise.as(messenger[name].apply(messenger[name], data));\r\n                    } else {\r\n                        p = WinJS.Promise.as(messenger[name](data));\r\n                    }\r\n\r\n                   messenger._pendings[details.id] = { promise: p, details: details };\r\n\r\n                    p.then(function (arg) {\r\n                        messenger._send({ name: name, id: details.id, type: 'complete', sender: 'WinJSContrib.WinJSContrib.Messenger', data: arg });\r\n                    }, function (arg) {\r\n                        messenger._send({ name: name, id: details.id, type: 'error', sender: 'WinJSContrib.WinJSContrib.Messenger', data: arg });\r\n                    }, function (arg) {\r\n                        messenger._send({ name: name, id: details.id, type: 'progress', sender: 'WinJSContrib.WinJSContrib.Messenger', data: arg });\r\n                    }).then(function () {\r\n                        delete messenger._pendings[details.id];\r\n                    });\r\n                } catch (exception) {\r\n                    delete messenger._pendings[details.id];\r\n                    messenger._send({ name: name, id: details.id, type: 'error', sender: 'WinJSContrib.WinJSContrib.Messenger', data: { description: exception.description, message: exception.message, stack: exception.stack } });\r\n                }\r\n\r\n                return;\r\n            }\r\n            else {\r\n                messenger._send({ name: name, id: details.id, type: 'error', sender: 'WinJSContrib.WinJSContrib.Messenger', data: { message: 'callback function not found' } });\r\n            }\r\n        } else {\r\n            if (name && messenger[name]) {\r\n                messenger[name](data);\r\n                return;\r\n            }\r\n            messenger.dispatchEvent(name, data);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * release messenger and associated resources (if using webworker, worker is terminated\r\n     */\r\n    WinJSContrib.Messenger.prototype.dispose = function () {\r\n        var messenger = this;\r\n        if (messenger._receiver) {\r\n            if (messenger._receiver.terminate)\r\n                messenger._receiver.terminate();\r\n\r\n            messenger._receiver.removeEventListener('message', messenger._bindedProcessEvent);\r\n        }\r\n    };\r\n})();","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        /*\n         look at http://burakkanber.com/blog/machine-learning-full-text-search-in-javascript-relevance-scoring/\n         */\n        /**\n         * definition for a field\n         * @typedef {Object} WinJSContrib.Search.FieldDefinition\n         * @property {number} weight weight of the item to rank search results\n         * @example\n         * { weight : 2}\n         */\n        /**\n         * Definition of an index content\n         * @typedef {Object} WinJSContrib.Search.IndexDefinition\n         * @property {string} key name of the property considered as a key for the items\n         * @property {Object} fields object containing item's property path as name, and {@link WinJSContrib.Search.FieldDefinition} as value\n         * @example\n         * { key: 'id', fields: { \"title\": { weight : 5}, \"description.detail\": { weight : 2}}}\n         */\n        /**\n         * Small text search features based on objet indexing and text stemming. It's inspired by tools like Lucene.\n         * For now indexes are stored with WinRT files, but it will soon be extended to support an extensible storage mecanism\n         * @namespace WinJSContrib.Search\n         */\n        /**\n         * path for search worker script file\n         * @field WinJSContrib.Search.workerPath\n         * @type {string}\n         */\n        Search.workerPath = './scripts/winjscontrib/winjscontrib.search.worker.js';\n        function writeFile(folder, fileName, CreationCollisionOption, objectGraph) {\n            return new WinJS.Promise(function (complete, error) {\n                folder.createFileAsync(fileName, CreationCollisionOption).done(function (docfile) {\n                    Windows.Storage.FileIO.writeTextAsync(docfile, JSON.stringify(objectGraph)).done(function () {\n                        if (WinJS && WinJS.log)\n                            WinJS.log(\"File written \" + docfile.path);\n                        complete();\n                    }, error);\n                }, error);\n            });\n        }\n        Search.writeFile = writeFile;\n        function openFile(folder, fileName) {\n            return new WinJS.Promise(function (complete, error) {\n                folder.createFileAsync(fileName, Windows.Storage.CreationCollisionOption.openIfExists).then(function (file) {\n                    Windows.Storage.FileIO.readTextAsync(file).done(function (text) {\n                        if (text)\n                            complete(JSON.parse(text));\n                        else\n                            complete();\n                    }, error);\n                }, error);\n            });\n        }\n        Search.openFile = openFile;\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var Index = (function () {\n            /**\n             * Search index\n             * @class WinJSContrib.Search.Index\n             * @classdesc\n             * This class is the heart of the search engine. operations performed by this object are synchronous but exposes as promises.\n             * This way Index is almost interchangeable with {@link WinJSContrib.Search.IndexWorkerProxy}\n             * @param {string} name index name\n             * @param {WinJSContrib.Search.IndexDefinition} definition index definition\n             */\n            function Index(name, definition) {\n                this.items = [];\n                this.storeData = true;\n                var index = this;\n                index.name = name || 'defaultIndex';\n                index.definition = definition || {};\n                index.items = [];\n                index.storeData = true;\n                index.onprogress = undefined;\n                index.stopWords = WinJSContrib.Search.Stemming.StopWords.common;\n                index.pipeline = new WinJSContrib.Search.Stemming.Pipeline(definition);\n                //index.pipeline.registerDefault();\n                index.folderPromise = Windows.Storage.ApplicationData.current.localFolder.createFolderAsync(\"WinJSContrib\\\\Search\", Windows.Storage.CreationCollisionOption.openIfExists).then(function (folder) {\n                    return folder;\n                }, function (err) {\n                    if (WinJS && WinJS.log)\n                        WinJS.log(\"Folder init error \" + err.message);\n                    return null;\n                });\n            }\n            /**\n             * get number of items in index\n             * @function WinJSContrib.Search.Index.prototype.count\n             * @returns {WinJS.Promise}\n             */\n            Index.prototype.count = function () {\n                return WinJS.Promise.wrap(this.items.length);\n            };\n            /**\n             * clear index\n             * @function WinJSContrib.Search.Index.prototype.clear\n             * @returns {WinJS.Promise}\n             */\n            Index.prototype.clear = function () {\n                this.items = [];\n                return WinJS.Promise.wrap();\n            };\n            /**\n             * release index\n             * @function WinJSContrib.Search.Index.prototype.dispose\n             */\n            Index.prototype.dispose = function () {\n                this.items = [];\n                this.definition = undefined;\n                this.stopWords = undefined;\n                this.pipeline.clear();\n                this.pipeline = undefined;\n                this.onprogress = undefined;\n                this.folderPromise = undefined;\n            };\n            /**\n             * export index\n             * @function WinJSContrib.Search.Index.prototype.export\n             */\n            Index.prototype.export = function () {\n                return { definition: this.definition, items: this.items };\n            };\n            /**\n             * serialize index to string\n             * @function WinJSContrib.Search.Index.prototype.toString\n             */\n            Index.prototype.toString = function () {\n                return JSON.stringify(this.export());\n            };\n            /**\n             * load index from serialized string\n             * @function WinJSContrib.Search.Index.prototype.loadData\n             */\n            Index.prototype.loadData = function (indexString) {\n                var tmp = indexString;\n                if (typeof tmp == 'String')\n                    tmp = JSON.parse(indexString);\n                if (tmp) {\n                    if (tmp.definition && tmp.definition.fields && tmp.items && tmp.items.length) {\n                        this.definition = tmp.definition;\n                        this.pipeline.reload(this.definition);\n                    }\n                    this.items = tmp.items || [];\n                }\n            };\n            /**\n             * save index to storage\n             * @function WinJSContrib.Search.Index.prototype.save\n             * @returns {WinJS.Promise}\n             */\n            Index.prototype.save = function () {\n                var idx = this;\n                var exp = idx.export();\n                return idx.folderPromise.then(function (folder) {\n                    return Search.writeFile(folder, idx.name, Windows.Storage.CreationCollisionOption.replaceExisting, exp).then(function (filename) {\n                        return { index: idx };\n                    });\n                });\n            };\n            /**\n             * load index from storage\n             * @function WinJSContrib.Search.Index.prototype.load\n             * @returns {WinJS.Promise}\n             */\n            Index.prototype.load = function () {\n                var idx = this;\n                return idx.folderPromise.then(function (folder) {\n                    return Search.openFile(folder, idx.name).then(function (savedidx) {\n                        idx.loadData(savedidx);\n                    });\n                });\n            };\n            Index.prototype._runSearch = function (querytext, options) {\n                var index = this;\n                var preparedTokens = index.processText(querytext);\n                var searchResult = [];\n                var size = index.items.length;\n                var lastprogress = -1;\n                for (var i = 0; i < size; i++) {\n                    var itemResult = index._searchItem(preparedTokens, index.items[i]);\n                    if (itemResult)\n                        searchResult.push(itemResult);\n                    var p = (100 * i / size) << 0;\n                    if (index.onprogress && p != lastprogress)\n                        index.onprogress({ progressPercent: p, items: size, current: i });\n                    lastprogress = p;\n                }\n                searchResult = searchResult.sort(function (a, b) {\n                    return b.rank - a.rank;\n                });\n                if (options && options.limit) {\n                    searchResult = searchResult.slice(0, options.limit);\n                }\n                return searchResult;\n            };\n            /**\n             * search index\n             * @function WinJSContrib.Search.Index.prototype.search\n             * @param {string} querytext\n             * @returns {WinJS.Promise} search result\n             */\n            Index.prototype.search = function (querytext, options) {\n                return WinJS.Promise.wrap(this._runSearch(querytext, options));\n            };\n            Index.prototype._searchItem = function (searchtokens, indexitem) {\n                var index = this;\n                var size = indexitem.items.length;\n                var points = 0;\n                for (var i = 0; i < size; i++) {\n                    var tokenitem = indexitem.items[i];\n                    if (searchtokens.untokenized && tokenitem.tokens.untokenized == searchtokens.untokenized) {\n                        points += 4 * tokenitem.weight;\n                    }\n                    if (searchtokens.untokenized && tokenitem.tokens.untokenized && tokenitem.tokens.untokenized.indexOf(searchtokens.untokenized) >= 0) {\n                        points += 2 * tokenitem.weight;\n                    }\n                    for (var t = 0; t < tokenitem.tokens.items.length; t++) {\n                        var token = tokenitem.tokens.items[t];\n                        for (var s = 0; s < searchtokens.items.length; s++) {\n                            var stoken = searchtokens.items[s];\n                            if (stoken.length > 1 && token == stoken) {\n                                points += tokenitem.weight;\n                            }\n                            if (stoken.length > 2 && token.indexOf(stoken) >= 0) {\n                                points += tokenitem.weight * 0.2;\n                            }\n                        }\n                    }\n                }\n                if (points) {\n                    return { rank: points, key: indexitem.key, item: indexitem.rawdata };\n                }\n            };\n            /**\n             * set index definition\n             * @function WinJSContrib.Search.Index.prototype.define\n             */\n            Index.prototype.define = function (obj) {\n                this.definition = obj;\n            };\n            Index.prototype._add = function (obj) {\n                var index = this;\n                var key = undefined;\n                var def = index.definition;\n                var res = {\n                    items: [],\n                    rawdata: undefined,\n                    key: undefined\n                };\n                if (!def || !def.fields)\n                    return;\n                if (index.storeData)\n                    res.rawdata = obj;\n                if (def.key)\n                    res.key = WinJSContrib.Utils.readProperty(obj, def.key);\n                for (var elt in def.fields) {\n                    if (def.fields.hasOwnProperty(elt)) {\n                        var weight = def.fields[elt].weight || 1;\n                        var value = WinJSContrib.Utils.readProperty(obj, elt.split('.'));\n                        if (value)\n                            res.items.push({ tokens: index.processText(value), weight: weight });\n                    }\n                }\n                index.items.push(res);\n                return WinJS.Promise.wrap(res);\n            };\n            /**\n             * add an object to index\n             * @function WinJSContrib.Search.Index.prototype.add\n             * @param {Object} obj object to index\n             * @param {WinJSContrib.Search.IndexDefinition} definition index definition (optional), use index's definition if not defined\n             * @returns {WinJS.Promise}\n             */\n            Index.prototype.add = function (obj) {\n                return WinJS.Promise.wrap(this._add(obj));\n            };\n            /**\n             * add an array of objects to index\n             * @function WinJSContrib.Search.Index.prototype.addRange\n             * @param {Array} items items array\n             * @returns {WinJS.Promise}\n             */\n            Index.prototype.addRange = function (arr, progress) {\n                var index = this;\n                var size = arr.length;\n                var indexed = [];\n                var lastprogress = -1;\n                for (var i = 0; i < size; i++) {\n                    var item = index._add(arr[i]);\n                    if (item)\n                        indexed.push(item);\n                    var p = (100 * i / size) << 0;\n                    if (progress && p != lastprogress)\n                        progress({ progressPercent: p, items: size, current: i });\n                    lastprogress = p;\n                }\n                return WinJS.Promise.wrap({ indexed: indexed.length });\n            };\n            Index.prototype.refresh = function () {\n                var index = this;\n                var old = index.items;\n                var size = old.length;\n                index.items = [];\n                for (var i = 0; i < size; i++) {\n                    var item = index.items[i];\n                    index.add(item.rawdata);\n                }\n            };\n            /**\n             * prepare a text for search by applying stemming and tokenizing text\n             * @function WinJSContrib.Search.Index.prototype.processText\n             * @param {string} text\n             */\n            Index.prototype.processText = function (text) {\n                if (typeof text == \"number\")\n                    text = text.toString();\n                var tokens = this.tokenize(text);\n                var res = [];\n                var size = tokens.length;\n                for (var i = 0; i < size; i++) {\n                    var txt = this.pipeline.run(tokens[i]);\n                    if (txt.length > 1)\n                        res.push(txt);\n                }\n                return { items: res, untokenized: this.pipeline.run(text) };\n            };\n            /**\n             * Check if a word is a stopword\n             * @function WinJSContrib.Search.Index.prototype.checkWord\n             * @param {string} word\n             */\n            Index.prototype.checkWord = function (token) {\n                var size = this.stopWords.length;\n                for (var i = 0; i < size; i++) {\n                    if (token == this.stopWords[i])\n                        return '';\n                }\n                return token;\n            };\n            /**\n             * split a string into words\n             * @function WinJSContrib.Search.Index.prototype.tokenize\n             * @param {string} text\n             */\n            Index.prototype.tokenize = function (token) {\n                var index = this;\n                var tokens = [];\n                if (!token || !token.split)\n                    return tokens;\n                var words = token.split(/\\W+/);\n                for (var i = 0; i < words.length; i++) {\n                    if (words[i].length > 0) {\n                        tokens.push(words[i]);\n                    }\n                }\n                return tokens;\n            };\n            return Index;\n        })();\n        Search.Index = Index;\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var IndexGroup = (function () {\n            /**\n             * group of indexes\n             * @class WinJSContrib.Search.IndexGroup\n             * @param {Object} definitions object containing definitions\n             * @example\n             * var idxgroup = new WinJSContrib.Search.IndexGroup({ peoples: { \"firstname\": { weight: 42 }} });\n             */\n            function IndexGroup(definitions) {\n                /**\n                 * object containing indexes, stored by name\n                 * @field\n                 * @type Object\n                 */\n                this.indexes = {};\n                if (definitions) {\n                    for (var n in definitions) {\n                        var elt = definitions[n];\n                        if (!elt.useworker)\n                            this.indexes[n] = new WinJSContrib.Search.Index(n, elt.definition);\n                        else\n                            this.indexes[n] = new WinJSContrib.Search.IndexWorkerProxy(n, elt.definition);\n                    }\n                }\n            }\n            /**\n             * add an index to group\n             * @function WinJSContrib.Search.IndexGroup.prototype.addIndex\n             * @param {string} name index name\n             * @param {WinJSContrib.Search.IndexDefinition} definition index definition\n             * @params {boolean} async true if index must operate on a web worker\n             * @params {Array} items array of items to index\n             * @returns {WinJS.Promise}\n             */\n            IndexGroup.prototype.addIndex = function (name, definition, async, items) {\n                if (async)\n                    var idx = new WinJSContrib.Search.IndexWorkerProxy(name, definition);\n                else\n                    var idx = new WinJSContrib.Search.Index(name, definition);\n                this.indexes[name] = idx;\n                if (items && items.length) {\n                    return idx.addRange(items).then(function () {\n                        return idx;\n                    });\n                }\n                return WinJS.Promise.wrap(idx);\n            };\n            /**\n             * add items to an index\n             * @function WinJSContrib.Search.IndexGroup.prototype.addRange\n             * @param {string} name index name\n             * @params {Array} items array of items to index\n             * @returns {WinJS.Promise}\n             */\n            IndexGroup.prototype.addRangefunction = function (name, items) {\n                var idx = this.indexes[name];\n                if (idx && items && items.length) {\n                    return idx.addRange(items);\n                }\n                return WinJS.Promise.wrapError({ message: 'search index ' + name + ' not found' });\n            };\n            /**\n             * search group's indexes\n             * @function WinJSContrib.Search.IndexGroup.prototype.search\n             * @param {string} querytext search query\n             */\n            IndexGroup.prototype.search = function (querytext) {\n                var group = this;\n                var searchresult = { hasResult: false, allResults: [] };\n                function searchindex(name, index) {\n                    return index.search(querytext).then(function (res) {\n                        if (res && res.length) {\n                            res.forEach(function (item) {\n                                item.searchItemType = name;\n                                searchresult.allResults.push(item);\n                            });\n                        }\n                        searchresult[name] = res;\n                    });\n                }\n                var promises = [];\n                for (var n in this.indexes) {\n                    promises.push(searchindex(n, this.indexes[n]));\n                }\n                return WinJS.Promise.join(promises).then(function () {\n                    searchresult.allResults.sort(function (a, b) {\n                        return b.rank - a.rank;\n                    });\n                    searchresult.hasResult = searchresult.allResults.length > 0;\n                    return searchresult;\n                });\n            };\n            /**\n             * save group indexes\n             * @function WinJSContrib.Search.IndexGroup.prototype.save\n             * @returns {WinJS.Promise}\n             */\n            IndexGroup.prototype.save = function () {\n                var promises = [];\n                for (var n in this.indexes) {\n                    promises.push(this.indexes[n].save());\n                }\n                return WinJS.Promise.join(promises);\n            };\n            /**\n             * load group indexes\n             * @function WinJSContrib.Search.IndexGroup.prototype.load\n             * @returns {WinJS.Promise}\n             */\n            IndexGroup.prototype.load = function () {\n                var promises = [];\n                for (var n in this.indexes) {\n                    promises.push(this.indexes[n].load());\n                }\n                return WinJS.Promise.join(promises);\n            };\n            /**\n             * release all indexes\n             * @function WinJSContrib.Search.IndexGroup.prototype.dispose\n             */\n            IndexGroup.prototype.dispose = function () {\n                for (var n in this.indexes) {\n                    this.indexes[n].dispose();\n                }\n                this.indexes = {};\n            };\n            return IndexGroup;\n        })();\n        Search.IndexGroup = IndexGroup;\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var IndexWorkerProxy = (function () {\n            /**\n             * @classdesc\n             * Proxy for a {@link WinJSContrib.Search.Index} running in a web worker\n             * @class\n             * @param {string} name index name\n             * @param {WinJSContrib.Search.IndexDefinition} definition index definition\n             * @param {string} workerpath path for web worker script file (optional)\n             */\n            function IndexWorkerProxy(name, definition, workerpath) {\n                var wrapper = this;\n                wrapper.worker = new WinJSContrib.Messenger.SmartWorker(workerpath || WinJSContrib.Search.workerPath);\n                wrapper.init(name, definition);\n            }\n            /**\n             * initialize worker\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.init\n             * @param {string} name\n             * @param {WinJSContrib.Search.IndexDefinition} definition index definition (optional), use index's definition if not defined\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.init = function (name, definition, load) {\n                return this.worker.start('init', { name: name, load: load, definition: definition });\n            };\n            /**\n             * start search\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.search\n             * @param {string} searchTerm search query\n             * @param {Object} options\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.search = function (searchTerm, options) {\n                return this.worker.start('search', { searchTerm: searchTerm, options: options });\n            };\n            /**\n             * get the number of items in index\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.count\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.count = function () {\n                return this.worker.start('count');\n            };\n            /**\n             * add an object to index\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.add\n             * @param {Object} obj object to index\n             * @param {Object} options\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.add = function (data, options) {\n                return this.worker.start('index', { items: [data], options: options });\n            };\n            /**\n             * add an array of objects to index\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.addRange\n             * @param {Array} items items array\n             * @param {Object} options\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.addRange = function (data, options) {\n                return this.worker.start('index', { items: data, options: options });\n            };\n            /**\n             * release proxy\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.dispose\n             */\n            IndexWorkerProxy.prototype.dispose = function () {\n                this.worker.dispose();\n            };\n            /**\n             * clear index\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.clear\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.clear = function () {\n                return this.worker.start('clear');\n            };\n            /**\n             * load index from storage\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.load\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.load = function () {\n                return this.worker.start('load');\n            };\n            /**\n             * save index to storage\n             * @function WinJSContrib.Search.IndexWorkerProxy.prototype.save\n             * @returns {WinJS.Promise}\n             */\n            IndexWorkerProxy.prototype.save = function () {\n                return this.worker.start('save');\n            };\n            return IndexWorkerProxy;\n        })();\n        Search.IndexWorkerProxy = IndexWorkerProxy;\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var Stemming;\n        (function (Stemming) {\n            /**\n             * @namespace\n             */\n            var Pipeline = (function () {\n                /**\n                 * stemming pipeline\n                 * @class WinJSContrib.Search.Stemming.Pipeline\n                 */\n                function Pipeline(definition) {\n                    this.reload = function (definition) {\n                        var pipe = this;\n                        var sets = WinJSContrib.Search.Stemming.Presets;\n                        var ops = WinJSContrib.Search.Stemming.Op;\n                        pipe._processors = [];\n                        var processorNames = null;\n                        if (definition) {\n                            var type = typeof definition.stemming;\n                            if (type === 'string') {\n                                processorNames = sets[definition.stemming];\n                            }\n                            else if (definition.stemming && definition.stemming.length) {\n                                processorNames = definition.stemming;\n                            }\n                        }\n                        if (!processorNames) {\n                            processorNames = WinJSContrib.Search.Stemming.Presets.standard;\n                        }\n                        processorNames.forEach(function (name) {\n                            var processor = ops[name];\n                            if (processor) {\n                                pipe._processors.push(processor);\n                            }\n                        });\n                    };\n                    this.reload(definition);\n                }\n                /**\n                 * add a stemming function to pipeline\n                 * @function WinJSContrib.Search.Stemming.Pipeline.prototype.add\n                 * @param {function} callback stemming function\n                 */\n                Pipeline.prototype.add = function (callback) {\n                    this._processors.push(callback);\n                };\n                /**\n                 * @function WinJSContrib.Search.Stemming.Pipeline.prototype.clear\n                 * remove all stemming functions from pipeline\n                 */\n                Pipeline.prototype.clear = function () {\n                    this._processors = [];\n                };\n                /**\n                 * apply stemming pipeline to text\n                 * @function WinJSContrib.Search.Stemming.Pipeline.prototype.run\n                 * @param {string} text\n                 */\n                Pipeline.prototype.run = function (text) {\n                    var size = this._processors.length;\n                    var res = text;\n                    for (var i = 0; i < size; i++) {\n                        res = this._processors[i](res);\n                    }\n                    return res;\n                };\n                return Pipeline;\n            })();\n            Stemming.Pipeline = Pipeline;\n        })(Stemming = Search.Stemming || (Search.Stemming = {}));\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var Stemming;\n        (function (Stemming) {\n            var Presets;\n            (function (Presets) {\n                Presets.standard = [\n                    \"lowerCase\",\n                    \"removeDiacritics\"\n                ];\n                Presets.full = [\n                    \"lowerCase\",\n                    \"removeDiacritics\",\n                    \"dedup\",\n                    \"dropInitialLetters\",\n                    \"dropBafterMAtEnd\",\n                    \"transformCK\",\n                    \"cTransform\",\n                    \"dTransform\",\n                    \"dropG\",\n                    \"transformG\",\n                    \"dropH\",\n                    \"transformPH\",\n                    \"transformQ\",\n                    \"transformS\",\n                    \"transformX\",\n                    \"transformT\",\n                    \"dropT\",\n                    \"transformV\",\n                    \"transformWH\",\n                    \"dropW\",\n                    \"dropY\",\n                    \"transformZ\"\n                ];\n            })(Presets = Stemming.Presets || (Stemming.Presets = {}));\n        })(Stemming = Search.Stemming || (Search.Stemming = {}));\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var Stemming;\n        (function (Stemming) {\n            var StopWords;\n            (function (StopWords) {\n                /**\n                * common stop words\n                * @field WinJSContrib.Search.Stemming.StopWords.common\n                */\n                StopWords.common = [\n                    //french\n                    \"de\",\n                    \"du\",\n                    \"des\",\n                    \"le\",\n                    \"la\",\n                    \"les\",\n                    \"te\",\n                    \"ta\",\n                    \"ton\",\n                    \"tes\",\n                    \"un\",\n                    \"une\",\n                    \"et\",\n                    \"ou\",\n                    \"mais\",\n                    \"pour\",\n                    \"par\",\n                    \"avec\",\n                    \"si\",\n                    //english\n                    \"a\",\n                    \"able\",\n                    \"about\",\n                    \"across\",\n                    \"after\",\n                    \"all\",\n                    \"almost\",\n                    \"also\",\n                    \"am\",\n                    \"among\",\n                    \"an\",\n                    \"and\",\n                    \"any\",\n                    \"are\",\n                    \"as\",\n                    \"at\",\n                    \"be\",\n                    \"because\",\n                    \"been\",\n                    \"but\",\n                    \"by\",\n                    \"can\",\n                    \"cannot\",\n                    \"could\",\n                    \"dear\",\n                    \"did\",\n                    \"do\",\n                    \"does\",\n                    \"either\",\n                    \"else\",\n                    \"ever\",\n                    \"every\",\n                    \"for\",\n                    \"from\",\n                    \"get\",\n                    \"got\",\n                    \"had\",\n                    \"has\",\n                    \"have\",\n                    \"he\",\n                    \"her\",\n                    \"hers\",\n                    \"him\",\n                    \"his\",\n                    \"how\",\n                    \"however\",\n                    \"i\",\n                    \"if\",\n                    \"in\",\n                    \"into\",\n                    \"is\",\n                    \"it\",\n                    \"its\",\n                    \"just\",\n                    \"least\",\n                    \"let\",\n                    \"like\",\n                    \"likely\",\n                    \"may\",\n                    \"me\",\n                    \"might\",\n                    \"most\",\n                    \"must\",\n                    \"my\",\n                    \"neither\",\n                    \"no\",\n                    \"nor\",\n                    \"not\",\n                    \"of\",\n                    \"off\",\n                    \"often\",\n                    \"on\",\n                    \"only\",\n                    \"or\",\n                    \"other\",\n                    \"our\",\n                    \"own\",\n                    \"rather\",\n                    \"said\",\n                    \"say\",\n                    \"says\",\n                    \"she\",\n                    \"should\",\n                    \"since\",\n                    \"so\",\n                    \"some\",\n                    \"than\",\n                    \"that\",\n                    \"the\",\n                    \"their\",\n                    \"them\",\n                    \"then\",\n                    \"there\",\n                    \"these\",\n                    \"they\",\n                    \"this\",\n                    \"tis\",\n                    \"to\",\n                    \"too\",\n                    \"twas\",\n                    \"us\",\n                    \"wants\",\n                    \"was\",\n                    \"we\",\n                    \"were\",\n                    \"what\",\n                    \"when\",\n                    \"where\",\n                    \"which\",\n                    \"while\",\n                    \"who\",\n                    \"whom\",\n                    \"why\",\n                    \"will\",\n                    \"with\",\n                    \"would\",\n                    \"yet\",\n                    \"you\",\n                    \"your\"\n                ];\n            })(StopWords = Stemming.StopWords || (Stemming.StopWords = {}));\n        })(Stemming = Search.Stemming || (Search.Stemming = {}));\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var Search;\n    (function (Search) {\n        var Stemming;\n        (function (Stemming) {\n            var Op;\n            (function (Op) {\n                /**\n                 * built-in stemmings\n                 * @namespace\n                 */\n                /**\n                 *\n                 */\n                function lowerCase(token) {\n                    if (!token)\n                        return;\n                    return token.toLowerCase();\n                }\n                Op.lowerCase = lowerCase;\n                /**\n                 *\n                 */\n                function dedup(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/([^c])\\1/g, '$1');\n                }\n                Op.dedup = dedup;\n                /**\n                 *\n                 */\n                function dropInitialLetters(token) {\n                    if (!token)\n                        return;\n                    if (token.match(/^(kn|gn|pn|ae|wr)/))\n                        return token.substr(1, token.length - 1);\n                    return token;\n                }\n                Op.dropInitialLetters = dropInitialLetters;\n                /**\n                 *\n                 */\n                function dropBafterMAtEnd(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/mb$/, 'm');\n                }\n                Op.dropBafterMAtEnd = dropBafterMAtEnd;\n                /**\n                 *\n                 */\n                function cTransform(token) {\n                    if (!token)\n                        return;\n                    token = token.replace(/([^s]|^)(c)(h)/g, '$1x$3').trim();\n                    token = token.replace(/cia/g, 'xia');\n                    token = token.replace(/c(i|e|y)/g, 's$1');\n                    token = token.replace(/c/g, 'k');\n                    return token;\n                }\n                Op.cTransform = cTransform;\n                /**\n                 *\n                 */\n                function dTransform(token) {\n                    if (!token)\n                        return;\n                    token = token.replace(/d(ge|gy|gi)/g, 'j$1');\n                    token = token.replace(/d/g, 't');\n                    return token;\n                }\n                Op.dTransform = dTransform;\n                /**\n                 *\n                 */\n                function dropG(token) {\n                    if (!token)\n                        return;\n                    token = token.replace(/gh(^$|[^aeiou])/g, 'h$1');\n                    token = token.replace(/g(n|ned)$/g, '$1');\n                    return token;\n                }\n                Op.dropG = dropG;\n                /**\n                 *\n                 */\n                function transformG(token) {\n                    if (!token)\n                        return;\n                    token = token.replace(/([^g]|^)(g)(i|e|y)/g, '$1j$3');\n                    token = token.replace(/gg/g, 'g');\n                    token = token.replace(/g/g, 'k');\n                    return token;\n                }\n                Op.transformG = transformG;\n                /**\n                 *\n                 */\n                function dropH(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/([aeiou])h([^aeiou])/g, '$1$2');\n                }\n                Op.dropH = dropH;\n                /**\n                 *\n                 */\n                function transformCK(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/ck/g, 'k');\n                }\n                Op.transformCK = transformCK;\n                /**\n                 *\n                 */\n                function transformPH(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/ph/g, 'f');\n                }\n                Op.transformPH = transformPH;\n                /**\n                 *\n                 */\n                function transformQ(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/q/g, 'k');\n                }\n                Op.transformQ = transformQ;\n                /**\n                 *\n                 */\n                function transformS(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/s(h|io|ia)/g, 'x$1');\n                }\n                Op.transformS = transformS;\n                /**\n                 *\n                 */\n                function transformT(token) {\n                    if (!token)\n                        return;\n                    token = token.replace(/t(ia|io)/g, 'x$1');\n                    token = token.replace(/th/, '0');\n                    return token;\n                }\n                Op.transformT = transformT;\n                /**\n                 *\n                 */\n                function dropT(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/tch/g, 'ch');\n                }\n                Op.dropT = dropT;\n                /**\n                 *\n                 */\n                function transformV(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/v/g, 'f');\n                }\n                Op.transformV = transformV;\n                /**\n                 *\n                 */\n                function transformWH(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/^wh/, 'w');\n                }\n                Op.transformWH = transformWH;\n                /**\n                 *\n                 */\n                function dropW(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/w([^aeiou]|$)/g, '$1');\n                }\n                Op.dropW = dropW;\n                /**\n                 *\n                 */\n                function transformX(token) {\n                    if (!token)\n                        return;\n                    token = token.replace(/^x/, 's');\n                    token = token.replace(/x/g, 'ks');\n                    return token;\n                }\n                Op.transformX = transformX;\n                /**\n                 *\n                 */\n                function dropY(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/y([^aeiou]|$)/g, '$1');\n                }\n                Op.dropY = dropY;\n                /**\n                 *\n                 */\n                function transformZ(token) {\n                    if (!token)\n                        return;\n                    return token.replace(/z/, 's');\n                }\n                Op.transformZ = transformZ;\n                /**\n                 *\n                 */\n                function dropVowels(token) {\n                    if (!token)\n                        return;\n                    return token.charAt(0) + token.substr(1, token.length).replace(/[aeiou]/g, '');\n                }\n                Op.dropVowels = dropVowels;\n                /**\n                 *\n                 */\n                function removeDiacritics(s) {\n                    if (!s)\n                        return;\n                    var r = s.toLowerCase();\n                    r = r.replace(new RegExp(\"/.../g\", 'g'), \" \");\n                    r = r.replace(new RegExp(\"[àáâãäå]\", 'g'), \"a\");\n                    r = r.replace(new RegExp(\"æ\", 'g'), \"ae\");\n                    r = r.replace(new RegExp(\"ç\", 'g'), \"c\");\n                    r = r.replace(new RegExp(\"[èéêë]\", 'g'), \"e\");\n                    r = r.replace(new RegExp(\"[ìíîï]\", 'g'), \"i\");\n                    r = r.replace(new RegExp(\"ñ\", 'g'), \"n\");\n                    r = r.replace(new RegExp(\"[òóôõö]\", 'g'), \"o\");\n                    r = r.replace(new RegExp(\"œ\", 'g'), \"oe\");\n                    r = r.replace(new RegExp(\"[ùúûü]\", 'g'), \"u\");\n                    r = r.replace(new RegExp(\"[ýÿ]\", 'g'), \"y\");\n                    r = r.replace(new RegExp(\"['\\\"]\", 'g'), \" \");\n                    return r;\n                }\n                Op.removeDiacritics = removeDiacritics;\n            })(Op = Stemming.Op || (Stemming.Op = {}));\n        })(Stemming = Search.Stemming || (Search.Stemming = {}));\n    })(Search = WinJSContrib.Search || (WinJSContrib.Search = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\n//# sourceMappingURL=winjscontrib.search.js.map","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/**\r\n * @namespace\r\n */\r\nvar WinJSContrib = WinJSContrib || {};\r\n\r\n/**\r\n * @namespace\r\n */\r\nWinJSContrib.UI = WinJSContrib.UI || {};\r\n\r\n/**\r\n * @namespace\r\n */\r\nWinJSContrib.Utils = WinJSContrib.Utils || {};\r\n\r\n/// <reference path=\"winjscontrib.core.js\" />\r\nfunction HSL(hVal, sVal, lVal) {\r\n    var res = {\r\n        h: hVal,\r\n        s: sVal,\r\n        l: lVal,\r\n        addH: function (increment) {\r\n            this.h = this.h + increment;\r\n        },\r\n        addS: function (increment) {\r\n            this.s = this.s + increment;\r\n        },\r\n        addL: function (increment) {\r\n            this.l = this.l + increment;\r\n        },\r\n        toString: function () {\r\n            return 'hsl(' + this.h + ',' + this.s + '%, ' + this.l + '%)';\r\n        },\r\n        clone: function (hInc, sInc, lInc) {\r\n            var res = new HSL(this.h, this.s, this.l);\r\n            res.addH(hInc);\r\n            res.addS(sInc);\r\n            res.addL(lInc);\r\n            return res;\r\n        }\r\n    };\r\n\r\n    return res;\r\n}\r\n\r\n(function ($) {\r\n    $.fn.winControl = function () {\r\n        return this[0].winControl;\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.tap = function (callback, options) {\r\n        var opt = options || {};\r\n\r\n        return this.each(function () {\r\n        \tWinJSContrib.UI.tap(this, callback, options);\r\n        });\r\n    };\r\n\r\n    $.fn.untap = function (callback) {\r\n        return this.each(function () {\r\n            WinJSContrib.UI.untap(this);            \r\n        });\r\n    };\r\n\r\n    jQuery.fn.hatchShow = function () {\r\n        $('.hsjs').css('visibility', 'hidden').css('font-size', '').css('display', 'inner-block').css('white-space', 'pre').each(function () {\r\n            var t = $(this);\r\n            var parent = t.parent();\r\n            if (parent.hasClass('hatchshow_temp')) {\r\n                //t = parent;\r\n                parent = parent.parent();\r\n            }\r\n            else {\r\n                t.wrap(\"<span class='hatchshow_temp' style='display:block'>\");\r\n            }\r\n            var pw = parent.width();\r\n            var w = t.width();\r\n            while (t.width() < pw) {\r\n                var fsize = t.fontSize();\r\n                if (fsize > 200)\r\n                    break;\r\n                t.css('font-size', (fsize + 1) + \"px\"),\r\n                  function () {\r\n                      while (t.width() > pw) {\r\n                          var fsize = t.fontSize();\r\n                          if (fsize < 8)\r\n                              break;\r\n                          t.css('font-size', (fsize - .1) + \"px\")\r\n                      }\r\n                  };\r\n            };\r\n        }).hide().css('visibility', '').fadeIn();\r\n    };\r\n\r\n\r\n    jQuery.fn.fontSize = function () { return parseInt($(this).css('font-size').replace('px', '')); };\r\n\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.pressEnterDefaultTo = function (eltSelector, scope) {\r\n        return this.each(function () {\r\n            var $this = $(this);\r\n            $this.keypress(function (e) {\r\n                var key = e.which ? e.which : e.keyCode;\r\n                if (key == 13) {\r\n                    var $elt = scope ? $(eltSelector, scope) : $(eltSelector);\r\n                    jQuery(this).blur();\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    if ($elt[0].mcnTapTracking && $elt[0].mcnTapTracking.callback) {\r\n                        $elt[0].mcnTapTracking.callback($elt[0]);\r\n                    }\r\n                    $elt.focus().click();\r\n                }\r\n            });\r\n        });\r\n    };\r\n\r\n    $.fn.onPressEnter = function (callback) {\r\n        return this.each(function () {\r\n            var $this = $(this);\r\n            $this.keypress(function (e) {\r\n                var key = e.which ? e.which : e.keyCode;\r\n                if (key == 13) {\r\n                    jQuery(this).blur();\r\n                    e.preventDefault();\r\n                    if (callback) callback();\r\n                }\r\n            });\r\n        });\r\n    };\r\n\r\n    $.fn.throttleTextChanged = function (throttling, callback) {\r\n        return this.each(function () {\r\n            var elt = this;\r\n            var $this = $(this);\r\n            var lastval = elt.value;\r\n            $this.keydown(function (e) {\r\n                clearTimeout(elt.mcnTxtThrottling);\r\n                elt.mcnTxtThrottling = setTimeout(function () {\r\n                    lastval = elt.value;\r\n                    callback(elt, elt.value);\r\n                }, throttling);\r\n            });\r\n\r\n            $this.blur(function (e) {\r\n                if (lastval != elt.value) {\r\n                    lastval = elt.value;\r\n                    callback(elt, elt.value);\r\n                }\r\n            });\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.transitionProperties = function (properties, delay, targetValueCallback) {\r\n        var that = $(this);\r\n        //-ms-transition: all @transdur ease-in-out;\r\n        return new WinJS.Promise(function (complete, error) {\r\n            var val = properties + ' ' + delay + 'ms ease-out';\r\n            var res = that.css('transition', val);\r\n\r\n            if (targetValueCallback) {\r\n                targetValueCallback(res);\r\n            }\r\n            res.delay(delay + 10).promise().done(function () {\r\n                that.css('-ms-transition', '');\r\n                complete(res);\r\n            },\r\n            function () {\r\n                that.css('-ms-transition', '');\r\n                error(res);\r\n            });\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.toWinJSPromise = function () {\r\n        return new WinJS.Promise(function (complete, error) {\r\n            var res = this.promise().done(function () {\r\n                complete(res);\r\n            },\r\n            function () {\r\n                error(res);\r\n            });\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.renderWith = function (templateSelector, object) {\r\n        var template = $(templateSelector).get(0);\r\n        if (template)\r\n            template = template.winControl;\r\n\r\n        return this.each(function () {\r\n            var $this = $(this);\r\n            if (template) {\r\n                template.render(null, object).done(function (elt) {\r\n                    $this.append(elt.children[0]);\r\n                });\r\n            }\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.renderWithEach = function (templateSelector, objectArray, itemCallback) {\r\n        var template = $(templateSelector).get(0);\r\n        if (template)\r\n            template = template.winControl;\r\n\r\n        return this.each(function () {\r\n            var $this = $(this);\r\n            if (template) {\r\n                objectArray.forEach(function (element, index) {\r\n                    template.render(null, element).done(function (elt) {\r\n                        var templatedElt = elt.children[0];\r\n                        $this.append(templatedElt);\r\n                        if (itemCallback)\r\n                            itemCallback(element, templatedElt);\r\n                    });\r\n                });\r\n            }\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.scrollInView = function (offset, animate) {\r\n        var viewState = Windows.UI.ViewManagement.ApplicationView.value;\r\n        var horizontal = true;\r\n        if (viewState === Windows.UI.ViewManagement.ApplicationViewState.snapped || viewState === Windows.UI.ViewManagement.ApplicationViewState.fullScreenPortrait)\r\n            horizontal = false;\r\n\r\n        return this.each(function () {\r\n            var $this = $(this);\r\n            if (horizontal) {\r\n                this.offsetParent.scrollLeft = this.offsetLeft - (offset ? offset : 0);\r\n            } else {\r\n                this.offsetParent.scrollTop = this.offsetTop - (offset ? offset : 0);\r\n            }\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.scrollInParentView = function (offset, animate) {\r\n        var viewState = Windows.UI.ViewManagement.ApplicationView.value;\r\n        var horizontal = true;\r\n        if (viewState === Windows.UI.ViewManagement.ApplicationViewState.snapped || viewState === Windows.UI.ViewManagement.ApplicationViewState.fullScreenPortrait)\r\n            horizontal = false;\r\n\r\n        return this.each(function () {\r\n            if (horizontal) {\r\n                this.offsetParent.offsetParent.scrollLeft = this.offsetLeft - (offset ? offset : 0);\r\n            } else {\r\n                this.offsetParent.offsetParent.scrollTop = this.offsetTop - (offset ? offset : 0);\r\n            }\r\n        });\r\n    };\r\n})(jQuery);\r\n\r\n(function ($) {\r\n    $.fn.loadedPromises = function (callback) {\r\n        var res = [];\r\n        this.each(function () {\r\n            var $this = $(this);\r\n            var that = this;\r\n            var promise = new WinJS.Promise(function (complete, error) {\r\n                function onerror(e) {\r\n                    that.removeEventListener('error', onerror);\r\n                    that.removeEventListener('load', onloaded);\r\n                    error({ message: 'element not loaded', elt: e.currentTarget });\r\n                }\r\n\r\n                function onloaded() {\r\n                    that.removeEventListener('error', onerror);\r\n                    that.removeEventListener('load', onloaded);\r\n                    complete(that);\r\n                    if (callback)\r\n                        callback(that);\r\n                }\r\n\r\n                that.addEventListener('error', onerror);\r\n                that.addEventListener('load', onloaded, false);\r\n\r\n                if (that.naturalWidth > 0) {\r\n                    onloaded();\r\n                }\r\n            });\r\n            res.push(promise);\r\n        });\r\n\r\n        return res;\r\n    };\r\n\r\n    $.fn.whenLoaded = function (callback) {\r\n        var promises = this.loadedPromises();\r\n        if (callback) {\r\n            WinJS.Promise.join(promises).done(function (res) {\r\n                callback(res);\r\n            });\r\n        } else {\r\n            return WinJS.Promise.join(promises);\r\n        }\r\n    };\r\n\r\n    $.fn.afterTransition = function (callback, timeout) {\r\n        var promises = [];\r\n        var completed = false;\r\n\r\n        this.each(function () {\r\n            var currentElement = this;\r\n\r\n            var prom = new WinJS.Promise(function (complete, error) {\r\n                var onaftertransition = function (event) {\r\n                    if (event.srcElement === currentElement) {\r\n                        close();\r\n                    }\r\n                };\r\n                var close = function () {\r\n                    clearTimeout(timeOutRef);\r\n                    currentElement.removeEventListener(\"transitionend\", onaftertransition, false);\r\n                    complete();\r\n                }\r\n\r\n                currentElement.addEventListener(\"transitionend\", onaftertransition, false);\r\n                timeOutRef = setTimeout(close, timeout || 1000);\r\n            });\r\n            promises.push(prom);\r\n        });\r\n\r\n        var success = null, error = null;\r\n        var resultPromise = new WinJS.Promise(function (c, e) {\r\n            success = c;\r\n            error = e;\r\n        });\r\n\r\n        var p = WinJS.Promise.join(promises);\r\n        p.done(function () {\r\n            if (!completed) {\r\n                completed = true;\r\n                if (callback) {\r\n                    callback();\r\n                }\r\n                success();\r\n                return;\r\n            }\r\n            p.cancel();\r\n            error();\r\n        }, error);\r\n\r\n        return resultPromise;\r\n    };\r\n\r\n    $.fn.afterAnimation = function (callback) {\r\n        var promises = [];\r\n        this.each(function () {\r\n            var ctrl = this;\r\n            var prom = new WinJS.Promise(function (complete, error) {\r\n                function ontransition(event) {\r\n                    if (event.srcElement === currentElement) {\r\n                        ctrl.removeEventListener(\"animationend\", ontransition);\r\n                        complete();\r\n                    }\r\n                }\r\n\r\n                ctrl.addEventListener(\"animationend\", ontransition);\r\n            });\r\n            promises.push(prom);\r\n        });\r\n\r\n        WinJS.Promise.join(promises).done(function () {\r\n            if (callback)\r\n                callback();\r\n        });\r\n\r\n        return this;\r\n    };\r\n\r\n    $.fn.classBasedAnimation = function (classname) {\r\n        var promises = [];\r\n        return this.each(function () {\r\n            var ctrl = this;\r\n            $(ctrl).afterAnimation(function () {\r\n                $(ctrl).removeClass(classname);\r\n            });\r\n\r\n            $(ctrl).addClass(classname);\r\n        });\r\n    };\r\n})(jQuery);","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/// <reference path=\"WinJSContrib.core.js\" />\r\n\r\n(function () {\r\n    \"use strict\";\r\n\r\n    var appView = null;\r\n    if (window.Windows && window.Windows.UI && window.Windows.UI.ViewManagement && window.Windows.UI.ViewManagement.ApplicationView)\r\n        appView = window.Windows.UI.ViewManagement.ApplicationView;\r\n\r\n    var nav = WinJS.Navigation;\r\n\r\n    var defaultExitPageAnimation = function (elt) {\r\n        return WinJS.UI.Animation.exitPage(elt)\r\n    }\r\n\r\n    var defaultEnterPageAnimation = function (elt) {\r\n        return WinJS.UI.Animation.enterPage(elt);\r\n    }\r\n\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        parentNavigator: function (element) {\r\n            var current = element.parentNode;\r\n\r\n            while (current) {\r\n                if (current.mcnNavigator) {\r\n                    return current.winControl;\r\n                }\r\n                current = current.parentNode;\r\n            }\r\n        },\r\n\r\n        PageControlNavigator: WinJS.Class.mix(WinJS.Class.define(\r\n            /**\r\n             * @class WinJSContrib.UI.PageControlNavigator\r\n             * @param {HTMLElement} element DOM element containing the control\r\n             * @param {Object} options\r\n             */\r\n            function PageControlNavigator(element, options) {\r\n                var options = options || {};\r\n                var navigator = this;\r\n                this.element = element || document.createElement(\"div\");\r\n                this.element.winControl = this;\r\n                this.element.mcnNavigator = true;\r\n                this.element.classList.add('mcn-navigator');\r\n                this.element.classList.add('mcn-navigation-ctrl');\r\n                this.eventTracker = new WinJSContrib.UI.EventTracker();\r\n                this.delay = options.delay || 0;\r\n                this.disableHistory = options.disableHistory || false;\r\n                this.animationWaitForPreviousPageClose = options.animationWaitForPreviousPageClose || true;\r\n                this.animations = {};\r\n                this.locks = 0;\r\n\r\n                if (options.enterPageAnimation) {\r\n                    this.animations.enterPage = WinJSContrib.Utils.resolveMethod(element, options.enterPageAnimation);\r\n                }\r\n                if (!this.animations.enterPage)\r\n                    this.animations.enterPage = defaultEnterPageAnimation;\r\n\r\n                if (options.exitPageAnimation) {\r\n                    this.animations.exitPage = WinJSContrib.Utils.resolveMethod(element, options.exitPageAnimation);\r\n                }\r\n                if (!this.animations.exitPage)\r\n                    this.animations.exitPage = defaultExitPageAnimation;\r\n                this.home = options.home;\r\n                if (appView)\r\n                    this._lastViewstate = appView.value;\r\n\r\n                this.global = options.global !== undefined ? options.global : true;\r\n                if (this.global) { //navigation classique \r\n                    document.body.onkeyup = this._keyupHandler.bind(this);\r\n                    document.body.onkeypress = this._keypressHandler.bind(this);\r\n                    document.body.onmspointerup = this._mspointerupHandler.bind(this);\r\n\r\n                    WinJSContrib.UI.Application = WinJSContrib.UI.Application || {};\r\n                    WinJSContrib.UI.Application.navigator = this;\r\n\r\n                    this.eventTracker.addEvent(nav, 'beforenavigate', this._beforeNavigate.bind(this));\r\n                    this.eventTracker.addEvent(nav, 'navigated', this._navigated.bind(this));\r\n\r\n                    var systemNavigationManager = null;\r\n                    if (WinJSContrib.UI.enableSystemBackButton && window.Windows && window.Windows.UI && window.Windows.UI.Core && window.Windows.UI.Core.SystemNavigationManager) {\r\n                        systemNavigationManager = window.Windows.UI.Core.SystemNavigationManager.getForCurrentView();\r\n                    }\r\n\r\n                    if (systemNavigationManager && WinJSContrib.UI.enableSystemBackButton) {\r\n                        this.eventTracker.addEvent(systemNavigationManager, 'backrequested', function (arg) {\r\n                            if (WinJS.Navigation.canGoBack) {\r\n                                navigator.back();\r\n                                arg.handled = true;\r\n                            }\r\n                        });\r\n\r\n                    }\r\n                }\r\n                else {\r\n                    if (options.navigationEvents) {\r\n                        this.addNavigationEvents();\r\n                    }\r\n                    this._history = { backstack: [] };\r\n                }\r\n\r\n                this.eventTracker.addEvent(window, 'resize', function (args) {\r\n                    if (navigator.resizeHandler)\r\n                        cancelAnimationFrame(navigator.resizeHandler);\r\n\r\n                    navigator.resizeHandler = requestAnimationFrame(function () {\r\n                        navigator.resizeHandler = null;\r\n                        navigator._resized(args);\r\n                    });\r\n                });\r\n            },\r\n                /**\r\n                 * @lends WinJSContrib.UI.PageControlNavigator.prototype\r\n                 */\r\n                {\r\n                    home: \"\",\r\n                    /// <field domElement=\"true\" />\r\n                    element: null,\r\n                    _lastNavigationPromise: WinJS.Promise.as(),\r\n                    _lastViewstate: 0,\r\n\r\n                    // This is the currently loaded Page object.\r\n                    pageControl: {\r\n                        get: function () {\r\n                            return this.pageElement ? this.pageElement.winControl : null;\r\n                        }\r\n                    },\r\n\r\n                    // This is the root element of the current page.\r\n                    pageElement: {\r\n                        get: function () {\r\n                            return this._pageElement || this.element.lastElementChild;\r\n                        }\r\n                    },\r\n\r\n                    history: {\r\n                        get: function () {\r\n                            if (this.global)\r\n                                return WinJS.Navigation.history;\r\n                            else\r\n                                return this._history;\r\n                        }\r\n                    },\r\n\r\n                    addLock: function () {\r\n                        this.locks++;\r\n                    },\r\n\r\n                    removeLock: function () {\r\n                        this.locks--;\r\n                    },\r\n\r\n                    // Creates a container for a new page to be loaded into.\r\n                    _createPageElement: function () {\r\n                        var element = document.createElement(\"div\");\r\n                        element.setAttribute(\"dir\", window.getComputedStyle(this.element, null).direction);\r\n                        //element.style.width = \"100%\";\r\n                        //element.style.height = \"100%\";\r\n                        //element.style.position = 'relative';\r\n                        return element;\r\n                    },\r\n\r\n                    // This function disposes the page navigator and its contents.\r\n                    dispose: function () {\r\n                        if (this._disposed) {\r\n                            return;\r\n                        }\r\n                        this._disposed = true;\r\n                        this.removeNavigationEvents();\r\n                        if (WinJS.Utilities.disposeSubTree)\r\n                            WinJS.Utilities.disposeSubTree(this.element);\r\n\r\n                        this.eventTracker.dispose();\r\n                    },\r\n\r\n                    //check back navigation in the context of navigation events.\r\n                    _checkBackNavigation: function (arg) {\r\n                        var navigator = this;\r\n                        var currentPage = navigator.pageControl;\r\n                        var confirm = function () {\r\n                            arg.handled = true;\r\n                            if (arg.preventDefault)\r\n                                arg.preventDefault();\r\n                        }\r\n                        var check = function () {\r\n                            if (navigator.canGoBack) {\r\n                                navigator.back();\r\n                                confirm();\r\n                                return true;\r\n                            };\r\n                        }\r\n\r\n                        if (currentPage.canClose) {\r\n                            var res = currentPage.canClose();\r\n                            if (WinJS.Promise.is(res)) {\r\n                                res.then(function (canClose) {\r\n                                    if (!canClose) {\r\n                                        confirm();\r\n                                        return true;\r\n                                    }\r\n                                    return check();\r\n                                });\r\n                            } else {\r\n                                if (!res) {\r\n                                    confirm();\r\n                                    return true;\r\n                                }\r\n                                return check();\r\n                            }\r\n\r\n                        } else {\r\n                            return check();\r\n                        }\r\n                    },\r\n\r\n                    //register hardware backbutton. unecessary if navigator is global\r\n                    addNavigationEvents: function () {\r\n                        var navigator = this;\r\n                        this.navigationEvents = WinJSContrib.UI.registerNavigationEvents(this, function (arg) {\r\n                            navigator._checkBackNavigation(arg);\r\n                        });\r\n                    },\r\n\r\n                    removeNavigationEvents: function () {\r\n                        if (this.navigationEvents) {\r\n                            this.navigationEvents();\r\n                            this.navigationEvents = null;\r\n                        }\r\n                    },\r\n\r\n                    // Retrieves a list of animation elements for the current page.\r\n                    // If the page does not define a list, animate the entire page.\r\n                    _getAnimationElements: function (isExit) {\r\n                        if (this.pageControl && this.pageControl.getAnimationElements) {\r\n                            return this.pageControl.getAnimationElements(isExit);\r\n                        }\r\n                        return this.pageElement;\r\n                    },\r\n\r\n                    // Navigates back whenever the backspace key is pressed and\r\n                    // not captured by an input field.\r\n                    _keypressHandler: function (args) {\r\n                        if (this.locks > 0)\r\n                            return;\r\n\r\n                        if (args.key === \"Backspace\") {\r\n                            this.back();\r\n                        }\r\n                    },\r\n\r\n                    // Navigates back or forward when alt + left or alt + right\r\n                    // key combinations are pressed.\r\n                    _keyupHandler: function (args) {\r\n                        if (this.locks > 0)\r\n                            return;\r\n\r\n                        if ((args.key === \"Left\" && args.altKey) || (args.key === \"BrowserBack\")) {\r\n                            this.back();\r\n                        }/* else if ((args.key === \"Right\" && args.altKey) || (args.key === \"BrowserForward\")) {\r\n            \t\t\tnav.forward();\r\n            \t\t}*/\r\n                    },\r\n\r\n                    // This function responds to clicks to enable navigation using\r\n                    // back and forward mouse buttons.\r\n                    _mspointerupHandler: function (args) {\r\n                        if (args.button === 3) {\r\n                            nav.back();\r\n                        } else if (args.button === 4) {\r\n                            nav.forward();\r\n                        }\r\n                    },\r\n\r\n                    navigate: function (location, initialState, skipHistory, isback, stacked) {\r\n                        var nav = this;\r\n                        if (this.global) {\r\n                            return WinJS.Navigation.navigate(location, initialState);\r\n                        } else {\r\n                            var arg = {\r\n                                skipHistory: skipHistory,\r\n                                detail: {\r\n                                    location: location,\r\n                                    state: initialState,\r\n                                    navigateStacked : stacked,\r\n                                    setPromise: function (promise) {\r\n                                        this.pagePromise = promise;\r\n                                    }\r\n                                }\r\n                            };\r\n                            nav._beforeNavigate(arg);\r\n                            arg.detail.pagePromise = arg.detail.pagePromise || WinJS.Promise.wrap();\r\n                            nav._history.current = { state: initialState, location: location };\r\n                            return arg.detail.pagePromise.then(function () {\r\n                                if (isback) {\r\n                                    nav._history.backstack.splice(nav._history.backstack.length - 1, 1);\r\n                                }\r\n                                nav._navigated(arg);\r\n                                return arg.detail.pagePromise;\r\n                            });\r\n                        }\r\n                    },\r\n\r\n                    clearHistory: function () {\r\n                        if (this.global) {\r\n                            WinJS.Navigation.history.backStack = [];\r\n                        } else {\r\n                            this._history.backstack = [];\r\n                            this._history.current = null;\r\n                        }\r\n                    },\r\n\r\n                    closeAllPages: function () {\r\n                        var navigator = this;\r\n                        var pages = navigator.element.children;\r\n                        \r\n                        for (var i = pages.length-1 ; i >= 0 ; i--) {\r\n                            var page = pages[i];\r\n                            if (page.classList.contains(\"pagecontrol\")) {\r\n                                navigator.element.removeChild(page);\r\n                                page.winControl.dispose();\r\n                            }\r\n                        }\r\n                    },\r\n\r\n                    clear: function () {\r\n                        this.clearHistory();\r\n                        this.closeAllPages();\r\n                        this._pageElement = null;\r\n                        this.element.innerHTML = '';\r\n                    },\r\n\r\n                    //warning, deprecated...\r\n                    open: function (uri, options) {\r\n                        return this.navigate(uri, options);\r\n                    },\r\n\r\n                    pick: function (uri, options) {\r\n                        options = options || {};\r\n                        options.navigateStacked = true;\r\n                        return this.navigate(uri, options);\r\n                    },\r\n\r\n                    canGoBack: {\r\n                        get: function () {\r\n                            if (this.global)\r\n                                return nav.canGoBack;\r\n                            else\r\n                                return this._history.backstack.length > 0;\r\n                        }\r\n                    },\r\n\r\n                    _handleStackedBack: function () {\r\n                        var navigator = this;\r\n                        if (navigator.global) {\r\n                            var isStacked = navigator.stackNavigation == true || (WinJS.Navigation.history.current.state && WinJS.Navigation.history.current.state.navigateStacked);\r\n                            if (isStacked) {\r\n                                var previousPage = navigator.element.children[navigator.element.children.length - 2];\r\n                                if (previousPage) {\r\n                                    WinJS.Navigation.history.backStack.splice(WinJS.Navigation.history.backStack.length - 1, 1);\r\n\r\n                                    return navigator.closePage(navigator.pageControl.element).then(function () {\r\n                                        navigator._updateBackButton(previousPage.winControl.element);\r\n                                        if (previousPage.winControl && previousPage.winControl.navactivate) {\r\n                                            previousPage.winControl.navactivate();\r\n                                        }\r\n                                    });\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n\r\n                    back: function (distance) {\r\n                        var navigator = this;\r\n                        \r\n                        if (navigator.global) {\r\n                            //navigator._handleBack();\r\n\r\n                            return WinJS.Navigation.back(distance);\r\n                        }\r\n                        else {\r\n                            if (navigator._history.backstack.length) {\r\n                                var pageindex = navigator._history.backstack.length - 1;\r\n                                var previousPage = navigator._history.backstack[pageindex];\r\n\r\n                                return navigator.navigate(previousPage.location, previousPage.state, true, true);\r\n                            }\r\n                        }\r\n                    },\r\n\r\n                    _beforeNavigate: function (args) {\r\n                        var navigator = this;\r\n                        var page = this.pageElement;\r\n                        var navlocation = args.detail.location;\r\n                        var navstate = args.detail.state;\r\n\r\n                        args.detail.state = args.detail.state || {};\r\n                        var openStacked = navigator.stackNavigation == true || args.detail.navigateStacked || args.detail.state.navigateStacked;\r\n\r\n                        if (navigator.global && page && page.winControl && page.winControl.navigationState && page.winControl.navigationState.state && page.winControl.navigationState.state.navigateStacked) {\r\n                            var history = WinJS.Navigation.history.backStack[WinJS.Navigation.history.backStack.length - 1];\r\n                            if (navlocation == history.location && navstate == history.state) {\r\n                                var res = navigator._handleStackedBack();\r\n                                if (WinJS.Promise.is(res)) {\r\n                                    WinJS.Navigation.history.current = history;\r\n                                    args.detail.setPromise(res.then(function () {\r\n                                        var p = new WinJS.Promise(function (c) { });\r\n                                        args.detail.setPromise(p);\r\n                                        p.cancel();\r\n                                        return p;\r\n                                    }));\r\n                                    return;\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        if (this.locks > 0) {\r\n                            var p = new WinJS.Promise(function (c) { });\r\n                            args.detail.setPromise(p);\r\n                            p.cancel();\r\n                            return;\r\n                        }\r\n                        else if (page && page.winControl && !openStacked && page.winControl.canClose) {\r\n                            var completeCallback = null;\r\n                            var p = new WinJS.Promise(function (c) {\r\n                                completeCallback = c;\r\n                            });\r\n                            setImmediate(function () {\r\n                                WinJS.Promise.wrap(page.winControl.canClose()).then(function (res) {\r\n                                    if (!res) {\r\n                                        p.cancel();\r\n                                    }\r\n                                    else {\r\n                                        navigator.triggerPageExit(openStacked);\r\n                                        completeCallback();\r\n                                    }\r\n                                });\r\n                            });\r\n                            args.detail.setPromise(p);\r\n\r\n                            return;\r\n                        }\r\n\r\n                        if (openStacked && !args.detail.state.mcnNavigationDetails) {\r\n                            if (page.winControl.navdeactivate) {\r\n                                args.detail.setPromise(WinJS.Promise.as(page.winControl.navdeactivate.apply(page.winControl)));\r\n                                return;\r\n                            }\r\n                            return;\r\n                        }\r\n\r\n                        if (navigator.global && !openStacked && WinJS.Navigation.history.current.state && WinJS.Navigation.history.current.state.navigateStacked) {\r\n                            navigator.closeAllPages();\r\n                            var backstack = WinJS.Navigation.history.backStack;\r\n                            for (var i = backstack.length - 1 ; i >= 0 ; i--) {\r\n                                if (backstack[i].state && backstack[i].state.navigateStacked) {\r\n                                    backstack.splice(i, 1);\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        navigator.triggerPageExit();\r\n                    },\r\n\r\n                    triggerPageExit: function (openStacked) {\r\n                        var navigator = this;\r\n                        var page = this.pageElement;\r\n                        if (openStacked) {\r\n                            if (page.winControl.navdeactivate) {\r\n                                page.winControl.exitPagePromise = WinJS.Promise.as(page.winControl.navdeactivate());\r\n                            } else {\r\n                                page.winControl.exitPagePromise = WinJS.Promise.wrap();\r\n                            }\r\n                            return;\r\n                        }\r\n                        var hidepage = function () {\r\n                            if (!openStacked) {\r\n                                page.style.display = 'none';\r\n                                page.style.visibility = 'hidden';\r\n                                page.style.opacity = '';\r\n                            }\r\n                        }\r\n                        if (page && page.winControl && !page.winControl.exitPagePromise) {\r\n                            if (page.winControl.exitPage) {\r\n                                var exitPageResult = page.winControl.exitPage();\r\n                                if (exitPageResult) {\r\n                                    var res = WinJS.Promise.as(exitPageResult);\r\n                                    page.winControl.exitPagePromise = res.then(function () {\r\n                                        if (page.winControl.exitPageAnimation) {\r\n                                            return WinJS.Promise.as(page.winControl.exitPageAnimation());\r\n                                        }\r\n                                    }).then(hidepage);\r\n                                } else {\r\n                                    if (page.winControl.exitPageAnimation) {\r\n                                        page.winControl.exitPagePromise = WinJS.Promise.as(page.winControl.exitPageAnimation()).then(hidepage);\r\n                                    } else {\r\n                                        page.winControl.exitPagePromise = WinJS.Promise.as(navigator.animations.exitPage(navigator._getAnimationElements(true))).then(hidepage);\r\n                                    }\r\n                                }\r\n                            } else {\r\n                                if (page.winControl.exitPageAnimation) {\r\n                                    page.winControl.exitPagePromise = WinJS.Promise.as(page.winControl.exitPageAnimation()).then(hidepage);\r\n                                } else {\r\n                                    page.winControl.exitPagePromise = WinJS.Promise.as(navigator.animations.exitPage(navigator._getAnimationElements(true))).then(hidepage);\r\n                                }\r\n                            }\r\n\r\n                            var layoutCtrls = page.querySelectorAll('.mcn-layout-ctrl');\r\n                            if (layoutCtrls && layoutCtrls.length) {\r\n                                for (var i = 0 ; i < layoutCtrls.length; i++) {\r\n                                    var ctrl = layoutCtrls[i].winControl;\r\n                                    if (ctrl.exitPage)\r\n                                        ctrl.exitPage();\r\n                                }\r\n                            }\r\n\r\n                            if (WinJSContrib.UI.Application.progress)\r\n                                WinJSContrib.UI.Application.progress.show();\r\n                        }\r\n                    },\r\n\r\n                    closePage: function (pageElementToClose, args) {\r\n                        var navigator = this;\r\n                        args = args || {};\r\n                        var pagecontainer = navigator.element;\r\n                        var oldElement = pageElementToClose || this.pageElement;\r\n                        if (oldElement) {\r\n                            WinJSContrib.UI.untapAll(oldElement);\r\n                        }\r\n                        var oldPageExitPromise = (oldElement && oldElement.winControl && oldElement.winControl.exitPagePromise) ? oldElement.winControl.exitPagePromise : WinJS.Promise.wrap()\r\n                        navigator.dispatchEvent('closingPage', { page: oldElement });\r\n\r\n                        if (oldElement && oldElement.winControl) {\r\n                            oldElement.winControl.pageLifeCycle.stop();\r\n                            oldElement.winControl.dispatchEvent('closing', { youpla: 'boom' });\r\n\r\n                            if (oldElement.winControl.cancelPromises) {\r\n                                oldElement.winControl.cancelPromises();\r\n                            }\r\n                        }\r\n\r\n                        if (!navigator.global && !navigator.disableHistory && oldElement && oldElement.winControl && oldElement.winControl.navigationState && !args.skipHistory) {\r\n                            navigator._history.backstack.push(oldElement.winControl.navigationState);\r\n                        }\r\n\r\n                        navigator._pageElement = null;\r\n                        return oldPageExitPromise.then(function () {\r\n                            if (oldElement) {\r\n                                oldElement.style.opacity = '0';\r\n                                oldElement.style.display = 'none';\r\n                                //    }\r\n                                //    return WinJS.Promise.timeout();\r\n                                //}).then(function () {\r\n                                //    if (oldElement) {\r\n                                if (oldElement.winControl) {\r\n                                    oldElement.winControl.stackedOn = null;\r\n                                    oldElement.winControl.stackedBy = null;\r\n                                    if (oldElement.winControl.eventTracker) {\r\n                                        oldElement.winControl.eventTracker.dispose();\r\n                                    }\r\n\r\n                                    if (oldElement.winControl.unload) {\r\n                                        oldElement.winControl.unload();\r\n                                    }\r\n                                }\r\n\r\n                                if (WinJS.Utilities.disposeSubTree)\r\n                                    WinJS.Utilities.disposeSubTree(oldElement);\r\n\r\n                                //oldElement.innerHTML = '';\r\n                                //setImmediate(function () {\r\n                                try {\r\n                                    oldElement.parentElement.removeChild(oldElement);\r\n                                }\r\n                                catch (exception) {\r\n                                    console.log('cannot remove page, WTF ????????')\r\n                                }\r\n                                //});\r\n                            }\r\n                        });\r\n                    },\r\n\r\n                    // Responds to navigation by adding new pages to the DOM.\r\n                    _navigated: function (args) {\r\n                        var navigator = this;\r\n                        \r\n\r\n                        args.detail.state = args.detail.state || {};\r\n                        var pagecontainer = navigator.element;\r\n                        var oldPage = this.pageControl;\r\n                        var oldElement = this.pageElement;\r\n                        var openStacked = navigator.stackNavigation == true || args.detail.navigateStacked || (args.detail.state && args.detail.state.navigateStacked);\r\n\r\n                        if (this._lastNavigationPromise) {\r\n                            this._lastNavigationPromise.cancel();\r\n\r\n                            if (WinJSContrib.UI.Application.progress)\r\n                                WinJSContrib.UI.Application.progress.hide();\r\n                        }\r\n\r\n                        if (oldPage && oldPage.stackedOn && args.detail.state.mcnNavigationDetails) {//back en nav stacked\r\n                            var closeOldPagePromise = navigator.closePage(oldElement, args);\r\n                            this._lastNavigationPromise = closeOldPagePromise;\r\n                            args.detail.setPromise(closeOldPagePromise);\r\n                            if (WinJSContrib.UI.Application.progress)\r\n                                WinJSContrib.UI.Application.progress.hide();\r\n                            return;\r\n                        }\r\n                        else if (openStacked) {\r\n                            if (!navigator.global && !navigator.disableHistory && oldElement && oldElement.winControl && oldElement.winControl.navigationState && !args.skipHistory) {\r\n                                navigator._history.backstack.push(oldElement.winControl.navigationState);\r\n                            }\r\n                            \r\n                            var closeOldPagePromise = WinJS.Promise.wrap();\r\n                        }\r\n                        else {\r\n                            var closeOldPagePromise = navigator.closePage(oldElement, args);\r\n                        }\r\n\r\n                        if (navigator.global && !openStacked) {\r\n                            var backstack = WinJS.Navigation.history.backStack;\r\n                            for (var i = backstack.length - 1 ; i >= 0 ; i--) {\r\n                                if (backstack[i].state && backstack[i].state.navigateStacked) {\r\n                                    backstack.splice(i, 1);\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        //if (this._handleSystemBackBtn && Windows && Windows.UI && Windows.UI.Core && Windows.UI.Core.SystemNavigationManager) {\r\n                        //    if (navigator.canGoBack)\r\n                        //        Windows.UI.Core.SystemNavigationManager.getForCurrentView().appViewBackButtonVisibility = Windows.UI.Core.AppViewBackButtonVisibility.visible;\r\n                        //    else\r\n                        //        Windows.UI.Core.SystemNavigationManager.getForCurrentView().appViewBackButtonVisibility = Windows.UI.Core.AppViewBackButtonVisibility.collapsed;\r\n                        //}\r\n                        args.detail.state.mcnNavigationDetails = {\r\n                            id: WinJSContrib.Utils.guid(),\r\n                            date: new Date()\r\n                        };\r\n\r\n                        //var newElement = null; //this._createPageElement();\r\n                        //var newElementCtrl = null;\r\n                        var parentedComplete;\r\n                        var parented = new WinJS.Promise(function (c) { parentedComplete = c; });\r\n                        //newElement.style.opacity = '0';\r\n                        var layoutCtrls = [];\r\n\r\n\r\n                        //if (navigator.animationWaitForPreviousPageClose) {\r\n                        //    var tempo = closeOldPagePromise.then(function () {\r\n                        //        return WinJS.Promise.timeout(navigator.delay);\r\n                        //    });\r\n                        //} else {\r\n                        //    var tempo = WinJS.Promise.timeout(navigator.delay);\r\n                        //}\r\n\r\n                        navigator.currentPageDetails = args.detail;\r\n\r\n                        var openNewPagePromise = WinJSContrib.UI.Pages.renderFragment(pagecontainer, args.detail.location, args.detail.state, {\r\n                            //delay: tempo,\r\n                            enterPage: navigator.animations.enterPage,\r\n\r\n                            //parented: closeOldPagePromise.then(function () {\r\n                            //\treturn parented;\r\n                            //}),\r\n\r\n                            getFragmentElement : navigator.fragmentInjector,\r\n\r\n                            closeOldPagePromise: closeOldPagePromise.then(function () { }, function () { }),\r\n\r\n                            oninit: function (element, options) {\r\n                                if (!element) return;\r\n                                var control = element.winControl;\r\n                                control.navigator = navigator;\r\n                                control.element.mcnPage = true;\r\n                                if (openStacked) {\r\n                                    control.stackedOn = oldPage;\r\n                                    if (oldPage) {\r\n                                        oldPage.stackedBy = control;\r\n                                    }\r\n                                }\r\n                                control.renderComplete = control.renderComplete.then(function () {\r\n                                    parentedComplete();\r\n                                });\r\n                            },\r\n\r\n                            onrender: function (element, options) {\r\n                                if (args.detail.state && args.detail.state.clearNavigationHistory) {\r\n                                    if (navigator.global) {\r\n                                        WinJS.Navigation.history.backStack = [];\r\n                                    } else {\r\n                                        navigator._history.backstack = [];\r\n                                    }\r\n                                }\r\n                                navigator._updateBackButton(element);\r\n                            },\r\n\r\n                            onready: function (element, options) {\r\n                                navigator.dispatchEvent('pageContentReady', { page: element.winControl });\r\n                                if (WinJSContrib.UI.Application.progress)\r\n                                    WinJSContrib.UI.Application.progress.hide();\r\n                            }\r\n                        }).then(function () {\r\n                            navigator._lastNavigationPromise = undefined;\r\n                        });\r\n\r\n                        this._lastNavigationPromise = openNewPagePromise;\r\n\r\n\r\n                        args.detail.setPromise(WinJS.Promise.join([closeOldPagePromise, openNewPagePromise]));\r\n                    },\r\n\r\n                    // Responds to resize events and call the updateLayout function\r\n                    // on the currently loaded page.\r\n                    _resized: function (args) {\r\n                        var navigator = this;\r\n                        if (this.pageControl && this.pageControl.element) {\r\n                            var navigator = this;\r\n                            var control = this.pageControl;\r\n                            var element = control.element;\r\n\r\n                            //navigator.pageControl.element.opacity = '0';\r\n                            cancelAnimationFrame(navigator.layoutProcess);\r\n                            navigator.layoutProcess = requestAnimationFrame(function () {\r\n                                var vw = appView ? appView.value : null;\r\n                                for (var i = 0, l = navigator.element.children.length; i < l; i++) {\r\n                                    var control = navigator.element.children[i].winControl;\r\n                                    if (control) {\r\n                                        if (control.__checkLayout) {\r\n                                            control.__checkLayout(element, vw, navigator._lastViewstate);\r\n                                        }\r\n                                        else {\r\n                                            if (control.updateLayout) {\r\n                                                control.updateLayout.call(control, element, vw, navigator._lastViewstate);\r\n                                            }\r\n                                            var layoutCtrls = element.querySelectorAll('.mcn-layout-ctrl');\r\n                                            if (layoutCtrls && layoutCtrls.length) {\r\n                                                for (var i = 0 ; i < layoutCtrls.length; i++) {\r\n                                                    var ctrl = layoutCtrls[i].winControl;\r\n                                                    if (ctrl.updateLayout)\r\n                                                        ctrl.updateLayout(ctrl.element, vw, navigator._lastViewstate);\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    }\r\n                                }\r\n                                //WinJS.UI.Animation.fadeIn(navigator.pageControl.element);\r\n                            });\r\n                        }\r\n                        this._lastViewstate = appView ? appView.value : null;\r\n                    },\r\n\r\n                    _handleBack: function () {\r\n                        nav.back();\r\n                    },\r\n\r\n                    // Updates the back button state. Called after navigation has\r\n                    // completed.\r\n                    _updateBackButton: function (element) {\r\n                        var ctrl = this;\r\n                        var canGoBack = ctrl.canGoBack;\r\n\r\n                        var systemNavigationManager = null;\r\n\r\n                        if (WinJSContrib.UI.enableSystemBackButton && window.Windows && window.Windows.UI && window.Windows.UI.Core && window.Windows.UI.Core.SystemNavigationManager) {\r\n                            systemNavigationManager = window.Windows.UI.Core.SystemNavigationManager.getForCurrentView();\r\n                        }\r\n                        if (ctrl.global && systemNavigationManager && WinJSContrib.UI.enableSystemBackButton) {\r\n                            if (!canGoBack)\r\n                                systemNavigationManager.appViewBackButtonVisibility = window.Windows.UI.Core.AppViewBackButtonVisibility.collapsed;\r\n                            else\r\n                                systemNavigationManager.appViewBackButtonVisibility = window.Windows.UI.Core.AppViewBackButtonVisibility.visible;\r\n                        }\r\n\r\n                        var backButtons = element.querySelectorAll(\".win-backbutton, .back-button, .win-navigation-backbutton\");\r\n                        //var backButton = this.pageElement.querySelector(\"header[role=banner] .win-backbutton\");\r\n\r\n                        if (backButtons && backButtons.length > 0) {\r\n                            var clearNav = false;\r\n                            //console.log('nav:' + JSON.stringify(args.detail.state))\r\n                            //if (args && args.detail && args.detail.state && args.detail.state.clearNavigationHistory)\r\n                            //    clearNav = args.detail.state.clearNavigationHistory;\r\n\r\n                            for (var i = 0, l = backButtons.length; i < l ; i++) {\r\n                                var btn = backButtons[i];\r\n                                if (canGoBack && !clearNav) {\r\n                                    btn.classList.remove('disabled');\r\n                                    btn.disabled = false;\r\n                                } else {\r\n                                    btn.classList.add('disabled');\r\n                                    btn.disabled = true;\r\n                                }\r\n\r\n                                btn.onclick = function (arg) {\r\n                                    if (ctrl.global) {\r\n                                        nav.back();\r\n                                    }\r\n                                    else {\r\n                                        var navigator = WinJSContrib.UI.parentNavigator(arg.currentTarget);\r\n                                        navigator.back();\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            ), WinJS.Utilities.eventMixin)\r\n    });\r\n\r\n    if (WinJSContrib.UI.WebComponents) {\r\n        WinJSContrib.UI.WebComponents.register('mcn-navigator', WinJSContrib.UI.PageControlNavigator, {\r\n            properties: ['global'],\r\n            map: {\r\n                \"ENTERPAGEANIMATION\": {\r\n                    attribute: \"enterPageAnimation\",\r\n                    property: \"animations.enterPage\",\r\n                    resolve: true\r\n                },\r\n                \"EXITPAGEANIMATION\": {\r\n                    attribute: \"exitPageAnimation\",\r\n                    property: \"animations.exitPage\",\r\n                    resolve: true\r\n                }\r\n            }\r\n        });\r\n    }\r\n})();\r\n","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/**\n * @namespace WinJSContrib.UI.Animation\n */\n/**\n */\nvar WinJSContrib;\n(function (WinJSContrib) {\n    var UI;\n    (function (UI) {\n        var Animation;\n        (function (Animation) {\n            /**\n             * @enum\n             * @memberof WinJSContrib.UI.Animation\n             */\n            Animation.Easings = {\n                /**\n                 * Quad ease in\n                 */\n                easeInQuad: 'cubic-bezier(0.550, 0.085, 0.680, 0.530)',\n                /**\n                 * Cubic ease in\n                 */\n                easeInCubic: 'cubic-bezier(0.550, 0.055, 0.675, 0.190)',\n                /**\n                 * Quart ease in\n                 */\n                easeInQuart: 'cubic-bezier(0.895, 0.030, 0.685, 0.220)',\n                /**\n                 * Quint ease in\n                 */\n                easeInQuint: 'cubic-bezier(0.755, 0.050, 0.855, 0.060)',\n                /**\n                 * Sine ease in\n                 */\n                easeInSine: 'cubic-bezier(0.470, 0.000, 0.745, 0.715)',\n                /**\n                 * Expo ease in\n                 */\n                easeInExpo: 'cubic-bezier(0.950, 0.050, 0.795, 0.035)',\n                /**\n                 * Circ ease in\n                 */\n                easeInCirc: 'cubic-bezier(0.600, 0.040, 0.980, 0.335)',\n                /**\n                 * Back ease in\n                 */\n                easeInBack: 'cubic-bezier(0.600, -0.280, 0.735, 0.045)',\n                /**\n                 * Quad ease out\n                 */\n                easeOutQuad: 'cubic-bezier(0.250, 0.460, 0.450, 0.940)',\n                /**\n                 * Cubic ease out\n                 */\n                easeOutCubic: 'cubic-bezier(0.215, 0.610, 0.355, 1.000)',\n                /**\n                 * Quart ease out\n                 */\n                easeOutQuart: 'cubic-bezier(0.165, 0.840, 0.440, 1.000)',\n                /**\n                 * Quint ease out\n                 */\n                easeOutQuint: 'cubic-bezier(0.230, 1.000, 0.320, 1.000)',\n                /**\n                 * Sine ease out\n                 */\n                easeOutSine: 'cubic-bezier(0.390, 0.575, 0.565, 1.000)',\n                /**\n                 * Expo ease out\n                 */\n                easeOutExpo: 'cubic-bezier(0.190, 1.000, 0.220, 1.000)',\n                /**\n                 * Circ ease out\n                 */\n                easeOutCirc: 'cubic-bezier(0.075, 0.820, 0.165, 1.000)',\n                /**\n                 * Back ease out\n                 */\n                easeOutBack: 'cubic-bezier(0.175, 0.885, 0.320, 1.275)',\n                /**\n                 * Quad ease in-out\n                 */\n                easeInOutQuad: 'cubic-bezier(0.455, 0.030, 0.515, 0.955)',\n                /**\n                 * Cubic ease in-out\n                 */\n                easeInOutCubic: 'cubic-bezier(0.645, 0.045, 0.355, 1.000)',\n                /**\n                 * Quart ease in-out\n                 */\n                easeInOutQuart: 'cubic-bezier(0.770, 0.000, 0.175, 1.000)',\n                /**\n                 * Quint ease in-out\n                 */\n                easeInOutQuint: 'cubic-bezier(0.860, 0.000, 0.070, 1.000)',\n                /**\n                 * Sine ease in-out\n                 */\n                easeInOutSine: 'cubic-bezier(0.445, 0.050, 0.550, 0.950)',\n                /**\n                 * Expo ease in-out\n                 */\n                easeInOutExpo: 'cubic-bezier(1.000, 0.000, 0.000, 1.000)',\n                /**\n                 * Circ ease in-out\n                 */\n                easeInOutCirc: 'cubic-bezier(0.785, 0.135, 0.150, 0.860)',\n                /**\n                 * Back ease in-out\n                 */\n                easeInOutBack: 'cubic-bezier(0.680, -0.550, 0.265, 1.550)',\n            };\n            var equivalents = WinJS.Utilities._browserStyleEquivalents || { transform: { cssName: 'transform' } };\n            function getOpt(options) {\n                if (options && typeof options == 'number')\n                    return { duration: options };\n                else\n                    return options || {};\n            }\n            /**\n             * configurable fade out\n             * @function WinJSContrib.UI.Animation.fadeOut\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function fadeOut(elements, options) {\n                options = getOpt(options);\n                var args = {\n                    property: \"opacity\",\n                    delay: staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333),\n                    duration: options.duration || 167,\n                    timing: options.easing || \"ease-in-out\",\n                    to: 0\n                };\n                return WinJS.UI.executeTransition(elements, args);\n            }\n            Animation.fadeOut = fadeOut;\n            /**\n             * configurable fade in\n             * @function WinJSContrib.UI.Animation.fadeIn\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function fadeIn(elements, options) {\n                options = getOpt(options);\n                return WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333),\n                    duration: options.duration || 167,\n                    timing: options.easing || \"ease-in-out\",\n                    to: 1\n                });\n            }\n            Animation.fadeIn = fadeIn;\n            function staggerDelay(initialDelay, extraDelay, delayFactor, delayCap) {\n                return function (i) {\n                    var ret = initialDelay;\n                    for (var j = 0; j < i; j++) {\n                        extraDelay *= delayFactor;\n                        ret += extraDelay;\n                    }\n                    if (delayCap) {\n                        ret = Math.min(ret, delayCap);\n                    }\n                    return ret;\n                };\n            }\n            /**\n             * configurable page exit effect\n             * @function WinJSContrib.UI.Animation.pageExit\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function pageExit(elements, options) {\n                options = getOpt(options);\n                var args = {\n                    property: \"opacity\",\n                    delay: staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333),\n                    duration: options.duration || 160,\n                    timing: options.easing || \"ease-in\",\n                    to: 0\n                };\n                return WinJS.UI.executeTransition(elements, args);\n            }\n            Animation.pageExit = pageExit;\n            /**\n             * configurable page enter effect\n             * @function WinJSContrib.UI.Animation.enterPage\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function enterPage(elements, options) {\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 120, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var animationParams = {\n                    keyframe: 'WinJSContrib-EnterPage',\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: options.duration || 600,\n                    timing: options.easing || \"cubic-bezier(0.1, 0.9, 0.2, 1)\"\n                };\n                var promise1 = WinJS.UI.executeAnimation(elements, animationParams);\n                var args = {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: options.duration || 600,\n                    timing: options.easing || \"ease-out\",\n                    to: 1\n                };\n                var promise2 = WinJS.UI.executeTransition(elements, args);\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.enterPage = enterPage;\n            function slideAnim(element, keyframeName, isIn, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var duration = options.duration || isIn ? 250 : 150;\n                var delay = options.delay || 5;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var easing = WinJSContrib.UI.Animation.Easings.easeInQuad;\n                if (isIn)\n                    easing = WinJSContrib.UI.Animation.Easings.easeOutQuad;\n                var animationParams = {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: duration,\n                    timing: options.easing || easing\n                };\n                var promise1 = WinJS.UI.executeAnimation(element, animationParams);\n                var transitionParams = {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: duration / 2,\n                    timing: easing,\n                    from: 0,\n                    to: 1\n                };\n                if (!isIn) {\n                    transitionParams.from = 1;\n                    transitionParams.to = 0;\n                    if (transitionParams.delay < duration / 2)\n                        transitionParams.delay = duration / 2;\n                }\n                var promise2 = WinJS.UI.executeTransition(element, transitionParams);\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromBottom\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromBottom(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromBottom', true, options);\n            }\n            Animation.slideFromBottom = slideFromBottom;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromTop\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromTop(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromTop', true, options);\n            }\n            Animation.slideFromTop = slideFromTop;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromLeft\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromLeft(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromLeft', true, options);\n            }\n            Animation.slideFromLeft = slideFromLeft;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideFromRight\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideFromRight(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideFromRight', true, options);\n            }\n            Animation.slideFromRight = slideFromRight;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToBottom\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToBottom(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToBottom', false, options);\n            }\n            Animation.slideToBottom = slideToBottom;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToTop\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToTop(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToTop', false, options);\n            }\n            Animation.slideToTop = slideToTop;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToLeft\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToLeft(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToLeft', false, options);\n            }\n            Animation.slideToLeft = slideToLeft;\n            /**\n             * configurable slide effect\n             * @function WinJSContrib.UI.Animation.slideToRight\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function slideToRight(elements, options) {\n                return slideAnim(elements, 'WinJSContrib-slideToRight', false, options);\n            }\n            Animation.slideToRight = slideToRight;\n            /**\n             * animation for tab exit\n             * @function WinJSContrib.UI.Animation.tabExitPage\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function tabExitPage(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var animationParams = {\n                    keyframe: \"WinJSContrib-tabExitPage\",\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: options.duration || 160,\n                    timing: \"ease-in\"\n                };\n                var promise1 = WinJS.UI.executeAnimation(elements, animationParams);\n                var transitionParams = {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: options.duration || 160,\n                    timing: \"linear\",\n                    from: 1,\n                    to: 0\n                };\n                var promise2 = WinJS.UI.executeTransition(elements, transitionParams);\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.tabExitPage = tabExitPage;\n            /**\n             * animation for tab exit\n             * @function WinJSContrib.UI.Animation.tabEnterPage\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like duration, delay, easing\n             */\n            function tabEnterPage(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: \"WinJSContrib-tabEnterPage\",\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: options.duration || 250,\n                    timing: WinJSContrib.UI.Animation.Easings.easeOutQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: options.duration || 250,\n                    timing: \"ease-out\",\n                    from: 0,\n                    to: 1\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.tabEnterPage = tabEnterPage;\n            /**\n             * exit and grow animation\n             * @function WinJSContrib.UI.Animation.exitGrow\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function exitGrow(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-exitGrow\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var dur = options.duration || 250;\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeInQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeInQuint,\n                    from: 1,\n                    to: 0\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.exitGrow = exitGrow;\n            /**\n             * exit and shrink animation\n             * @function WinJSContrib.UI.Animation.exitShrink\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function exitShrink(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-exitShrink\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var dur = options.duration || 250;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 10, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeInQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: WinJSContrib.UI.Animation.Easings.easeInQuint,\n                    from: 1,\n                    to: 0\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.exitShrink = exitShrink;\n            /**\n             * shrink and fall animation\n             * @function WinJSContrib.UI.Animation.shrinkAndFall\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function shrinkAndFall(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var dur = options.duration || 250;\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: \"WinJSContrib-shrinkAndFall\",\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || \"ease-in\"\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: \"ease-in\",\n                    from: 1,\n                    to: 0\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.shrinkAndFall = shrinkAndFall;\n            /**\n             * enter and shrink animation\n             * @function WinJSContrib.UI.Animation.enterShrink\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function enterShrink(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-enterShrink\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var dur = options.duration || 350;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeOutQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeOutQuint,\n                    from: 0,\n                    to: 1\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.enterShrink = enterShrink;\n            /**\n             * enter and shrink animation\n             * @function WinJSContrib.UI.Animation.enterGrow\n             * @param {Object} elements element or array of elements\n             * @param {WinJSContrib.UI.AnimationOptions} options options like delay, easing\n             */\n            function enterGrow(elements, options) {\n                var offsetArray;\n                options = getOpt(options);\n                var keyframeName = \"WinJSContrib-enterGrow\";\n                if (options.exagerated) {\n                    keyframeName += '-exagerated';\n                }\n                var dur = options.duration || 350;\n                var stagger = staggerDelay(options.delay !== undefined ? options.delay : 5, options.itemdelay !== undefined ? options.itemdelay : 83, 1, options.maxdelay !== undefined ? options.maxdelay : 333);\n                var promise1 = WinJS.UI.executeAnimation(elements, {\n                    keyframe: keyframeName,\n                    property: equivalents.transform.cssName,\n                    delay: stagger,\n                    duration: dur,\n                    timing: options.easing || WinJSContrib.UI.Animation.Easings.easeOutQuad\n                });\n                var promise2 = WinJS.UI.executeTransition(elements, {\n                    property: \"opacity\",\n                    delay: stagger,\n                    duration: dur,\n                    timing: WinJSContrib.UI.Animation.Easings.easeOutQuint,\n                    from: 0,\n                    to: 1\n                });\n                return WinJS.Promise.join([promise1, promise2]);\n            }\n            Animation.enterGrow = enterGrow;\n        })(Animation = UI.Animation || (UI.Animation = {}));\n    })(UI = WinJSContrib.UI || (WinJSContrib.UI = {}));\n})(WinJSContrib || (WinJSContrib = {}));\n\n//# sourceMappingURL=../../Sources/Common/winjscontrib.ui.animation.js.map","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n//this control requires snap.svg\r\n\r\n(function () {\r\n    'use strict';\r\n    var elasticbuttonkinds = {\r\n        rectangle: {\r\n            morphpath: 'M286,113c0,0-68.8,6-136,6c-78.2,0-137-6-137-6S6,97.198,6,62.5C6,33.999,13,12,13,12s59-7,137-7c85,0,136,7,136,7s8,17.598,8,52C294,96.398,286,113,286,113z',\r\n            svg: '<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 300 125\" preserveAspectRatio=\"none\"><path d=\"M286.5,113c0,0-104,0-136.5,0c-35.75,0-136.5,0-136.5,0s0-39.417,0-52.5c0-12.167,0-48.5,0-48.5s101.833,0,136.5,0c33.583,0,136.5,0,136.5,0s0,35.917,0,48.5C286.5,73.167,286.5,113,286.5,113z\"/></svg>'\r\n        },\r\n        roundedrectangle: {\r\n            morphpath: 'M287,95.25c0,11.046-5.954,19.75-17,19.75c0,0-90-4-120-4s-120,4-120,4c-11.046,0-17.25-9.5-17.25-20.5c0-8.715,0.25-10.75,0.25-34s-0.681-26.257-1-33.75C11.5,15,18.954,10,30,10c0,0,90,3,120,3s120-3,120-3c11.046,0,17.75,6.5,17,20c-0.402,7.239,0,6.75,0,30.5C287,83.5,287,84.75,287,95.25z',\r\n            svg: '<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 300 125\" preserveAspectRatio=\"none\"><path d=\"M290,95c0,11.046-8.954,20-20,20c0,0-90,0-120,0s-120,0-120,0c-11.046,0-20-9-20-20c0-8.715,0-25.875,0-34.5c0-7.625,0-22.774,0-30.5c0-11.625,8.954-20,20-20c0,0,90,0,120,0s120,0,120,0c11.046,0,20,8.954,20,20c0,7.25,0,22.875,0,30.5C290,69.125,290,84.5,290,95z\"/></svg>'\r\n        },\r\n        round: {\r\n            morphpath: 'M251,150c0,93.5-29.203,143-101,143S49,243.5,49,150C49,52.5,78.203,7,150,7S251,51.5,251,150z',\r\n            svg: '<svg width=\"100%\" height=\"100%\" viewBox=\"0 0 300 300\" preserveAspectRatio=\"none\"><path d=\"M281,150c0,71.797-59.203,131-131,131S19,221.797,19,150S78.203,19,150,19S281,78.203,281,150z\"/></svg>'\r\n        },\r\n    };\r\n\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        ElasticButton: WinJS.Class.mix(WinJS.Class.define(function ctor(element, options) {\r\n            this.element = element || document.createElement('DIV');\r\n            options = options || {};\r\n            this.element.winControl = this;\r\n            this.behavior = {\r\n                speed: { reset: 800, active: 150 },\r\n                easing: { reset: mina.elastic, active: mina.easein }\r\n            };\r\n\r\n            this.element.classList.add('mcn-elasticbutton');\r\n            this.element.classList.add('win-disposable');\r\n            WinJS.UI.setOptions(this, options);\r\n        }, {\r\n            kind: {\r\n                get: function () {\r\n                    return this._kind;\r\n                },\r\n                set: function (val) {\r\n                    this._kind = val;\r\n                    this.render();\r\n                }\r\n            },\r\n\r\n            render: function () {\r\n                var ctrl = this;\r\n                this.element.classList.add('mcn-elasticbutton-' + ctrl.kind);\r\n                var contentCreated = false;\r\n                if (!ctrl.contentElement) {\r\n                    ctrl.contentElement = document.createElement('DIV');\r\n                    ctrl.contentElement.className = 'mcn-elasticbutton-content';\r\n                    WinJSContrib.Utils.moveChilds(ctrl.element, ctrl.contentElement);\r\n                    contentCreated = true;\r\n                }\r\n\r\n                if (!ctrl.bgElement) {\r\n                    ctrl.bgElement = document.createElement('DIV');\r\n                    ctrl.bgElement.className = 'mcn-elasticbutton-bg';\r\n                    ctrl.element.appendChild(ctrl.bgElement);\r\n                }\r\n\r\n                if (contentCreated) {\r\n                    ctrl.element.appendChild(ctrl.contentElement);\r\n                }\r\n\r\n                if (!ctrl.contentElement) {\r\n                    ctrl.contentElement = document.createElement('DIV');\r\n                    ctrl.contentElement.className = 'mcn-elasticbutton-content';\r\n                    while (ctrl.element.children.length > 0) {\r\n                        ctrl.contentElement.appendChild(ctrl.element.children[0]);\r\n                    }\r\n                    ctrl.element.appendChild(ctrl.contentElement);\r\n                }\r\n\r\n                ctrl.currentKind = elasticbuttonkinds[this.kind];\r\n                if (ctrl.currentKind) {\r\n                    ctrl.bgElement.innerHTML = ctrl.currentKind.svg;\r\n                    ctrl.snap = Snap(ctrl.bgElement.querySelector('svg'));\r\n                    ctrl.pathEl = ctrl.snap.select('path');\r\n                    ctrl.paths = {\r\n                        reset: ctrl.pathEl.attr('d'),\r\n                        active: ctrl.currentKind.morphpath\r\n                    };\r\n                    if (ctrl.eventTracker)\r\n                        ctrl.eventTracker.dispose();\r\n                    ctrl.eventTracker = new WinJSContrib.UI.EventTracker();\r\n                    ctrl.eventTracker.addEvent(ctrl.element, 'pointerdown', function (arg) { ctrl._ptdown(arg); });\r\n                    ctrl.eventTracker.addEvent(ctrl.element, 'pointerup', function (arg) { ctrl._ptup(arg); });\r\n                    ctrl.eventTracker.addEvent(ctrl.element, 'pointerleave', function (arg) { ctrl._ptup(arg); })\r\n                }\r\n            },\r\n\r\n            _ptdown: function (arg) {\r\n                this.element.classList.add(\"pressed\");\r\n                this.pathEl.stop().animate({ 'path': this.paths.active }, this.behavior.speed.active, this.behavior.easing.active);\r\n            },\r\n\r\n            _ptup: function (arg) {\r\n                this.element.classList.remove(\"pressed\");\r\n                this.pathEl.stop().animate({ 'path': this.paths.reset }, this.behavior.speed.reset, this.behavior.easing.reset);\r\n            },\r\n\r\n            dispose: function () {\r\n                if (this.eventTracker) this.eventTracker.dispose();\r\n                WinJS.Utilities.disposeSubTree(this.element);\r\n                this.element = null;\r\n            }\r\n        }),\r\n\t\tWinJS.Utilities.eventMixin,\r\n\t\tWinJS.Utilities.createEventProperties(\"myevent\"))\r\n    });\r\n})();","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n/// <reference path=\"winjscontrib.core.js\" />\r\n\r\n//this controls requires snap.svg\r\n\r\n(function () {\r\n    'use strict';\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        FOWrapper: WinJS.Class.mix(WinJS.Class.define(function ctor(element, options) {\r\n            this.element = element || document.createElement('DIV');\r\n            options = options || {};\r\n            this.element.winControl = this;\r\n            this.element.classList.add('mcn-fowrapper');\r\n            this.element.classList.add('mcn-layout-ctrl');\r\n            this.element.classList.add('win-disposable');\r\n            WinJS.UI.setOptions(this, options);\r\n            this.render();\r\n        }, {\r\n            someProperty: {\r\n                get: function () {\r\n                    return this._someProperty;\r\n                },\r\n                set: function (val) {\r\n                    this._someProperty = val;\r\n                }\r\n            },\r\n\r\n            render: function () {\r\n                var ctrl = this;\r\n                ctrl.wrapperId = WinJSContrib.Utils.guid();\r\n                var body = document.createElement(\"BODY\");\r\n                body.className = \"mcn-fowrapper-content\";\r\n                body.style.width = '100%';\r\n                body.style.height = '100%';\r\n                WinJSContrib.Utils.moveChilds(ctrl.element, body);\r\n                ctrl.element.innerHTML = '<svg id=\"' + ctrl.wrapperId + '\" class=\"mcn-fowrapper-svg\" xmlns=\"http://www.w3.org/2000/svg\" style=\"width:100%; height: 100%\">' +\r\n                    '<defs>' +\r\n                        '<filter id=\"blur-' + ctrl.wrapperId + '\" x=\"0\" y=\"0\"><feGaussianBlur class=\"gblur\" in=\"SourceGraphic\" stdDeviation=\"0\" /></filter>' +\r\n                    '</defs>' +\r\n                    '<foreignObject class=\"fowrapper\" width=\"100%\" height=\"100%\" requiredExtensions=\"http://www.w3.org/1999/xhtml\" filter=\"url(#blur-' + ctrl.wrapperId + ')\">' +\r\n                    '</foreignObject>' +\r\n                '</svg>';\r\n                var container = ctrl.element.querySelector(\".fowrapper\");\r\n                ctrl.svg = ctrl.element.querySelector(\"svg\");\r\n                ctrl.container = container;\r\n                ctrl.content = body;\r\n                ctrl.blurFilter = ctrl.element.querySelector(\".gblur\");\r\n                ctrl.sblurFilter = Snap(ctrl.blurFilter);\r\n                container.appendChild(body);\r\n            },\r\n\r\n            blurTo: function (blur, duration, easing) {\r\n                var ctrl = this;\r\n\r\n                ctrl.sblurFilter.stop();\r\n                if (!duration) {\r\n                    ctrl.blurFilter.setAttribute(\"stdDeviation\", blur);                    \r\n                    return;\r\n                }\r\n\r\n                ctrl.sblurFilter.animate({ stdDeviation: blur }, duration, easing || mina.easeout);\r\n                ctrl.dispatchEvent('blur');\r\n            },\r\n\r\n            updateLayout: function () {\r\n                if (this.container) {\r\n                    this.container.setAttribute(\"width\", \"100%\");\r\n                    this.container.setAttribute(\"height\", \"100%\");\r\n                }\r\n            },\r\n\r\n            dispose: function () {\r\n                WinJS.Utilities.disposeSubTree(this.element);                \r\n                this.element = null;\r\n            }\r\n        }),\r\n        WinJS.Utilities.eventMixin,\r\n        WinJS.Utilities.createEventProperties(\"blur\"))\r\n    });\r\n})();","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib = WinJSContrib || {};\r\nWinJSContrib.UI = WinJSContrib.UI || {};\r\n\r\n(function () {\r\n    \"use strict\";\r\n\r\n    WinJSContrib.UI.MultiPassRenderer = WinJS.Class.define(\r\n    /**\r\n     * This control manage multi-pass rendering for improving performances when showing a list of items.\r\n     * The renderer will render \"shells\" for the items to enable page layout, and render items content on demand, or when items scrolls to view.  \r\n     * @class WinJSContrib.UI.MultiPassRenderer\r\n     */\r\n    function (element, options) {\r\n        options = options || {};\r\n        this.items = [];\r\n        this.element = element;\r\n        this._scrollProcessor = null;\r\n        this._tolerance = 1;\r\n        this._virtualize = false;\r\n        this._scrollContainer = options.scrollContainer || null;\r\n        this._multipass = options.multipass || false;\r\n        this._orientation = options.orientation || '';\r\n        this.itemClassName = options.itemClass || options.className || options.itemClassName;\r\n        this.itemTemplate = WinJSContrib.Utils.getTemplate(options.template || options.itemTemplate);\r\n        this.itemInvoked = options.invoked || options.itemInvoked;\r\n        this.onitemContent = options.onitemContent;\r\n        this._onScrollBinded = this._onScroll.bind(this);\r\n\r\n        if (element) {\r\n            element.className = element.className + ' mcn-items-ctrl mcn-layout-ctrl win-disposable';\r\n        }\r\n\r\n        //element.mcnRenderer = this;\r\n        //WinJS.UI.setOptions(this, options);\r\n    },\r\n    /**\r\n      * @lends WinJSContrib.UI.MultiPassRenderer.prototype\r\n      */\r\n    {\r\n        dispose : function(){\r\n            var ctrl = this;\r\n            WinJSContrib.UI.untapAll(ctrl.element);\r\n            WinJS.Utilities.disposeSubTree(ctrl.element);\r\n            ctrl._unregisterScrollEvents();\r\n            ctrl._scrollContainer = null;\r\n            ctrl.element = null;\r\n            ctrl._scrollProcessor = null;\r\n            ctrl.rect = null;           \r\n            ctrl.items = [];\r\n        },\r\n\r\n        clear: function () {\r\n            var ctrl = this;\r\n            WinJS.Utilities.disposeSubTree(ctrl.element);\r\n            ctrl.element.innerHTML = '';\r\n        },\r\n\r\n        /**\r\n         * kind of multipass, can be 'section', or 'item'\r\n         * @type {String}\r\n         * @field\r\n         */\r\n        multipass: {\r\n            get: function () {\r\n                return this._multipass;\r\n            },\r\n            set: function (val) {\r\n                this._multipass = val;\r\n                this.refreshScrollEvents();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * tolerance for determining if the rendering should apply. Tolerance is expressed in scroll container proportion. For example, 1 means that tolerance is equal to scroll container size\r\n         * @type {number}\r\n         * @field\r\n         */\r\n        tolerance: {\r\n            get: function () {\r\n                return this._tolerance;\r\n            },\r\n            set: function (val) {\r\n                this._tolerance = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * indicate if renderer empty items out of sight\r\n         * @type {boolean}\r\n         * @field\r\n         */\r\n        virtualize: {\r\n            get: function () {\r\n                return this._virtualize;\r\n            },\r\n            set: function (val) {\r\n                this._virtualize = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * could be 'vertical' or 'horizontal'\r\n         * @type {String}\r\n         * @field\r\n         */\r\n        orientation: {\r\n            get: function () {\r\n                return this._orientation;\r\n            },\r\n            set: function (val) {\r\n                this._orientation = val;\r\n                this.refreshScrollEvents();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Element containing scroll. If scrollContainer is filled, items content will get rendered when coming into view\r\n         * @type {HTMLElement}\r\n         * @field\r\n         */\r\n        scrollContainer: {\r\n            get: function () {\r\n                return this._scrollContainer;\r\n            },\r\n            set: function (val) {\r\n                this._unregisterScrollEvents();\r\n                this._scrollContainer = val;\r\n                this._registerScrollEvents();\r\n                //this.checkRendering();\r\n            }\r\n        },\r\n\r\n        _onScroll: function () {\r\n            var ctrl = this;\r\n            if (ctrl.scrollContainer && ctrl._scrollProcessor) {\r\n                if (ctrl._scrollRequest) {\r\n                    cancelAnimationFrame(ctrl._scrollRequest);\r\n                }\r\n\r\n                ctrl._scrollRequest = requestAnimationFrame(function () {\r\n                    ctrl.checkRendering();\r\n                });\r\n            }\r\n        },\r\n\r\n        _unregisterScrollEvents: function () {\r\n            this._scrollProcessor = null;\r\n            this.clearOffsets();\r\n            if (this.scrollContainer) {\r\n                this.scrollContainer.removeEventListener('scroll', this._onScrollBinded);\r\n            }\r\n        },\r\n\r\n        _registerScrollEvents: function () {\r\n            var ctrl = this;\r\n            if (ctrl.scrollContainer) {\r\n                this.scrollContainer.addEventListener('scroll', this._onScrollBinded);\r\n\r\n                if (ctrl.orientation == 'vertical') {\r\n                    if (ctrl.multipass == 'section') {\r\n                        ctrl._scrollProcessor = function () { ctrl._checkSection(ctrl._vIsInView); }\r\n                    } else if (ctrl.multipass == 'item') {\r\n                        ctrl._scrollProcessor = function () { ctrl._checkItem(ctrl._vIsInView); }\r\n                    }\r\n                } else {\r\n                    if (ctrl.multipass == 'section') {\r\n                        ctrl._scrollProcessor = function () { ctrl._checkSection(ctrl._hIsInView); }\r\n                    } else if (ctrl.multipass == 'item') {\r\n                        ctrl._scrollProcessor = function () { ctrl._checkItem(ctrl._hIsInView); }\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * refresh scroll events associated to multi pass renderer\r\n         */\r\n        refreshScrollEvents: function () {\r\n            this._unregisterScrollEvents();\r\n            this._registerScrollEvents();\r\n            this.clearOffsets();\r\n        },\r\n\r\n        _vIsInView: function (rect, scrollContainer, tolerance) {\r\n            var pxTolerance = scrollContainer.clientHeight * tolerance;\r\n            if (rect.y >= scrollContainer.scrollTop - pxTolerance && rect.y <= scrollContainer.scrollTop + scrollContainer.clientHeight + pxTolerance)\r\n                return true;\r\n\r\n            if (rect.y + rect.height >= scrollContainer.scrollTop - pxTolerance && rect.y + rect.height <= scrollContainer.scrollTop + scrollContainer.clientHeight + pxTolerance)\r\n                return true;\r\n\r\n            if (rect.y <= scrollContainer.scrollTop - pxTolerance && rect.y + rect.height >= scrollContainer.scrollTop + scrollContainer.clientHeight + pxTolerance)\r\n                return true;\r\n\r\n            return false;\r\n        },\r\n\r\n        _hIsInView: function (rect, scrollContainer, tolerance) {\r\n            var pxTolerance = scrollContainer.clientWidth * (tolerance || 0);\r\n            if (rect.x >= scrollContainer.scrollLeft - pxTolerance && rect.x <= scrollContainer.scrollLeft + scrollContainer.clientWidth + pxTolerance)\r\n                return true;\r\n\r\n            if (rect.x + rect.width >= scrollContainer.scrollLeft - pxTolerance && rect.x + rect.width <= scrollContainer.scrollLeft + scrollContainer.clientWidth + pxTolerance)\r\n                return true;\r\n\r\n            if (rect.x <= scrollContainer.scrollLeft - pxTolerance && rect.x + rect.width >= scrollContainer.scrollLeft + scrollContainer.clientWidth + pxTolerance)\r\n                return true;\r\n\r\n            return false;\r\n        },\r\n\r\n        /**\r\n         * Clear cached offsets for bloc and for items\r\n         */\r\n        clearOffsets: function () {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n            \r\n            ctrl.rect = null;\r\n            ctrl.items.forEach(function (item) {\r\n                item.rect = null;\r\n            });\r\n        },\r\n\r\n        /**\r\n         * update ui related properties like cached offsets, scroll events, ...\r\n         */\r\n        updateLayout: function () {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n            ctrl.refreshScrollEvents();\r\n        },\r\n\r\n        _checkSection: function (check, tolerance, noRender) {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n            tolerance = tolerance || 0;\r\n\r\n            if (!ctrl.rect && ctrl.items && ctrl.items.length) {\r\n                ctrl.rect = WinJSContrib.UI.offsetFrom(ctrl.element, ctrl.scrollContainer);\r\n            } else {\r\n                ctrl.rect = ctrl.rect || { x: 0, y: 0, width: 0, height: 0 };\r\n                ctrl.rect.width = ctrl.element.clientWidth;\r\n                ctrl.rect.height = ctrl.element.clientHeight;\r\n            }\r\n\r\n            if (check(ctrl.rect, ctrl.scrollContainer, tolerance)) {\r\n                if (noRender)\r\n                    return true;\r\n\r\n                ctrl.renderItemsContent();\r\n                if (ctrl.onrendersection) {\r\n                    ctrl.onrendersection();\r\n                }\r\n            } else if (ctrl.virtualize && tolerance > 0 && ctrl.items && ctrl.items.length && ctrl.items[0].rendered) {\r\n                ctrl.items.forEach(function (item) {\r\n                    item.empty();\r\n                });\r\n            }\r\n\r\n            if (tolerance == 0 && ctrl.tolerance > 0) {\r\n                setImmediate(function () {\r\n                    ctrl._checkSection(check, ctrl.tolerance);\r\n                });\r\n            }\r\n        },\r\n\r\n        _checkItem: function (check, tolerance) {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n            tolerance = tolerance || 0;\r\n            var allRendered = true;\r\n\r\n            var countR = function () {\r\n                var countRendered = 0;\r\n                ctrl.items.forEach(function (item) {\r\n                    if (item.rendered) {\r\n                        countRendered++;\r\n                    }\r\n                });\r\n                console.log('rendered ' + countRendered);\r\n            }\r\n\r\n            if (ctrl._checkSection(check, tolerance, true)) {\r\n                ctrl.items.forEach(function (item) {\r\n                    if (!item.rect) {\r\n                        item.rect = WinJSContrib.UI.offsetFrom(item.element, ctrl.scrollContainer);\r\n                    }\r\n                    allRendered = allRendered & item.rendered;\r\n\r\n                    if (!item.rendered && check(item.rect, ctrl.scrollContainer, tolerance)) {\r\n                        item.render();\r\n                    } else if (item.rendered && ctrl.virtualize && tolerance > 0 && !check(item.rect, ctrl.scrollContainer, tolerance)) {\r\n                        item.empty();\r\n                    }\r\n                });\r\n                ctrl.allRendered = allRendered;\r\n                //countR();\r\n            } else if (tolerance > 0 && ctrl.items.length && (ctrl.items[0].rendered || ctrl.items[ctrl.items.length - 1].rendered)) {\r\n                ctrl.items.forEach(function (item) {\r\n                    if (!item.rect) {\r\n                        item.rect = WinJSContrib.UI.offsetFrom(item.element, ctrl.scrollContainer);\r\n                    }\r\n                    if (ctrl.virtualize && !check(item.rect, ctrl.scrollContainer, tolerance)) {\r\n                        item.empty();\r\n                    }\r\n                });\r\n                //countR();\r\n            }\r\n\r\n            if (tolerance == 0 && ctrl.tolerance > 0) {\r\n                setImmediate(function () {\r\n                    ctrl._checkItem(check, ctrl.tolerance);\r\n                });\r\n            }\r\n\r\n\r\n        },\r\n\r\n        /**\r\n         * render items shells to the page\r\n         * @param {Array} items array of items to render\r\n         * @param {Object} renderOptions options for rendering items, can override control options like item template\r\n         */\r\n        prepareItems: function (items, renderOptions) {\r\n            var ctrl = this;\r\n            items = items || [];\r\n            renderOptions = renderOptions || {};\r\n            var numItems = items.length;\r\n\r\n            var itemInvoked = renderOptions.itemInvoked || ctrl.itemInvoked;\r\n            if (typeof itemInvoked == 'string')\r\n                itemInvoked = WinJSContrib.Utils.resolveMethod(ctrl.element, itemInvoked);\r\n            var template = WinJSContrib.Utils.getTemplate(renderOptions.template) || ctrl.itemTemplate;\r\n            var className = renderOptions.itemClassName || ctrl.itemClassName;\r\n            var onitemInit = renderOptions.onitemInit || ctrl.onitemInit;\r\n            var onitemContent = renderOptions.onitemContent || ctrl.onitemContent;\r\n            var container = ctrl.element;\r\n            var registereditems = ctrl.items;\r\n\r\n            items.forEach(function (itemdata) {\r\n                var item = new WinJSContrib.UI.MultiPassItem(ctrl, null, {\r\n                    data: itemdata,\r\n                    template: template,\r\n                    className: className,\r\n                    itemInvoked: itemInvoked,\r\n                    onitemInit: onitemInit,\r\n                    onitemContent: onitemContent\r\n                });\r\n                registereditems.push(item);\r\n                container.appendChild(item.element);\r\n            });\r\n            //for (var i = 0 ; i < numItems; i++) {\r\n            //    var itemdata = items[i];\r\n            //    var item = new WinJSContrib.UI.MultiPassItem(ctrl, null, {\r\n            //        data: itemdata,\r\n            //        template: template,\r\n            //        className: className,\r\n            //        itemInvoked: itemInvoked,\r\n            //        onitemInit: onitemInit,\r\n            //        onitemContent: onitemContent\r\n            //    });\r\n            //    registereditems.push(item);\r\n            //    container.appendChild(item.element);\r\n            //}\r\n\r\n            if (renderOptions.renderItems || !this.multipass) {\r\n                ctrl.renderItemsContent();\r\n            }\r\n            //ctrl.element.style.display = '';\r\n        },\r\n\r\n        /**\r\n         * check rendering of items, based on multipass configuration (force items on screen to render)\r\n         */\r\n        checkRendering: function () {\r\n            var ctrl = this;\r\n            if (ctrl.element && ctrl._scrollProcessor)\r\n                ctrl._scrollProcessor();\r\n        },\r\n\r\n        /**\r\n         * force rendering of all unrendered items\r\n         */\r\n        renderItemsContent: function () {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n\r\n            ctrl.items.forEach(function (item) {\r\n                if (!item.rendered) {\r\n                    //setImmediate(function () {\r\n                    item.render();\r\n                    //});\r\n                }\r\n            });\r\n            ctrl.allRendered = true;\r\n        }\r\n    });\r\n\r\n    WinJSContrib.UI.MultiPassItem = WinJS.Class.define(\r\n        /**\r\n         * Item for multipass rendering\r\n         * @class WinJSContrib.UI.MultiPassItem\r\n         */\r\n    function (renderer, element, options) {\r\n        options = options || {};\r\n        var item = this;\r\n        item.renderer = renderer;\r\n        item.element = element || document.createElement('DIV');\r\n        item.element.className = item.element.className + ' ' + options.className + ' mcn-multipass-item unloaded win-disposable';\r\n        item.element.winControl = item;\r\n\r\n        item.itemInvoked = options.itemInvoked;\r\n        item.itemDataPromise = WinJS.Promise.as(options.data);\r\n\r\n        item.itemTemplate = options.template;\r\n        item.rendered = false;\r\n        item.onitemContent = options.onitemContent;\r\n        if (options.onitemInit) {\r\n            options.onitemInit(this);\r\n        }\r\n    },\r\n    /**\r\n     * @lends WinJSContrib.UI.MultiPassItem\r\n     */\r\n    {\r\n        dispose: function () {\r\n            var item = this;\r\n            item.renderer = null;\r\n            item.element = null;\r\n            item.itemInvoked = null;\r\n            item.itemData = null;\r\n            item.itemDataPromise = null;\r\n            item.itemTemplate = null;\r\n            item.onitemContent = null;\r\n        },\r\n\r\n        /**\r\n         * render item content\r\n         */\r\n        render: function (delayed) {\r\n            var ctrl = this;\r\n\r\n            if (ctrl.element && ctrl.itemTemplate && !ctrl.rendered) {\r\n\r\n                ctrl.rendered = true;\r\n                return ctrl._renderContent();\r\n            }\r\n\r\n            return WinJS.Promise.wrap(ctrl.contentElement);\r\n        },\r\n\r\n        /**\r\n         * empty item and mark it as unrendered\r\n         */\r\n        empty: function () {\r\n            var ctrl = this;\r\n            if (ctrl.element && ctrl.rendered) {\r\n                WinJSContrib.UI.untapAll(ctrl.element);\r\n                ctrl.element.classList.remove('loaded');\r\n                ctrl.element.innerHTML = '';\r\n                ctrl.rendered = false;\r\n            }\r\n        },\r\n\r\n        _renderItemContent: function (rendered) {\r\n            var ctrl = this;\r\n            if (!ctrl.element)\r\n                return;\r\n\r\n            ctrl.element.appendChild(rendered);\r\n\r\n            if (ctrl.itemInvoked) {\r\n                if (typeof ctrl.itemInvoked == 'string')\r\n                    ctrl.itemInvoked = WinJSContrib.Utils.resolveMethod(ctrl.element, ctrl.itemInvoked);\r\n\r\n                if (ctrl.itemInvoked) {\r\n                    WinJSContrib.UI.tap(ctrl.element, function (arg) {\r\n                        ctrl.itemInvoked(ctrl);\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (ctrl.onitemContent) {\r\n                ctrl.onitemContent(ctrl.itemData, rendered);\r\n            }\r\n            else if (ctrl.renderer.onitemContent) {\r\n                ctrl.renderer.onitemContent(ctrl.itemData, rendered);\r\n            }\r\n\r\n            setImmediate(function () {\r\n                if (ctrl.element) {\r\n                    ctrl.element.classList.remove('unloaded');\r\n                    ctrl.element.classList.add('loaded');\r\n                }\r\n            });\r\n\r\n            ctrl.rendered = true;\r\n            ctrl.contentElement = rendered;\r\n            return rendered;\r\n        },\r\n\r\n        _renderContent: function () {\r\n            var ctrl = this;\r\n\r\n            if (ctrl.element && ctrl.itemTemplate) {\r\n                return ctrl.itemDataPromise.then(function (data) {\r\n                    ctrl.itemData = data;\r\n                    return ctrl.itemTemplate.render(data).then(function (rendered) {\r\n                        ctrl._renderItemContent(rendered);\r\n                    });\r\n                });\r\n            }\r\n\r\n            return WinJS.Promise.wrap();\r\n        }\r\n    });\r\n})();","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\n(function () {\r\n\r\n\t\"use strict\";\r\n\r\n\t/**\r\n     * Object representing a layout configuration for the grid control\r\n     * @typedef {Object} WinJSContrib.UI.GridControlLayout\r\n     * @property {string} layout layout algorythm to apply (horizontal | vertical | flexhorizontal | flexvertical | hbloc\r\n     * @property {number} cellSpace space between grid cells\r\n     * @property {number} cellWidth width of grid cells\r\n     * @property {number} cellHeight height of grid cells\r\n     * @property {number} itemsPerColumn number of cells per column if using a layout with a fixed number of cells\r\n     * @property {number} itemsPerRow number of cells per row if using a layout with a fixed number of cells\r\n     * @example\r\n     * {\r\n     *     layout: 'horizontal',\r\n     *     itemsPerColumn: (options.itemsPerColumn) ? options.itemsPerColumn : undefined,\r\n     *     itemsPerRow: (options.itemsPerRow) ? options.itemsPerRow : undefined,\r\n     *     cellSpace: 10,\r\n     *     cellWidth: (options.cellWidth) ? options.cellWidth : undefined,\r\n     *     cellHeight: (options.cellHeight) ? options.cellHeight : undefined,\r\n     * }\r\n     */\r\n\r\n\tWinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n\t\tGridControl: WinJS.Class.define(\r\n            /**\r\n             * @classdesc\r\n             * Control that layout it's children with different algorythms. Used with {@link WinJSContrib.UI.Hub}, The Grid could rely on multipass rendering to optimize large hub pages load.\r\n             * @class WinJSContrib.UI.GridControl\r\n             * @param {HTMLElement} element DOM element containing the control\r\n             * @param {Object} options\r\n             */\r\n            function GridControl(element, options) {\r\n            \tvar grid = this;\r\n            \toptions = options || {};\r\n            \tgrid.element = element;\r\n\r\n            \tgrid.element.className = grid.element.className + ' mcn-grid-ctrl mcn-layout-ctrl win-disposable';\r\n            \tgrid.element.winControl = grid;\r\n\r\n\r\n            \t/**\r\n                 * multipass renderer for the grid\r\n                 * @field\r\n                 * @type WinJSContrib.UI.MultiPassRenderer\r\n                 */\r\n            \tgrid.renderer = new WinJSContrib.UI.MultiPassRenderer(grid.element, {\r\n            \t\tmultipass: options.multipass,\r\n            \t\titemClassName: options.itemClassName,\r\n            \t\titemTemplate: options.itemTemplate,\r\n            \t\titemInvoked: options.itemInvoked,\r\n            \t});\r\n\r\n\r\n            \tgrid.layouts = options.layouts;\r\n\r\n            \t/**\r\n                 * default layout definitions for the grid\r\n                 * @field\r\n                 * @type WinJSContrib.UI.GridControlLayout\r\n                 */\r\n            \tgrid.defaultLayout = {\r\n            \t\tlayout: options.layout || 'none',\r\n            \t\titemsPerColumn: (options.itemsPerColumn) ? options.itemsPerColumn : undefined,\r\n            \t\titemsPerRow: (options.itemsPerRow) ? options.itemsPerRow : undefined,\r\n            \t\tcellSpace: (options.cellSpace) ? options.cellSpace : 10,\r\n            \t\tcellWidth: (options.cellWidth) ? options.cellWidth : undefined,\r\n            \t\tcellHeight: (options.cellHeight) ? options.cellHeight : undefined,\r\n            \t};\r\n\r\n            \t/**\r\n                 * indicate if grid accept layout event from the page (if you use WinJS Contrib page events)\r\n                 * @field\r\n                 * @type boolean\r\n                 */\r\n            \tgrid.autolayout = options.autolayout || true;\r\n\r\n            \tvar parent = WinJSContrib.Utils.getScopeControl(grid.element);\r\n            \tif (parent && parent.pageLifeCycle) {\r\n            \t\tparent.pageLifeCycle.steps.layout.attach(function () {\r\n            \t\t\tif (grid.autolayout) {\r\n            \t\t\t\tgrid.layout();\r\n            \t\t\t}\r\n            \t\t});\r\n            \t}\r\n            \telse if (parent && parent.elementReady) {\r\n            \t\tparent.elementReady.then(function () {\r\n            \t\t\tparent.readyComplete.then(function () {\r\n            \t\t\t\tif (grid.autolayout) {\r\n            \t\t\t\t\tgrid.layout();\r\n            \t\t\t\t}\r\n            \t\t\t});\r\n            \t\t});\r\n            \t}\r\n            },\r\n            /**\r\n             * @lends WinJSContrib.UI.GridControl.prototype\r\n             */\r\n            {\r\n            \t/**\r\n                 * scroll element containing the grid. Required for multi pass rendering\r\n                 * @field\r\n                 * @type HTMLElement\r\n                 */\r\n            \tscrollContainer: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.scrollContainer;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.scrollContainer = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * indicate if grid layout itself according to the page lifecycle (default to true)\r\n                 * @field\r\n                 * @type boolean\r\n                 */\r\n            \tautolayout: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this._autolayout;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis._autolayout = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * layout definitions for the grid. It's an object containing several grid layout options. See {@link WinJSContrib.UI.GridControlLayout}\r\n                 * @field\r\n                 * @type Object\r\n                 */\r\n            \tlayouts: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.gridLayouts;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.gridLayouts = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * indicate the kind of multipass treatment\r\n                 * @field\r\n                 * @type string\r\n                 */\r\n            \tmultipass: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.multipass;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.multipass = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * callback triggered when clicking on an item\r\n                 * @field\r\n                 * @type HTMLElement\r\n                 */\r\n            \titemInvoked: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.itemInvoked;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.itemInvoked = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * item template (WinJS Template or template function)\r\n                 * @field\r\n                 * @type Object\r\n                 */\r\n            \titemTemplate: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.itemTemplate;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.itemTemplate = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * css class added on item's placeholder\r\n                 * @field\r\n                 * @type Object\r\n                 */\r\n            \titemClassName: {\r\n            \t\tget: function () {\r\n            \t\t\treturn this.renderer.itemClassName;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n            \t\t\tthis.renderer.itemClassName = val;\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * items to render\r\n                 * @field\r\n                 * @type Object\r\n                 */\r\n            \titems: {\r\n            \t\tget: function () {\r\n            \t\t\treturn;\r\n            \t\t},\r\n            \t\tset: function (val) {\r\n\t\t\t\t\t\tif (val && val.length)\r\n            \t\t\t\tthis.prepareItems(val);\r\n            \t\t}\r\n            \t},\r\n\r\n            \t/**\r\n                 * render HTML for items\r\n                 * @param {Array} items array of items to render\r\n                 * @param {Object} renderOptions\r\n                 */\r\n            \tprepareItems: function (items, renderOptions) {\r\n                    if (!this.element)\r\n                        return;\r\n                    \r\n            \t\tvar parent = WinJSContrib.Utils.getParentControlByClass('mcn-layout-ctrl', this.element);\r\n            \t\tvar parentMultipass = undefined;\r\n            \t\tif (!this.renderer.multipass && parent && parent.multipass) {\r\n            \t\t\tthis.renderer.multipass = parent.multipass;\r\n            \t\t}\r\n\r\n            \t\tthis.renderer.prepareItems(items, renderOptions);\r\n            \t},\r\n\r\n            \t/**\r\n                 * force items content to render\r\n                 */\r\n            \trenderItemsContent: function () {\r\n            \t\tif (!this.renderer)\r\n                        return;\r\n                    this.renderer.renderItemsContent();\r\n            \t},\r\n\r\n            \tresetElement: function (elt, isItem) {\r\n            \t\tvar style = elt.style;\r\n            \t\tif (isItem && style.position) style.position = '';\r\n            \t\tif (!isItem && style.display) style.display = '';\r\n            \t\tif (style.width) style.width = '';\r\n            \t\tif (style.height) style.height = '';\r\n            \t\tif (style.minWidth) style.minWidth = '';\r\n            \t\tif (style.minHeight) style.minHeight = '';\r\n            \t\tif (style.left) style.left = '';\r\n            \t\tif (style.top) style.top = '';\r\n            \t},\r\n\r\n            \tclearContent: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\tctrl.renderer.clear();\r\n            \t},\r\n\r\n            \t/**\r\n                 * Clear all layout and position styles on items\r\n                 */\r\n            \tclearLayout: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\t\r\n            \t\tctrl.resetElement(ctrl.element, false);\r\n            \t\tif (ctrl.element.children.length) {\r\n            \t\t\tfor (var i = 0, l = ctrl.element.children.length; i < l; i++) {\r\n            \t\t\t\tctrl.resetElement(ctrl.element.children[i], true);\r\n            \t\t\t}\r\n            \t\t}\r\n            \t},\r\n\r\n            \tfill: function (matrix, x, y, w, h) {\r\n            \t\tif (matrix.length < x + w) {\r\n            \t\t\tfor (var i = matrix.length ; i < x + w ; i++) {\r\n            \t\t\t\tmatrix.push([]);\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\tfor (var i = x ; i < x + w ; i++) {\r\n            \t\t\tvar col = matrix[i];\r\n            \t\t\tif (col.length < y + h) {\r\n            \t\t\t\tfor (var j = col.length ; j < y + h ; j++) {\r\n            \t\t\t\t\tcol.push(false);\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n\r\n            \t\t\tfor (var j = y ; j < y + h ; j++) {\r\n            \t\t\t\tcol[j] = true;\r\n            \t\t\t}\r\n            \t\t}\r\n            \t},\r\n\r\n            \tfit: function (matrix, x, y, w, h, maxW, maxH) {\r\n            \t\t//items to big\r\n            \t\tif (maxH && h > maxH && y === 0)\r\n            \t\t\treturn true;\r\n            \t\tif (maxW && w > maxW && x === 0)\r\n            \t\t\treturn true;\r\n\r\n            \t\t//overflow grid capacity\r\n            \t\tif (maxW && (x + w) > maxW)\r\n            \t\t\treturn false;\r\n            \t\tif (maxH && (y + h) > maxH)\r\n            \t\t\treturn false;\r\n\r\n            \t\tfor (var i = x ; i < x + w ; i++) {\r\n            \t\t\tvar col = matrix[i];\r\n            \t\t\tif (col) {\r\n            \t\t\t\tfor (var j = y ; j < y + h ; j++) {\r\n            \t\t\t\t\tif (col[j] === true)\r\n            \t\t\t\t\t\treturn false;\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\treturn true;\r\n            \t},\r\n\r\n            \tfirstFit: function (matrix, w, h, maxH, numItems) {\r\n            \t\tvar ctrl = this;\r\n            \t\tfor (var i = 0 ; i < numItems * maxH * 2 ; i++) {\r\n            \t\t\tvar col = matrix[i];\r\n            \t\t\tif (col) {\r\n            \t\t\t\tfor (var j = 0 ; j < maxH ; j++) {\r\n            \t\t\t\t\tif (col[j] !== true && ctrl.fit(matrix, i, j, w, h, undefined, maxH)) {\r\n            \t\t\t\t\t\treturn { x: i, y: j };\r\n            \t\t\t\t\t}\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n            \t\t\telse {\r\n            \t\t\t\treturn { x: i, y: 0 };\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\treturn undefined;\r\n            \t},\r\n\r\n            \tvisibleChilds: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\tvar res = [];\r\n\r\n            \t\tfor (var i = 0, l = ctrl.element.children.length; i < l ; i++) {\r\n            \t\t\tvar item = ctrl.element.children[i];\r\n            \t\t\tvar st = window.getComputedStyle(item);\r\n            \t\t\tif (st.display != 'none' && st.visibility != 'hidden') {\r\n            \t\t\t\tres.push(item);\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\treturn res;\r\n            \t},\r\n\r\n            \t/**\r\n                 * Layouts algorythm implementations\r\n                 */\r\n            \tGridLayoutsImpl: {\r\n            \t\tnone: function () {\r\n            \t\t},\r\n\r\n            \t\tflexhorizontal: function () {\r\n            \t\t\tvar ctrl = this;\r\n            \t\t\tctrl.renderer.orientation = 'horizontal';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\tctrl.element.style.display = 'flex';\r\n            \t\t\tctrl.element.style.flexFlow = 'column wrap';\r\n            \t\t\tctrl.element.style.alignContent = 'flex-start';\r\n            \t\t\t//ctrl.element.style.alignContent = 'flex-start';\r\n\r\n            \t\t\tif (ctrl.element.style.width)\r\n            \t\t\t\tctrl.element.style.width = '';\r\n\r\n            \t\t\tctrl.element.style.height = '';\r\n\r\n            \t\t\tif (ctrl.element.clientHeight)\r\n            \t\t\t\tctrl.element.style.height = ctrl.element.clientHeight + 'px';\r\n            \t\t\telse\r\n            \t\t\t\tctrl.element.style.height = '';\r\n\r\n            \t\t\tvar _itemsPerColumn = Math.floor(ctrl.element.clientHeight / (ctrl.data.cellHeight + ctrl.data.cellSpace));\r\n            \t\t\tif (_itemsPerColumn) {\r\n            \t\t\t\tvar visibleitems = ctrl.visibleChilds();\r\n            \t\t\t\tvar columns = Math.ceil(visibleitems.length / _itemsPerColumn);\r\n            \t\t\t\tctrl.element.style.minWidth = ((ctrl.data.cellWidth + ctrl.data.cellSpace) * columns) + 'px';\r\n            \t\t\t}\r\n            \t\t},\r\n\r\n            \t\tflexvertical: function () {\r\n            \t\t    var ctrl = this;\r\n                        ctrl.renderer.orientation = 'vertical';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\tctrl.element.style.display = 'flex';\r\n            \t\t\tctrl.element.style.flexFlow = 'row wrap';\r\n            \t\t\tctrl.element.style.alignContent = 'flex-start';\r\n\r\n            \t\t\tctrl.element.style.width = '';\r\n            \t\t\tif (ctrl.element.clientWidth)\r\n            \t\t\t\tctrl.element.style.width = ctrl.element.clientWidth + 'px';\r\n            \t\t\telse\r\n            \t\t\t\tctrl.element.style.width = '';\r\n\r\n            \t\t\tif (ctrl.element.style.height)\r\n            \t\t\t\tctrl.element.style.height = '';\r\n            \t\t},\r\n\r\n            \t\thbloc: function () {\r\n            \t\t\tvar ctrl = this;\r\n            \t\t\tctrl.renderer.orientation = 'horizontal';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\tctrl.element.style.height = '';\r\n            \t\t\tvar _containerH = ctrl.element.clientHeight;\r\n            \t\t\tif (!_containerH)\r\n            \t\t\t\treturn;\r\n\r\n            \t\t\tvar cellW = ctrl.data.cellWidth;\r\n            \t\t\tvar space = ctrl.data.cellSpace;\r\n            \t\t\tvar colCount = 1;\r\n            \t\t\tvar colOffset = 0;\r\n            \t\t\tvar topOffset = 0;\r\n\r\n            \t\t\tvar childs = ctrl.visibleChilds();\r\n            \t\t\tchilds.forEach(function (elt) {\r\n            \t\t\t\tif (elt.style.position != 'absolute')\r\n            \t\t\t\t\telt.style.position = 'absolute';\r\n            \t\t\t\tvar eltH = elt.clientHeight;\r\n            \t\t\t\tif (topOffset + eltH > _containerH) {\r\n            \t\t\t\t\tcolCount++;\r\n            \t\t\t\t\tcolOffset = colOffset + space + cellW;\r\n            \t\t\t\t\ttopOffset = 0;\r\n            \t\t\t\t}\r\n\r\n            \t\t\t\tif (elt.style.left != colOffset + 'px')\r\n            \t\t\t\t\telt.style.left = colOffset + 'px';\r\n            \t\t\t\tif (elt.style.top != topOffset + 'px')\r\n            \t\t\t\t\telt.style.top = topOffset + 'px';\r\n\r\n            \t\t\t\ttopOffset += eltH;\r\n            \t\t\t});\r\n\r\n            \t\t\tcolOffset = colOffset + cellW;\r\n            \t\t\tif (ctrl.element.style.width != colOffset + 'px')\r\n            \t\t\t\tctrl.element.style.width = colOffset + 'px';\r\n            \t\t},\r\n\r\n            \t\thorizontal: function () {\r\n            \t\t\tvar ctrl = this;\r\n            \t\t\tctrl.renderer.orientation = 'horizontal';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\tctrl.element.style.height = '';\r\n            \t\t\tvar _containerH = ctrl.element.clientHeight;\r\n            \t\t\tif (!_containerH)\r\n            \t\t\t\treturn;\r\n\r\n            \t\t\tvar _itemsPerColumn = Math.floor(_containerH / (ctrl.data.cellHeight + ctrl.data.cellSpace));\r\n            \t\t\tif (_itemsPerColumn <= 0)\r\n            \t\t\t\t_itemsPerColumn = 1;\r\n\r\n            \t\t\tvar cellW = ctrl.data.cellWidth;\r\n            \t\t\tvar cellH = ctrl.data.cellHeight;\r\n            \t\t\tvar space = ctrl.data.cellSpace;\r\n            \t\t\tvar aspectRatio = cellW / cellH;\r\n            \t\t\tvar ratioW = 1;\r\n            \t\t\tvar ratioH = 1;\r\n\r\n            \t\t\tif (ctrl.data.itemsPerColumn) {\r\n            \t\t\t\t_itemsPerColumn = ctrl.data.itemsPerColumn;\r\n            \t\t\t\tcellH = ((_containerH - ((_itemsPerColumn - 1) * space)) / _itemsPerColumn) >> 0;\r\n            \t\t\t\tcellW = (ctrl.data.cellWidth * cellH / ctrl.data.cellHeight) >> 0;\r\n            \t\t\t\tratioW = cellW / ctrl.data.cellWidth;\r\n            \t\t\t\tratioH = cellH / ctrl.data.cellHeight;\r\n            \t\t\t}\r\n\r\n            \t\t\tvar gridCellsMatrix = [[]];\r\n            \t\t\tvar childs = ctrl.visibleChilds();\r\n            \t\t\tchilds.forEach(function (elt) {\r\n            \t\t\t\telt.style.position = 'absolute';\r\n            \t\t\t\tvar eltW = elt.offsetWidth * ratioW;\r\n            \t\t\t\tvar eltH = elt.offsetHeight * ratioH;\r\n            \t\t\t\tvar eltColumns = (eltW / cellW) >> 0;\r\n            \t\t\t\tvar eltRows = (eltH / cellH) >> 0;\r\n\r\n            \t\t\t\tvar pos = ctrl.firstFit(gridCellsMatrix, eltColumns, eltRows, _itemsPerColumn, ctrl.element.children.length);\r\n            \t\t\t\tif (!pos)\r\n            \t\t\t\t\tpos = { x: 0, y: 0 };\r\n            \t\t\t\tctrl.fill(gridCellsMatrix, pos.x, pos.y, eltColumns, eltRows);\r\n\r\n            \t\t\t\tvar left = pos.x * (cellW + space);\r\n            \t\t\t\tvar top = pos.y * (cellH + space);\r\n            \t\t\t\tvar w = (eltColumns * cellW + ((eltColumns - 1) * space));\r\n            \t\t\t\tvar h = (eltRows * cellH + ((eltRows - 1) * space));\r\n            \t\t\t\telt.style.left = left + 'px';\r\n            \t\t\t\telt.style.top = top + 'px';\r\n            \t\t\t\telt.style.width = w + 'px';\r\n            \t\t\t\telt.style.height = h + 'px';\r\n            \t\t\t});\r\n\r\n            \t\t\tvar elementWidth = gridCellsMatrix.length * (cellW + space);\r\n            \t\t\tctrl.element.style.width = elementWidth + 'px';\r\n            \t\t},\r\n\r\n            \t\tvertical: function (plugin) {\r\n            \t\t\tvar ctrl = this;\r\n            \t\t\tctrl.renderer.orientation = 'vertical';\r\n            \t\t\tctrl.element.style.width = '';\r\n            \t\t\tctrl.element.style.position = 'relative';\r\n            \t\t\t//Be aware that in this case, we invert the matrix to crawl data in lines\r\n            \t\t\tvar _containerW = ctrl.element.clientWidth;\r\n            \t\t\tif (!_containerW)\r\n            \t\t\t\treturn;\r\n\r\n            \t\t\tvar _itemsPerLine = Math.floor(_containerW / (ctrl.data.cellWidth + ctrl.data.cellSpace));\r\n            \t\t\tif (_itemsPerLine <= 0)\r\n            \t\t\t\t_itemsPerLine = 1;\r\n\r\n            \t\t\tvar cellW = ctrl.data.cellWidth;\r\n            \t\t\tvar cellH = ctrl.data.cellHeight;\r\n            \t\t\tvar space = ctrl.data.cellSpace;\r\n            \t\t\tvar aspectRatio = cellW / cellH;\r\n            \t\t\tvar ratioW = 1;\r\n            \t\t\tvar ratioH = 1;\r\n\r\n            \t\t\tif (ctrl.data.itemsPerRow) {\r\n            \t\t\t\t_itemsPerLine = ctrl.data.itemsPerRow;\r\n            \t\t\t\tcellW = ((_containerW - ((_itemsPerLine - 1) * space)) / _itemsPerLine) >> 0;\r\n            \t\t\t\tcellH = (ctrl.data.cellHeight * cellW / ctrl.data.cellWidth) >> 0;\r\n            \t\t\t\tratioW = cellW / ctrl.data.cellWidth;\r\n            \t\t\t\tratioH = cellH / ctrl.data.cellHeight;\r\n            \t\t\t}\r\n\r\n            \t\t\tvar gridCellsMatrix = [[]];\r\n            \t\t\tvar childs = ctrl.visibleChilds();\r\n            \t\t\tchilds.forEach(function (elt) {\r\n            \t\t\t\telt.style.position = 'absolute';\r\n\r\n            \t\t\t\tvar eltW = elt.offsetWidth * ratioW;\r\n            \t\t\t\tvar eltH = elt.offsetHeight * ratioH;\r\n            \t\t\t\tvar eltColumns = (eltW / cellW) >> 0;\r\n            \t\t\t\tvar eltRows = (eltH / cellH) >> 0;\r\n\r\n            \t\t\t\tvar pos = ctrl.firstFit(gridCellsMatrix, eltRows, eltColumns, _itemsPerLine, ctrl.element.children.length);\r\n            \t\t\t\t//if (!pos)\r\n            \t\t\t\t//    return;\r\n\r\n            \t\t\t\tctrl.fill(gridCellsMatrix, pos.x, pos.y, eltRows, eltColumns);\r\n\r\n            \t\t\t\tvar left = pos.y * (cellW + space);\r\n            \t\t\t\tvar top = pos.x * (cellH + space);\r\n            \t\t\t\telt.style.left = left + 'px';\r\n            \t\t\t\telt.style.top = top + 'px';\r\n            \t\t\t\telt.style.width = (eltColumns * cellW + ((eltColumns - 1) * space)) + 'px';\r\n            \t\t\t\telt.style.height = (eltRows * cellH + ((eltRows - 1) * space)) + 'px';\r\n\r\n            \t\t\t});\r\n\r\n            \t\t\tvar elementHeight = gridCellsMatrix.length * (cellH + space);\r\n            \t\t\tctrl.element.style.height = elementHeight + 'px';\r\n            \t\t},\r\n            \t},\r\n\r\n            \t/**\r\n                 * layout content items\r\n                 */\r\n            \tlayout: function () {\r\n            \t    var ctrl = this;\r\n            \t    if (!ctrl.element)\r\n            \t        return;\r\n            \t\tvar oldlayout = ctrl.data;\r\n            \t\tctrl.data = ctrl.getLayout();\r\n\r\n            \t\tif (ctrl.data) {\r\n            \t\t\t//if (ctrl.data == oldlayout && ctrl.data.applyed)\r\n            \t\t\t//    return;\r\n\r\n            \t\t\tctrl.data.cellSpace = (ctrl.data.cellSpace != undefined ? ctrl.data.cellSpace : (ctrl.defaultLayout.cellSpace != undefined ? ctrl.defaultLayout.cellSpace : 10));\r\n            \t\t\tctrl.data.cellWidth = ctrl.data.cellWidth || ctrl.defaultLayout.cellWidth || 0;\r\n            \t\t\tctrl.data.cellHeight = ctrl.data.cellHeight || ctrl.defaultLayout.cellHeight || 0;\r\n\r\n            \t\t\t//if cell dimensions are not defined, take it from last child\r\n            \t\t\tif (!ctrl.data.cellWidth || !ctrl.data.cellHeight) {\r\n            \t\t\t    if (ctrl.element && ctrl.element.childNodes && ctrl.element.children.length > 0) {\r\n            \t\t\t\t\tvar childs = ctrl.visibleChilds();\r\n            \t\t\t\t\tif (childs && childs.length) {\r\n            \t\t\t\t\t\tvar firstChild = childs[0];\r\n            \t\t\t\t\t\tvar w = firstChild.clientWidth;\r\n            \t\t\t\t\t\tvar h = firstChild.clientHeight;\r\n            \t\t\t\t\t\tvar l = childs.length;\r\n            \t\t\t\t\t\tif (l > 10) l = 10;\r\n            \t\t\t\t\t\tfor (var i = 0, l = childs.length; i < l ; i++) {\r\n            \t\t\t\t\t\t\tvar item = childs[i];\r\n            \t\t\t\t\t\t\tif (w == 0 || item.clientWidth < w) {\r\n            \t\t\t\t\t\t\t\tw = item.clientWidth;\r\n            \t\t\t\t\t\t\t}\r\n            \t\t\t\t\t\t\tif (h == 0 || item.clientHeight < h) {\r\n            \t\t\t\t\t\t\t\th = item.clientHeight;\r\n            \t\t\t\t\t\t\t}\r\n            \t\t\t\t\t\t}\r\n            \t\t\t\t\t\tctrl.data.cellWidth = w;\r\n            \t\t\t\t\t\tctrl.data.cellHeight = h;\r\n            \t\t\t\t\t}\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n\r\n            \t\t\tvar layoutChanged = !oldlayout || ctrl.data.layout !== oldlayout.layout;\r\n            \t\t\tif (ctrl.data.layout) {\r\n            \t\t\t\tvar layoutfunc = ctrl.GridLayoutsImpl[ctrl.data.layout.toLowerCase()];\r\n            \t\t\t\tif (layoutfunc) {\r\n            \t\t\t\t\tif (layoutChanged)\r\n            \t\t\t\t\t\tctrl.changeLayout();\r\n\r\n            \t\t\t\t\tlayoutfunc.bind(ctrl)(layoutChanged);\r\n            \t\t\t\t\tctrl.data.applyed = true;\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n            \t\t\tctrl.renderer.checkRendering();\r\n            \t\t}\r\n            \t},\r\n\r\n            \tchangeLayout: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\tctrl.clearLayout();\r\n            \t\tctrl.renderer.updateLayout();\r\n            \t},\r\n\r\n            \t/**\r\n                 * update grid layout\r\n                 */\r\n            \tupdateLayout: function (element, viewState, lastViewState) {\r\n            \t    var ctrl = this;\r\n            \t    if (!ctrl.element)\r\n            \t        return;\r\n            \t\tctrl.layout();\r\n            \t},\r\n\r\n            \t/**\r\n                 * get layout applicable to the current context\r\n                 */\r\n            \tgetLayout: function () {\r\n            \t\tvar ctrl = this;\r\n            \t\tvar matchingLayout = undefined;\r\n            \t\tif (ctrl.gridLayouts) {\r\n            \t\t\tfor (var name in ctrl.gridLayouts) {\r\n            \t\t\t\tvar layout = ctrl.gridLayouts[name];\r\n            \t\t\t\tif (ctrl.gridLayouts.hasOwnProperty(name)) {\r\n            \t\t\t\t\tif (layout.query) {\r\n            \t\t\t\t\t\tvar mq = window.matchMedia(layout.query);\r\n            \t\t\t\t\t\tif (mq.matches) {\r\n            \t\t\t\t\t\t\tmatchingLayout = layout;\r\n            \t\t\t\t\t\t}\r\n            \t\t\t\t\t} else if (!matchingLayout) {\r\n            \t\t\t\t\t\tmatchingLayout = layout;\r\n            \t\t\t\t\t}\r\n            \t\t\t\t}\r\n            \t\t\t\telse if (!matchingLayout) {\r\n            \t\t\t\t\tmatchingLayout = layout;\r\n            \t\t\t\t}\r\n            \t\t\t}\r\n            \t\t}\r\n\r\n            \t\tif (!matchingLayout) {\r\n            \t\t\tmatchingLayout = ctrl.defaultLayout;\r\n            \t\t}\r\n\r\n            \t\treturn JSON.parse(JSON.stringify(matchingLayout));\r\n            \t},\r\n\r\n            \t/**\r\n                 * Release grid resources\r\n                 */\r\n            \tdispose: function () {\r\n            \t\tthis.element = null;\r\n            \t\tthis.renderer.dispose();\r\n            \t\tif (WinJS.Utilities.disposeSubTree)\r\n            \t\t\tWinJS.Utilities.disposeSubTree(this.element);\r\n            \t}\r\n            })\r\n\t});\r\n\r\n\tif (WinJSContrib.UI.WebComponents) {\r\n\t\tWinJSContrib.UI.WebComponents.register('mcn-grid', WinJSContrib.UI.GridControl, {\r\n\t\t\tproperties: ['multipass', 'autolayout', 'layouts', 'itemInvoked', 'itemTemplate', 'itemClassName', 'items']\r\n\t\t});\r\n\t}\r\n})();","/* \r\n * WinJS Contrib v2.1.0.2\r\n * licensed under MIT license (see http://opensource.org/licenses/MIT)\r\n * sources available at https://github.com/gleborgne/winjscontrib\r\n */\r\n\r\nvar WinJSContrib = WinJSContrib || {};\r\nWinJSContrib.UI = WinJSContrib.UI || {};\r\n\r\n/** @namespace */\r\nWinJSContrib.UI.DataSources = WinJSContrib.UI.DataSources || {};\r\n\r\n\r\n(function (ds, gr) {\r\n    \"use strict\";\r\n\r\n    ds.DataSourceManager = WinJS.Class.mix(WinJS.Class.define(\r\n    /** \r\n     * \r\n     * @class WinJSContrib.UI.DataSources.DataSourceManager\r\n     * @classdesc helper class to manage an array with filter and grouping facilities and plug it into listview with or without semantic zoom. \r\n     * This is a low level helper object, it's likely that relying on {@link WinJSContrib.UI.SemanticListViews} will be easier.\r\n     * @param {Object} options\r\n     * @example\r\n     * {@lang javascript}\r\n     * var datamgr = new WinJSContrib.UI.DataSources.DataSourceManager({\r\n     *    defaultGroupLimit: 12,\r\n     *    groupKind: WinJSContrib.UI.DataSources.Grouping.byField,\r\n     *    field: 'metadata.genre',\r\n     *    listview: page.zoomedInList,\r\n     *    zoomedOutListView: page.zoomedOutList\r\n     * });\r\n     * \r\n     */\r\n    function (options) {\r\n        this.groupedList = null;\r\n        this.list = null;\r\n        this.defaultGroupLimit = 0;\r\n        this.filters = new WinJS.Binding.List();\r\n        this.filters.onitemchanged = this.init.bind(this);\r\n        this.filters.oniteminserted = this.init.bind(this);\r\n        this.filters.onitemremoved = this.init.bind(this);\r\n        this.apply(options);\r\n    },\r\n    /**\r\n     * @lends WinJSContrib.UI.DataSources.DataSourceManager.prototype\r\n     */\r\n    {\r\n        apply: function (options) {\r\n            options = options || {};\r\n\r\n            if (options.field)\r\n                this.field = options.field;\r\n\r\n            if (options.defaultGroupLimit) this.defaultGroupLimit = options.defaultGroupLimit;\r\n            if (options.filter) this.filter = options.filter;\r\n            if (options.groupKind) {\r\n                if (options.groupKind != this.groupKind) {\r\n                    this.groupKind = options.groupKind;\r\n                }\r\n                options = options.groupKind(options);\r\n            }\r\n            if (options.defaultGroupName) this.defaultGroupName = options.defaultGroupName;\r\n            if (options.compareGroups) this.compareGroups = options.compareGroups;\r\n            if (options.getGroupKey) this.getGroupKey = options.getGroupKey;\r\n            if (options.getGroupData) this.getGroupData = options.getGroupData;\r\n            if (options.listview) this.listview = options.listview;\r\n            if (options.zoomedOutListView) this.zoomedOutListView = options.zoomedOutListView;\r\n            if (options.items) this.items = options.items;\r\n\r\n        },\r\n\r\n        /**\r\n         * path to the field to use for groupings\r\n         * @field\r\n         * @type string\r\n         */\r\n        field: {\r\n            get: function () {\r\n                return this._field;\r\n            },\r\n            set: function (val) {\r\n                this._field = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * no grouping if items.length < defaultGroupLimit\r\n         * @field\r\n         * @type number\r\n         */\r\n        defaultGroupLimit: {\r\n            get: function () {\r\n                return this._defaultGroupLimit;\r\n            },\r\n            set: function (val) {\r\n                this._defaultGroupLimit = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * groupKind grouping manager function\r\n         * @field\r\n         * @type function\r\n         */\r\n        groupKind: {\r\n            get: function () {\r\n                return this._groupKind;\r\n            },\r\n            set: function (val) {\r\n                if (val != this._groupKind) {\r\n                    this._groupKind = val;\r\n                    this.apply({ groupKind: val });\r\n                    this.init();\r\n                }\r\n                if (!val) {\r\n                    this.compareGroups = null;\r\n                    this.getGroupData = null;\r\n                    this.getGroupKey = null;\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * items listview\r\n         * @field\r\n         * @type WinJS.UI.ListView\r\n         */\r\n        listview: {\r\n            get: function () {\r\n                return this._listview;\r\n            },\r\n            set: function (val) {\r\n                if (this._listview) {\r\n                    this.detach();\r\n                }\r\n\r\n                this._listview = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * listview for grouped items\r\n         * @field\r\n         * @type WinJS.UI.ListView\r\n         */\r\n        groupedList: {\r\n            get: function () {\r\n                return this._groupedList;\r\n            },\r\n            set: function (val) {\r\n                this._groupedList = val;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * item filter callback\r\n         * @field\r\n         * @type function\r\n         */\r\n        filter: {\r\n            get: function () {\r\n                return this._filter;\r\n            },\r\n            set: function (val) {\r\n                if (this._filter) {\r\n                    this.detach();\r\n                }\r\n\r\n                this._filter = val;\r\n                if (val) {\r\n                    this.init();\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * data items\r\n         * @field\r\n         * @type Array\r\n         */\r\n        items: {\r\n            get: function () {\r\n                return this._items;\r\n            },\r\n            set: function (val) {\r\n                if (this._items) {\r\n                    this.detach();\r\n                }\r\n                this._items = val;\r\n                if (val) {\r\n                    this.init();\r\n                }\r\n                else {\r\n                    this.list = null;\r\n                    this.groupedList = null;\r\n                    this.filteredlist = null;\r\n                    this.detach();\r\n                }\r\n            }\r\n        },\r\n\r\n        _filterItems: function (item) {\r\n            var ctrl = this;\r\n            var res = function (item) { return true; };\r\n\r\n            if (this.filter)\r\n                res = function (item) { return ctrl.filter(item) };\r\n\r\n            if (this.filters.length) {\r\n                var addFilter = function (f, newFilter) {\r\n                    return function (item) {\r\n                        var tmp = f(item);\r\n                        if (!tmp)\r\n                            return false;\r\n\r\n                        return newFilter(item);\r\n                    }\r\n                }\r\n\r\n                for (var i = 0 ; i < this.filters.length ; i++) {\r\n                    var filter = this.filters.getAt(i);\r\n                    res = addFilter(res, filter);\r\n                }\r\n            }\r\n\r\n            return res;\r\n        },\r\n\r\n        refresh: function () {\r\n            this.init();\r\n        },\r\n\r\n        /**\r\n         * initialise data\r\n         */\r\n        init: function (dontAttach) {\r\n            var ctrl = this;\r\n            this.detach();\r\n            if (this.items) {\r\n                this.list = new WinJS.Binding.List(this.items);\r\n\r\n                if (this.filter || this.filters.length) {\r\n                    var filterCallback = this._filterItems();\r\n                    this.filteredlist = this.list.createFiltered(filterCallback);\r\n                }\r\n                else {\r\n                    this.filteredlist = this.list;\r\n                }\r\n\r\n                if (this.getGroupKey && this.getGroupData && this.compareGroups) {\r\n                    this.groupedList = this.filteredlist.createGrouped(this.getGroupKey.bind(this), this.getGroupData.bind(this), this.compareGroups.bind(this));\r\n\r\n                    var g = ctrl.groupedList.groups;\r\n                    for (var n in g._groupItems) {\r\n                        console.log(n);\r\n                        var grp = ctrl.groupedList._groupsProjection._groupItems[n];\r\n                        if (grp && grp.groupSize !== undefined)\r\n                            grp.data.groupCount = grp.groupSize;\r\n                    }\r\n                } else {\r\n                    this.groupedList = null;\r\n                }\r\n\r\n                if (!dontAttach)\r\n                    this.attach();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * clean-up, initialise data and bind listviews to data\r\n         * @param {Array} items\r\n         */\r\n        prepareItems: function (items) {\r\n            this.detach();\r\n            this._items = items;\r\n            this.init(true);\r\n        },\r\n\r\n        /**\r\n         * attach listviews to data\r\n         */\r\n        attach: function () {\r\n            if ((this.groupedList || this.filteredlist) && this.listview) {\r\n                if (this.groupedList && this.groupedList.length >= this.defaultGroupLimit) {\r\n                    this.listview.itemDataSource = this.groupedList.dataSource;\r\n                    this.listview.groupDataSource = this.groupedList.groups.dataSource;\r\n\r\n                    if (this.zoomedOutListView)\r\n                        this.zoomedOutListView.itemDataSource = this.groupedList.groups.dataSource;\r\n\r\n                    var semzoom = this.parentSemanticZoom();\r\n                    if (semzoom) {\r\n                        semzoom.locked = false;\r\n                    }\r\n                }\r\n                else if (this.filteredlist && (this.filteredlist.length >= this.defaultGroupLimit || !this.groupedList)) {\r\n                    this.listview.itemDataSource = this.filteredlist.dataSource;\r\n                    this.listview.groupDataSource = null;\r\n                    var semzoom = this.parentSemanticZoom();\r\n                    if (semzoom) {\r\n                        semzoom.locked = true;\r\n                    }\r\n                }\r\n                //else if (this.filteredlist && this.filteredlist.length) {\r\n                //    this.listview.itemDataSource = this.filteredlist.dataSource;\r\n                //    this.listview.groupDataSource = null;\r\n                //    var semzoom = this.parentSemanticZoom();\r\n                //    if (semzoom) {\r\n                //        semzoom.locked = true;\r\n                //    }\r\n                //}\r\n                else {\r\n                    if (this.groupedList)\r\n                        this.listview.itemDataSource = this.groupedList.dataSource;\r\n                    this.listview.groupDataSource = null;\r\n                    if (this.zoomedOutListView)\r\n                        this.zoomedOutListView.itemDataSource = null;\r\n\r\n                    var semzoom = this.parentSemanticZoom();\r\n                    if (semzoom) {\r\n                        semzoom.locked = true;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * get parent semantic zoom control\r\n         * @returns {WinJS.UI.SemanticZoom}\r\n         */\r\n        parentSemanticZoom: function () {\r\n            var parent = this.listview.element.parentElement;\r\n            while (parent) {\r\n                if (parent.classList.contains('win-semanticzoom'))\r\n                    return parent.winControl;\r\n                parent = parent.parentElement;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * detach listviews from data\r\n         */\r\n        detach: function () {\r\n            if (this.listview) {\r\n                this.listview.itemDataSource = null;\r\n                this.listview.groupDataSource = null;\r\n                if (this.zoomedOutListView)\r\n                    this.zoomedOutListView.itemDataSource = null;\r\n            }\r\n        }\r\n    }), WinJS.UI.DOMEventMixin);\r\n\r\n    WinJSContrib.UI.SemanticListViews = WinJS.Class.mix(WinJS.Class.define(\r\n    /** \r\n     * \r\n     * @class WinJSContrib.UI.SemanticListViews\r\n     * @classdesc Control wrapping semantic zoom and listviews with a {@link WinJSContrib.UI.DataSources.DataSourceManager}\r\n     * @param {HTMLElement} element DOM element containing the control\r\n     * @param {Object} options\r\n     * \r\n     * @example {@lang xml}\r\n     * <div id=\"semanticzoom\" data-win-control=\"WinJSContrib.UI.SemanticListViews\" data-win-options=\"{\r\n     *      listview: { itemTemplate: select('#listItemTemplate'), groupHeaderTemplate : select('#groupItemTemplate')},\r\n     *      zoomedOutListview: { itemTemplate: select('#semanticItemTemplate')},\r\n     *      data: {\r\n     *          defaultGroupLimit: 12,\r\n     *          groupKind: WinJSContrib.UI.DataSources.Grouping.byField,\r\n     *          field: 'metadata.genre',\r\n     *          items: moviesSample\r\n     *      }}\">\r\n     * </div>\r\n     */\r\n    function ctor(element, options) {\r\n        this.element = element || document.createElement('DIV');\r\n        options = options || {};\r\n        this.element.winControl = this;\r\n        this.element.classList.add('win-disposable');\r\n        WinJS.UI.setOptions(this, options);\r\n        this._initControl(options);\r\n    },\r\n    /**\r\n     * @lends WinJSContrib.UI.SemanticListViews.prototype\r\n     */\r\n    {\r\n        /**\r\n         * semantic zoom control\r\n         * @field\r\n         * @type {WinJS.UI.SemanticZoom}\r\n         */\r\n        semanticZoom: {\r\n            get: function () {\r\n                return this._semanticZoom;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * items listview\r\n         * @field\r\n         * @type WinJS.UI.ListView \r\n         */\r\n        listview: {\r\n            get: function () {\r\n                return this._listview;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * listview for zoomed out items (usually groups)\r\n         * @field\r\n         * @type WinJS.UI.ListView \r\n         */\r\n        zoomedOutListview: {\r\n            get: function () {\r\n                return this._zoomedOutListview;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * dataManager datasource manager\r\n         * @field\r\n         * @type WinJSContrib.UI.DataSources.DataSourceManager \r\n         */\r\n        dataManager: {\r\n            get: function () {\r\n                return this._dataManager;\r\n            }\r\n        },\r\n\r\n        _initControl: function (options) {\r\n            var semanticPlaceholder = document.createElement('DIV')\r\n            semanticPlaceholder.style.width = '100%';\r\n            semanticPlaceholder.style.height = '100%';\r\n\r\n            var listviewPlaceholder = document.createElement('DIV');\r\n            listviewPlaceholder.style.width = '100%';\r\n            listviewPlaceholder.style.height = '100%';\r\n            listviewPlaceholder.className = 'zoomedinlist';\r\n\r\n            var zoomedOutListviewPlaceholder = document.createElement('DIV');\r\n            zoomedOutListviewPlaceholder.style.width = '100%';\r\n            zoomedOutListviewPlaceholder.style.height = '100%';\r\n            zoomedOutListviewPlaceholder.className = 'zoomedoutlist';\r\n\r\n            semanticPlaceholder.appendChild(listviewPlaceholder);\r\n            semanticPlaceholder.appendChild(zoomedOutListviewPlaceholder);\r\n            this.element.appendChild(semanticPlaceholder);\r\n\r\n            this._listview = new WinJS.UI.ListView(listviewPlaceholder, options.listview);\r\n            this._zoomedOutListview = new WinJS.UI.ListView(zoomedOutListviewPlaceholder, options.zoomedOutListview);\r\n\r\n            this._semanticZoom = new WinJS.UI.SemanticZoom(semanticPlaceholder, options.semanticzoom);\r\n\r\n            var dataOptions = options.data || {};\r\n            dataOptions.listview = this._listview;\r\n            dataOptions.zoomedOutListView = this._zoomedOutListview;\r\n            this._dataManager = new ds.DataSourceManager(dataOptions);\r\n        },\r\n\r\n        /**\r\n         * release control\r\n         */\r\n        dispose: function () {\r\n            WinJS.Utilities.disposeSubTree(this.element);\r\n        }\r\n    }), WinJS.UI.DOMEventMixin, WinJS.Utilities.createEventProperties(\"myevent\"));\r\n})(WinJSContrib.UI.DataSources, WinJSContrib.UI.DataSources.Grouping);\r\n\r\nif (WinJSContrib.UI.WebComponents) {\r\n    WinJSContrib.UI.WebComponents.register('mcn-semanticlistviews', WinJSContrib.UI.SemanticListViews, {\r\n        properties: [],\r\n        controls: {\r\n            \"listview\": WinJS.UI.ListView,\r\n            \"zoomedOutListview\": WinJS.UI.ListView,\r\n            \"semanticZoom\": WinJS.UI.SemanticZoom\r\n        },\r\n        map: {\r\n            \"DEFAULTGROUPLIMIT\": { attribute: 'defaultGroupLimit', property: '_dataManager.defaultGroupLimit', resolve: true },\r\n            \"GROUPKIND\": { attribute: 'groupKind', property: '_dataManager.groupKind', resolve: true },\r\n            \"FIELD\": { attribute: 'field', property: '_dataManager.field', resolve: true },\r\n            \"ITEMS\": { attribute: 'items', property: '_dataManager.items', resolve: true },\r\n        }\r\n    });\r\n}\r\n\r\n/** \r\n * Custom grouping settings for {@link WinJSContrib.UI.DataSources.DataSourceManager}\r\n * @namespace \r\n * @example\r\n * var datamgr = new WinJSContrib.UI.DataSources.DataSourceManager({\r\n *    defaultGroupLimit: 12,\r\n *    groupKind: WinJSContrib.UI.DataSources.Grouping.byField,\r\n *    field: 'metadata.genre',\r\n *    listview: page.zoomedInList,\r\n *    zoomedOutListView: page.zoomedOutList\r\n * });\r\n */\r\nWinJSContrib.UI.DataSources.Grouping = WinJSContrib.UI.DataSources.Grouping || {};\r\n\r\n(function (ds, gr) {\r\n    \"use strict\";\r\n\r\n    /**\r\n     * alphabetic grouping, use \"options.field\" to define the property used for grouping\r\n     * @param {Object} options grouping options\r\n     * @returns {Object} group manager\r\n     */\r\n    WinJSContrib.UI.DataSources.Grouping.alphabetic = WinJS.Utilities.markSupportedForProcessing(function (options) {\r\n        options = options || {};\r\n        options.defaultGroupName = options.defaultGroupName || '#';\r\n\r\n        options.compareGroups = options.compareGroups || function (left, right) {\r\n            return left.toUpperCase().charCodeAt(0) - right.toUpperCase().charCodeAt(0);\r\n        }\r\n\r\n        options.getGroupKey = options.getGroupKey || function (dataItem) {\r\n            if (!dataItem)\r\n                return this.defaultGroupName;\r\n\r\n            var val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                return this.defaultGroupName;\r\n\r\n            var key = val[0].toUpperCase();\r\n            return key;\r\n        }\r\n\r\n        options.getGroupData = options.getGroupData || function (dataItem) {\r\n            var val = '#';\r\n            if (dataItem)\r\n                val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                val = this.defaultGroupName;\r\n\r\n            var key = val[0].toUpperCase();\r\n            return {\r\n                title: key\r\n            };\r\n        }\r\n        return options;\r\n    });\r\n\r\n    /**\r\n     * grouping by a string field on items, use \"options.field\" to define the property used for grouping\r\n     * @param {Object} options grouping options\r\n     * @returns {Object} group manager\r\n     */\r\n    WinJSContrib.UI.DataSources.Grouping.byField = WinJS.Utilities.markSupportedForProcessing(function (options) {\r\n        options.defaultGroupName = options.defaultGroupName || '#';\r\n\r\n        options.compareGroups = options.compareGroups || function (a, b) {\r\n            if (a > b)\r\n                return 1;\r\n            if (a < b)\r\n                return -1;\r\n\r\n            return 0;\r\n        }\r\n\r\n        options.getGroupKey = options.getGroupKey || function (dataItem) {\r\n            if (!dataItem)\r\n                return this.defaultGroupName;\r\n\r\n            var val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                return this.defaultGroupName;\r\n\r\n            var key = val.toString().toUpperCase();\r\n            return key;\r\n        }\r\n\r\n        options.getGroupData = options.getGroupData || function (dataItem) {\r\n            var val = '#';\r\n            if (dataItem)\r\n                val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                val = this.defaultGroupName;\r\n\r\n            var key = val;\r\n            return {\r\n                title: key\r\n            };\r\n        }\r\n\r\n        return options;\r\n    });\r\n\r\n    /**\r\n     * grouping by year from a date field, use \"options.field\" to define the property used for grouping\r\n     * @param {Object} options grouping options\r\n     * @returns {Object} group manager\r\n     */\r\n    WinJSContrib.UI.DataSources.Grouping.byYear = WinJS.Utilities.markSupportedForProcessing(function (options) {\r\n        options.defaultGroupName = options.defaultGroupName || '#';\r\n\r\n        options.compareGroups = options.compareGroups || function (a, b) {\r\n            if (a > b)\r\n                return 1;\r\n            if (a < b)\r\n                return -1;\r\n\r\n            return 0;\r\n        }\r\n\r\n        options.getGroupKey = options.getGroupKey || function (dataItem) {\r\n            if (!dataItem)\r\n                return this.defaultGroupName;\r\n\r\n            var val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                return this.defaultGroupName;\r\n\r\n            var key = new Date(new Date(new Date(val).setMonth(0, 1)).setHours(0, 0, 0, 0));\r\n            return key.toISOString();\r\n        }\r\n\r\n        options.getGroupData = options.getGroupData || function (dataItem) {\r\n            var val = '#';\r\n            if (dataItem)\r\n                val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                val = this.defaultGroupName;\r\n\r\n            var key = new Date(new Date(new Date(val).setMonth(0, 1)).setHours(0, 0, 0, 0));\r\n            return {\r\n                title: key.getFullYear().toString(),\r\n                date: key\r\n            };\r\n        }\r\n\r\n        return options;\r\n    });\r\n\r\n    /**\r\n     * grouping by month from a date field, use \"options.field\" to define the property used for grouping\r\n     * @param {Object} options grouping options\r\n     * @returns {Object} group manager\r\n     */\r\n    WinJSContrib.UI.DataSources.Grouping.byMonth = WinJS.Utilities.markSupportedForProcessing(function (options) {\r\n        options.defaultGroupName = options.defaultGroupName || '#';\r\n\r\n        options.compareGroups = options.compareGroups || function (a, b) {\r\n            if (a > b)\r\n                return 1;\r\n            if (a < b)\r\n                return -1;\r\n\r\n            return 0;\r\n        }\r\n\r\n        options.getGroupKey = options.getGroupKey || function (dataItem) {\r\n            if (!dataItem)\r\n                return this.defaultGroupName;\r\n\r\n            var val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                return this.defaultGroupName;\r\n\r\n            var key = new Date(new Date(new Date(val).setDate(1)).setHours(0, 0, 0, 0));\r\n            return key.toISOString();\r\n        }\r\n\r\n        options.getGroupData = options.getGroupData || function (dataItem) {\r\n            var val = '#';\r\n            if (dataItem)\r\n                val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                val = this.defaultGroupName;\r\n\r\n            var key = new Date(new Date(new Date(val).setDate(1)).setHours(0, 0, 0, 0));\r\n            return {\r\n                title: WinJSContrib.Utils.pad2(key.getMonth() + 1) + '-' + key.getFullYear().toString(),\r\n                date: key\r\n            };\r\n        }\r\n\r\n        return options;\r\n    });\r\n\r\n    /**\r\n     * grouping by day from a date field, use \"options.field\" to define the property used for grouping\r\n     * @param {Object} options grouping options\r\n     * @returns {Object} group manager\r\n     */\r\n    WinJSContrib.UI.DataSources.Grouping.byDay = WinJS.Utilities.markSupportedForProcessing(function (options) {\r\n        options.defaultGroupName = options.defaultGroupName || '#';\r\n\r\n        options.compareGroups = options.compareGroups || function (a, b) {\r\n            if (a > b)\r\n                return 1;\r\n            if (a < b)\r\n                return -1;\r\n\r\n            return 0;\r\n        }\r\n\r\n        options.getGroupKey = options.getGroupKey || function (dataItem) {\r\n            if (!dataItem)\r\n                return this.defaultGroupName;\r\n\r\n            var val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                return this.defaultGroupName;\r\n\r\n            var key = new Date(new Date(val).setHours(0, 0, 0, 0));\r\n            return key.toISOString();\r\n        }\r\n\r\n        options.getGroupData = options.getGroupData || function (dataItem) {\r\n            var val = '#';\r\n            if (dataItem)\r\n                val = WinJSContrib.Utils.readProperty(dataItem, this.field);\r\n            if (!val)\r\n                val = this.defaultGroupName;\r\n\r\n            var key = new Date(new Date(val).setHours(0, 0, 0, 0));\r\n            return {\r\n                title: WinJSContrib.Utils.pad2(key.getMonth() + 1) + '-' + WinJSContrib.Utils.pad2(key.getDate()) + '-' + key.getFullYear().toString(),\r\n                date: key\r\n            };\r\n        }\r\n\r\n        return options;\r\n    });\r\n\r\n})(WinJSContrib.UI.DataSources, WinJSContrib.UI.DataSources.Grouping);\r\n","/// <reference path=\"winjscontrib.core.js\" />\r\n(function () {\r\n    'use strict';\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        AspectRatio: WinJS.Class.mix(WinJS.Class.define(function ctor(element, options) {\r\n            this.element = element || document.createElement('DIV');\r\n            options = options || {};\r\n            this.element.winControl = this;\r\n            this.element.style.display = 'none';\r\n            this.element.classList.add('mcn-aspectratio');\r\n            this.element.classList.add('win-disposable');\r\n            this.element.classList.add('mcn-layout-ctrl');\r\n            WinJS.UI.setOptions(this, options);\r\n            this.render();\r\n        }, {\r\n            baseWidth: {\r\n                get: function () {\r\n                    return this._baseWidth;\r\n                },\r\n                set: function (val) {\r\n                    this._baseWidth = val;\r\n                }\r\n            },\r\n\r\n            baseWidthMin: {\r\n                get: function () {\r\n                    return this._baseWidthMin;\r\n                },\r\n                set: function (val) {\r\n                    this._baseWidthMin = val;\r\n                }\r\n            },\r\n\r\n            baseWidthMargin: {\r\n                get: function () {\r\n                    return this._baseWidthMargin || 0;\r\n                },\r\n                set: function (val) {\r\n                    this._baseWidthMargin = val;\r\n                }\r\n            },\r\n\r\n            baseHeight: {\r\n                get: function () {\r\n                    return this._baseHeight;\r\n                },\r\n                set: function (val) {\r\n                    this._baseHeight = val;\r\n                }\r\n            },\r\n\r\n            baseHeightMin: {\r\n                get: function () {\r\n                    return this._baseHeightMin;\r\n                },\r\n                set: function (val) {\r\n                    this._baseHeightMin = val;\r\n                }\r\n            },\r\n\r\n            baseHeightMargin: {\r\n                get: function () {\r\n                    return this._baseHeightMargin || 0;\r\n                },\r\n                set: function (val) {\r\n                    this._baseHeightMargin = val;\r\n                }\r\n            },\r\n\r\n            ratio: {\r\n                get: function () {\r\n                    return this._ratio;\r\n                },\r\n                set: function (val) {\r\n                    this._ratio = val;\r\n                }\r\n            },\r\n\r\n            basedOn: {\r\n                get: function () {\r\n                    return this._basedOn;\r\n                },\r\n                set: function (val) {\r\n                    this._basedOn = val;\r\n                }\r\n            },\r\n\r\n            target: {\r\n                get: function () {\r\n                    return this._target;\r\n                },\r\n                set: function (val) {\r\n                    this._target = val;\r\n                }\r\n            },\r\n\r\n            render: function () {\r\n                var ctrl = this;\r\n                if (!ctrl.styleElt) {\r\n                    ctrl.styleElt = document.createElement('STYLE');\r\n                    ctrl.element.appendChild(ctrl.styleElt);\r\n                }\r\n                ctrl.updateLayout();\r\n            },\r\n\r\n            pageLayout: function () {\r\n                this.updateLayout();\r\n            },\r\n\r\n            updateLayout: function () {\r\n                var ctrl = this;\r\n\r\n                if (!ctrl.parentpage)\r\n                    ctrl.parentpage = WinJSContrib.Utils.getScopeControl(ctrl.element);\r\n\r\n                if (!ctrl.container)\r\n                    ctrl.container = ctrl.element.parentElement;\r\n\r\n                if (ctrl.container && ctrl.target) {\r\n                    if (ctrl.basedOn == \"height\") {\r\n                        ctrl.updateLayoutBasedOnHeight();\r\n                    } else {\r\n                        ctrl.updateLayoutBasedOnWidth();\r\n                    }\r\n                }\r\n            },\r\n\r\n            updateLayoutBasedOnWidth: function () {\r\n                var ctrl = this;\r\n\r\n                var classname = ctrl.target;\r\n                if (ctrl.prefix) {\r\n                    classname = ctrl.prefix + ' ' + classname;\r\n                }\r\n\r\n                var container = ctrl.parentpage.element;\r\n                if (ctrl.baseWidth) {\r\n                    var nbitems = ((ctrl.container.clientWidth / ctrl.baseWidth) << 0) + 1;\r\n                    var itemW = ((ctrl.container.clientWidth / nbitems) << 0) - ctrl.baseWidthMargin - 0.25;\r\n                    if (ctrl.ratio) {\r\n                        var targetH = (itemW / ctrl.ratio) << 0;\r\n                        ctrl.styleElt.innerHTML = classname + \"{ width: \" + itemW + \"px; height:\" + targetH + \"px}\";\r\n                    } else {\r\n                        ctrl.styleElt.innerHTML = classname + \"{ width: \" + itemW + \"px; }\";\r\n                    }\r\n                } else if (ctrl.ratio) {\r\n                    var elements = ctrl.container.querySelectorAll(ctrl.target);\r\n                    var eltW = elements[0].clientWidth;\r\n                    var eltH = elements[0].clientHeight;\r\n\r\n                    if (eltW > 0) {\r\n                        var targetH = (eltW / ctrl.ratio) << 0;\r\n                        if (ctrl.max) {\r\n                            var maxH = (container.clientHeight * ctrl.max / 100) << 0;\r\n                            if (targetH > maxH) {\r\n                                targetH = maxH;\r\n                            }\r\n                        }\r\n                        ctrl.styleElt.innerHTML = classname + \"{ height:\" + targetH + \"px}\";\r\n                    }\r\n                } else {\r\n                    console.warn(\"aspect ratio control must have baseWidth and/or ratio\")\r\n                }\r\n            },\r\n\r\n            updateLayoutBasedOnHeight: function () {\r\n                var ctrl = this;\r\n\r\n                var classname = ctrl.target;\r\n                if (ctrl.prefix) {\r\n                    classname = ctrl.prefix + ' ' + classname;\r\n                }\r\n\r\n                if (ctrl.baseHeight) {\r\n                    var nbitems = ((ctrl.container.clientHeight / ctrl.baseHeight) << 0) + 1;\r\n                    var itemH = ((ctrl.container.clientHeight / nbitems) << 0) - ctrl.baseHeightMargin;\r\n                    var targetW = (itemH / ctrl.ratio) << 0;\r\n                    ctrl.styleElt.innerHTML = classname + \"{ width: \" + targetW + \"px; height:\" + itemH + \"px}\";\r\n                } else {\r\n                    var elements = ctrl.container.querySelectorAll(ctrl.target);\r\n                    var eltW = elements[0].clientWidth;\r\n                    var eltH = elements[0].clientHeight;\r\n\r\n                    if (eltH > 0) {\r\n                        var targetW = (eltH * ctrl.ratio) << 0;\r\n                        if (ctrl.max) {\r\n                            var maxW = (ctrl.container.clientWidth * ctrl.max / 100) << 0;\r\n                            if (targetW > maxW) {\r\n                                targetW = maxW;\r\n                            }\r\n                        }\r\n                        ctrl.styleElt.innerHTML = classname + \"{ width:\" + targetW + \"px}\";\r\n                    }\r\n                }\r\n            },\r\n\r\n            dispose: function () {\r\n                var ctrl = this;\r\n                ctrl.parentpage = null;\r\n                ctrl.container = null;\r\n                ctrl.styleElt.parentElement.removeChild(ctrl.styleElt);\r\n                WinJS.Utilities.disposeSubTree(this.element);\r\n                this.element = null;\r\n            }\r\n        }),\r\n\t\tWinJS.Utilities.eventMixin,\r\n\t\tWinJS.Utilities.createEventProperties(\"myevent\"))\r\n    });\r\n})();","(function () {\r\n    'use strict';\r\n    WinJS.Namespace.define(\"WinJSContrib.UI\", {\r\n        VisualState: WinJS.Class.mix(WinJS.Class.define(function ctor(element, options) {\r\n            this.element = element || document.createElement('DIV');\r\n            options = options || {};\r\n            this.element.winControl = this;\r\n            this.element.style.display = \"none\";\r\n            this.element.classList.add('mcn-visualstate');\r\n            this.element.classList.add('mcn-layout-ctrl');\r\n            this.element.classList.add('win-disposable');\r\n            WinJS.UI.setOptions(this, options);\r\n        }, {\r\n            states: {\r\n                get: function () {\r\n                    return this._states;\r\n                },\r\n                set: function (val) {\r\n                    this._states = val;\r\n                }\r\n            },\r\n\r\n            target: {\r\n                get: function () {\r\n                    return this._target;\r\n                },\r\n                set: function (val) {\r\n                    this._target = val;\r\n                }\r\n            },\r\n\r\n            checkAllStates: function (name, state) {\r\n                var ctrl = this;\r\n                if (ctrl.states) {\r\n                    for (var n in ctrl.states) {\r\n                        ctrl.checkState(n, ctrl.states[n]);\r\n                    }\r\n                }\r\n            },\r\n\r\n            checkState: function (name, state) {\r\n                var ctrl = this;\r\n                if (!ctrl.element)\r\n                    return;\r\n\r\n                var target = ctrl.target || ctrl.element.parentElement;\r\n                var targetW = target.clientWidth;\r\n                var targetH = target.clientHeight;\r\n                var evaluate = true;\r\n                if (state.wGt)\r\n                    evaluate = evaluate && targetW > state.wGt;\r\n                if (state.wLt)\r\n                    evaluate = evaluate && targetW < state.wLt;\r\n                if (state.hGt)\r\n                    evaluate = evaluate && targetH > state.hGt;\r\n                if (state.hLt)\r\n                    evaluate = evaluate && targetH < state.hLt;\r\n\r\n                if (evaluate) {\r\n                    state.active = true;\r\n                    target.classList.add(\"state-\" + name);\r\n                } else {\r\n                    state.active = false;\r\n                    target.classList.remove(\"state-\" + name);\r\n                }\r\n            },\r\n\r\n            pageLayout: function () {\r\n                var ctrl = this;\r\n                ctrl.checkAllStates();\r\n            },\r\n\r\n            updateLayout: function () {\r\n                var ctrl = this;\r\n                ctrl.checkAllStates();\r\n            },\r\n\r\n            dispose: function () {\r\n                WinJS.Utilities.disposeSubTree(this.element);\r\n                this.element = null;\r\n            }\r\n        }),\r\n\t\tWinJS.Utilities.eventMixin,\r\n\t\tWinJS.Utilities.createEventProperties(\"myevent\"))\r\n    });\r\n})();"],"sourceRoot":" "}