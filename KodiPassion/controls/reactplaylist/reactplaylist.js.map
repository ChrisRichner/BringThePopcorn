{"version":3,"sources":["reactplaylist.jsx"],"names":[],"mappings":"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","file":"KodiPassion/controls/reactplaylist/reactplaylist.js","sourcesContent":["var KodiPassion = KodiPassion || {};\r\nKodiPassion.UI = KodiPassion.UI || {};\r\n(function () {\r\n    'use strict';\r\n    var CSSTransitionGroup = React.addons.CSSTransitionGroup;\r\n\r\n    class PlaylistItem extends React.Component {\r\n        render() {\r\n            return (<div key={this.props.data.id} className={ (Kodi.NowPlaying.current.id==this.props.data.id) ? \"playlist-item current\" : \"playlist-item\" }>\r\n                <img src={this.props.picture} className=\"thumbnail\" draggable=\"false\" />\r\n                <div className=\"desc\">\r\n                    <div className=\"title\">{this.props.data.label}</div>\r\n                    <div className=\"album\">\r\n                        <div>{this.props.data.artist}</div>\r\n                        <div>{this.props.data.album}</div>\r\n                    </div>\r\n                </div>\r\n                <div className=\"actions\">\r\n                    <button className=\"blink btnplay kdp-play\"></button>\r\n                    <button className=\"blink btnremove kdp-close\"></button>\r\n                </div>\r\n            </div>);\r\n        }\r\n\r\n        componentDidMount() {\r\n            var node = React.findDOMNode(this);\r\n            node.style.opacity = '0';\r\n            var delay = Math.max(this.props.index*40, 300);\r\n            setTimeout(function () {                 \r\n                WinJSContrib.UI.Animation.slideFromBottom(node);\r\n            }, delay);\r\n            this.registerEvents(node);\r\n        }\r\n\r\n        componentDidUpdate() {\r\n            var node = React.findDOMNode(this);\r\n            this.registerEvents(node);\r\n        }\r\n\r\n        componentWillUpdate(nextProps, nextState) {\r\n            var node = React.findDOMNode(this);\r\n            var targeturl = Kodi.API.kodiThumbnail(nextProps.data.thumbnail);\r\n            var thumbnail = node.querySelector(\".thumbnail\");\r\n            if (thumbnail && thumbnail.src == targeturl) {\r\n                nextProps.picture = thumbnail.src;\r\n            }\r\n        }\r\n\r\n        registerEvents(node) {            \r\n            var thumbnail = node.querySelector(\".thumbnail\");\r\n            if (!thumbnail.src) {\r\n                Kodi.Utils.toThumbnailBg(this.props.data, ['thumbnail'], thumbnail, ['src']);\r\n            }\r\n            var btnplay = node.querySelector(\".btnplay\");\r\n            WinJSContrib.UI.tap(btnplay, () => {\r\n                return Kodi.API.Player.moveTo(Kodi.NowPlaying.current.playerid, this.props.index).then(() => {\r\n                    var e = document.createEvent('Event');\r\n                    e.initEvent('refreshplaylist', true, true);\r\n                    node.dispatchEvent(e);\r\n                });\r\n            });\r\n\r\n            var btnremove = node.querySelector(\".btnremove\");\r\n            WinJSContrib.UI.tap(btnremove, () => {\r\n                return Kodi.API.PlayList.removeAt(Kodi.NowPlaying.current.playlistid, this.props.index).then(() => {\r\n                    return WinJSContrib.UI.removeElementAnimation(node).then(() => {\r\n                        var e = document.createEvent('Event');\r\n                        e.initEvent('refreshplaylist', true, true);\r\n                        node.dispatchEvent(e);\r\n                    });\r\n                });\r\n            });\r\n        }\r\n    }\r\n\r\n    class PlaylistItemsList extends React.Component {\r\n        render() {\r\n            this.props.items = this.props.items || [];\r\n\r\n            return (<div className=\"playlist-items\">\r\n                        {this.props.items.map(function(item, idx) {\r\n                        return <PlaylistItem index={idx} data={item} />\r\n                        })}\r\n            </div>);\r\n        }\r\n    }\r\n\r\n    class ReactPlayListControl {\r\n        constructor(element, options) {\r\n            this.element = element || document.createElement('DIV');\r\n            this.eventTracker = new WinJSContrib.UI.EventTracker();\r\n            options = options || {};\r\n            this.element.winControl = this;\r\n            this.element.classList.add('reactplaylistcontrol');\r\n            this.element.classList.add('win-disposable');\r\n            this.element.classList.add('mcn-layout-ctrl');\r\n            WinJS.UI.setOptions(this, options);\r\n            this.compFactory = React.createFactory(PlaylistItemsList);\r\n\r\n            this.eventTracker.addEvent(this.element, \"refreshplaylist\", () => {\r\n                this.refresh();\r\n            });\r\n\r\n            this.eventTracker.addBinding(Kodi.NowPlaying.current, \"id\", () => {\r\n                this.refresh();\r\n            });\r\n\r\n            this.eventTracker.addBinding(Kodi.NowPlaying.current, \"expanded\", () => {\r\n                this.refresh();\r\n                if (!Kodi.NowPlaying.current.expanded) {\r\n                    this.element.innerHTML = \"\";\r\n                }\r\n            });\r\n\r\n            this.eventTracker.addEvent(WinJS.Application, \"Playlist.OnAdd\", () => {\r\n                clearTimeout(this.throttle);\r\n                this.throttle = setTimeout(() => {\r\n                    var delta = (new Date()) - this.lastrefresh;\r\n                    if (delta > 1000) {\r\n                        this.refresh();\r\n                    }\r\n                }, 700);\r\n\r\n            });\r\n        }\r\n\r\n        get items() {\r\n            return this._items;\r\n        }\r\n\r\n        set items(val) {\r\n            this._items = val;\r\n            this.refresh();\r\n        }\r\n\r\n        refresh() {\r\n            if (Kodi.NowPlaying.current.expanded) {\r\n                console.info(\"refresh playlist\");\r\n                Kodi.API.PlayList.getItems(Kodi.NowPlaying.current.playlistid).then((playlist) => {\r\n                    this._items = playlist.items;\r\n\r\n                    this.component = React.render(this.compFactory({ items: this.items }), this.element);\r\n                    this.lastrefresh = new Date();\r\n                }, (err) => {\r\n                    console.error(err);\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    KodiPassion.UI.ReactPlayListControl = ReactPlayListControl;\r\n})();"],"sourceRoot":" "}