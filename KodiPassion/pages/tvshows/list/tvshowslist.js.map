{"version":3,"sources":["tvshowslist.ts"],"names":["KodiPassion","KodiPassion.UI","KodiPassion.UI.Pages","KodiPassion.UI.Pages.TvShowsListPage","KodiPassion.UI.Pages.TvShowsListPage.constructor","KodiPassion.UI.Pages.TvShowsListPage.init","KodiPassion.UI.Pages.TvShowsListPage.setView","KodiPassion.UI.Pages.TvShowsListPage.cleanViewClasses","KodiPassion.UI.Pages.TvShowsListPage.processed","KodiPassion.UI.Pages.TvShowsListPage.ready","KodiPassion.UI.Pages.TvShowsListPage.pickGenre","KodiPassion.UI.Pages.TvShowsListPage.updateLayout","KodiPassion.UI.Pages.TvShowsListPage.calcItemsSizes"],"mappings":"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","file":"KodiPassion/pages/tvshows/list/tvshowslist.js","sourcesContent":["module KodiPassion.UI.Pages {\r\n\r\n    export class TvShowsListPage {\r\n        public static url = \"/pages/tvshows/list/tvshowslist.html\";\r\n\r\n        itemsPromise: WinJS.Promise<any>;\r\n        selectedGenre: string;\r\n        semanticzoom: any;\r\n        element: HTMLElement;\r\n        genretitle: HTMLElement;\r\n        listitemtemplate: WinJS.Binding.Template;\r\n        itemsStyle: HTMLStyleElement;\r\n        tvshows: Kodi.API.Videos.TVShows.TVShow[];\r\n        genres: Kodi.API.Genre[];\r\n\r\n\r\n        static tvshowsViews = {\r\n            \"wall\": {\r\n                groupKind: null,\r\n                groupField: null,\r\n                template: '/templates/tvshowposter.html'\r\n            },\r\n            \"alphabetic\": {\r\n                groupKind: WinJSContrib.UI.DataSources.Grouping.alphabetic,\r\n                groupField: 'title',\r\n                template: '/templates/tvshowposter.html'\r\n            },\r\n            \"year\": {\r\n                groupKind: WinJSContrib.UI.DataSources.Grouping.alphabetic,\r\n                groupField: 'year',\r\n                template: '/templates/tvshowposter.html'\r\n            }\r\n        }\r\n\r\n        init(element, options) {\r\n            var page = this;\r\n            element.classList.add(\"page-tvshowslist\");\r\n            var view = TvShowsListPage.tvshowsViews[\"wall\"];\r\n            page.itemsPromise = Kodi.Data.loadRootData();\r\n        }\r\n\r\n        setView(viewname) {\r\n            var page = this;\r\n            page.cleanViewClasses();\r\n            var view = TvShowsListPage.tvshowsViews[viewname] || TvShowsListPage.tvshowsViews[\"wall\"];\r\n            if (view.groupKind) {\r\n                page.semanticzoom.dataManager.groupKind = view.groupKind;\r\n                page.semanticzoom.dataManager.field = view.groupField;\r\n            }\r\n            page.element.classList.add(\"view-\" + viewname);\r\n            page.listitemtemplate = new WinJS.Binding.Template(null, { href: view.template });\r\n            page.semanticzoom.listview.itemTemplate = page.listitemtemplate.element;\r\n        }\r\n\r\n        cleanViewClasses() {\r\n            var page = this;\r\n            for (var v in TvShowsListPage.tvshowsViews) {\r\n                page.element.classList.remove(\"view-\" + v);\r\n            }\r\n        }\r\n\r\n        processed(element, options) {\r\n            var page = this;\r\n\r\n            if (options && options.genre) {\r\n                page.selectedGenre = options.genre;\r\n                page.genretitle.innerText = page.selectedGenre;\r\n            }\r\n\r\n            page.itemsStyle = <HTMLStyleElement>document.createElement(\"STYLE\");\r\n            page.element.appendChild(page.itemsStyle);\r\n            page.itemsPromise = page.itemsPromise.then(function (data: Kodi.Data.IMediaLibrary) {\r\n                page.tvshows = data.tvshows.tvshows;\r\n                page.genres = data.tvshowGenres.genres;\r\n                page.setView(\"wall\");\r\n                page.semanticzoom.dataManager.filter = function (movie) {\r\n                    if (!page.selectedGenre)\r\n                        return true;\r\n\r\n                    var hasgenre = movie.allgenres.indexOf(page.selectedGenre) >= 0;\r\n                    return hasgenre;\r\n                }\r\n                page.semanticzoom.listview.layout = new WinJS.UI.GridLayout();\r\n                page.semanticzoom.listview.layout.orientation = \"vertical\";\r\n                page.semanticzoom.listview.oniteminvoked = function (arg) {\r\n                    arg.detail.itemPromise.then(function (item) {\r\n                        WinJS.Navigation.navigate(\"/pages/tvshows/seriedetail/tvshowsseriedetail.html\", { tvshow: item.data, navigateStacked: true });\r\n                    });\r\n                }\r\n            });\r\n        }\r\n\r\n        ready() {\r\n            var page = this;\r\n            page.itemsPromise.then(function () {\r\n                page.calcItemsSizes();\r\n                page.semanticzoom.dataManager.items = page.tvshows;\r\n            });\r\n        }\r\n\r\n        pickGenre() {\r\n            var page = this;\r\n            KodiPassion.UI.GenrePicker.pick(page.genres).then(function (genre) {\r\n                if (genre) {\r\n                    if (genre === \"all\") {\r\n                        page.selectedGenre = null;\r\n                        page.genretitle.innerText = \"all\";\r\n                    } else {\r\n                        page.selectedGenre = genre.label;\r\n                        page.genretitle.innerText = page.selectedGenre;\r\n                    }\r\n                    page.semanticzoom.dataManager.refresh();\r\n                }\r\n            });\r\n        }\r\n\r\n        updateLayout(element) {\r\n            var page = this;\r\n            this.calcItemsSizes();\r\n            page.semanticzoom.listview.forceLayout();\r\n        }\r\n\r\n        calcItemsSizes() {\r\n            var page = this;\r\n            var w = page.element.clientWidth;\r\n            if (w) {\r\n                var nbitems = ((w / 260) << 0) + 1;\r\n                var posterW = ((w / nbitems) << 0) - 1;\r\n                var posterH = (posterW / Kodi.App.PictureRatios.movieposter) << 0;\r\n                page.itemsStyle.innerHTML = \".page-tvshowslist.view-wall .tvshow { width:\" + posterW + \"px; height:\" + posterH + \"px}\";\r\n            }\r\n        }\r\n    }\r\n\r\n    WinJS.UI.Pages.define(TvShowsListPage.url, TvShowsListPage);\r\n}\r\n"],"sourceRoot":" "}